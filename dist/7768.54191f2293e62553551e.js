"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[7768],{25404:(e,t,s)=>{s.d(t,{A:()=>m});var a=s(84051),o=s(13439),i=s(31481),n=s(85982),r=s(17663),d=s(80140),c=s(39351),l=s(17712),u=s(59030),h=s(24433),p=s(20021);const m=(0,a.ph)(({peerId:e,canManage:t,gift:s,currentUserEmojiStatus:m,collectibleEmojiStatuses:f})=>{const{showNotification:g,openChatWithDraft:I,openGiftTransferModal:v,openGiftResalePriceComposerModal:b,openGiftStatusInfoModal:y,setEmojiStatus:S,toggleSavedGiftPinned:w,changeGiftVisibility:A,updateStarGiftPrice:M,closeGiftInfoModal:C}=(0,o.ko)(),P=(0,c.A)(),k=(0,u.A)(),F=s&&"gift"in s,T=F?s:void 0,U=F?s.gift:s,x="starGiftUnique"===U?.type?U.slug:void 0,B=(0,a.Kr)(()=>{if(x)return`${i.jsp}nft/${x}`},[x]),R=(0,a.Kr)(()=>{if(x)return f?.find(e=>"collectible"===e.type&&e.slug===x)},[x,f]),J="collectible"===m?.type?m.slug:void 0,N=U&&"starGiftUnique"===U.type,E=N&&J===U.slug,L=R&&!E,O=N?U.resellPrice:void 0,D=t&&T&&!T.isUnsaved&&N,Y=(0,l.A)(()=>{const{inputGift:e,isUnsaved:t}=T;A({gift:e,shouldUnsave:!t})}),G=(0,l.A)(()=>{B&&((0,n.eM)(B),g({message:P("LinkCopied")}))}),V=(0,l.A)(()=>{B&&I({text:{text:B}})}),j=(0,l.A)(()=>{T&&"starGiftUnique"===T?.gift.type&&(T.canTransferAt&&T.canTransferAt>(0,d.Fm)()?g({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,r.U)(k,1e3*T.canTransferAt)}}}):v({gift:T}))}),q=(0,l.A)(()=>{T&&(T.canResellAt&&T.canResellAt>(0,d.Fm)()?g({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,r.U)(k,1e3*T.canResellAt)}}}):b({peerId:e,gift:T}))}),W=(0,l.A)(()=>{T&&"starGiftUnique"===T.gift.type&&T.inputGift&&(C(),M({gift:T.inputGift,price:{currency:i.OUy,amount:0,nanos:0}}),g({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:P("GiftUnique",{title:T.gift.title,number:T.gift.number})}}}))}),K=(0,l.A)(()=>{"starGiftUnique"===U?.type&&R&&y({emojiStatus:R})}),z=(0,l.A)(()=>{E&&S({emojiStatus:{type:"regular",documentId:i.zNY}})}),H=(0,l.A)(()=>{w({peerId:e,gift:T})});return(0,p.FD)(p.FK,{children:[D&&(0,p.Y)(h.A,{icon:T.isPinned?"unpin":"pin",onClick:H,children:P(T.isPinned?"ChatListUnpinFromTop":"ChatListPinToTop")}),(0,p.Y)(h.A,{icon:"link-badge",onClick:G,children:P("CopyLink")}),(0,p.Y)(h.A,{icon:"forward",onClick:V,children:P("Share")}),t&&N&&(0,p.Y)(h.A,{icon:"diamond",onClick:j,children:P("GiftInfoTransfer")}),t&&N&&!O&&(0,p.Y)(h.A,{icon:"sell-outline",onClick:q,children:P("Sell")}),t&&N&&Boolean(O)&&(0,p.Y)(h.A,{icon:"unlist-outline",onClick:W,children:P("GiftInfoUnlist")}),t&&T&&(0,p.Y)(h.A,{icon:T.isUnsaved?"eye-outline":"eye-crossed-outline",onClick:Y,children:P(T.isUnsaved?"GiftActionShow":"GiftActionHide")}),L&&(0,p.Y)(h.A,{icon:"crown-wear-outline",onClick:K,children:P("GiftInfoWear")}),E&&(0,p.Y)(h.A,{icon:"crown-take-off-outline",onClick:z,children:P("GiftInfoTakeOff")})]})})},33020:(e,t,s)=>{s.r(t),s.d(t,{LockScreen:()=>kd,Main:()=>Md});var a=s(31481),o=(s(48544),s(42347)),i=s(23174),n=s(89925),r=s(24585),d=s(96454),c=s(85982),l=s(46275),u=s(14487),h=s(87894),p=s(60343),m=s(43044),f=s(48775),g=s(6e4),I=s(37836),v=s(80140),b=s(4875),y=s(90709),S=s(70636),w=s(13439),A=s(17872),M=s(32989),C=s(57639),P=s(22986),k=s(48899),F=s(5560),T=s(26129),U=s(43503),x=s(76023);const B=32*x.$,R=45.5*x.$,J=26.5*x.$,N=16*x.$,E=16.125*x.$;var L=s(16350),O=s(82150),D=s(43874);function Y(e,t){return t-((0,C.nTw)(e).isLeftColumnShown&&!(0,D.Ny)()?e.leftColumnWidth||((s=U.A.get().width)>a.gQx?Math.min(Math.max(.25*s,N),.33*s):s>a.j7z?Math.min(Math.max(.33*s,N),.4*s):J):0);var s}function G(e,t,s){const a=(0,C.nZ4)(e,t.chatId),o=t.reactions||{results:[],areTags:a},i=(0,C.VF$)(e,t.chatId),n=(0,y.AK)(o.results,s);let{recentReactions:r=[]}=o;return r.length&&(r=r.filter(({isOwn:t,peerId:s})=>!t&&s!==e.currentUserId)),s.forEach(t=>{const{currentUserId:s}=e;"paid"!==t.type&&r.unshift({peerId:i?.id||s,reaction:t,addedDate:Math.floor(Date.now()/1e3),isOwn:!0})}),(0,O.r3)(e,t.chatId,t.id,{reactions:{...o,results:n,recentReactions:r}})}function V(e,t,s){return(0,L.wi)(e,t,s,!0)}const j=350,q=1e3;let W=0;function K(e,t,s,a,o,i,n,r){const d=r?.reactions;if(d&&(0,P.T)(o,d))return e;const c=d?.results.find(e=>e.localAmount);if(c?.localAmount){const{localIsPrivate:e,localAmount:t,localPeerId:s}=c;o.results=(0,y.Ny)(o.results,t,e,s)}if(e=(0,A.r3y)(e,s,a,{reactions:o}),!n)return e;const{reaction:l,isOwn:h,isUnread:m}=o.recentReactions?.[0]??{};if((0,C.xYJ)(e,"reactionEffects")&&r&&l&&m&&!h){const e=(0,p.bj)(r);t.startActiveReaction({containerId:e,reaction:l,tabId:(0,u.g0)()})}const f=i.unreadReactions?.includes(a),g=(0,y.pU)(e,o);if(g&&!f){e=V(e,s,{unreadReactionsCount:(i?.unreadReactionsCount||0)+1,unreadReactions:[...i?.unreadReactions||[],a].sort((e,t)=>t-e)});const t=(0,C.O5q)(e,s,a);if(!i||!t)return e;(0,I.aj)(()=>{(0,F.Oq)({chat:i,message:t,isReaction:!0})})}return!g&&f&&(e=V(e,s,{unreadReactionsCount:(i?.unreadReactionsCount||1)-1,unreadReactions:i?.unreadReactions?.filter(e=>e!==a)})),e}function z(e,t,s,a,o,i=!1){const n=i?(0,C.Jl6)(e,t,s):(0,C.O5q)(e,t,s);if(!n&&!a)return e;if(n&&o.content&&!(0,p.iL)(s)){const{photo:e,video:t,sticker:s,document:a}=(0,y.r_)(n);e&&o.content.photo?(o.content.photo.blobUrl??=e.blobUrl,o.content.photo.thumbnail??=e.thumbnail):t&&o.content.video?o.content.video.blobUrl??=t.blobUrl:s&&o.content.sticker?o.content.sticker.isPreloadedGlobally??=s.isPreloadedGlobally:a&&o.content.document&&(o.content.document.previewBlobUrl??=a.previewBlobUrl)}const r=n?{...n,...o}:o;return i?(0,A.Egm)(e,t,s,r):(0,A.r3y)(e,t,s,r)}function H(e,t,s,a){const{chatId:o}=s,i=(0,T.Q)(s),{threadInfo:n}=(0,C.Tac)(e,s)||{};if(!n&&i?.replyToMsgId){const n=(0,C.O5q)(e,o,i.replyToMsgId);n?e=(0,A.Wwn)(e,n,o,s.id,a):t.loadMessage({chatId:o,messageId:i.replyToMsgId,threadUpdate:{isDeleting:a,lastMessageId:s.id}})}return e}function _(e,t,s){const{id:a,chatId:o}=s,n=(0,C.QP5)(e,s),{threadInfo:r}=(0,C.Tac)(e,s)||{},d=(0,C.hds)(e,o),c=d?.unreadCount&&!(0,C.gCU)(e,o,i.l3);e=H(e,t,s);const{threadId:l}=r??{threadId:n};return l&&(e=(0,A.d4w)(e,o,l,[a]),Object.values(e.byTabId).forEach(({id:t})=>{if((0,C.haw)(e,o,l,t)){const s=(0,C.RjD)(e,o,l),i=(0,A.fgD)(e,o,l,a,t),n=(0,C.rA3)(i,o,l,t);s&&!n.includes(s)||(e=i)}}),r&&(e=(0,A.eww)(e,o,l,"threadInfo",{...r,lastMessageId:s.id}),(0,y.Nb)(s)||(0,y._P)(s)||(e=(0,A.eAk)(e,o,l,{messagesCount:(r.messagesCount||0)+1})))),c||(e=(0,A.d4w)(e,o,i.l3,[a]),Object.values(e.byTabId).forEach(({id:t})=>{if((0,C.haw)(e,o,i.l3,t)){const s=(0,C.RjD)(e,o,i.l3),n=(0,A.fgD)(e,o,i.l3,a,t),r=(0,C.rA3)(n,o,i.l3,t);s&&!r.includes(s)||(e=n)}})),e}function $(e,t,s,a=!1){const{chats:o}=e,i=o.byId[t],n=(0,C.ZZX)(e,t),r=i?.isForum?(0,C.nkm)(e,s):void 0;r&&(e=(0,A.TwA)(e,t,r.id,{lastMessageId:s.id}));const d=(0,C.L_2)(e,s);e=(0,A.eAk)(e,t,d,{lastMessageId:s.id});const c=(0,C.QP5)(e,s);return c&&(e=(0,A.yKC)(e,c,s.id,"saved")),!n||a||n===s.id||n===s.previousLocalId||s.id>n?(0,A.yKC)(e,t,s.id):e}function X(e,t,s=i.l3){const a=(0,C.zeq)(e,t),o=(0,C.gCU)(e,t,s);if(!a||!o)return;let n=o.length;for(;n--;){const e=a[o[n]];if(e&&!e.isDeleting)return e}}function Q(e,t,s,a){if(t){const o=(0,C.hds)(e,t);if(!o)return;const n=new Set;n.add(i.l3),s.forEach(s=>{e=(0,A.r3y)(e,t,s,{isDeleting:!0}),(0,C.S0q)(e,t,s)&&(e=(0,A.do9)(e,t,s));const o=(0,C.O5q)(e,t,s);if(!o)return;"chatEditPhoto"===o.content.action?.type&&o.content.action.photo&&(e=(0,A.sol)(e,t,o.content.action.photo.id,!0)),e=H(e,a,o,!0);const i=(0,C.L_2)(e,o);i&&n.add(i)}),a.requestChatUpdate({chatId:t});const r=new Set(s);n.forEach(s=>{const n=(0,C.Vw0)(e,t,s);if(!n?.lastMessageId||!r.has(n.lastMessageId))return;const d=X(e,t,s);d?(s===i.l3&&(e=$(e,t,d,!0)),e=(0,A.eAk)(e,t,s,{lastMessageId:d.id}),o.isForum&&(e=(0,A.TwA)(e,t,Number(s),{lastMessageId:d.id}))):o.isForum&&s!==i.l3&&a.loadTopicById({chatId:t,topicId:Number(s)})}),(0,w.UF)(e);const d=(0,C.Rwe)(e);return void setTimeout(()=>{e=(0,w.mS)();const a=s.filter(s=>(0,C.O5q)(e,t,s)?.isDeleting);e=(0,A.AH0)(e,t,a),(0,w.UF)(e)},d?q:j)}const o=[];s.forEach(t=>{const s=(0,C.Egn)(e,t);if(s){o.push(s);const i=X(e=(0,A.r3y)(e,s,t,{isDeleting:!0}),s);i&&(e=$(e,s,i,!0));const n=(0,C.O5q)(e,s,t);if((0,C.nZ4)(e,s)&&n){const t=(0,C.L_2)(e,n);if((0,y.cG)(s,t,e.currentUserId)){const o=X(e,s,t);a.requestSavedDialogUpdate({chatId:String(t)}),o&&(e=(0,A.yKC)(e,s,o.id,"saved"))}}"chatEditPhoto"===n?.content.action?.type&&n.content.action.photo&&(e=(0,A.sol)(e,s,n.content.action.photo.id,!0));const r=(0,C.Rwe)(e);setTimeout(()=>{e=(0,w.mS)(),e=(0,A.AH0)(e,s,[t]),(0,w.UF)(e)},r?q:j)}}),(0,w.UF)(e),(0,h.Am)(o).forEach(e=>{a.requestChatUpdate({chatId:e})})}(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"newMessage":{const{chatId:a,id:o,message:i,shouldForceReply:n,wasDrafted:r,poll:d,webPage:c}=s;e=_(e=z(e,a,o,!0,i),t,i);const l=(0,C.O5q)(e,a,o),u=(0,T.Q)(l),h=(0,T.W)(l),p=(0,C.hds)(e,a);p?.isForum&&u?.isForumTopic&&!(0,C.nkm)(e,l)&&u.replyToMsgId&&t.loadTopicById({chatId:a,topicId:u.replyToMsgId});const m=(0,y.Nb)(i);if(Object.values(e.byTabId).forEach(({id:s})=>{m&&r&&(e=$(e,a,l));const d=(0,C.L_2)(e,l);if(e=(0,A.PKO)(e,l,a,d,s),(0,C.fo$)(e,a,i,s)){if(m&&i.isOutgoing&&!i.content?.action&&!h?.storyId&&!i.content?.storyData){const o=(0,C.Xf0)(e,s);o&&t.focusMessage({chatId:a,threadId:o.threadId,messageId:i.id,noHighlight:!0,isResizingContainer:!0,tabId:s})}m||setTimeout(()=>{e=(0,w.mS)(),n&&t.updateDraftReplyInfo({replyToMsgId:o,tabId:s}),e=$(e,a,l),(0,w.UF)(e)},j)}else e=$(e,a,l)}),d&&(e=(0,A.J81)(e,d.id,d)),c&&(e=(0,A.o7c)(e,c.id,c)),i.reportDeliveryUntilDate&&i.reportDeliveryUntilDate>(0,v.Fm)()&&t.reportMessageDelivery({chatId:a,messageId:o}),(0,w.UF)(e),m||p?.isNotJoined||(0,C.mJZ)(e,a)||t.loadTopChats(),!m&&(0,C.nZ4)(e,a)){const s=(0,C.QP5)(e,l);s&&!(0,C.mJZ)(e,s,"saved")&&t.requestSavedDialogUpdate({chatId:s})}break}case"updateChatLastMessage":{const{id:t,lastMessage:a}=s;e=$(e,t,a,!0),e=(0,A.KcS)(e,[a]),(0,w.UF)(e);break}case"updateStartEmojiInteraction":Object.values(e.byTabId).forEach(({id:t})=>{const{chatId:a}=(0,C.Xf0)(e,t)||{};if(a!==s.id)return;const o=(0,C.O5q)(e,a,s.messageId);if(!o)return;if((0,y.P5)(o)?.text!==s.emoji)return;const i=(0,C.nTw)(e,t);e=(0,M.w)(e,{activeEmojiInteractions:[...i.activeEmojiInteractions||[],{id:Math.random(),animatedEffect:s.emoji,messageId:s.messageId}]},t)}),(0,w.UF)(e);break;case"newScheduledMessage":{const{chatId:t,id:a,message:o,poll:n,webPage:r}=s;e=z(e,t,a,!0,o,!0);const d=(0,C.K3w)(e,t,i.l3)||[];e=(0,A.eww)(e,t,i.l3,"scheduledIds",(0,h.Am)([...d,a]));const c=(0,C.L_2)(e,o);if(c!==i.l3){const s=(0,C.K3w)(e,t,c)||[];e=(0,A.eww)(e,t,c,"scheduledIds",(0,h.Am)([...s,a]))}n&&(e=(0,A.J81)(e,n.id,n)),r&&(e=(0,A.o7c)(e,r.id,r)),e=(0,A.zTz)(e,t,{hasScheduledMessages:!0}),(0,w.UF)(e);break}case"updateScheduledMessage":{const{chatId:a,id:o,message:n,poll:r,webPage:d,isFromNew:c}=s,l=(0,C.Jl6)(e,a,o);if(!l)return void(c&&t.apiUpdate({"@type":"newScheduledMessage",id:s.id,chatId:s.chatId,message:s.message,poll:s.poll,webPage:s.webPage}));e=z(e,a,o,!1,n,!0);const u=Object.keys((0,C.yFI)(e,a)||{}).map(Number).sort((e,t)=>t-e);e=(0,A.eww)(e,a,i.l3,"scheduledIds",u);const h=(0,C.L_2)(e,l);if(h!==i.l3){const t=(0,C.K3w)(e,a,h)||[];e=(0,A.eww)(e,a,h,"scheduledIds",t.sort((e,t)=>t-e))}r&&(e=(0,A.J81)(e,r.id,r)),d&&(e=(0,A.o7c)(e,d.id,d)),(0,w.UF)(e);break}case"updateMessage":{const{chatId:a,id:o,message:i,poll:n,webPage:r,isFromNew:d,shouldForceReply:c}=s,l=(0,C.O5q)(e,a,o);if(!l)return void(d&&t.apiUpdate({"@type":"newMessage",id:s.id,chatId:s.chatId,message:s.message,poll:s.poll,webPage:s.webPage,shouldForceReply:c}));const u=(0,C.hds)(e,a);e=z(e,a,o,!1,i);const h=(0,C.O5q)(e,a,o);i.reactions&&u&&(e=K(e,t,a,o,i.reactions,u,h.isOutgoing,l)),i.content?.text?.text!==l?.content?.text?.text&&(e=(0,A.gt4)(e,a,o)),n&&(e=(0,A.J81)(e,n.id,n)),r&&(e=(0,A.o7c)(e,r.id,r)),(0,w.UF)(e);break}case"updateQuickReplyMessage":{const{id:t,message:a,poll:o,webPage:i}=s;e=(0,A.QNR)(e,t,a),o&&(e=(0,A.J81)(e,o.id,o)),i&&(e=(0,A.o7c)(e,i.id,i)),(0,w.UF)(e);break}case"deleteQuickReplyMessages":{const{messageIds:t}=s;e=(0,A.vad)(e,t),(0,w.UF)(e);break}case"updateQuickReplies":{const{quickReplies:t}=s,a=(0,h.dU)(t,"id");e=(0,A.xAV)(e,a),(0,w.UF)(e);break}case"deleteQuickReply":e=(0,A.hjk)(e,s.quickReplyId),(0,w.UF)(e);break;case"updateVideoProcessingPending":{const{chatId:a,localId:o,newScheduledMessageId:i}=s;e=(0,A.AH0)(e,a,[o]),e=(0,A.zTz)(e,a,{hasScheduledMessages:!0}),(0,w.UF)(e),Object.values(e.byTabId).forEach(({id:s})=>{const o=(0,C.Xf0)(e,s);if(o?.chatId!==a)return;const n=Date.now();n-W<1e3||(W=n,t.showNotification({message:{key:"VideoConversionText"},title:{key:"VideoConversionTitle"},tabId:s}),t.focusMessage({chatId:a,messageId:i,messageListType:"scheduled",tabId:s}))});break}case"updateMessageSendSucceeded":{const{chatId:a,localId:o,message:n,poll:r}=s;e=_(e,t,n);const d=(0,C.O5q)(e,a,o);e=(0,A.AH0)(e,a,[o]),n.isScheduled&&(e=(0,A.XAm)(e,a,[o])),e=(0,A.r3y)(e,a,n.id,{...d,...n,previousLocalId:o,isDeleting:void 0}),r&&(e=(0,A.J81)(e,r.id,r)),e={...e,fileUploads:{byMessageKey:(0,h.cJ)(e.fileUploads.byMessageKey,[(0,p.bj)(n)])}};const c=(0,C.O5q)(e,a,n.id);e=$(e,a,c);const l=(0,C.Tac)(e,n);Object.values(e.byTabId).forEach(({id:s})=>{const{chatId:o,threadId:r}=(0,C.Xf0)(e,s)||{};o===a&&(l?.threadInfo?.threadId||i.l3)===r&&t.markMessageListRead({maxId:n.id,tabId:s})}),l?.threadInfo?.threadId&&(e=(0,A.eww)(e,a,l.threadInfo.threadId,"threadInfo",{...l.threadInfo,lastMessageId:n.id,lastReadInboxMessageId:n.id})),e=(0,A.wix)(e,a,{lastReadInboxMessageId:n.id});const u=(0,C.hds)(e,a);if(u?.isNotJoined||(0,C.mJZ)(e,a)||t.loadTopChats(),(0,C.nZ4)(e,a)){const s=(0,C.QP5)(e,c);s&&!(0,C.mJZ)(e,s,"saved")&&t.requestSavedDialogUpdate({chatId:s})}(0,w.UF)(e);break}case"updateScheduledMessageSendSucceeded":{const{chatId:t,localId:a,message:o,poll:n}=s,r=(0,C.K3w)(e,t,i.l3)||[];e=(0,A.eww)(e,t,i.l3,"scheduledIds",[...r,o.id]);const d=(0,C.L_2)(e,o);if(d!==i.l3){const s=(0,C.K3w)(e,t,d)||[];e=(0,A.eww)(e,t,d,"scheduledIds",[...s,o.id])}const c=(0,C.Jl6)(e,t,a);e=(0,A.XAm)(e,t,[a]),e=(0,A.Egm)(e,t,o.id,{...c,...o,previousLocalId:a,isDeleting:void 0}),n&&(e=(0,A.J81)(e,n.id,n)),(0,w.UF)(e);break}case"updatePinnedIds":{const{chatId:t,isPinned:a,messageIds:o}=s,n=(0,h._E)((0,C.zeq)(e,t),o),r={[i.l3]:o};Object.values(n).forEach(s=>{const o=(0,C.L_2)(e,s);if(e=(0,A.r3y)(e,t,s.id,{isPinned:a}),o===i.l3)return;const n=r[o]||[];n.push(s.id),r[o]=n}),Object.entries(r).forEach(([s,o])=>{const n=(0,C.fcC)(e,t,i.l3)||[],r=a?(0,h.Am)(n.concat(o)).sort((e,t)=>t-e):n.filter(e=>!o.includes(e));e=(0,A.eww)(e,t,Number(s),"pinnedIds",r)}),(0,w.UF)(e);break}case"updateThreadInfo":{const{threadInfo:a}=s;e=(0,A.Ng8)(e,[a]);const{chatId:o,threadId:i}=a;if(!o||!i)return;const n=(0,C.hds)(e,o),r=(0,C.Vw0)(e,o,i),d=(0,C.S0q)(e,o,i);if(n?.isForum&&(d&&d.lastMessageId===r?.lastReadInboxMessageId?e=(0,A.TwA)(e,o,Number(i),{unreadCount:0}):t.loadTopicById({chatId:o,topicId:Number(i)})),!n?.isForum){const t=n?.lastReadInboxMessageId,s=a.lastReadInboxMessageId||t;t&&s&&(e=(0,A.eAk)(e,o,i,{lastReadInboxMessageId:Math.max(s,t)}))}(0,w.UF)(e);break}case"resetMessages":{const{id:a}=s,o=(0,C.zeq)(e,a);if(o&&!(0,k.L8)(a)){const s=(0,u.g0)();e=(0,A.AH0)(e,a,Object.keys(o).map(Number)),(0,w.UF)(e),t.loadFullChat({chatId:a,force:!0}),t.loadViewportMessages({chatId:a,threadId:i.l3,tabId:s})}break}case"deleteMessages":{const{ids:a,chatId:o}=s;Q(e,o,a,t);break}case"deleteScheduledMessages":{const{ids:a,newIds:o,chatId:n}=s,r=a?.some(t=>(0,C.Jl6)(e,n,t)?.isVideoProcessingPending),d=o?.find(t=>{const s=(0,C.O5q)(e,n,t);return s?.content.video});r&&d&&Object.values(e.byTabId).forEach(({id:e})=>{t.showNotification({message:{key:"VideoConversionDone"},actionText:{key:"VideoConversionView"},action:{action:"focusMessage",payload:{chatId:n,messageId:d,tabId:e}},tabId:e})}),function(e,t,s,a){t.forEach(t=>{a=(0,A.Egm)(a,e,t,{isDeleting:!0})}),(0,w.UF)(a);const o=(0,C.Rwe)(a);setTimeout(()=>{a=(0,w.mS)(),a=(0,A.XAm)(a,e,t);const s=(0,C.yFI)(a,e);a=(0,A.eww)(a,e,i.l3,"scheduledIds",Object.keys(s||{}).map(Number)),(0,w.UF)(a)},o?q:j)}(n,a,0,e);break}case"deleteHistory":{const{chatId:o}=s,i=e.messages.byChatId[o];if(o===a.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map(e=>({...e,isDeleted:!0}))},(0,w.UF)(e)),i){const s=Object.keys(i.byId).map(Number);Q(e=(0,w.mS)(),o,s,t)}else t.requestChatUpdate({chatId:o});e=(0,w.mS)(),e=(0,A.SJu)(e,o),(0,w.UF)(e);break}case"deleteSavedHistory":{const{chatId:a}=s,o=e.currentUserId;e=(0,A.SJu)(e,a,"saved"),(0,w.UF)(e),function(e,t,s,a){const o=(0,C.zeq)(e,t);if(!o)return;const i=Object.values(o).filter(t=>(0,C.L_2)(e,t)===s).map(e=>e.id);i.length&&Q(e,t,i,a)}(e=(0,w.mS)(),o,a,t);break}case"deleteParticipantHistory":{const{chatId:a,peerId:o}=s;!function(e,t,s,a){const o=(0,C.zeq)(e,t),i=Object.values(o).filter(e=>e.senderId===s).map(e=>e.id);i.length&&Q(e,t,i,a)}(e=(0,w.mS)(),a,o,t);break}case"updateCommonBoxMessages":{const{ids:t,messageUpdate:a}=s;t.forEach(t=>{const s=(0,C.Egn)(e,t);s&&(e=(0,A.r3y)(e,s,t,a))}),(0,w.UF)(e);break}case"updateChannelMessages":{const{channelId:t,ids:a,messageUpdate:o}=s;a.forEach(s=>{e=(0,A.r3y)(e,t,s,o)}),(0,w.UF)(e);break}case"updateMessagePoll":{const{pollId:t,pollUpdate:a}=s;e=(0,A.J81)(e,t,a),(0,w.UF)(e);break}case"updateMessagePollVote":{const{pollId:t,peerId:a,options:o}=s;e=(0,A.DLl)(e,t,a,o),(0,w.UF)(e);break}case"updateServiceNotification":{const{message:a}=s;(0,C.dqr)(e)&&t.createServiceNotification({message:a});break}case"updateMessageReactions":{const{chatId:a,id:o,reactions:i}=s,n=(0,C.O5q)(e,a,o),r=(0,C.hds)(e,s.chatId);if(!r||!n)return;e=K(e,t,a,o,i,r,n.isOutgoing,n),(0,w.UF)(e);break}case"updateMessageExtendedMedia":{const{chatId:t,id:a,extendedMedia:o,isBought:i}=s,n=(0,C.O5q)(e,t,a);if(!(0,C.hds)(e,s.chatId)||!n)return;if(n.content.invoice){const s=o[0];if("mediaType"in s&&"extendedMediaPreview"===s.mediaType){if(!n.content.invoice)return;e=(0,A.r3y)(e,t,a,{content:{...n.content,invoice:{...n.content.invoice,extendedMedia:s}}}),(0,w.UF)(e)}else{const o=s;e=(0,A.r3y)(e,t,a,{content:{...o}}),(0,w.UF)(e)}}if(n.content.paidMedia){const s=i?{isBought:i,extendedMedia:o}:{extendedMedia:o,isBought:void 0};e=(0,A.r3y)(e,t,a,{content:{...n.content,paidMedia:{...n.content.paidMedia,...s}}}),(0,w.UF)(e)}break}case"updateTranscribedAudio":{const{transcriptionId:t,text:a,isPending:o}=s;e={...e,transcriptions:{...e.transcriptions,[t]:{...e.transcriptions[t]||{},transcriptionId:t,text:a,isPending:o}}},(0,w.UF)(e);break}case"updateMessageSendFailed":{const{chatId:a,localId:o,error:i}=s;i.match(/CHAT_SEND_.+?FORBIDDEN/)&&Object.values(e.byTabId).forEach(({id:e})=>{t.showAllowedMessageTypesNotification({chatId:a,tabId:e})}),e=(0,A.r3y)(e,a,o,{sendingState:"messageSendingStateFailed"}),(0,w.UF)(e);break}case"updateScheduledMessageSendFailed":{const{chatId:a,localId:o,error:i}=s;i.match(/CHAT_SEND_.+?FORBIDDEN/)&&Object.values(e.byTabId).forEach(({id:e})=>{t.showAllowedMessageTypesNotification({chatId:a,tabId:e})}),e=(0,A.Egm)(e,a,o,{sendingState:"messageSendingStateFailed"}),(0,w.UF)(e);break}case"updateMessageTranslations":{const{chatId:t,messageIds:a,toLanguageCode:o,translations:i}=s;e=(0,A.rmT)(e,t,a,o,i),(0,w.UF)(e);break}case"failedMessageTranslations":{const{chatId:t,messageIds:a,toLanguageCode:o}=s;e=(0,A.rmT)(e,t,a,o,[]),(0,w.UF)(e)}}});const Z=new Map,ee=(0,I.sg)(e=>e(),500,!1);async function te({global:e,chatId:t,threadId:s,draft:a,isLocalOnly:o,noLocalTimeUpdate:i}){const n=(0,C.hds)(e,t),r=(0,C.mBe)(e,t);if(!n||r&&(0,y.PL)(r))return;const d=(0,C.OEv)(e,t,s,a?.replyInfo),c=a?{...a,replyInfo:d,date:Math.floor(Date.now()/1e3),isLocal:!0}:void 0;e=(0,A.eww)(e,t,s,"draft",c),i||(e=(0,A.wix)(e,t,{draftDate:c?.date})),(0,w.UF)(e),o||(await(0,b.px)("saveDraft",{chat:n,draft:c})&&c&&(c.isLocal=!1),e=(0,w.mS)(),e=(0,A.eww)(e,t,s,"draft",c),e=(0,A.wix)(e,t,{draftDate:c?.date}),(0,w.UF)(e))}async function se(e,t,s){const{fromChatId:a,messageIds:o,toChatId:n,withMyScore:r,noAuthors:d,noCaptions:c,toThreadId:l=i.l3}=(0,C.nTw)(e,s).forwardMessages,{messagePriceInStars:u,isSilent:p,scheduledAt:m}=t,f=(0,C.g29)(e),g=l===i.l3,I=a?(0,C.hds)(e,a):void 0,v=n?(0,C.hds)(e,n):void 0,S=a&&o?o.sort((e,t)=>e-t).map(t=>(0,C.O5q)(e,a,t)).filter(Boolean):void 0;if(!I||!v||!S||l&&!g&&!v.isForum)return;const A=(0,C.VF$)(e,n),P=(0,C.GA4)(e,n,l||i.l3),k=(0,C.ZZX)(e,v.id),F=[],[T,U]=(0,h.jB)(S,e=>!(0,y.u7)(e)),x=T.filter(t=>(0,C.R4s)(e,t));if(x.length){const s=e.config?.maxForwardedCount?(0,y.v$)(x,e.config.maxForwardedCount):[x];for(const e of s){const s={fromChat:I,toChat:v,toThreadId:l,messages:e,isSilent:p,scheduledAt:m,sendAs:A,withMyScore:r,noAuthors:d,noCaptions:c,isCurrentUserPremium:f,wasDrafted:Boolean(P),lastMessageId:k,messagePriceInStars:u};if(u){const e=await(0,b.px)("forwardMessagesLocal",s);F.push({...t,forwardParams:{...s,forwardedLocalMessagesSlice:e},forwardedLocalMessagesSlice:e})}else(0,b.px)("forwardMessages",s)}}for(const t of U){const{text:s,entities:a}=t.content.text||{},{sticker:o}=t.content,i={chat:v,replyInfo:(0,C.OEv)(e,v.id,l),text:s,entities:a,sticker:o,isSilent:p,scheduledAt:m,sendAs:A,lastMessageId:k};await ne(e,i,F)}return e=(0,w.mS)(),e=(0,M.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},s),(0,w.UF)(e),F}async function ae(e,t,s,o,r,d=!1,c=!1,l,...[p=(0,u.g0)()]){const m=t.id;let f,g=a.yo2;switch(r){case n.TN.Backwards:o?(f=-1,g+=1):f=void 0;break;case n.TN.Around:f=-(Math.round(a.yo2/2)+1);break;case n.TN.Forwards:f=-(a.yo2+1),o&&(g+=1)}const I=(e=(0,w.mS)()).currentUserId,v=(0,y.cG)(m,s,I),S=v?String(s):m,M=await(0,b.px)("fetchMessages",{chat:(0,C.hds)(e,S),offsetId:o,addOffset:f,limit:g,threadId:s,isSavedDialog:v});if(!M)return;const{messages:P,count:k}=M;e=(0,w.mS)();const F=m===a.zv8?e.serviceNotifications.filter(({isDeleted:e})=>!e).map(({message:e})=>e):[],T=[].concat(P,F),U=(0,h.dU)(T,"id"),x=Object.keys(U).map(Number);if(s!==i.l3&&!(0,y.cG)(m,s,e.currentUserId)){const t=(0,C.dU3)(e,m,s);x[0]&&t!==x[0]||t===s||x.unshift(Number(s))}e=(0,A.o4A)(e,m,U),e=d?(0,A.E0b)(e,m,s,x):(0,A.d4w)(e,m,s,x);let B=(0,C.gCU)(e,m,s);const R=o?(0,C.Lzh)(e,m,s,o):void 0;if(d&&B&&R&&(R.length&&!(0,h.h8)(B,R)||(e=(0,A.d4w)(e,m,s,R),B=(0,C.gCU)(e,m,s),e=(0,A.qKm)(e,m,s,R),d=!1)),!c){const t=d&&R?R:B;if(t){const{newViewportIds:a}=oe(t,o,r);e=(0,A.s3Z)(e,m,s,a,p)}}k&&(e=(0,A.eAk)(e,t.id,s,{messagesCount:k})),(0,w.UF)(e),l?.()}function oe(e,t,s){const{length:o}=e,i=t?function(e,t){return t<e[0]?0:t>e[e.length-1]?e.length-1:e.findIndex((s,a)=>s===t||s<t&&e[a+1]>t)}(e,t):-1,r=s===n.TN.Backwards?i:i+1||o,d=s===n.TN.Around?Math.round(a.yo2/2):a.yo2,c=r-d,l=r+d-1,u=e.slice(Math.max(0,c),l+1);let h,p;switch(s){case n.TN.Backwards:h=r>=0,p=c>=0;break;case n.TN.Forwards:h=r<o,p=l<=o-1;break;case n.TN.Around:default:h=u.length>0,p=u.length===a.yo2}return{newViewportIds:u,areSomeLocal:h,areAllLocal:p}}async function ie(e,t){const s=(0,C.PVB)(e,t);if(!s)return;if((0,S.vj)(s)){if((0,C.ODG)(e,t))return;return s.paidMessagesStars}if(!s?.paidMessagesStars)return;const a=(0,C.vGo)(e,s.id);return a?a.paidMessagesStars:await(0,b.px)("fetchPaidMessagesStarsAmount",s)}async function ne(e,t,s){if(t.messagePriceInStars){const e=await(0,b.px)("sendMessageLocal",t);e&&s.push({...t,localMessage:e})}else re(e,t)}async function re(e,t){let s;(t.replyInfo||d.pz)&&await(0,I.P_)();const a=t.attachment?(t,o)=>{Z.has(o)||(s=o,Z.set(o,a)),e=(0,w.mS)(),e=(0,A.mR)(e,o,t),(0,w.UF)(e)}:void 0;await(0,b.px)("sendMessage",t,a),a&&s&&(e=(0,w.mS)(),e=(0,A.mR)(e,s,void 0),(0,w.UF)(e),Z.delete(s))}async function de(e,t,s){const a=(0,C.hds)(e,t);if(!a)return;const o=await(0,b.px)("fetchUnreadMentions",{chat:a,offsetId:s});if(!o)return;const{messages:i}=o,n=(0,h.dU)(i,"id"),r=Object.keys(n).map(Number);e=(0,w.mS)(),e=(0,A.o4A)(e,a.id,n),e=(0,A.Wez)(e,t,a,r),(0,w.UF)(e)}(0,w.aJ)("loadViewportMessages",(e,t,s)=>{const{direction:a=n.TN.Around,isBudgetPreload:o=!1,shouldForceRender:i=!1,onLoaded:r,onError:d,tabId:c=(0,u.g0)()}=s||{};let{chatId:l,threadId:h}=s||{};if(!l||!h){const t=(0,C.Xf0)(e,c);if(!t)return void d?.();l=t.chatId,h=t.threadId}const m=(0,C.hds)(e,l),f=(0,C._ls)(e,l);if(!m||f)return void d?.();const g=(0,C.rA3)(e,l,h,c),v=(0,C.gCU)(e,l,h);if(g&&g.length&&a!==n.TN.Around){const s=a===n.TN.Backwards?g[0]:g[g.length-1];if((0,p.iL)(s))return;if(s===h&&a===n.TN.Backwards)return;const i=Boolean(v&&!v.includes(s)),d=i?(0,C.Lzh)(e,l,h,s):v;if(d?.length){const{newViewportIds:n,areSomeLocal:p,areAllLocal:f}=oe(d,s,a);p&&(e=(0,A.s3Z)(e,l,h,n,c)),(0,I.aj)(()=>{!async function(e,t,s,a,o,i,n,r,d,c,...[l=(0,u.g0)()]){s||await ae(e,i,n,d,r,a,o,c,l),o||t.loadViewportMessages({chatId:i.id,threadId:n,direction:r,isBudgetPreload:!0,onLoaded:c,tabId:l})}(e,t,f,i,o,m,h,a,s,r,c)})}if(o)return}else{const t=(0,C.kdX)(e,l,c)||(0,C.EHH)(e,l,h),s=Boolean(t&&v&&!v.includes(t)),a=(s?(0,C.Lzh)(e,l,h,t):v)||[],{newViewportIds:i,areSomeLocal:d,areAllLocal:u}=oe(a,t,n.TN.Around);d&&(e=(0,A.s3Z)(e,l,h,i,c)),u?r?.():(0,I.aj)(()=>{ae(e,m,h,t,n.TN.Around,s,o,r,c)})}(0,w.UF)(e,{forceOnHeavyAnimation:i})}),(0,w.aJ)("loadMessage",async(e,t,s)=>{const{chatId:a,messageId:o,replyOriginForId:n,threadUpdate:r}=s,d=(0,C.hds)(e,a);if(!d)return;const c=await async function(e,t,s,a){const o=await(0,b.px)("fetchMessage",{chat:t,messageId:s});if(o){if(o!==i.K1)return e=(0,w.mS)(),e=(0,A.r3y)(e,t.id,s,o.message),(0,w.UF)(e),o.message;if(a){e=(0,w.mS)();const s=(0,C.O5q)(e,t.id,a);e=(0,A.r3y)(e,t.id,a,{...s,replyInfo:void 0}),(0,w.UF)(e)}}}(e,d,o,n);if(c&&r){const{lastMessageId:t,isDeleting:s}=r;e=(0,w.mS)(),e=(0,A.Wwn)(e,c,a,t,s),(0,w.UF)(e)}}),(0,w.aJ)("loadMessagesById",async(e,t,s)=>{const{chatId:a,messageIds:o}=s,i=(0,C.hds)(e,a);if(!i)return;const n=await(0,b.px)("fetchMessagesById",{chat:i,messageIds:o});n&&(e=(0,w.mS)(),e=(0,A.o4A)(e,a,(0,h.dU)(n,"id")),(0,w.UF)(e))}),(0,w.aJ)("sendMessage",async(e,t,s)=>{const{messageList:o,tabId:n=(0,u.g0)()}=s,{storyId:r,peerId:d}=(0,C.V9I)(e,n),c=Boolean(r&&d);if(!o&&!c)return;let{chatId:l,threadId:g,type:I}=o||{};if(c&&(l=d,g=i.l3,I="thread"),s=(0,h.cJ)(s,["tabId"]),"scheduled"===I&&!s.scheduledAt)return e=(0,M.w)(e,{contentToBeScheduled:s},n),void(0,w.UF)(e);const v=(0,C.hds)(e,l),b=(0,C.GA4)(e,l,g),y=(0,C.nTw)(e,n).forwardMessages?.messageIds?.length,S=y||c?void 0:b?.replyInfo,A=y||c?void 0:b?.suggestedPostInfo,P=c?{type:"story",peerId:d,storyId:r}:void 0,k=(0,C.OEv)(e,l,g,S),F=P||k,T=(0,C.Vw0)(e,l,g),U=g===i.l3?(0,C.ZZX)(e,l):T?.lastMessageId,x=await ie(e,l),B=A?.price,R=B?.currency||a.OUy,J=B?.amount||0;if(J&&!S)if(R===a.OUy){if(J>(e.stars?.balance?.amount||0))return void t.openStarsBalanceModal({topup:{balanceNeeded:J},tabId:n})}else if(R===a.ykW&&J>(e.ton?.balance?.amount||0))return void t.openStarsBalanceModal({currency:a.ykW,tabId:n});const N=S&&A?(0,C.O5q)(e,l,S.replyToMsgId):void 0;let E;A&&N?.content&&(E=N.content);const L={...s,chat:v,replyInfo:F,suggestedPostInfo:A,suggestedMedia:E,noWebPage:(0,C.rQx)(e,l,g),sendAs:(0,C.VF$)(e,l),lastMessageId:U,messagePriceInStars:x,isStoryReply:c,isPending:!!x||void 0,...N&&{isInvertedMedia:N?.isInvertedMedia}};c||t.clearWebPagePreview({tabId:n});const O=(!s.attachments||s.attachments.length<=1)&&!y,D=!O&&s.shouldGroupMessages,Y=[];if(O){const{attachments:t,...s}=L,a={...s,attachment:t?t[0]:void 0,wasDrafted:Boolean(b)};await ne(e,a,Y)}else if(D){const{text:t,entities:s,attachments:o,...i}=L,n=function(e){return e.reduce((e,t,s,a)=>0===s?(e.push([t]),e):(me(t)===me(a[s-1])?e[e.length-1].push(t):e.push([t]),e),[])}(o);let r=!1;for(let o=0;o<n.length;o++){const d=n[o],c=(0,h.lD)(d,a.ynd);for(let a=0;a<c.length;a++){const l=`${Date.now()}${o}${a}`,u=0===a&&0===o,h=a===c.length-1&&o===n.length-1;if(d[0].quick&&!d[0].shouldSendAsFile){const[o,...n]=c[a];let d={...i,text:u&&!r?t:void 0,entities:u&&!r?s:void 0,attachment:o,groupedId:n.length>0?l:void 0,wasDrafted:Boolean(b)};await ne(e,d,Y),r=!0;for(const t of n)d={...i,attachment:t,groupedId:l},await ne(e,d,Y)}else{const o=c[a].slice(0,-1),n=c[a][c[a].length-1];for(const t of o){const s={...i,attachment:t,groupedId:l};await ne(e,s,Y)}const d={...i,text:h&&!r?t:void 0,entities:h&&!r?s:void 0,attachment:n,groupedId:o.length>0?l:void 0,wasDrafted:Boolean(b)};await ne(e,d,Y),r=!0}}}}else{const{text:t,entities:s,attachments:a,replyInfo:o,...i}=L;if(t){const a={...i,text:t,entities:s,replyInfo:o,wasDrafted:Boolean(b)};await ne(e,a,Y)}if(a)for(const t of a){const s={...i,attachment:t};await ne(e,s,Y)}}if(y){const t=await se(e,L,n);t&&Y.push(...t)}Y?.length&&async function(e,t){const s=t[0]?.chat;if(!s||!t.length)return;const a=await ie(e,s.id);if(!a)return void(0,w.ko)().sendMessages({sendParams:t});const o=t.reduce((e,t)=>{if(t.localMessage?.id)e.push(t.localMessage.id);else if(t.forwardedLocalMessagesSlice?.localMessages){const s=Object.values(t.forwardedLocalMessagesSlice.localMessages).map(e=>e.id).filter(Boolean);e.push(...s)}return e},[]),i=t[0]?.forwardedLocalMessagesSlice?.localMessages,n=t[0]?.localMessage||i&&Object.values(i)[0];if(!n)return;const r=o.length,d=t[0];let c;if(1===t.length&&d.isStoryReply){const{gif:e,sticker:t,isReaction:s}=d;e?c={key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}}:t?c={key:"StoryTooltipStickerSent"}:s&&(c={key:"StoryTooltipReactionSent"})}const l=c||{key:"MessageSentPaidToastTitle",variables:{count:r},options:{pluralValue:r}};(0,w.ko)().sendMessages({sendParams:t}),(0,w.ko)().showNotification({localId:(0,p.bj)(n),title:l,message:{key:"MessageSentPaidToastText",variables:{amount:(0,f.Kk)((0,m.Yw)(),a*r)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage"})}(e,Y)}),(0,w.aJ)("sendInviteMessages",async(e,t,s)=>{const{chatId:a,userIds:o,tabId:i=(0,u.g0)()}=s,n=(0,C.AWZ)(e,a);if(!n?.inviteLink)return;const r=[];return await Promise.all(o.map(t=>{const s=(0,C.hds)(e,t);if(!s)return;const a=(0,y.Yg)((0,C.mBe)(e,t));return a&&r.push(a),re(e,{chat:s,text:n.inviteLink})})),t.showNotification({message:(0,g.yE)("Conversation.ShareLinkTooltip.Chat.One",r.join(", ")),tabId:i})}),(0,w.aJ)("editMessage",(e,t,s)=>{const{messageList:a,text:o,entities:i,attachments:n,tabId:r=(0,u.g0)()}=s;if(!a)return;let d;const c=n?(t,s)=>{Z.has(s)||(d=s,Z.set(s,c)),e=(0,w.mS)(),e=(0,A.mR)(e,s,t),(0,w.UF)(e)}:void 0,{chatId:l,threadId:h,type:p}=a,m=(0,C.hds)(e,l),f=(0,C.KLw)(e,l,h,p);m&&f&&(t.setEditingId({messageId:void 0,tabId:r}),(async()=>{await(0,b.px)("editMessage",{chat:m,message:f,attachment:n?n[0]:void 0,text:o,entities:i,noWebPage:(0,C.rQx)(e,l,h)},c),c&&d&&(e=(0,w.mS)(),e=(0,A.mR)(e,d,void 0),(0,w.UF)(e),Z.delete(d))})())}),(0,w.aJ)("editTodo",(e,t,s)=>{const{chatId:a,todo:o,messageId:i}=s,n=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,i);n&&r&&(0,b.px)("editTodo",{chat:n,message:r,todo:o})}),(0,w.aJ)("cancelUploadMedia",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=(0,C.O5q)(e,a,o);if(!i)return;const n=i&&Z.get((0,p.bj)(i));n&&(0,b.om)(n),(0,y.Nb)(i)&&t.apiUpdate({"@type":"deleteMessages",ids:[o],chatId:a})}),(0,w.aJ)("saveDraft",(e,t,s)=>{const{chatId:a,threadId:o,text:i}=s,n=(0,C.hds)(e,a);if(!i||!n)return;const r=(0,C.GA4)(e,a,o);(!n.isMonoforum||r?.replyInfo||r?.suggestedPostInfo)&&te({global:e,chatId:a,threadId:o,draft:{text:i,replyInfo:r?.replyInfo,effectId:r?.effectId,suggestedPostInfo:r?.suggestedPostInfo}})}),(0,w.aJ)("clearDraft",(e,t,s)=>{const{chatId:a,threadId:o=i.l3,isLocalOnly:n,shouldKeepReply:r,shouldKeepSuggestedPost:d}=s,c=(0,C.GA4)(e,a,o);if(!c)return;const l=c.replyInfo;te({global:e,chatId:a,threadId:o,draft:r&&l||d&&c.suggestedPostInfo?{replyInfo:r?l:void 0,suggestedPostInfo:d?c.suggestedPostInfo:void 0}:void 0,isLocalOnly:n})}),(0,w.aJ)("updateDraftReplyInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,i=(0,C.Xf0)(e,a);if(!i)return;const{chatId:n,threadId:r}=i,d=(0,C.GA4)(e,n,r),c={type:"message",...d?.replyInfo,...o};c.replyToMsgId&&te({global:e,chatId:n,threadId:r,draft:{...d,replyInfo:c,suggestedPostInfo:void 0},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("resetDraftReplyInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:i,threadId:n}=o,r=(0,C.hds)(e,i),d=(0,C.GA4)(e,i,n);if(r?.isMonoforum&&!d?.replyInfo&&!d?.suggestedPostInfo)return;const c=d?.text?{...d,replyInfo:void 0}:void 0;te({global:e,chatId:i,threadId:n,draft:c,isLocalOnly:Boolean(c)})}),(0,w.aJ)("updateDraftSuggestedPostInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,i=(0,C.Xf0)(e,a);if(!i)return;const{chatId:n,threadId:r}=i,d=(0,C.GA4)(e,n,r),c={...d?.suggestedPostInfo,...o};te({global:e,chatId:n,threadId:r,draft:{...d,suggestedPostInfo:c},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("resetDraftSuggestedPostInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:i,threadId:n}=o;te({global:e,chatId:i,threadId:n,draft:void 0,isLocalOnly:!1})}),(0,w.aJ)("initDraftFromSuggestedMessage",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.O5q)(e,a,o);if(!n)return;const r=(0,C.Xf0)(e,i);if(!r)return;const{threadId:d}=r;if(t.clearDraft({chatId:a,threadId:d,isLocalOnly:!0}),t.updateDraftReplyInfo({replyToMsgId:o,monoforumPeerId:(0,C.QP5)(e,n),tabId:i}),n.suggestedPostInfo){const{scheduleDate:s,...a}=n.suggestedPostInfo,o=(0,v.Fm)(),r=e.appConfig.starsSuggestedPostFutureMin,d=s&&s>o+r?s:void 0;t.updateDraftSuggestedPostInfo({...a,scheduleDate:d,tabId:i})}t.saveDraft({chatId:a,threadId:d,text:n.content.text})}),(0,w.aJ)("saveEffectInDraft",(e,t,s)=>{const{chatId:a,threadId:o,effectId:i}=s,n=(0,C.hds)(e,a),r=(0,C.GA4)(e,a,o);(!n?.isMonoforum||r?.replyInfo||r?.suggestedPostInfo)&&te({global:e,chatId:a,threadId:o,draft:{...r,effectId:i},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("updateInsertingPeerIdMention",(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{insertingPeerIdMention:a},o)}),(0,w.aJ)("toggleMessageWebPage",(e,t,s)=>{const{chatId:a,threadId:o,noWebPage:i}=s;return(0,A.eww)(e,a,o,"noWebPage",i)}),(0,w.aJ)("pinMessage",(e,t,s)=>{const{chatId:a,messageId:o,isUnpin:i,isOneSide:n,isSilent:r}=s,d=(0,C.hds)(e,a);d&&(0,b.px)("pinMessage",{chat:d,messageId:o,isUnpin:i,isOneSide:n,isSilent:r})}),(0,w.aJ)("unpinAllMessages",async(e,t,s)=>{const{chatId:a,threadId:o}=s,n=(0,C.hds)(e,a);if(!n)return;await(0,b.px)("unpinAllMessages",{chat:n,threadId:o}),e=(0,w.mS)();const r=(0,C.fcC)(e,a,o);r?.forEach(t=>{e=(0,A.r3y)(e,a,t,{isPinned:!1})}),e=(0,A.eww)(e,n.id,i.l3,"pinnedIds",[]),(0,w.UF)(e)}),(0,w.aJ)("deleteMessages",(e,t,s)=>{const{messageIds:a,shouldDeleteForAll:o,messageList:i,tabId:n=(0,u.g0)()}=s,r=(0,C.Xf0)(e,n),d=i||r;if(!d)return;const{chatId:c,threadId:l}=d,h=(0,C.hds)(e,c),p=a.filter(t=>{const s=(0,C.O5q)(e,c,t);return s&&!(0,y.Nb)(s)});if(!p.length&&a.length)return void Q(e,(0,y.WX)(h)||(0,y.Vs)(h)?c:void 0,a,t);(0,b.px)("deleteMessages",{chat:h,messageIds:p,shouldDeleteForAll:o});const m=(0,C.Ys6)(e,c,l);m&&a.includes(m)&&t.setEditingId({messageId:void 0,tabId:n}),p.forEach(e=>{t.removeFromFocusList({chatId:c,messageId:e})})}),(0,w.aJ)("resetLocalPaidMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).notifications;return o&&o.length?(o.forEach(e=>{if("paidMessage"===e.type){const s=e.dismissAction;s&&!Array.isArray(s)&&t[s.action](s.payload),t.dismissNotification({localId:e.localId,tabId:a})}}),e):e}),(0,w.aJ)("deleteParticipantHistory",(e,t,s)=>{const{chatId:a,peerId:o}=s,i=(0,C.hds)(e,a),n=(0,C.PVB)(e,o);(0,b.px)("deleteParticipantHistory",{chat:i,peer:n})}),(0,w.aJ)("deleteScheduledMessages",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,i=(0,C.Xf0)(e,o);if(!i)return;const{chatId:n}=i,r=(0,C.hds)(e,n);(0,b.px)("deleteScheduledMessages",{chat:r,messageIds:a});const d=(0,C.VlN)(e,n);d&&a.includes(d)&&t.setEditingId({messageId:void 0,tabId:o})}),(0,w.aJ)("deleteHistory",async(e,t,s)=>{const{chatId:a,shouldDeleteForAll:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;await(0,b.px)("deleteHistory",{chat:n,shouldDeleteForAll:o}),e=(0,w.mS)();const r=(0,C.Xf0)(e,i);r&&r.chatId===a&&t.openChat({id:void 0,tabId:i});const d=e.chatFolders.byId;Object.values(d).forEach(e=>{if(e.includedChatIds.includes(a)||e.pinnedChatIds?.includes(a)){const t=e.includedChatIds.filter(e=>e!==a),s=e.pinnedChatIds?.filter(e=>e!==a),o={...e,includedChatIds:t,pinnedChatIds:s};(0,b.px)("editChatFolder",{id:e.id,folderUpdate:o})}})}),(0,w.aJ)("deleteSavedHistory",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;await(0,b.px)("deleteSavedHistory",{chat:i}),e=(0,w.mS)();const n=(0,C.Xf0)(e,o);n&&n.threadId===a&&t.openChat({id:void 0,tabId:o})}),(0,w.aJ)("reportMessages",async(e,t,s)=>{const{messageIds:o,description:i="",option:n="",chatId:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,r),l=await(0,b.px)("reportMessages",{peer:c,messageIds:o,description:i,option:n});if(!l)return;const{result:h,error:p}=l;if(p===a.zLi)return t.showNotification({message:(0,g.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,g.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===n),a={title:h.title,options:h.options,subtitle:s?.text};e=(0,M.w)(e,{reportModal:{chatId:r,messageIds:o,description:i,subject:"message",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===n),a={isOptional:h.isOptional,option:h.option,title:s?.text};e=(0,M.w)(e,{reportModal:{chatId:r,messageIds:o,description:i,subject:"message",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}}}),(0,w.aJ)("sendMessageAction",async(e,t,s)=>{const{action:a,chatId:o,threadId:i}=s;if("connectionStateReady"!==e.connectionState)return;if((0,C.nZ4)(e,o))return;const n=(0,C.hds)(e,o);if(!n||n.isMonoforum)return;const r=(0,C.mBe)(e,o);r&&((0,y.tv)(r)||(0,y.PL)(r))||await(0,b.px)("sendMessageAction",{peer:n,threadId:i,action:a})}),(0,w.aJ)("reportChannelSpam",(e,t,s)=>{const{participantId:a,chatId:o,messageIds:i}=s,n=(0,C.PVB)(e,a),r=(0,C.hds)(e,o);n&&r&&(0,b.px)("reportChannelSpam",{peer:n,chat:r,messageIds:i})}),(0,w.aJ)("markMessageListRead",(e,t,s)=>{if((0,C.trm)(e))return;const{maxId:o,tabId:n=(0,u.g0)()}=s,r=(0,C.Xf0)(e,n);if(!r)return;const{chatId:d,threadId:c}=r,l=(0,C.hds)(e,d);if(!l||(0,y.cG)(d,c,e.currentUserId))return;ee(()=>{(0,b.px)("markMessageListRead",{chat:l,threadId:c,maxId:o})}),d===a.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map(e=>e.isUnread&&e.id<=o?{...e,isUnread:!1}:e)});const h=(0,C.rA3)(e,d,c,n),p=(0,C.RjD)(e,d,c);if(c!==i.l3&&!l.isForum)return(0,A.eAk)(e,d,c,{lastReadInboxMessageId:o});if(!h||!p||!l.unreadCount)return e;const m=function(e,t,s){if(0===e.length||t<e[0]||s>e[e.length-1])return;let a=0;for(let o=0,i=e.length;o<i&&(e[o]>=t&&e[o]<=s&&a++,!(e[o]>=s));o++);return a}(h,p,o);if(!m)return e;const f=(0,C.S0q)(e,d,c);if(l.isForum&&f){e=(0,A.eAk)(e,d,c,{lastReadInboxMessageId:o});const t=Math.max(0,f.unreadCount-m);return 0===t&&(e=(0,A.wix)(e,d,{unreadCount:Math.max(0,l.unreadCount-1)})),(0,A.TwA)(e,d,Number(c),{unreadCount:t})}return(0,A.wix)(e,d,{lastReadInboxMessageId:o,unreadCount:Math.max(0,l.unreadCount-m)})}),(0,w.aJ)("markMessagesRead",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)(),shouldFetchUnreadReactions:i}=s,n=(0,C.meB)(e,o);n&&(0,b.px)("markMessagesRead",{chat:n,messageIds:a}).then(()=>{i&&t.fetchUnreadReactions({chatId:n.id})})}),(0,w.aJ)("loadWebPagePreview",async(e,t,s)=>{const{text:a,tabId:o=(0,u.g0)()}=s,i=await(0,b.px)("fetchWebPagePreview",{text:a});e=(0,w.mS)(),e=(0,M.w)(e,{webPagePreviewId:i?.id},o),(0,w.UF)(e),i&&t.apiUpdate({"@type":"updateWebPage",webPage:i})}),(0,w.aJ)("clearWebPagePreview",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{webPagePreviewId:void 0},a)}),(0,w.aJ)("sendPollVote",(e,t,s)=>{const{chatId:a,messageId:o,options:i}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("sendPollVote",{chat:n,messageId:o,options:i})}),(0,w.aJ)("toggleTodoCompleted",(e,t,s)=>{const{chatId:a,messageId:o,completedIds:i,incompletedIds:n}=s,r=(0,C.hds)(e,a),d=(0,C.O5q)(e,a,o),c=e.currentUserId,l=d?.content.todo;if(!l||!c||!r)return;const u=l.completions||[],h=u.map(e=>e.itemId),p=[...u],m=(0,v.Fm)();i.forEach(e=>{h.includes(e)||p.push({itemId:e,completedBy:c,completedAt:m})});const f=p.filter(e=>!n.includes(e.itemId)),g={...d.content,todo:{...l,completions:f}},I={...d,content:g};e=z(e,a,d.id,!1,I),(0,w.UF)(e),(0,b.px)("toggleTodoCompleted",{chat:r,messageId:d.id,completedIds:i,incompletedIds:n})}),(0,w.aJ)("appendTodoList",(e,t,s)=>{const{chatId:a,items:o,messageId:i}=s,n=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,i);n&&r&&(0,b.px)("appendTodoList",{chat:n,message:r,items:o})}),(0,w.aJ)("cancelPollVote",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=(0,C.hds)(e,a);i&&(0,b.px)("sendPollVote",{chat:i,messageId:o,options:[]})}),(0,w.aJ)("closePoll",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=(0,C.hds)(e,a),n=(0,C.O5q)(e,a,o),r=n&&(0,C.zcZ)(e,n);i&&r&&(0,b.px)("closePoll",{chat:i,messageId:o,poll:r})}),(0,w.aJ)("loadPollOptionResults",async(e,t,s)=>{const{chat:a,messageId:o,option:i,offset:n,limit:r,shouldResetVoters:d,tabId:c=(0,u.g0)()}=s,l=await(0,b.px)("loadPollOptionResults",{chat:a,messageId:o,option:i,offset:n,limit:r});if(!l)return;e=(0,w.mS)();const p=(0,C.nTw)(e,c),{pollResults:m}=p,{voters:f}=p.pollResults;e=(0,M.w)(e,{pollResults:{...m,voters:{...f,[i]:(0,h.Am)([...!d&&f?.[i]?f[i]:[],...l.votes.map(e=>e.peerId)])},offsets:{...m.offsets?m.offsets:{},[i]:l.nextOffset||""}}},c),(0,w.UF)(e)}),(0,w.aJ)("loadExtendedMedia",(e,t,s)=>{const{chatId:a,ids:o}=s,i=(0,C.hds)(e,a);i&&(0,b.px)("fetchExtendedMedia",{chat:i,ids:o})}),(0,w.aJ)("loadScheduledHistory",async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const n=await(0,b.px)("fetchScheduledHistory",{chat:o});if(!n)return;const{messages:r}=n,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort((e,t)=>t-e);if(e=(0,w.mS)(),e=(0,A.Ffw)(e,o.id,d),e=(0,A.eww)(e,o.id,i.l3,"scheduledIds",c),c.length||(e=(0,A.zTz)(e,o.id,{hasScheduledMessages:!1})),o?.isForum){const t={};r.forEach(s=>{const a=(0,C.L_2)(e,s),o=t[a]||[];o.push(s.id),t[a]=o}),Object.entries(t).forEach(([t,s])=>{e=(0,A.eww)(e,o.id,Number(t),"scheduledIds",s)})}(0,w.UF)(e)}),(0,w.aJ)("sendScheduledMessages",(e,t,s)=>{const{chatId:a,id:o}=s,i=(0,C.hds)(e,a);i&&(0,b.px)("sendScheduledMessages",{chat:i,ids:[o]})}),(0,w.aJ)("rescheduleMessage",(e,t,s)=>{const{chatId:a,messageId:o,scheduledAt:i}=s,n=(0,C.hds)(e,a),r=n&&(0,C.Jl6)(e,n.id,o);n&&r&&(0,b.px)("rescheduleMessage",{chat:n,message:r,scheduledAt:i})}),(0,w.aJ)("transcribeAudio",async(e,t,s)=>{const{messageId:a,chatId:o}=s,i=(0,C.hds)(e,o);if(!i)return;e=(0,A.r3y)(e,o,a,{transcriptionId:""}),(0,w.UF)(e);const n=await(0,b.px)("transcribeAudio",{chat:i,messageId:a});e=(0,w.mS)(),e=(0,A.r3y)(e,o,a,{transcriptionId:n,isTranscriptionError:!n}),(0,w.UF)(e)}),(0,w.aJ)("loadCustomEmojis",async(e,t,s)=>{const{ids:a,ignoreCache:o}=s,i=o?a:(0,h.Am)(a.filter(t=>!(0,C.O8F)(e,t))),n=await(0,b.px)("fetchCustomEmoji",{documentId:i});n&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,byId:{...e.customEmojis.byId,...(0,h.dU)(n,"id")}}},(0,w.UF)(e))}),(0,w.aJ)("forwardMessages",(e,t,s)=>{const{isSilent:a,scheduledAt:o,tabId:i=(0,u.g0)()}=s,{toChatId:n}=(0,C.nTw)(e,i).forwardMessages,r=n?(0,C.hds)(e,n):void 0;r&&se(e,{chat:r,isSilent:a,scheduledAt:o},i)}),(0,w.aJ)("sendMessages",async(e,t,s)=>{const{sendParams:a}=s;await Promise.all(a.map(async t=>{t.forwardedLocalMessagesSlice&&t.forwardParams?(await(0,I.P_)(),await(0,b.px)("forwardApiMessages",t.forwardParams)):await re(e,t)})),a.length>0&&a[0].messagePriceInStars&&t.loadStarStatus()}),(0,w.aJ)("loadPinnedMessages",async(e,t,s)=>{const{chatId:a,threadId:o}=s,i=(0,C.hds)(e,a);if(!i||(0,y.cG)(a,o,e.currentUserId))return;const n=await(0,b.px)("fetchPinnedMessages",{chat:i,threadId:o});if(!n)return;const{messages:r}=n,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort((e,t)=>t-e);e=(0,w.mS)(),e=(0,A.o4A)(e,i.id,d),e=(0,A.gz3)(e,i.id,o,c),(0,w.UF)(e)}),(0,w.aJ)("loadSeenBy",async(e,t,s)=>{const{chatId:a,messageId:o}=s,i=(0,C.hds)(e,a);if(!i)return;const n=await(0,b.px)("fetchSeenBy",{chat:i,messageId:o});n&&(e=(0,w.mS)(),e=(0,A.r3y)(e,a,o,{seenByDates:n}),(0,w.UF)(e))}),(0,w.aJ)("saveDefaultSendAs",(e,t,s)=>{const{chatId:a,sendAsId:o}=s,i=(0,C.hds)(e,a),n=(0,C.hds)(e,o)||(0,C.mBe)(e,o);if(i&&n)return(0,b.px)("saveDefaultSendAs",{sendAs:n,chat:i}),(0,A.ltr)(e,a,{sendAsId:o})}),(0,w.aJ)("loadSendAs",async(e,t,s)=>{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const i=await(0,b.px)("fetchSendAs",{chat:o});if(!i)return e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendAsPeerIds:i}),(0,w.UF)(e)}),(0,w.aJ)("loadSendPaidReactionsAs",async(e,t,s)=>{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const i=await(0,b.px)("fetchSendAs",{chat:o,isForPaidReactions:!0});if(!i)return e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendPaidReactionsAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,a,{sendPaidReactionsAsPeerIds:i}),(0,w.UF)(e)}),(0,w.aJ)("loadSponsoredMessages",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;if((0,S.mO)(o)&&(0,C.I_m)(e,o.id))return;const i=await(0,b.px)("fetchSponsoredMessages",{peer:o});i&&(e=(0,w.mS)(),e=(0,A.EKx)(e,a,i.messages[0]),(0,w.UF)(e))}),(0,w.aJ)("viewSponsored",(e,t,s)=>{const{randomId:a}=s;(0,b.px)("viewSponsoredMessage",{random:a})}),(0,w.aJ)("clickSponsored",(e,t,s)=>{const{randomId:a,isMedia:o,isFullscreen:i}=s;(0,b.px)("clickSponsoredMessage",{random:a,isMedia:o,isFullscreen:i})}),(0,w.aJ)("reportSponsored",async(e,t,s)=>{const{peerId:a,randomId:o,option:i="",tabId:n=(0,u.g0)()}=s,r=await(0,b.px)("reportSponsoredMessage",{randomId:o,option:i});if(r){if("premiumRequired"===r.type)return t.openPremiumModal({initialSection:"no_ads",tabId:n}),void t.closeReportAdModal({tabId:n});if("reported"===r.type||"hidden"===r.type)return t.showNotification({message:(0,g.yE)("reported"===r.type?"AdReported":"AdHidden"),tabId:n}),t.closeReportAdModal({tabId:n}),e=(0,w.mS)(),e=a?(0,A.Itk)(e,a):(0,A.b8O)(e,{sponsoredPeer:void 0},n),void(0,w.UF)(e);if("selectOption"===r.type){e=(0,w.mS)();const t=(0,C.nTw)(e,n).reportAdModal?.sections,s=t?.[t.length-1]?.options.find(e=>e.option===i),d={title:r.title,options:r.options,subtitle:s?.text};e=(0,M.w)(e,{reportAdModal:{chatId:a,randomId:o,sections:t?[...t,d]:[d]}},n),(0,w.UF)(e)}}}),(0,w.aJ)("hideSponsored",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};(0,C.g29)(e)?await(0,b.px)("toggleSponsoredMessages",{enabled:!1})&&(e=(0,w.mS)(),e=(0,A.weB)(e,e.currentUserId,{areAdsEnabled:!1}),(0,w.UF)(e),t.showNotification({message:(0,g.yE)("AdHidden"),tabId:a})):t.openPremiumModal({initialSection:"no_ads",tabId:a})}),(0,w.aJ)("fetchUnreadMentions",async(e,t,s)=>{const{chatId:a,offsetId:o}=s;await de(e,a,o)}),(0,w.aJ)("approveSuggestedPost",async(e,t,s)=>{const{chatId:o,messageId:i,scheduleDate:n,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,o);if(!d)return;const c=(0,C.O5q)(e,o,i);if(!(0,C.ODG)(e,o)&&c?.suggestedPostInfo?.price?.amount){const s=c.suggestedPostInfo.price.amount;if(c.suggestedPostInfo.price.currency===a.OUy){if(s>(e.stars?.balance?.amount||0))return void t.openStarsBalanceModal({topup:{balanceNeeded:s},tabId:r})}else if(s>(e.ton?.balance?.amount||0))return void t.openStarsBalanceModal({currency:a.ykW,tabId:r})}await(0,b.px)("toggleSuggestedPostApproval",{chat:d,messageId:i,reject:!1,scheduleDate:n})&&t.showNotification({message:{key:"SuggestedPostApproved"},tabId:r})}),(0,w.aJ)("rejectSuggestedPost",async(e,t,s)=>{const{chatId:a,messageId:o,rejectComment:i,tabId:n=(0,u.g0)()}=s,r=(0,C.hds)(e,a);r&&await(0,b.px)("toggleSuggestedPostApproval",{chat:r,messageId:o,reject:!0,rejectComment:i})&&t.showNotification({message:{key:"SuggestedPostRejectedNotification"},tabId:n})}),(0,w.aJ)("markMentionsRead",(e,t,s)=>{const{chatId:a,messageIds:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a);n&&(e=(0,A.pWt)(e,a,n,o,!0),(0,w.UF)(e),t.markMessagesRead({messageIds:o,tabId:i}))}),(0,w.aJ)("focusNextMention",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};let o=(0,C.meB)(e,a);if(o){if(!o.unreadMentions){await de(e,o.id),e=(0,w.mS)();const t=o.id;if(o=(0,C.meB)(e,a),!o?.unreadMentions||t!==o.id)return}t.focusMessage({chatId:o.id,messageId:o.unreadMentions[0],tabId:a})}}),(0,w.aJ)("readAllMentions",(e,t,s)=>{const{chatId:a,threadId:o=i.l3}=s,n=(0,C.hds)(e,a);if(n)return(0,b.px)("readAllMentions",{chat:n,threadId:o===i.l3?void 0:o}),o===i.l3?(0,A.wix)(e,n.id,{unreadMentionsCount:void 0,unreadMentions:void 0}):void 0}),(0,w.aJ)("openUrl",(e,t,s)=>{const{url:o,shouldSkipModal:i,ignoreDeepLinks:n,linkContext:d,tabId:c=(0,u.g0)()}=s,h=(0,r.Tc)(o),p=new URL(h),m=(0,r._G)(h);if(!n&&(0,l.zq)(h))return t.closeStoryViewer({tabId:c}),t.closePaymentModal({tabId:c}),void t.openTelegramLink({url:o,linkContext:d,tabId:c});const{appConfig:f,config:g}=e;if(g?.autologinToken&&f.autologinDomains.includes(p.hostname))return p.searchParams.set("autologin_token",g.autologinToken),void window.open(p.href,"_blank","noopener");if(f.urlAuthDomains.includes(p.hostname))return t.closeStoryViewer({tabId:c}),void t.requestLinkUrlAuth({url:o,tabId:c});const I=f.whitelistedDomains.includes(p.hostname);h.match(a.H_r)||i||I?window.open(p,"_blank","noopener"):t.toggleSafeLinkModal({url:m?p.toString():h,tabId:c})}),(0,w.aJ)("openChatOrTopicWithReplyInDraft",(e,t,s)=>{const{chatId:a,topicId:o,tabId:n=(0,u.g0)()}=s;e=(0,w.mS)();const r=(0,C.nTw)(e,n).replyingMessage;e=(0,M.w)(e,{isShareMessageModalShown:!1,replyingMessage:{}},n),(0,w.UF)(e),e=(0,w.mS)();const d=(0,C.meB)(e,n),c=(0,C.Xf0)(e,n)?.threadId;if(!d||!c)return;const l=o||i.l3,h=d.id,p={type:"message",replyToMsgId:r.messageId,replyToTopId:r.toThreadId,replyToPeerId:h,monoforumPeerId:r.toThreadId,quoteText:r.quoteText,quoteOffset:r.quoteOffset},m=r.messageId?p:(0,C.GA4)(e,h,c)?.replyInfo;if(!m)return;if(!(0,C.Vz3)(e,a,h,m))return void t.showNotification({message:(0,g.yE)("Chat.SendNotAllowedText"),tabId:n});if(!m.replyToPeerId&&a===d.id)return;const f=m?.replyToPeerId?m.replyToPeerId===a?void 0:m.replyToPeerId:h;!function(e,t,s,a){const o=(0,C.GA4)(e,a,t);s.replyToMsgId&&te({global:e,chatId:a,threadId:t,draft:{...o,replyInfo:s},isLocalOnly:!0,noLocalTimeUpdate:!0})}(e,l,{...m,replyToPeerId:f,type:"message"},a),t.openThread({chatId:a,threadId:l,tabId:n}),t.closeMediaViewer({tabId:n}),t.exitMessageSelectMode({tabId:n}),t.clearDraft({chatId:h,threadId:c})}),(0,w.aJ)("setForwardChatOrTopic",async(e,t,s)=>{const{chatId:a,topicId:o,tabId:n=(0,u.g0)()}=s,r=(0,C.mBe)(e,a);(0,C.lC)(e,n)&&r&&!await async function(e,t,s){let a=(0,C.vGo)(e,s);if(!a){const{accessHash:e}=t,o=await(0,b.px)("fetchFullUser",{id:s,accessHash:e});a=o?.fullInfo}return Boolean(!a?.noVoiceMessages)}(e,r,a)?t.showDialog({data:{message:(0,g.yE)("VoiceMessagesRestrictedByPrivacy",(0,y.Yg)(r))},tabId:n}):(e=(0,w.mS)(),(0,C.DI)(e,a,n)?(e=(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,n).forwardMessages,toChatId:a,toThreadId:o},isShareMessageModalShown:!1},n),(0,w.UF)(e),t.openThread({chatId:a,threadId:o||i.l3,tabId:n}),t.closeMediaViewer({tabId:n}),t.exitMessageSelectMode({tabId:n})):t.showAllowedMessageTypesNotification({chatId:a,tabId:n}))}),(0,w.aJ)("forwardToSavedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)(),scheduledAt:o}=s||{};e=(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,a).forwardMessages,toChatId:e.currentUserId}},a),(0,w.UF)(e),t.exitMessageSelectMode({tabId:a}),t.forwardMessages({isSilent:!0,tabId:a,scheduledAt:o})}),(0,w.aJ)("forwardStory",(e,t,s)=>{const{toChatId:a,tabId:o=(0,u.g0)()}=s||{},{fromChatId:i,storyId:n}=(0,C.nTw)(e,o).forwardMessages,r=i?(0,C.hds)(e,i):void 0,d=a?(0,C.hds)(e,a):void 0,c=i&&n?(0,C.Msb)(e,i,n):void 0;if(!r||!d||!c||"isDeleted"in c)return;const l=(0,C.ZZX)(e,a),{text:h,entities:p}=c.content.text||{};re(e,{chat:d,text:h,entities:p,story:c,lastMessageId:l}),e=(0,w.mS)(),e=(0,M.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},o),(0,w.UF)(e)}),(0,w.aJ)("requestMessageTranslation",(e,t,s)=>{const{chatId:a,id:o,toLanguageCode:i=(0,C.Qq_)(e),tabId:n=(0,u.g0)()}=s;return e=(0,A._Bm)(e,a,o,i,n),(0,A.qpc)(e,{translationLanguage:i})}),(0,w.aJ)("showOriginalMessage",(e,t,s)=>{const{chatId:a,id:o,tabId:i=(0,u.g0)()}=s;return(0,A.xGf)(e,a,o,i)}),(0,w.aJ)("markMessagesTranslationPending",(e,t,s)=>{const{chatId:a,messageIds:o,toLanguageCode:i=(0,C.wmb)(e)}=s;return o.forEach(t=>{e=(0,A.oeN)(e,a,t,i,{isPending:!0})}),e}),(0,w.aJ)("translateMessages",(e,t,s)=>{const{chatId:a,messageIds:o,toLanguageCode:i=(0,C.wmb)(e)}=s,n=(0,C.hds)(e,a);if(n)return t.markMessagesTranslationPending({chatId:a,messageIds:o,toLanguageCode:i}),(0,b.px)("translateText",{chat:n,messageIds:o,toLanguageCode:i}),e});let ce,le={};function ue(){ce&&(clearTimeout(ce),ce=void 0);const{loadMessageViews:e}=(0,w.ko)();Object.entries(le).forEach(([t,s])=>{e({chatId:t,ids:Array.from(s),shouldIncrement:!0})}),le={}}(0,w.aJ)("scheduleForViewsIncrement",(e,t,s)=>{const{ids:a,chatId:o}=s;ce||setTimeout(ue,1e3),le[o]||(le[o]=new Set),a.forEach(e=>{le[o].add(e)})}),(0,w.aJ)("loadMessageViews",async(e,t,s)=>{const{chatId:a,ids:o,shouldIncrement:i}=s;if((0,C.trm)(e))return;const n=(0,C.hds)(e,a);if(!n)return;const r=await(0,b.px)("fetchMessageViews",{chat:n,ids:o,shouldIncrement:i});r&&(e=(0,w.mS)(),r.viewsInfo.forEach(t=>{e=(0,A.r3y)(e,a,t.id,{viewsCount:t.views,forwardsCount:t.forwards},!0),t.threadInfo&&(e=(0,A.eAk)(e,a,t.id,t.threadInfo))}),(0,w.UF)(e))}),(0,w.aJ)("loadFactChecks",async(e,t,s)=>{const{chatId:a,ids:o}=s,i=(0,C.hds)(e,a);if(!i)return;const n=await(0,b.px)("fetchFactChecks",{chat:i,ids:o});n&&(e=(0,w.mS)(),n.forEach((t,s)=>{e=(0,A.r3y)(e,a,o[s],{factCheck:t})}),(0,w.UF)(e))}),(0,w.aJ)("loadPaidReactionPrivacy",()=>{(0,b.px)("fetchPaidReactionPrivacy")}),(0,w.aJ)("loadOutboxReadDate",async(e,t,s)=>{const{chatId:a,messageId:o}=s,i=(0,C.hds)(e,a);if(i)try{const t=await(0,b.px)("fetchOutboxReadDate",{chat:i,messageId:o});t?.date&&(e=(0,w.mS)(),e=(0,A.r3y)(e,a,o,{readDate:t.date}),(0,w.UF)(e))}catch(t){const{message:s}=t;if("USER_PRIVACY_RESTRICTED"===s||"YOUR_PRIVACY_RESTRICTED"===s){if(e=(0,w.mS)(),!(0,C.mBe)(e,a))return;const t=(0,C.K0y)(e,a);if(!t)return;const i="USER_PRIVACY_RESTRICTED"===s?{isReadDateRestricted:!0}:{isReadDateRestrictedByMe:!0};e=(0,A.wWy)(e,{[a]:{...t,...i}}),e=(0,A.r3y)(e,a,o,{readDate:void 0}),(0,w.UF)(e)}}}),(0,w.aJ)("loadQuickReplies",async e=>{const t=await(0,b.px)("fetchQuickReplies");t&&(e=(0,w.mS)(),e=(0,A.tMr)(e,(0,h.dU)(t.messages,"id")),e=(0,A.xAV)(e,t.quickReplies),(0,w.UF)(e))}),(0,w.aJ)("sendQuickReply",(e,t,s)=>{const{chatId:a,quickReplyId:o}=s,i=(0,C.hds)(e,a);return i?((0,b.px)("sendQuickReply",{chat:i,shortcutId:o}),e):e}),(0,w.aJ)("copyMessageLink",async(e,t,s)=>{const{chatId:a,messageId:o,shouldIncludeThread:i,shouldIncludeGrouped:n,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a);if(!d)return void t.showNotification({message:(0,g.yE)("ErrorOccurred"),tabId:r});const l=()=>t.showNotification({message:(0,g.yE)("ErrorOccurred"),tabId:r});if(!(0,y.WX)(d)&&!(0,y.Vs)(d))return void l();const h=(0,b.px)("exportMessageLink",{chat:d,id:o,shouldIncludeThread:i,shouldIncludeGrouped:n});await(0,c.LD)(h,()=>t.showNotification({message:(0,g.yE)("LinkCopied"),tabId:r}),l)});const he=new Map;let pe;function me(e){const{shouldSendAsFile:t,mimeType:s}=e;return a.IH3.has(s)?"audio":t?"file":s===a.Vz3?"gif":a.gex.has(s)||a.fNs.has(s)?"media":e.voice?"voice":"file"}(0,w.aJ)("reportMessageDelivery",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=he.get(a)||[];i.push(o),he.set(a,i),pe||(pe=window.setTimeout(()=>{pe=void 0,he.forEach((t,s)=>{const a=(0,C.hds)(e,s);a&&(0,b.px)("reportMessagesDelivery",{chat:a,messageIds:t})}),he.clear()},500))}),(0,w.aJ)("openPreparedInlineMessageModal",async(e,t,s)=>{const{botId:a,messageId:o,webAppKey:i,tabId:n=(0,u.g0)()}=s,r=(0,C.mBe)(e,a);if(!r)return;const d=await(0,b.px)("fetchPreparedInlineMessage",{bot:r,id:o});d?(e=(0,w.mS)(),e=(0,M.w)(e,{preparedMessageModal:{message:d,webAppKey:i,botId:a}},n),(0,w.UF)(e)):t.sendWebAppEvent({webAppKey:i,event:{eventType:"prepared_message_failed",eventData:{error:"MESSAGE_EXPIRED"}},tabId:n})}),(0,w.aJ)("openSharePreparedMessageModal",(e,t,s)=>{const{webAppKey:a,message:o,tabId:i=(0,u.g0)()}=s,n=o.peerTypes?.filter(e=>"self"!==e);e=(0,w.mS)(),e=(0,M.w)(e,{sharePreparedMessageModal:{webAppKey:a,filter:n,message:o}},i),(0,w.UF)(e)});var fe=s(529),ge=s(64520);const Ie=(0,I.nF)(e=>e(),500,!1);async function ve(e,t){const s=await(0,b.px)("fetchRecentStickers",{hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:s}},(0,w.UF)(e))}async function be(e,t,s){let a;try{a=await(0,b.px)("fetchStickers",{stickerSetInfo:s})}catch(a){if("STICKERSET_INVALID"===a.message)return void Object.values(e.byTabId).forEach(({id:a})=>{t.showNotification({message:(0,g.yE)("StickerPack.ErrorNotFound"),tabId:a}),"shortName"in s&&(0,C.nTw)(e,a).openedStickerSetShortName===s.shortName&&(e=(0,M.w)(e,{openedStickerSetShortName:void 0},a),(0,w.UF)(e))})}if(e=(0,w.mS)(),!a)return;const{set:o,stickers:i,packs:n}=a,r=(e=(0,A.v9P)(e,o.id,{...o,stickers:i,packs:n})).stickers.forEmoji.emoji;r&&n[r]&&(e=(0,A.PcY)(e)),(0,w.UF)(e)}async function ye(e,t,s,a,...[o=(0,u.g0)()]){const i=await(0,b.px)("searchGifs",{query:t,offset:a,username:s});i&&(e=(0,w.mS)(),e=(0,A.Mel)(e,!a,i.gifs,i.nextOffset,o),(0,w.UF)(e))}(0,w.aJ)("loadStickerSets",async(e,t)=>{const[s,a]=await Promise.all([(0,b.px)("fetchStickerSets",{hash:e.stickers.added.hash}),(0,b.px)("fetchCustomEmojiSets",{hash:e.customEmojis.added.hash})]);a&&s&&(e=(0,w.mS)(),e=(0,A.MkE)(e,"added",s.hash,s.sets),e=(0,A.E24)(e,a.hash,a.sets),(0,w.UF)(e),t.loadCustomEmojis({ids:e.recentCustomEmojis}))}),(0,w.aJ)("loadAddedStickers",async(e,t)=>{const{added:{setIds:s=[]},setsById:a}=e.stickers,{added:{setIds:o=[]}}=e.customEmojis,i=[...s,...o];if(i.length)for(let e=0;e<i.length;e++){const s=i[e];a[s]?.stickers||(t.loadStickers({stickerSetInfo:{id:s,accessHash:a[s].accessHash}}),e%10==0&&e>0&&await(0,I.v7)(200))}}),(0,w.aJ)("loadRecentStickers",e=>{const{hash:t}=e.stickers.recent||{};ve(e,t)}),(0,w.aJ)("loadFavoriteStickers",async e=>{const{hash:t}=e.stickers.favorite||{},s=await(0,b.px)("fetchFavoriteStickers",{hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:s}},(0,w.UF)(e))}),(0,w.aJ)("loadPremiumStickers",async e=>{const{hash:t}=e.stickers.premium||{};if((0,C.trm)(e))return;const s=await(0,b.px)("fetchStickersForEmoji",{emoji:"⭐️⭐️",hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,premium:{hash:s.hash,stickers:s.stickers}}},(0,w.UF)(e))}),(0,w.aJ)("loadGreetingStickers",async e=>{const{hash:t}=e.stickers.greeting||{};if((0,C.trm)(e))return;const s=await(0,b.px)("fetchStickersForEmoji",{emoji:"👋⭐️",hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,greeting:{hash:s.hash,stickers:s.stickers.filter(e=>"👋"===e.emoji)}}},(0,w.UF)(e))}),(0,w.aJ)("loadFeaturedStickers",async e=>{const{hash:t}=e.stickers.featured||{},s=await(0,b.px)("fetchFeaturedStickers",{hash:t});s&&(e=(0,w.mS)(),e=(0,A.MkE)(e,"featured",s.hash,s.sets),(0,w.UF)(e))}),(0,w.aJ)("loadPremiumGifts",async e=>{const t=await(0,b.px)("fetchPremiumGifts");if(!t)return;const{set:s,stickers:a}=t;e=(0,w.mS)(),e={...e,premiumGifts:{...s,stickers:a}},(0,w.UF)(e)}),(0,w.aJ)("loadTonGifts",async e=>{const t=await(0,b.px)("fetchTonGifts");if(!t)return;const{set:s,stickers:a}=t;e=(0,w.mS)(),e={...e,tonGifts:{...s,stickers:a}},(0,w.UF)(e)}),(0,w.aJ)("loadDefaultTopicIcons",async e=>{const t=await(0,b.px)("fetchDefaultTopicIcons");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t,o={...s,stickers:a};e=(0,A.v9P)(e,o.id,o),e={...e,defaultTopicIconsId:o.id},(0,w.UF)(e)}),(0,w.aJ)("loadDefaultStatusIcons",async e=>{const t=await(0,b.px)("fetchDefaultStatusEmojis");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t,o={...s,stickers:a};e=(0,A.v9P)(e,o.id,o),e={...e,defaultStatusIconsId:o.id},(0,w.UF)(e)}),(0,w.aJ)("loadUserCollectibleStatuses",async(e,t)=>{(0,w.UF)(e);const{hash:s}=e.collectibleEmojiStatuses||{},a=await(0,b.px)("fetchCollectibleEmojiStatuses",{hash:s});if(!a)return;e=(0,w.mS)(),e={...e,collectibleEmojiStatuses:{hash:a.hash,statuses:a.statuses}},(0,w.UF)(e);const o=a.statuses.map(({documentId:e})=>e);t.loadCustomEmojis({ids:o})}),(0,w.aJ)("loadStickers",(e,t,s)=>{const{stickerSetInfo:a}=s,o=(0,C.ycM)(e,a);o&&o.count===o?.stickers?.length||be(e,t,a)}),(0,w.aJ)("loadAnimatedEmojis",async e=>{const[t,s]=await Promise.all([(0,b.px)("fetchAnimatedEmojis"),(0,b.px)("fetchAnimatedEmojiEffects")]);t&&s&&(e=(0,w.mS)(),e=(0,A.$nQ)(e,{...t.set,stickers:t.stickers}),e={...e,animatedEmojiEffects:{...s.set,stickers:s.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadBirthdayNumbersStickers",async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:a.OVC}});t&&(e=(0,w.mS)(),e={...e,birthdayNumbers:{...t.set,stickers:t.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadRestrictedEmojiStickers",async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:a.Kh8}});t&&(e=(0,w.mS)(),e={...e,restrictedEmoji:{...t.set,stickers:t.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadGenericEmojiEffects",async e=>{const t=await(0,b.px)("fetchGenericEmojiEffects");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t;e={...e,genericEmojiEffects:{...s,stickers:a}},(0,w.UF)(e)}),(0,w.aJ)("loadSavedGifs",async e=>{const{hash:t}=e.gifs.saved,s=await(0,b.px)("fetchSavedGifs",{hash:t});s&&(e=(0,w.mS)(),e={...e,gifs:{...e.gifs,saved:s}},(0,w.UF)(e))}),(0,w.aJ)("saveGif",async(e,t,s)=>{const{gif:a,shouldUnsave:o,tabId:i=(0,u.g0)()}=s,n=e.gifs.saved.gifs?.length,r=(0,ge.d)(e,"savedGifs"),d=(0,ge.B)(e,"savedGifs"),c=(0,C.g29)(e);if(!o&&n&&n>=r&&t.showNotification({title:g.yE("LimitReachedFavoriteGifs",r.toString()),message:c?g.yE("LimitReachedFavoriteGifsSubtitlePremium"):g.yE("LimitReachedFavoriteGifsSubtitle",d.toString()),...!c&&{action:{action:"openPremiumModal",payload:{tabId:i}}},className:"bold-link",tabId:i}),!await(0,b.px)("saveGif",{gif:a,shouldUnsave:o}))return;e=(0,w.mS)();const l=e.gifs.saved.gifs?.filter(({id:e})=>e!==a.id)||[],h=o?l:[a,...l];e={...e,gifs:{...e.gifs,saved:{...e.gifs.saved,gifs:h}}},(0,w.UF)(e)}),(0,w.aJ)("faveSticker",(e,t,s)=>{const{sticker:a,tabId:o=(0,u.g0)()}=s,i=e.stickers.favorite.stickers.length,n=(0,ge.d)(e,"stickersFaved"),r=(0,ge.B)(e,"stickersFaved"),d=(0,C.g29)(e);i>=n&&t.showNotification({title:g.yE("LimitReachedFavoriteStickers",n.toString()),message:d?g.yE("LimitReachedFavoriteStickersSubtitlePremium"):g.yE("LimitReachedFavoriteStickersSubtitle",r.toString()),...!d&&{action:{action:"openPremiumModal",payload:{tabId:o}}},className:"bold-link",tabId:o}),a&&(0,b.px)("faveSticker",{sticker:a})}),(0,w.aJ)("unfaveSticker",(e,t,s)=>{const{sticker:a}=s;a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:{...e.stickers.favorite,stickers:e.stickers.favorite.stickers.filter(({id:e})=>e!==a.id)}}},(0,w.UF)(e),(0,b.px)("faveSticker",{sticker:a,unfave:!0}))}),(0,w.aJ)("removeRecentSticker",async(e,t,s)=>{const{sticker:a}=s;await(0,b.px)("removeRecentSticker",{sticker:a})&&ve((0,w.mS)())}),(0,w.aJ)("clearRecentStickers",async e=>{await(0,b.px)("clearRecentStickers")&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:{stickers:[]}}},(0,w.UF)(e))}),(0,w.aJ)("toggleStickerSet",(e,t,s)=>{const{stickerSetId:a}=s,o=(0,C.ycM)(e,a);if(!o)return;const{accessHash:i,installedDate:n,isArchived:r}=o,d=!r&&Boolean(n);(0,b.px)(d?"uninstallStickerSet":"installStickerSet",{stickerSetId:a,accessHash:i})}),(0,w.aJ)("loadEmojiKeywords",async(e,t,s)=>{const{language:a}=s;let o=e.emojiKeywords[a];if(o?.isLoading)return;e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{...o,isLoading:!0}}},(0,w.UF)(e);const i=await(0,b.px)("fetchEmojiKeywords",{language:a,fromVersion:o?o.version:0});if(o=(e=(0,w.mS)()).emojiKeywords[a],!i)return e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{...o,isLoading:!1}}},void(0,w.UF)(e);e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{isLoading:!1,version:i.version,keywords:{...o?.keywords,...i.keywords}}}},(0,w.UF)(e)}),(0,w.aJ)("setStickerSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;a&&Ie(async()=>{const t=await(0,b.px)("searchStickers",{query:a});if(!t)return;e=(0,w.mS)();const{setsById:s,added:i}=e.stickers,n=t.sets.map(({id:e})=>e);i.setIds&&i.setIds.forEach(e=>{if(!n.includes(e)){const{title:t}=s[e]||{};t&&(0,fe.A)(t,a)&&n.unshift(e)}}),e=(0,A.MkE)(e,"search",t.hash,t.sets),e=(0,A.bG)(e,t.hash,n,o),(0,w.UF)(e)})}),(0,w.aJ)("setGifSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;"string"==typeof a&&Ie(()=>{ye(e=(0,w.mS)(),a,e.config?.gifSearchUsername,void 0,o)})}),(0,w.aJ)("searchMoreGifs",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{query:o,offset:i}=(0,C.nTw)(e,a).gifSearch;"string"==typeof o&&Ie(()=>{ye(e=(0,w.mS)(),o,e.config?.gifSearchUsername,i,a)})}),(0,w.aJ)("loadStickersForEmoji",(e,t,s)=>{const{emoji:a}=s,{hash:o}=e.stickers.forEmoji;Ie(async()=>{e=(0,w.mS)(),e={...e,stickers:{...e.stickers,forEmoji:{...e.stickers.forEmoji,emoji:a}}},(0,w.UF)(e);const t=await(0,b.px)("fetchStickersForEmoji",{emoji:a,hash:o});e=(0,w.mS)(),t&&e.stickers.forEmoji.emoji===a&&(e=(0,A.f_N)(e,a,t.stickers,t.hash),(0,w.UF)(e))})}),(0,w.aJ)("clearStickersForEmoji",e=>({...e,stickers:{...e.stickers,forEmoji:{}}})),(0,w.aJ)("loadCustomEmojiForEmoji",(e,t,s)=>{const{emoji:a}=s;return(0,A.G4z)(e,a)}),(0,w.aJ)("clearCustomEmojiForEmoji",e=>({...e,customEmojis:{...e.customEmojis,forEmoji:{}}})),(0,w.aJ)("loadFeaturedEmojiStickers",async e=>{const t=await(0,b.px)("fetchFeaturedEmojiStickers",{});t&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,featuredIds:t.sets.map(({id:e})=>e),byId:{...e.customEmojis.byId,...(0,h.dU)(t.sets.flatMap(e=>e.stickers||[]),"id")}},stickers:{...e.stickers,setsById:{...e.stickers.setsById,...(0,h.dU)(t.sets,"id")}}},(0,w.UF)(e))}),(0,w.aJ)("openStickerSet",async(e,t,s)=>{const{stickerSetInfo:a,shouldIgnoreCache:o,tabId:i=(0,u.g0)()}=s;!o&&(0,C.ycM)(e,a)||await be(e,t,a),e=(0,w.mS)();const n=(0,C.ycM)(e,a);n?.shortName&&(e=(0,M.w)(e,{openedStickerSetShortName:n.shortName},i),(0,w.UF)(e))}),(0,w.aJ)("loadRecentEmojiStatuses",async e=>{const t=await(0,b.px)("fetchRecentEmojiStatuses");t&&(e=(0,w.mS)(),e=(0,A.T3R)(e,t.hash,t.emojiStatuses),(0,w.UF)(e))});var Se=s(17663),we=s(62214);const Ae=(0,I.nF)(e=>e(),500,!1);async function Me(e,t,s){if(!(0,we.YE)(t)&&!(0,we.WX)(t))return;const a=(0,C.O5q)(e,t.id,s);if(a)return a;const o=await(0,b.px)("fetchMessage",{chat:t,messageId:s});return"MESSAGE_DELETED"===o?void 0:o?.message}(0,w.aJ)("setGlobalSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,{chatId:i}=(0,C.nTw)(e,o).globalSearch;a&&!i&&Ae(async()=>{const[t,s]=await Promise.all([(0,b.px)("searchChats",{query:a}),(0,b.px)("fetchSponsoredPeer",{query:a})]);e=(0,w.mS)();const i=(0,C.xT4)(e,o);if(!t||!i||a!==i)return e=(0,A.RgT)(e,{chats:!1},o),void(0,w.UF)(e);const{accountResultIds:n,globalResultIds:r}=t;e=(0,A.RgT)(e,{chats:!1},o),e=(0,A.b8O)(e,{localResults:{peerIds:n},globalResults:{...(0,C.nTw)(e,o).globalSearch.globalResults,peerIds:r},sponsoredPeer:s},o),(0,w.UF)(e)})}),(0,w.aJ)("setGlobalSearchDate",(e,t,s)=>{const{date:a,tabId:o=(0,u.g0)()}=s,i=a?(0,Se.TI)(a):a;e=(0,A.b8O)(e,{minDate:a,maxDate:i,query:"",resultsByType:{...(0,C.nTw)(e,o).globalSearch.resultsByType,text:{totalCount:void 0,foundIds:[],nextOffsetId:0}}},o),(0,w.UF)(e),t.searchMessagesGlobal({type:"text",tabId:o})}),(0,w.aJ)("searchMessagesGlobal",(e,t,s)=>{const{type:o,context:i,shouldResetResultsByType:n,shouldCheckFetchingMessagesStatus:r,tabId:d=(0,u.g0)()}=s;r&&(e=(0,A.RgT)(e,{messages:!0},d),(0,w.UF)(e),e=(0,w.mS)());const{query:c,resultsByType:h,chatId:p}=(0,C.nTw)(e,d).globalSearch,{totalCount:g,foundIds:I,nextOffsetId:v,nextOffsetPeerId:y,nextOffsetRate:M}=!n&&h?.[o]||{};if(void 0!==g&&(!g||I&&I.length>=g))return;const P=p?(0,C.PVB)(e,p):void 0;!async function(e,t){const{query:s="",type:o,context:i,offsetRate:n,offsetId:r,offsetPeer:d,peer:c,maxDate:h,minDate:p,shouldResetResultsByType:g,tabId:I=(0,u.g0)()}=t;let v,y;"publicPosts"===o&&(e=(0,A.RgT)(e,{publicPosts:!0},I),(0,w.UF)(e));const M=(0,C.nTw)(e,I).globalSearch.searchFlood;if(c){const e=(0,b.px)("searchMessagesInChat",{peer:c,query:s,type:o,limit:a.wAs,offsetId:r,minDate:p,maxDate:h}),t=(0,S.vj)(c)&&c.isForum?(0,b.px)("fetchTopics",{chat:c,query:s,limit:a.mH$}):void 0,[i,n]=await Promise.all([e,t]);if(i){const{messages:e,totalCount:t,nextOffsetId:s}=i,{topics:a,count:o}=n||{};v={topics:a,totalTopicsCount:o,messages:e,totalCount:t,nextOffsetId:s}}}else if(v=await(0,b.px)("searchMessagesGlobal",{query:s,offsetRate:n,offsetId:r,offsetPeer:d,limit:a.wAs,type:o,context:i,maxDate:h,minDate:p}),(0,l.zq)(s)){const t=(0,l.vG)(s);"publicMessageLink"===t?.type?y=await async function(e,t){const{username:s,messageId:a}=t,o=(0,C.qn$)(e,s);if(o)return Me(e,o,a);const{chat:i}=await(0,b.px)("getChatByUsername",s)??{};return i?Me(e,i,a):void 0}(e,t):"privateMessageLink"===t?.type&&(y=await function(e,t){const{channelId:s,messageId:a}=t,o=(0,k.QE)(s),i=(0,C.hds)(e,o);if(i)return Me(e,i,a)}(e,t))}e=(0,w.mS)(),g&&(e=(0,A.b8O)(e,{resultsByType:{...((0,C.nTw)(e,I).globalSearch||{}).resultsByType,[o]:void 0}},I));const P=(0,C.xT4)(e,I);if(!v||""!==s&&s!==P)return e=(0,A.RgT)(e,{messages:!1,publicPosts:!1},I),void(0,w.UF)(e);y&&(v.totalCount=v.messages.unshift(y));const{messages:F,userStatusesById:T,totalCount:U,nextOffsetRate:x,nextOffsetId:B,nextOffsetPeerId:R}=v,J=v.searchFlood||M;T&&(e=(0,A.d2X)(e,T)),F.length&&(e=(0,A.KcS)(e,F)),e=(0,A.HyB)(e,F,U,o,x,B,R,J,I),v.topics&&(e=(0,A.mIA)(e,c.id,v.totalTopicsCount,v.topics));const N=v.topics?.map(({id:e})=>e).sort((e,t)=>t-e);if(e=(0,A.b8O)(e,{foundTopicIds:N},I),(0,w.UF)(e),"publicPosts"===o&&J&&!J.queryIsFree&&!r&&0===M?.remains){const e=(0,m.Yw)();(0,w.ko)().showNotification({icon:"star",message:{key:"NotificationPaidExtraSearch",variables:{stars:(0,f.Kk)(e,J.starsAmount)}}})}}(e,{query:c,type:o,context:i,shouldResetResultsByType:n,offsetRate:M,offsetId:v,offsetPeer:y?(0,C.PVB)(e,y):void 0,peer:P,tabId:d})}),(0,w.aJ)("searchPopularBotApps",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).globalSearch.popularBotApps,i=o?.nextOffset;if(o?.peerIds&&!i)return;e=(0,A.RgT)(e,{botApps:!0},a),(0,w.UF)(e);const n=await(0,b.px)("fetchPopularAppBots",{offset:i});if(e=(0,w.mS)(),!n)return e=(0,A.RgT)(e,{botApps:!1},a),void(0,w.UF)(e);e=(0,A.b8O)(e,{popularBotApps:{peerIds:[...o?.peerIds||[],...n.peerIds],nextOffset:n.nextOffset}},a),e=(0,A.RgT)(e,{botApps:!1},a),(0,w.UF)(e)}),(0,w.aJ)("checkSearchPostsFlood",async(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,i=await(0,b.px)("checkSearchPostsFlood",a);e=(0,w.mS)(),i&&(e=(0,A.b8O)(e,{searchFlood:i},o),(0,w.UF)(e))});var Ce=s(57309);async function Pe(e,t,s,o,i,n=!1,r,...[d=(0,u.g0)()]){const c=r?e.currentUserId:t.id,l=await(0,b.px)("searchMessagesInChat",{peer:t,type:o,limit:2*a.Um,threadId:s,offsetId:i,isSavedDialog:r});if(!l)return;const{userStatusesById:p,messages:m,totalCount:f,nextOffsetId:g}=l,I=(0,h.dU)(m,"id"),v=Object.keys(I).map(Number);e=(0,w.mS)(),(0,C.BU_)(e,d)&&(e=(0,A.d2X)(e,p),e=(0,A.o4A)(e,c,I),e=(0,A.jU1)(e,c,s,o,v,f,g,d),(0,w.UF)(e),n||Pe(e,t,s,o,g,!0,r,d))}(0,w.aJ)("performMiddleSearch",async(e,t,s)=>{const{query:o,chatId:n,threadId:r=i.l3,tabId:d=(0,u.g0)()}=s||{};if(!n)return;const c=e.currentUserId,l=(0,y.cG)(n,r,c),h=l?String(r):n,p=h?(0,C.PVB)(e,h):void 0;let m=(0,C.TCk)(e,d);if(!p)return;m||(e=(0,A.$RI)(e,h,r,{},d),(0,w.UF)(e),e=(0,w.mS)()),m=(0,C.TCk)(e,d);const{results:f,savedTag:g,type:I,isHashtag:v}=m,S=f?.query===o,M=S?f?.nextOffsetId:void 0,P=S?f?.nextOffsetRate:void 0,k=S?f?.nextOffsetPeerId:void 0,F=S&&k?(0,C.hds)(e,k):void 0;if((v||!g)&&!o)return e=(0,A.$RI)(e,h,r,{fetchingQuery:void 0},d),void(0,w.UF)(e);let T;if(e=(0,A.$RI)(e,h,r,{fetchingQuery:o},d),(0,w.UF)(e),"chat"===I&&(T=await(0,b.px)("searchMessagesInChat",{peer:p,type:"text",query:v?`#${o}`:o,threadId:r,limit:a.gXr,offsetId:M,isSavedDialog:l,savedTag:g})),"myChats"===I&&(T=await(0,b.px)("searchMessagesGlobal",{type:"text",query:v?`#${o}`:o,limit:a.gXr,offsetId:M,offsetRate:P,offsetPeer:F})),"channels"===I&&(T=await(0,b.px)("searchPublicPosts",{hashtag:o,limit:a.gXr,offsetId:M,offsetPeer:F,offsetRate:P})),!T)return;const{userStatusesById:U,messages:x,totalCount:B,nextOffsetId:R,nextOffsetRate:J,nextOffsetPeerId:N}=T,E=x.map(Ce.D);e=(0,w.mS)(),m=(0,C.TCk)(e,d);const L=m?.savedTag&&!(0,y.a0)(g,m.savedTag);if(!m||m?.fetchingQuery!==o||L)return;const O=l?c:p.id;e=(0,A.d2X)(e,U),e=(0,A.KcS)(e,x),e=(0,A.$RI)(e,O,r,{fetchingQuery:void 0},d),e=(0,A.VmW)(e,O,r,{foundIds:E,totalCount:B,nextOffsetId:R,nextOffsetRate:J,nextOffsetPeerId:N,query:o||""},g,d),(0,w.UF)(e)}),(0,w.aJ)("searchHashtag",(e,t,s)=>{const{hashtag:a,tabId:o=(0,u.g0)()}=s,i=(0,C.Xf0)(e,o);if(!i)return;const n=a.replace(/^#/,"");t.updateMiddleSearch({chatId:i.chatId,threadId:i.threadId,update:{isHashtag:!0,requestedQuery:n},tabId:o})}),(0,w.aJ)("searchSharedMediaMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:i}=(0,C.Xf0)(e,a)||{};if(!o||!i)return;const n=(0,y.cG)(o,i,e.currentUserId),r=n?String(i):o,d=(0,C.PVB)(e,r),c=(0,C.BU_)(e,a);if(!d||!c)return;const{currentType:l,resultsByType:h}=c,p=l&&h&&h[l],m=p?.nextOffsetId;l&&Pe(e,d,i,l,m,void 0,n,a)}),(0,w.aJ)("searchChatMediaMessages",(e,t,s)=>{const{chatId:o,threadId:i,currentMediaMessageId:r,limit:d,direction:c,tabId:l=(0,u.g0)()}=s;if(!o||!i||!r)return;const p=(0,y.cG)(o,i,e.currentUserId),m=p?String(i):o,f=(0,C.hds)(e,m);if(!f)return;let g=(0,C.CuV)(e,l);if(!g){if(e=(0,A.tXQ)(e,o,i,l),(0,w.UF)(e),g=(0,C.CuV)(e,l),!g)return;e=(0,w.mS)()}!async function(e,t,s,o,i,r,d,c=a.laV,...[l=(0,u.g0)()]){const{isSynced:p}=e;if(!p||i.isLoading)return;let m=function(e,t){if((0,h.OX)(t,e.currentSegment.foundIds))return e.currentSegment;const s=e.segments.findIndex(e=>(0,h.OX)(t,e.foundIds));if(-1===s)return void(e.currentSegment&&e.currentSegment.foundIds.length&&e.segments.push(e.currentSegment));const a=e.segments.splice(s,1)[0];return e.segments.push(e.currentSegment),a}(i,o);if(void 0===r&&(r=function(e,t){if(!t)return n.TN.Around;const s=t.foundIds.length,a=t.foundIds.indexOf(e);if(-1===a)return n.TN.Around;if(t.loadingState.areAllItemsLoadedBackwards&&t.loadingState.areAllItemsLoadedForwards)return;const o=9>Math.floor(s/2)?0:9,i=s-1;if(a<=o){if(t.loadingState.areAllItemsLoadedBackwards)return;return n.TN.Backwards}if(a>=i-o){if(t.loadingState.areAllItemsLoadedForwards)return;return n.TN.Forwards}}(o,m)),void 0===r)return;const f=function(e,t,s){return s?e===n.TN.Backwards?s.foundIds[0]:e===n.TN.Forwards?s.foundIds[s.foundIds.length-1]:t:t}(r,o,m),g=function(e,t){return e===n.TN.Backwards?0:e===n.TN.Forwards?-(t+1):-(Math.round(t/2)+1)}(r,c),I=d?e.currentUserId:t.id;e=(0,A.lwK)(e,I,s,!0,l),(0,w.UF)(e);const v=await(0,b.px)("searchMessagesInChat",{peer:t,type:"media",limit:c,threadId:s,offsetId:f,isSavedDialog:d,addOffset:g});if(e=(0,w.mS)(),!v)return e=(0,A.lwK)(e,I,s,!1,l),void(0,w.UF)(e);const{messages:S,userStatusesById:M}=v,C=(0,h.dU)(S,"id"),P=Object.keys(C).map(Number);e=(0,A.d2X)(e,M),e=(0,A.o4A)(e,I,C);const k=function(e,t,s,a){let o=Boolean(a?.loadingState.areAllItemsLoadedForwards),i=Boolean(a?.loadingState.areAllItemsLoadedBackwards);return s<t&&(e===n.TN.Forwards?o=!0:e===n.TN.Backwards&&(i=!0)),{areAllItemsLoadedForwards:o,areAllItemsLoadedBackwards:i}}(r,c,P.length,m),F=(0,y.lH)(C,P,"inlineMedia");m=(0,A.olz)(F,k,m),e=(0,A.Qb2)(e,I,s,m,i,l),e=(0,A.lwK)(e,I,s,!1,l),(0,w.UF)(e)}(e,f,i,r,g,c,p,d,l)}),(0,w.aJ)("searchMessagesByDate",async(e,t,s)=>{const{timestamp:a,tabId:o=(0,u.g0)()}=s,{chatId:i}=(0,C.Xf0)(e,o)||{};if(!i)return;const n=(0,C.hds)(e,i);if(!n)return;const r=await(0,b.px)("findFirstMessageIdAfterDate",{chat:n,timestamp:a});r&&t.focusMessage({chatId:n.id,messageId:r,tabId:o})}),(0,w.aJ)("checkPublicLink",async(e,t,s)=>{const{username:a,tabId:o=(0,u.g0)()}=s,{chatId:i}=(0,C.Xf0)(e,o)||{};if(!i)return;if((0,C.nTw)(e,o).management.progress===n.TD.InProgress)return;e=(0,A.H6X)(e,i,{isUsernameAvailable:void 0,checkedUsername:void 0},o),(0,w.UF)(e);const{result:r,error:d}=await(0,b.px)("checkChatUsername",{username:a});e=(0,w.mS)(),e=(0,A.G42)(e,!0===r?n.TD.Complete:n.TD.Error,o),e=(0,A.H6X)(e,i,{isUsernameAvailable:!0===r,checkedUsername:a,error:d},o),(0,w.UF)(e),void 0===r&&t.openLimitReachedModal({limit:"channelsPublic",tabId:o})}),(0,w.aJ)("updatePublicLink",async(e,t,s)=>{const{username:a,shouldDisableUsernames:i,tabId:r=(0,u.g0)()}=s,{chatId:d}=(0,C.Xf0)(e,r)||{};if(!d)return;const c=await(0,o.Jm)(e,t,d,r);if(!c)return;e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.InProgress,r),(0,w.UF)(e);const l=await(0,b.px)("setChatUsername",{chat:c,username:a});i&&await(0,b.px)("deactivateAllUsernames",{chat:c}),e=(0,w.mS)(),e=(0,A.G42)(e,l?n.TD.Complete:n.TD.Error,r),e=(0,A.H6X)(e,c.id,{isUsernameAvailable:void 0,checkedUsername:void 0,error:void 0},r),(0,w.UF)(e)}),(0,w.aJ)("updatePrivateLink",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{},i=o&&(0,C.hds)(e,o);o&&i&&(0,b.px)("updatePrivateLink",{chat:i})}),(0,w.aJ)("setEditingExportedInvite",(e,t,s)=>{const{chatId:a,invite:o,tabId:i=(0,u.g0)()}=s;e=(0,A.H6X)(e,a,{editingInvite:o},i),(0,w.UF)(e)}),(0,w.aJ)("setOpenedInviteInfo",(e,t,s)=>{const{chatId:a,invite:o,tabId:i=(0,u.g0)()}=s,n=o?{inviteInfo:{invite:o}}:{inviteInfo:void 0};e=(0,A.H6X)(e,a,n,i),(0,w.UF)(e)}),(0,w.aJ)("loadExportedChatInvites",async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a,adminId:o,isRevoked:i,limit:n,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a),c=(0,C.mBe)(e,o||e.currentUserId);if(!d||!c)return;const l=await(0,b.px)("fetchExportedChatInvites",{peer:d,admin:c,isRevoked:i,limit:n});if(!l)return;e=(0,w.mS)();const{invites:h}=l,p=i?{revokedInvites:h}:{invites:h};e=(0,A.H6X)(e,a,p,r),(0,w.UF)(e)}),(0,w.aJ)("editExportedChatInvite",async(e,t,s)=>{const{chatId:a,link:o,isRevoked:i,expireDate:n,usageLimit:r,isRequestNeeded:d,title:c,tabId:l=(0,u.g0)()}=s,h=(0,C.hds)(e,a);if(!h)return;const p=await(0,b.px)("editExportedChatInvite",{peer:h,link:o,isRevoked:i,expireDate:n,usageLimit:r,isRequestNeeded:d,title:c});if(!p)return;const{oldInvite:m,newInvite:f}=p;e=(0,w.mS)();const{management:g}=(0,C.nTw)(e,l),I=(g.byChatId[a].invites||[]).filter(e=>e.link!==m.link),v=[...g.byChatId[a].revokedInvites||[]];f.isRevoked?v.unshift(f):I.push(f),e=(0,A.H6X)(e,a,{invites:I,revokedInvites:v},l),(0,w.UF)(e)}),(0,w.aJ)("exportChatInvite",async(e,t,s)=>{const{chatId:a,expireDate:o,usageLimit:i,isRequestNeeded:n,title:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a);if(!c)return;const l=await(0,b.px)("exportChatInvite",{peer:c,expireDate:o,usageLimit:i,isRequestNeeded:n,title:r});if(!l)return;e=(0,w.mS)();const h=(0,C.nTw)(e,d).management.byChatId[a].invites||[];e=(0,A.H6X)(e,a,{invites:[...h,l]},d),(0,w.UF)(e)}),(0,w.aJ)("deleteExportedChatInvite",async(e,t,s)=>{const{chatId:a,link:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;if(!await(0,b.px)("deleteExportedChatInvite",{peer:n,link:o}))return;e=(0,w.mS)();const r=(0,C.nTw)(e,i).management.byChatId[a];e=(0,A.H6X)(e,a,{invites:r?.invites?.filter(e=>e.link!==o),revokedInvites:r?.revokedInvites?.filter(e=>e.link!==o)},i),(0,w.UF)(e)}),(0,w.aJ)("deleteRevokedExportedChatInvites",async(e,t,s)=>{const{chatId:a,adminId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a),r=(0,C.mBe)(e,o||e.currentUserId);n&&r&&await(0,b.px)("deleteRevokedExportedChatInvites",{peer:n,admin:r})&&(e=(0,w.mS)(),e=(0,A.H6X)(e,a,{revokedInvites:[]},i),(0,w.UF)(e))}),(0,w.aJ)("loadChatInviteImporters",async(e,t,s)=>{const{chatId:a,link:o,offsetDate:i,offsetUserId:n,limit:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a),l=n?(0,C.mBe)(e,n):void 0;if(!c||n&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:i,offsetUser:l,limit:r});if(!h)return;const{importers:p}=h;e=(0,w.mS)();const m=(0,C.nTw)(e,d).management.byChatId[a]?.inviteInfo;m?.invite&&m.invite.link===o&&(e=(0,A.H6X)(e,a,{inviteInfo:{...m,importers:p}},d),(0,w.UF)(e))}),(0,w.aJ)("loadChatInviteRequesters",async(e,t,s)=>{const{chatId:a,link:o,offsetDate:i,offsetUserId:n,limit:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a),l=n?(0,C.mBe)(e,n):void 0;if(!c||n&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:i,offsetUser:l,limit:r,isRequested:!0});if(!h)return;const{importers:p}=h;e=(0,w.mS)();const m=(0,C.nTw)(e,d).management.byChatId[a]?.inviteInfo;m?.invite&&m.invite.link===o&&(e=(0,A.H6X)(e,a,{inviteInfo:{...m,requesters:p}},d),(0,w.UF)(e))}),(0,w.aJ)("loadChatJoinRequests",async(e,t,s)=>{const{chatId:a,offsetDate:o=0,offsetUserId:i,limit:n=0}=s,r=(0,C.hds)(e,a),d=i?(0,C.mBe)(e,i):void 0;if(!r||i&&!d)return;const c=await(0,b.px)("fetchChatInviteImporters",{peer:r,offsetDate:o,offsetUser:d,limit:n,isRequested:!0});if(!c)return;const{importers:l}=c;e=(0,w.mS)(),e=(0,A.wix)(e,a,{joinRequests:l}),(0,w.UF)(e)}),(0,w.aJ)("hideChatJoinRequest",async(e,t,s)=>{const{chatId:a,userId:o,isApproved:i}=s,n=(0,C.hds)(e,a),r=(0,C.mBe)(e,o);if(!n||!r)return;if(!await(0,b.px)("hideChatJoinRequest",{peer:n,user:r,isApproved:i}))return;e=(0,w.mS)();const d=(0,C.hds)(e,a);d&&(e=(0,A.wix)(e,a,{joinRequests:d.joinRequests?.filter(e=>e.userId!==o)}),(0,w.UF)(e))}),(0,w.aJ)("hideAllChatJoinRequests",async(e,t,s)=>{const{chatId:a,isApproved:o,link:i}=s,n=(0,C.hds)(e,a);n&&await(0,b.px)("hideAllChatJoinRequests",{peer:n,isApproved:o,link:i})&&(e=(0,w.mS)(),(0,C.hds)(e,a)&&(e=(0,A.wix)(e,a,{joinRequests:[]}),e=(0,A.ltr)(e,a,{recentRequesterIds:[],requestsPending:0}),(0,w.UF)(e)))}),(0,w.aJ)("hidePeerSettingsBar",async(e,t,s)=>{const{peerId:a}=s,o=(0,C.mBe)(e,a);o&&await(0,b.px)("hidePeerSettingsBar",o)&&(e=(0,w.mS)(),e=(0,A.weB)(e,a,{settings:void 0}),(0,w.UF)(e))}),(0,w.aJ)("uploadContactProfilePhoto",async(e,t,s)=>{const{userId:a,file:o,isSuggest:i,tabId:r=(0,u.g0)()}=s,d=(0,C.mBe)(e,a);if(!d)return;if(e=(0,A.G42)(e,n.TD.InProgress,r),(0,w.UF)(e),!await(0,b.px)("uploadContactProfilePhoto",{user:d,file:o,isSuggest:i}))return e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.Error,r),void(0,w.UF)(e);e=(0,w.mS)(),(0,w.UF)(e);const{id:c,accessHash:l}=d;if(!await(0,b.px)("fetchFullUser",{id:c,accessHash:l}))return e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.Error,r),void(0,w.UF)(e);t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0}),e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.Complete,r),(0,w.UF)(e),o&&!i&&t.showNotification({message:g.yE("UserInfo.SetCustomPhoto.SuccessPhotoText",(0,y.u0)(d)),tabId:r})}),(0,w.aJ)("resetManagementError",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s||{};return(0,A.H6X)(e,a,{error:void 0},o)});var ke=s(37932),Fe=s(49763);let Te,Ue;function xe(e,t,s){const o=e.currentUserId,i=(0,y.cG)(t,s,o),n=i?String(s):t,r=(0,C.hds)(e,n);return(0,b.px)("fetchMessages",{chat:r,threadId:s,offsetId:i?void 0:r.lastReadInboxMessageId,addOffset:-(Math.round(a.yo2/2)+1),limit:a.yo2,isSavedDialog:i})}(0,w.aJ)("sync",(e,t)=>{a.Oig&&console.log(">>> START SYNC"),Te&&clearTimeout(Te),e=(0,w.mS)(),e={...e,isSyncing:!0},(0,w.UF)(e),Te=window.setTimeout(()=>{e=(0,w.mS)(),e={...e,isSyncing:!1},(0,w.UF)(e),Te=void 0},15e3);const{loadAllChats:s,preloadTopChatMessages:o}=t;(0,Fe.Ts)(),s({listType:"active",whenFirstBatchDone:async()=>{await async function(e,t){let s=!1;e=(0,w.mS)();let o=!1;const n=Object.keys(e.messages.byChatId).reduce((t,s)=>(t[s]=Object.keys(e.messages.byChatId[s].threadsById).reduce((t,a)=>(t[Number(a)]=(0,h.Oy)({draft:(0,C.GA4)(e,s,Number(a)),editingId:(0,C.Ys6)(e,s,Number(a)),editingDraft:(0,C.U0A)(e,s,Number(a))}),t),{}),t),{}),r=Object.entries(e.chats.lastMessageIds.all||{}).map(([t,s])=>(0,C.O5q)(e,t,Number(s))).filter(Boolean),d=Object.values(e.chats.lastMessageIds.saved||{}).map(t=>(0,C.O5q)(e,e.currentUserId,Number(t))).filter(Boolean);for(const{id:n}of Object.values(e.byTabId)){e=(0,w.mS)();const{chatId:r,threadId:d}=(0,C.Xf0)(e,n)||{},c=d||i.l3,l=r&&d?(0,C.Vw0)(e,r,d):void 0,u=r?e.chats.byId[r]:void 0;if(r&&u){const[t,d]=await Promise.all([xe(e,r,c),c===i.l3||(0,y.cG)(u.id,c,e.currentUserId)?void 0:(0,b.px)("fetchDiscussionMessage",{chat:u,messageId:Number(c)})]);e=(0,w.mS)();const{chatId:p}=(0,C.Xf0)(e,n)||{};if(t&&p===r){const n=(0,C.zeq)(e,r),u=r===a.zv8?e.serviceNotifications.filter(({isDeleted:e})=>!e).map(({message:e})=>e):[],p=(0,C.pSx)(e,r),m=p?Object.values(p).map(({lastMessageId:e})=>n[e]).filter(Boolean):[],f=t.messages.map(({id:e})=>e),g=(0,h.Up)(e.messages.byChatId[r].threadsById,f),I=((!t.messages.length||t.messages.some(({id:e})=>e===d?.firstMessageId))&&d?.topMessages||[]).concat(t.messages,u),v=I.concat(m),b=(0,h.dU)(v,"id"),y=(0,h.Am)(I.map(({id:e})=>e));o||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach(({id:t})=>{e=(0,M.w)(e,{tabThreads:{}},t)}),o=!0),e=(0,A.o4A)(e,r,b),e=(0,A.d4w)(e,r,c,y),Object.entries(g).forEach(([t,s])=>{s?.threadInfo&&(e=(0,A.eAk)(e,r,t,s.threadInfo))}),l&&!l.isCommentsInfo&&c!==i.l3&&(e=(0,A.eAk)(e,r,c,{...(0,h.Up)(l,["fromChannelId","fromMessageId"])})),Object.values(e.byTabId).forEach(({id:t})=>{const{chatId:s,threadId:a}=(0,C.Xf0)(e,t)||{};s===r&&a===c&&(e=(0,A.s3Z)(e,r,c,y,t))}),e=(0,A.h7P)(e,(0,h.dU)(t.chats,"id")),e=(0,A.CKT)(e,(0,h.dU)(t.users,"id")),s=!0}}(0,w.UF)(e),u?.isForum&&(t.loadTopics({chatId:r,force:!0}),d&&d!==i.l3&&t.loadTopicById({chatId:r,topicId:Number(d),shouldCloseChatOnError:!0}))}e=(0,w.mS)(),s||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach(({id:t})=>{e=(0,M.w)(e,{tabThreads:{}},t)})),Object.keys(n).forEach(t=>{const s=n[t];Object.keys(s).forEach(s=>{e=(0,A.e49)(e,t,Number(s),n[t][Number(s)])})}),e=(0,A.KcS)(e,r),e=(0,A.KcS)(e,d),(0,w.UF)(e),Object.values(e.byTabId).forEach(({id:s})=>{const{chatId:a,messageId:o}=(0,C.nTw)(e,s).audioPlayer;a&&o&&!(0,C.O5q)(e,a,o)&&t.closeAudioPlayer({tabId:s})})}(e,t),e=(0,w.mS)(),e={...e,isSyncing:!1,isSynced:!0,isFetchingDifference:!1},(0,w.UF)(e),a.Oig&&console.log(">>> FINISH SYNC"),s({listType:"archived"}),o()}})}),(0,ke.DW)(e=>{const{connectionState:t,authState:s,isSynced:a}=e,{isMasterTab:o}=(0,C.nTw)(e);!o||a||Ue?.connectionState===t&&Ue?.authState===s||"connectionStateReady"===t&&"authorizationStateReady"===s&&(0,w.ko)().sync(),Ue=e}),(0,w.aJ)("reportPeer",async(e,t,s)=>{const{chatId:a,reason:o,description:i,tabId:n=(0,u.g0)()}=s;if(!a)return;const r=(0,C.hds)(e,a);if(!r)return;const d=await(0,b.px)("reportPeer",{peer:r,reason:o,description:i});t.showNotification({message:d?(0,g.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:n})}),(0,w.aJ)("reportProfilePhoto",async(e,t,s)=>{const{chatId:a,reason:o,description:i,photo:n,tabId:r=(0,u.g0)()}=s;if(!a)return;const d=(0,C.hds)(e,a);if(!d||!n)return;const c=await(0,b.px)("reportProfilePhoto",{peer:d,photo:n,reason:o,description:i});t.showNotification({message:c?(0,g.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:r})}),(0,w.aJ)("loadAuthorizations",async e=>{const t=await(0,b.px)("fetchAuthorizations");t&&(e=(0,w.mS)(),e={...e,activeSessions:{byHash:t.authorizations,orderedHashes:Object.keys(t.authorizations),ttlDays:t.ttlDays}},(0,w.UF)(e))}),(0,w.aJ)("terminateAuthorization",async(e,t,s)=>{const{hash:a}=s;if(!await(0,b.px)("terminateAuthorization",a))return;e=(0,w.mS)();const{[a]:o,...i}=e.activeSessions.byHash;e={...e,activeSessions:{byHash:i,orderedHashes:e.activeSessions.orderedHashes.filter(e=>e!==a)}},(0,w.UF)(e)}),(0,w.aJ)("terminateAllAuthorizations",async e=>{if(!await(0,b.px)("terminateAllAuthorizations"))return;const t=(e=(0,w.mS)()).activeSessions.orderedHashes.find(t=>e.activeSessions.byHash[t].isCurrent);if(!t)return;const s=e.activeSessions.byHash[t];e={...e,activeSessions:{byHash:{[t]:s},orderedHashes:[t]}},(0,w.UF)(e)}),(0,w.aJ)("changeSessionSettings",async(e,t,s)=>{const{hash:a,areCallsEnabled:o,areSecretChatsEnabled:i,isConfirmed:n}=s;await(0,b.px)("changeSessionSettings",{hash:a,areCallsEnabled:o,areSecretChatsEnabled:i,isConfirmed:n})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,byHash:{...e.activeSessions.byHash,[a]:{...e.activeSessions.byHash[a],...void 0!==o?{areCallsEnabled:o}:void 0,...void 0!==i?{areSecretChatsEnabled:i}:void 0,...n&&{isUnconfirmed:void 0}}}}},(0,w.UF)(e))}),(0,w.aJ)("changeSessionTtl",async(e,t,s)=>{const{days:a}=s;await(0,b.px)("changeSessionTtl",{days:a})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,ttlDays:a}},(0,w.UF)(e))}),(0,w.aJ)("loadWebAuthorizations",async e=>{const t=await(0,b.px)("fetchWebAuthorizations");if(!t)return;const{webAuthorizations:s}=t;e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:s,orderedHashes:Object.keys(s)}},(0,w.UF)(e)}),(0,w.aJ)("terminateWebAuthorization",async(e,t,s)=>{const{hash:a}=s;if(!await(0,b.px)("terminateWebAuthorization",a))return;e=(0,w.mS)();const{[a]:o,...i}=e.activeWebSessions.byHash;e={...e,activeWebSessions:{byHash:i,orderedHashes:e.activeWebSessions.orderedHashes.filter(e=>e!==a)}},(0,w.UF)(e)}),(0,w.aJ)("terminateAllWebAuthorizations",async e=>{await(0,b.px)("terminateAllWebAuthorizations")&&(e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:{},orderedHashes:[]}},(0,w.UF)(e))}),(0,w.aJ)("loadAccountDaysTtl",async(e,t,s)=>{const a=await(0,b.px)("fetchAccountTTL");a&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:a.days}},(0,w.UF)(e))}),(0,w.aJ)("setAccountTTL",async(e,t,s)=>{const{days:a,tabId:o=(0,u.g0)()}=s||{};a&&await(0,b.px)("setAccountTTL",{days:a})&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:a}},(0,w.UF)(e),t.closeDeleteAccountModal({tabId:o}))});const Be=(0,I.nF)(e=>e(),500,!1);(0,w.aJ)("loadFullUser",async(e,t,s)=>{const{userId:a,withPhotos:o}=s,i=(0,C.mBe)(e,a);if(!i)return;const{id:n,accessHash:r}=i,d=await(0,b.px)("fetchFullUser",{id:n,accessHash:r});if(!d?.user)return;e=(0,w.mS)();const c=(0,C.vGo)(e,a),{user:l,fullInfo:u}=d,p=(0,C.IVq)(e,a),m=i.avatarPhotoId!==l.avatarPhotoId||c?.profilePhoto?.id!==u?.profilePhoto?.id||c?.fallbackPhoto?.id!==u?.fallbackPhoto?.id||c?.personalPhoto?.id!==u?.personalPhoto?.id;e=(0,A.TKu)(e,a,d.user),e=(0,A.weB)(e,a,d.fullInfo),e=(0,A.CKT)(e,(0,h.dU)(d.users,"id")),e=(0,A.h7P)(e,(0,h.dU)(d.chats,"id")),e=(0,A.d2X)(e,d.userStatusesById),(0,w.UF)(e),(o||p?.count&&m)&&t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0})}),(0,w.aJ)("loadUser",async(e,t,s)=>{const{userId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const i=await(0,b.px)("fetchUsers",{users:[o]});if(!i)return;const{users:n,userStatusesById:r}=i;e=(0,w.mS)(),e=(0,A.CKT)(e,(0,h.dU)(n,"id")),e=(0,A.wWy)(e,{...e.users.statusesById,...r}),(0,w.UF)(e)}),(0,w.aJ)("loadTopUsers",async e=>{const{topPeers:{lastRequestedAt:t}}=e;if(t&&!((0,v.Fm)()-t>60))return;const s=await(0,b.px)("fetchTopUsers");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topPeers:{...e.topPeers,userIds:a,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("loadContactList",async e=>{const t=await(0,b.px)("fetchContactList");if(!t)return;e=(0,w.mS)(),e=(0,A.d2X)(e,t.userStatusesById);const s=e=>e.lastName||e.firstName||"",a=new Intl.Collator("en-US"),o=t.users.sort((e,t)=>a.compare(s(e),s(t))).filter(e=>!e.isSelf);e={...e,contactList:{userIds:o.map(e=>e.id)}},(0,w.UF)(e)}),(0,w.aJ)("loadCurrentUser",()=>{(0,b.px)("fetchCurrentUser")}),(0,w.aJ)("loadCommonChats",async(e,t,s)=>{const{userId:a}=s;if((0,C.trm)(e))return;const o=(0,C.mBe)(e,a),i=(0,C.Ua4)(e,a);if(!o||(0,y.tv)(o)||i?.isFullyLoaded)return;const n=await(0,b.px)("fetchCommonChats",{user:o,maxId:i?.maxId});if(!n)return;const{chatIds:r,count:d}=n,c=(0,h.Am)((i?.ids||[]).concat(r));e=(0,w.mS)(),e=(0,A.lWl)(e,o.id,{maxId:r.length?r[r.length-1]:void 0,ids:c,isFullyLoaded:c.length>=d}),(0,w.UF)(e)}),(0,w.aJ)("toggleNoPaidMessagesException",async(e,t,s)=>{const{userId:a,shouldRefundCharged:o}=s,i=(0,C.mBe)(e,a);i&&await(0,b.px)("toggleNoPaidMessagesException",{user:i,shouldRefundCharged:o})&&(e=(0,w.mS)(),e=(0,A.weB)(e,a,{settings:void 0}),(0,w.UF)(e))}),(0,w.aJ)("openChatRefundModal",async(e,t,s)=>{const{userId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.mBe)(e,a);if(!i)return;const n=await(0,b.px)("fetchPaidMessagesRevenue",{user:i});void 0!==n&&(e=(0,w.mS)(),e=(0,M.w)(e,{chatRefundModal:{userId:a,starsToRefund:n}},o),(0,w.UF)(e))}),(0,w.aJ)("updateContact",async(e,t,s)=>{const{userId:a,firstName:o,lastName:i,shouldSharePhoneNumber:r,tabId:d=(0,u.g0)()}=s,c=(0,C.mBe)(e,a);if(!c)return;let l;if(e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.InProgress,d),(0,w.UF)(e),!c.isContact&&c.phoneNumber)l=await(0,b.px)("importContact",{phone:c.phoneNumber,firstName:o,lastName:i});else{const{id:e,accessHash:t}=c;l=await(0,b.px)("updateContact",{id:e,accessHash:t,phoneNumber:"",firstName:o,lastName:i,shouldSharePhoneNumber:r})}l&&(t.loadPeerSettings({peerId:a}),t.loadPeerStories({peerId:a}),e=(0,w.mS)(),e=(0,A.TKu)(e,c.id,{firstName:o,lastName:i}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.Complete,d),e=(0,A.BOn)(e,d),(0,w.UF)(e)}),(0,w.aJ)("deleteContact",async(e,t,s)=>{const{userId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const{id:i,accessHash:n}=o;await(0,b.px)("deleteContact",{id:i,accessHash:n})}),(0,w.aJ)("loadMoreProfilePhotos",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,shouldInvalidateCache:o,isPreload:i}=s,n=(0,k.L8)(a),r=n?(0,C.mBe)(e,a):void 0,d=n?void 0:(0,C.hds)(e,a),c=r||d;if(d&&(0,C._ls)(e,a))return;const l=(0,C.IVq)(e,a);if(!c?.avatarPhotoId)return;if(l&&!o&&(i||!l.nextOffset))return;e=(0,A.Tqk)(e,a,!0),(0,w.UF)(e),e=(0,w.mS)();let u=(0,C.vGo)(e,a),h=(0,C.AWZ)(e,a);if(r&&!u){const{id:e,accessHash:t}=r,s=await(0,b.px)("fetchFullUser",{id:e,accessHash:t});if(!s?.user)return;u=s.fullInfo}if(d&&!h){const e=await(0,b.px)("fetchFullChat",d);if(!e?.fullInfo)return;h=e.fullInfo}const p=u||h;if(!p)return;const m=l?.nextOffset,f=!m||i||o?10:void 0,g=await(0,b.px)("fetchProfilePhotos",{peer:c,offset:m,limit:f});if(!g||!g.photos)return;e=(0,w.mS)();const{photos:I,count:v,nextOffsetId:y}=g;e=(0,A.LZP)(e,a,{newPhotos:I,count:v,nextOffset:y,fullInfo:p,shouldInvalidateCache:o}),(0,w.UF)(e)}),(0,w.aJ)("setUserSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;a&&Be(async()=>{const t=await(0,b.px)("searchChats",{query:a});e=(0,w.mS)();const s=(0,C.nTw)(e,o).userSearch.query;if(!t||!s||a!==s)return e=(0,A.Z0S)(e,!1,o),void(0,w.UF)(e);const{accountResultIds:i,globalResultIds:n}=t,r=i.filter(k.L8),d=n.filter(k.L8);e=(0,A.Z0S)(e,!1,o),e=(0,A.BFh)(e,{localUserIds:r,globalUserIds:d},o),(0,w.UF)(e)})}),(0,w.aJ)("importContact",async(e,t,s)=>{const{phoneNumber:a,firstName:o,lastName:i,tabId:n=(0,u.g0)()}=s,r=await(0,b.px)("importContact",{phone:a,firstName:o,lastName:i});r?(t.openChat({id:r,tabId:n}),e=(0,w.mS)(),e=(0,A.BOn)(e,n),(0,w.UF)(e)):t.showNotification({message:g.yE("Contacts.PhoneNumber.NotRegistred"),tabId:n})}),(0,w.aJ)("reportSpam",(e,t,s)=>{const{chatId:a}=s,o=(0,C.PVB)(e,a);o&&(0,b.px)("reportSpam",o)}),(0,w.aJ)("setEmojiStatus",async(e,t,s)=>{const{emojiStatus:a,referrerWebAppKey:o,tabId:i=(0,u.g0)()}=s;if(!(0,C.g29)(e))return o&&t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}},tabId:i}),void t.openPremiumModal({initialSection:"emoji_status",tabId:i});const n=await(0,b.px)("updateEmojiStatus",a);if(o){if(!n)return void t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"SERVER_ERROR"}},tabId:i});t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_set"},tabId:i}),t.showNotification({message:{key:"BotSuggestedStatusUpdated"},customEmojiIconId:a.documentId,tabId:i})}}),(0,w.aJ)("saveCloseFriends",async(e,t,s)=>{const{userIds:a}=s;await(0,b.px)("saveCloseFriends",a)&&(e=(0,w.mS)(),e.contactList?.userIds.forEach(t=>{const{isCloseFriend:s}=e.users.byId[t]||{};s&&!a.includes(t)&&(e=(0,A.TKu)(e,t,{isCloseFriend:void 0}))}),a.forEach(t=>{e=(0,A.TKu)(e,t,{isCloseFriend:!0})}),(0,w.UF)(e))}),(0,w.aJ)("openSuggestedStatusModal",async(e,t,s)=>{const{customEmojiId:a,duration:o,botId:i,webAppKey:n,tabId:r=(0,u.g0)()}=s,d=await(0,b.px)("fetchCustomEmoji",{documentId:[a]});d?.[0]?(e=(0,w.mS)(),e=(0,M.w)(e,{suggestedStatusModal:{customEmojiId:a,duration:o,webAppKey:n,botId:i}},r),(0,w.UF)(e)):n&&t.sendWebAppEvent({webAppKey:n,event:{eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}},tabId:r})}),(0,w.aJ)("loadPeerSettings",async(e,t,s)=>{const{peerId:a}=s;if((0,C.trm)(e))return;if(!(0,C.vGo)(e,a))return void t.loadFullUser({userId:a});const o=(0,C.mBe)(e,a);if(!o)return;const i=await(0,b.px)("fetchPeerSettings",o);if(!i)return;const{settings:n}=i;e=(0,w.mS)(),e=(0,A.weB)(e,a,{settings:n}),(0,w.UF)(e)}),(0,w.aJ)("markBotVerificationInfoShown",(e,t,s)=>{const{peerId:o}=s,i=e.settings.botVerificationShownPeerIds,n=(0,h.Am)([o,...i]).slice(0,a.qLe);e={...e,settings:{...e.settings,botVerificationShownPeerIds:n}},(0,w.UF)(e)});var Re=s(33204),Je=s(59852),Ne=s(20179);function Ee(e,t,s,...[a=(0,u.g0)()]){const o=(0,C.nTw)(e,a);return(0,M.w)(e,{inlineBots:{...o.inlineBots,byUsername:{...o.inlineBots.byUsername,[t]:s}}},a)}function Le(e,t,...[s=(0,u.g0)()]){return(0,M.w)(e,{inlineBots:{...(0,C.nTw)(e,s).inlineBots,isLoading:t}},s)}function Oe(e,t,s,...[a=(0,u.g0)()]){const o=(0,C.nTw)(e,a),i=o.webApps.openedWebApps,n=i[t];if(!n)return e;const r={...n,...s},d=(0,Ne.rp)(r);return d?e=(0,M.w)(e,{webApps:{...o.webApps,openedWebApps:{...i,[d]:r}}},a):e}function De(e,t,s=!0,a=!0,...[o=(0,u.g0)()]){const i=(0,C.nTw)(e,o),n=(0,Ne.rp)(t);if(!n)return e;const r=[...i.webApps.openedOrderedKeys];r.includes(n)||r.push(n);const d=[...i.webApps.sessionKeys];d.includes(n)||d.push(n);const c=i.webApps.openedWebApps;return(0,M.w)(e,{webApps:{...i.webApps,...s&&{activeWebAppKey:n},isMoreAppsTabActive:!1,isModalOpen:a,modalState:"maximized",openedWebApps:{...c,[n]:t},openedOrderedKeys:r,sessionKeys:d}},o)}function Ye(e,t,s,...[a=(0,u.g0)()]){const o=(0,C.nTw)(e,a),{openedWebApps:i,openedOrderedKeys:n,activeWebAppKey:r}=o.webApps,d=i[t];if(!d)return e;if(!s&&d.shouldConfirmClosing)return Oe(e,t,{isCloseModalOpen:!0},a);const c={...i},l=(0,Ne.rp)(d);let h=n;l&&(delete c[l],h=n.filter(e=>e!==l));const p=r===(0,Ne.rp)(d),m=Object.keys(c),f=m.length;return(0,M.w)(e,{webApps:{...o.webApps,...p&&{activeWebAppKey:f?m[f-1]:void 0},openedWebApps:c,openedOrderedKeys:h,...!f&&{sessionKeys:[]}}},a)}function Ge(e,...[t=(0,u.g0)()]){return Object.keys((0,C.nTw)(e,t).webApps.openedWebApps).length>0}function Ve(e,t,...[s=(0,u.g0)()]){const a=(0,C.nTw)(e,s);return(0,M.w)(e,{webApps:{...a.webApps,isModalOpen:t}},s)}var je=s(30708);const qe=(0,I.sg)(e=>e(),500,!1);let We;function Ke(e,t,s,a,o){const i={botId:t,requestUrl:a,webAppName:o};if(function(e,t,s){const a=(0,C.nTw)(e,s).webApps.openedWebApps,o=(0,y.rp)(t);return!!o&&a[o]}(e,i,s)){const t=(0,y.rp)(i);return t&&(e=function(e,t,...[s=(0,u.g0)()]){const a=(0,C.nTw)(e,s);return a.webApps.openedWebApps[t]?e=(0,M.w)(e,{webApps:{...a.webApps,isMoreAppsTabActive:!1,activeWebAppKey:t,modalState:"maximized"}},s):e}(e,t,s),(0,w.UF)(e)),!0}return!1}function ze(e,t,s,a,...[o=(0,u.g0)()]){if("request"===a.type){e=(0,w.mS)();const t=(0,C.nTw)(e,o);if(!t.urlAuth)return;const{domain:s,bot:i,shouldRequestWriteAccess:n}=a;return e=(0,M.w)(e,{urlAuth:{...t.urlAuth,request:{domain:s,botId:i.id,shouldRequestWriteAccess:n}}},o),void(0,w.UF)(e)}const i="accepted"===a.type?a.url:s;window.open(i,"_blank","noopener"),t.closeUrlAuthModal({tabId:o})}async function He(e,t,s,a,o){await(0,b.px)("sendMessage",{chat:e,replyInfo:s,text:t,sendAs:a,lastMessageId:o})}async function _e(e,t,s,a,o,i,n=!1,...[r=(0,u.g0)()]){const{showDialog:d,showNotification:c,openUrl:l,openGame:h}=t,p=await(0,b.px)("answerCallbackButton",{chatId:s.id,accessHash:s.accessHash,messageId:a,data:i,isGame:n});if(!p)return;const{message:m,alert:f,url:g}=p;f?d({data:{message:m||"Error"},tabId:r}):m?c({message:m,tabId:r}):g&&(n?h({url:g,chatId:s.id,messageId:a,tabId:r}):l({url:g,tabId:r,linkContext:{type:"message",chatId:s.id,messageId:a,threadId:o}}))}(0,w.aJ)("clickSuggestedMessageButton",(e,t,s)=>{const{chatId:a,messageId:o,button:i,tabId:n=(0,u.g0)()}=s,{buttonType:r}=i,d=(0,C.O5q)(e,a,o);switch(r){case"suggestChanges":if(!d)break;t.initDraftFromSuggestedMessage({chatId:a,messageId:o,tabId:n})}}),(0,w.aJ)("clickBotInlineButton",(e,t,s)=>{const{chatId:a,messageId:o,threadId:i,button:n,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a),l=(0,C.O5q)(e,a,o);if(d&&l)switch(n.type){case"command":t.sendBotCommand({command:n.text,tabId:r});break;case"url":{const{url:e}=n;t.openUrl({url:e,tabId:r,linkContext:{type:"message",chatId:a,messageId:o,threadId:i}});break}case"copy":(0,c.eM)(n.copyText),t.showNotification({message:(0,g.yE)("ExactTextCopied",n.copyText),tabId:r});break;case"callback":_e(0,t,d,o,i,n.data,void 0,r);break;case"requestPoll":t.openPollModal({isQuiz:n.isQuiz,tabId:r});break;case"requestPhone":{const s=e.currentUserId?(0,C.mBe)(e,e.currentUserId):void 0;if(!s)return;t.showDialog({data:{phoneNumber:s.phoneNumber,firstName:s.firstName||"",lastName:s.lastName||"",userId:s.id},tabId:r});break}case"receipt":{const{receiptMessageId:e}=n;t.getReceipt({chatId:d.id,messageId:e,tabId:r});break}case"buy":t.openInvoice({type:"message",chatId:d.id,messageId:o,tabId:r});break;case"game":_e(0,t,d,o,i,void 0,!0,r);break;case"switchBotInline":{const{query:e,isSamePeer:s}=n;t.switchBotInline({query:e,isSamePeer:s,messageId:o,tabId:r});break}case"userProfile":{const{userId:e}=n;t.openChatWithInfo({id:e,tabId:r});break}case"simpleWebView":{const{url:s}=n,a=(0,C.Y7C)(e,l);if(!a)return;const o=(0,Je.A)();t.requestSimpleWebView({url:s,botId:a.id,theme:o,buttonText:n.text,tabId:r});break}case"webView":{const{url:s}=n,a=(0,C.Y7C)(e,l),o=l.viaBotId||a?.id;if(!o)return;const i=(0,Je.A)();t.requestWebView({url:s,botId:o,peerId:d.id,theme:i,buttonText:n.text,tabId:r});break}case"urlAuth":{const{url:e}=n;t.requestBotUrlAuth({chatId:d.id,messageId:o,buttonId:n.buttonId,url:e,tabId:r});break}}}),(0,w.aJ)("sendBotCommand",(e,t,s)=>{const{command:a,chatId:o,tabId:i=(0,u.g0)()}=s,n=o?(0,C.hds)(e,o):(0,C.meB)(e,i),r=(0,C.Xf0)(e,i);if(!n||!r)return;const{threadId:d}=r;t.resetDraftReplyInfo({tabId:i}),t.clearWebPagePreview({tabId:i});const c=(0,C.ZZX)(e,n.id);He(n,a,(0,C.GA4)(e,n.id,d)?.replyInfo,(0,C.VF$)(e,n.id),c)}),(0,w.aJ)("restartBot",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,{currentUserId:i}=e,n=(0,C.meB)(e,o),r=i&&(0,C.yps)(e,a);if(!i||!n||!r)return;const d=(0,C.ZZX)(e,n.id);await(0,b.px)("unblockUser",{user:r})&&(e=(0,w.mS)(),e=(0,A.OW3)(e,r.id),(0,w.UF)(e),He(n,"/start",void 0,(0,C.VF$)(e,a),d))}),(0,w.aJ)("loadTopInlineBots",async e=>{const{lastRequestedAt:t}=e.topInlineBots;if(t&&(0,v.Fm)()-t<60)return;const s=await(0,b.px)("fetchTopInlineBots");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topInlineBots:{...e.topInlineBots,userIds:a,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("loadTopBotApps",async e=>{const{lastRequestedAt:t}=e.topBotApps;if(t&&(0,v.Fm)()-t<60)return;const s=await(0,b.px)("fetchTopBotApps");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topBotApps:{...e.topBotApps,userIds:a,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("queryInlineBot",async(e,t,s)=>{const{chatId:a,username:o,query:i,offset:n,tabId:r=(0,u.g0)()}=s;let d=(0,C.nTw)(e,r).inlineBots.byUsername[o];if(!1!==d){if(void 0===d){const{user:t,chat:s}=await(0,b.px)("fetchInlineBot",{username:o})||{};if(e=(0,w.mS)(),!t||!s)return e=Ee(e,o,!1,r),void(0,w.UF)(e);d={id:t.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=Ee(e,o,d,r),(0,w.UF)(e)}(i!==d.query||d.canLoadMore)&&qe(()=>{!async function(e,{username:t,inlineBotData:s,chatId:a,query:o,offset:i},...[n=(0,u.g0)()]){e=(0,w.mS)();const r=(0,C.mBe)(e,s.id),d=(0,C.hds)(e,a);if(!r||!d)return;const c=s.query!==o;e=Ee(e=Le(e,!0,n),t,{...s,query:o,...c&&{offset:void 0,results:[]}},n),(0,w.UF)(e);const l=await(0,b.px)("fetchInlineBotResults",{bot:r,chat:d,query:o,offset:c?void 0:i});e=(0,w.mS)();const p=(0,C.nTw)(e,n).inlineBots.byUsername[t];if(e=Le(e,!1,n),!l||!p||o!==p.query)return void(0,w.UF)(e);const m=new Set((p.results||[]).map(e=>e.id)),f=l.results.filter(e=>!m.has(e.id));e=Ee(e,t,{...p,...(0,h.Up)(l,["help","switchPm","switchWebview"]),cacheTime:Date.now()+1e3*l.cacheTime,...f.length&&{isGallery:l.isGallery},canLoadMore:l.results.length>0&&Boolean(l.nextOffset),results:""===p.offset||p.offset===l.nextOffset?l.results:(p.results||[]).concat(f),offset:f.length?l.nextOffset:""},n),(0,w.UF)(e)}(e,{username:o,inlineBotData:d,chatId:a,query:i,offset:n},r)})}}),(0,w.aJ)("switchBotInline",(e,t,s)=>{const{query:a,isSamePeer:o,messageId:i,filter:n,tabId:r=(0,u.g0)()}=s;let{botId:d}=s;const c=(0,C.meB)(e,r);if(!c)return;if(!d&&i){const t=(0,C.O5q)(e,c.id,i);if(!t)return;const s=(0,C.Y7C)(e,t);d=t.viaBotId||s?.id}if(!d)return;const l=(0,C.mBe)(e,d);l&&t.openChatWithDraft({text:{text:`@${(0,y.Kl)(l)} ${a}`},chatId:o?c.id:void 0,filter:n,tabId:r})}),(0,w.aJ)("sendInlineBotApiResult",async(e,t,s)=>{const{chat:a,id:o,queryId:i,replyInfo:n,sendAs:r,isSilent:d,scheduledAt:c,allowPaidStars:l}=s;await(0,b.px)("sendInlineBotResult",{chat:a,resultId:o,queryId:i,replyInfo:n,sendAs:r,isSilent:d,scheduleDate:c,allowPaidStars:l}),l&&t.loadStarStatus()}),(0,w.aJ)("sendInlineBotResult",async(e,t,s)=>{const{id:a,queryId:o,isSilent:i,scheduledAt:n,threadId:r,chatId:d,tabId:c=(0,u.g0)()}=s;if(!a)return;const l=(0,C.hds)(e,d),h=(0,C.GA4)(e,d,r)?.replyInfo,p=(0,C.OEv)(e,d,r,h);t.resetDraftReplyInfo({tabId:c}),t.clearWebPagePreview({tabId:c});const g=await ie(e,d),I={chat:l,id:a,queryId:o,replyInfo:p,sendAs:(0,C.VF$)(e,d),isSilent:i,scheduledAt:n,allowPaidStars:g};g?(t.sendInlineBotApiResult({...I}),t.showNotification({localId:o,title:{key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}},message:{key:"MessageSentPaidToastText",variables:{amount:(0,f.Kk)((0,m.Yw)(),g)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage",tabId:c})):t.sendInlineBotApiResult(I)}),(0,w.aJ)("resetInlineBot",(e,t,s)=>{const{username:a,force:o,tabId:i=(0,u.g0)()}=s;let n=(0,C.nTw)(e,i).inlineBots.byUsername[a];n&&(!o&&Date.now()<n.cacheTime||(n={id:n.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=Ee(e,a,n,i),(0,w.UF)(e)))}),(0,w.aJ)("resetAllInlineBots",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).inlineBots.byUsername;Object.keys(o).forEach(e=>{t.resetInlineBot({username:e,tabId:a})})}),(0,w.aJ)("startBot",async(e,t,s)=>{const{botId:a,param:o}=s,i=(0,C.mBe)(e,a);if(!i)return;let n=(0,C.vGo)(e,a);if(!n){const e=await(0,b.px)("fetchFullUser",{id:i.id,accessHash:i.accessHash});n=e?.fullInfo}n?.isBlocked&&await(0,b.px)("unblockUser",{user:i}),await(0,b.px)("startBot",{bot:i,startParam:o})}),(0,w.aJ)("sharePhoneWithBot",async(e,t,s)=>{const{botId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;let i=(0,C.vGo)(e,a);if(!i){const e=await(0,b.px)("fetchFullUser",{id:o.id,accessHash:o.accessHash});i=e?.fullInfo}i?.isBlocked&&await(0,b.px)("unblockUser",{user:o}),e=(0,w.mS)();const n=(0,C.hds)(e,a),r=(0,C.mBe)(e,e.currentUserId);if(!n)return;const d=(0,C.ZZX)(e,n.id);await(0,b.px)("sendMessage",{chat:n,contact:{mediaType:"contact",firstName:r.firstName||"",lastName:r.lastName||"",phoneNumber:r.phoneNumber||"",userId:r.id},lastMessageId:d})}),(0,w.aJ)("requestSimpleWebView",async(e,t,s)=>{const{url:a,botId:o,theme:i,buttonText:n,isFromSideMenu:r,isFromSwitchWebView:d,startParam:c,tabId:l=(0,u.g0)()}=s;if(Ke(e,o,l,a))return;const h=(0,C.mBe)(e,o);if(!h)return;if(!(0,C.nTL)(e,o))return e=(0,M.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestSimpleWebView",payload:s}}},l),void(0,w.UF)(e);const p=await(0,b.px)("requestSimpleWebView",{url:a,bot:h,theme:i,startParam:c,isFromSideMenu:r,isFromSwitchWebView:d});p&&(e=De(e=(0,w.mS)(),{requestUrl:a,appName:h.firstName,url:p,botId:o,buttonText:n},!0,!0,l),(0,w.UF)(e))}),(0,w.aJ)("requestWebView",async(e,t,s)=>{const{url:a,botId:o,peerId:n,theme:r,isSilent:d,buttonText:c,isFromBotMenu:l,startParam:h,isFullscreen:p,tabId:m=(0,u.g0)()}=s;if(Ke(e,o,m,a))return;const f=(0,C.mBe)(e,o);if(!f)return;const g=(0,C.PVB)(e,n);if(!g)return;if(!(0,C.nTL)(e,o))return e=(0,M.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestWebView",payload:s}}},m),void(0,w.UF)(e);const I=(0,C.Xf0)(e,m),{chatId:v,threadId:y=i.l3}=I||{},S=v?(0,C.GA4)(e,v,y)?.replyInfo:void 0,A=v?(0,C.OEv)(e,v,y,S):void 0,P=v?(0,C.VF$)(e,v):void 0,k=await(0,b.px)("requestWebView",{url:a,bot:f,peer:g,theme:r,isSilent:d,replyInfo:A,isFromBotMenu:l,startParam:h,sendAs:P,isFullscreen:p});if(!k)return;const{url:F,queryId:T,isFullScreen:U}=k;e=De(e=(0,w.mS)(),{requestUrl:a,url:F,appName:f.firstName,botId:o,peerId:n,queryId:T,replyInfo:A,buttonText:c},!0,!0,m),(0,w.UF)(e),U&&(0,D.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:m})}),(0,w.aJ)("requestMainWebView",async(e,t,s)=>{const{botId:a,peerId:o,theme:i,startParam:n,mode:r,shouldMarkBotTrusted:d,tabId:c=(0,u.g0)()}=s;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:c});if(Ke(e,a,c))return;const l=(0,C.mBe)(e,a);if(!l)return;const h=(0,C.PVB)(e,o);if(!h)return;if(!(0,C.nTL)(e,a)){if(!d)return e=(0,M.w)(e,{botTrustRequest:{botId:a,type:"webApp",onConfirm:{action:"requestMainWebView",payload:s}}},c),void(0,w.UF)(e);t.markBotTrusted({botId:a,isWriteAllowed:!0,tabId:c})}const p=await(0,b.px)("requestMainWebView",{bot:l,peer:h,theme:i,startParam:n,mode:r});if(!p)return;const{url:m,queryId:f,isFullscreen:g}=p;e=De(e=(0,w.mS)(),{url:m,appName:l.firstName,botId:a,peerId:o,queryId:f,buttonText:""},!0,!0,c),(0,w.UF)(e),g&&(0,D.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:c})}),(0,w.aJ)("loadPreviewMedias",async(e,t,s)=>{const{botId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const i=await(0,b.px)("fetchPreviewMedias",{bot:o});e=(0,w.mS)(),i&&(e={...e,users:{...e.users,previewMediaByBotId:{...e.users.previewMediaByBotId,[a]:i}}},(0,w.UF)(e))}),(0,w.aJ)("openWebAppsCloseConfirmationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isWebAppsCloseConfirmationModalOpen:!0},a)}),(0,w.aJ)("closeWebAppsCloseConfirmationModal",(e,t,s)=>{const{shouldSkipInFuture:a,tabId:o=(0,u.g0)()}=s||{};return e=(0,A.qoo)(e,{shouldSkipWebAppCloseConfirmation:Boolean(a)}),(0,M.w)(e,{isWebAppsCloseConfirmationModalOpen:void 0},o)}),(0,w.aJ)("requestAppWebView",async(e,t,s)=>{const{botId:a,appName:o,startApp:i,mode:n,theme:r,isWriteAllowed:d,isFromConfirm:c,shouldSkipBotTrustRequest:l,tabId:h=(0,u.g0)()}=s;if(Ke(e,a,h,o))return;const p=(0,C.mBe)(e,a);if(!p)return;const m=Boolean(e.attachMenu.bots[p.id]);if(p.isAttachBot&&!c&&!m){const t=await(0,b.px)("loadAttachBot",{bot:p});if(t){e=(0,w.mS)();const a=t.bot;if(a.isDisclaimerNeeded||a.isForAttachMenu||a.isForSideMenu)return e=(0,M.w)(e,{requestedAttachBotInstall:{bot:a,onConfirm:{action:"requestAppWebView",payload:{...s,isFromConfirm:!0}}}},h),void(0,w.UF)(e)}}const f=await(0,b.px)("fetchBotApp",{bot:p,appName:o});if(e=(0,w.mS)(),!f)return void t.showNotification({message:(0,g.yE)("lng_username_app_not_found"),tabId:h});if(!l&&(f.isInactive||!(0,C.nTL)(e,a)))return s.shouldSkipBotTrustRequest=!0,e=(0,M.w)(e,{botTrustRequest:{botId:a,shouldRequestWriteAccess:f.shouldRequestWriteAccess,type:"botApp",onConfirm:{action:"requestAppWebView",payload:s}}},h),void(0,w.UF)(e);const I=(0,C.meB)(e,h),{url:v,isFullscreen:y}=await(0,b.px)("requestAppWebView",{peer:I||p,app:f,startParam:i,mode:n,isWriteAllowed:d,theme:r});if(e=(0,w.mS)(),!v)return;e=(0,w.mS)();const S=I?I.id:p.id;e=De(e,{url:v,appName:o&&p.firstName,peerId:S,botId:a,buttonText:""},!0,!0,h),(0,w.UF)(e),y&&(0,D.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:h})}),(0,w.aJ)("prolongWebView",async(e,t,s)=>{const{botId:a,peerId:o,isSilent:i,replyInfo:n,queryId:r,tabId:d=(0,u.g0)()}=s,c=(0,C.mBe)(e,a);if(!c)return;const l=(0,C.hds)(e,o);if(!l)return;const h=(0,C.VF$)(e,o);await(0,b.px)("prolongWebView",{bot:c,peer:l,isSilent:i,replyInfo:n,queryId:r,sendAs:h})||t.closeActiveWebApp({tabId:d})}),(0,w.aJ)("sendWebViewData",(e,t,s)=>{const{bot:a,data:o,buttonText:i}=s;(0,b.px)("sendWebViewData",{bot:a,data:o,buttonText:i})}),(0,w.aJ)("loadAttachBots",async e=>{await async function(e){const t=await(0,b.px)("loadAttachBots",{hash:void 0});if(t)return e=(0,w.mS)(),e={...e,attachMenu:{hash:t.hash,bots:t.bots}},(0,w.UF)(e),t}(e),(0,Re.A)({action:"loadAttachBots",payload:void 0},a.npx)}),(0,w.aJ)("toggleAttachBot",async(e,t,s)=>{const{botId:a,isWriteAllowed:o,isEnabled:i}=s,n=(0,C.mBe)(e,a);n&&await(0,b.px)("toggleAttachBot",{bot:n,isWriteAllowed:o,isEnabled:i})}),(0,w.aJ)("callAttachBot",(e,t,s)=>{const{bot:a,startParam:o,isFromConfirm:n,tabId:r=(0,u.g0)()}=s,d="isFromSideMenu"in s&&s.isFromSideMenu,c=!a,l=!c&&!e.attachMenu.bots[a.id]||a?.isInactive||a?.isDisclaimerNeeded;if(!n&&l)return(0,M.w)(e,{requestedAttachBotInstall:{bot:a,onConfirm:{action:"callAttachBot",payload:{...s,isFromConfirm:!0}}}},r);const h=(0,Je.A)();if(d&&t.requestSimpleWebView({botId:a.id,buttonText:"",isFromSideMenu:!0,startParam:o,theme:h,tabId:r}),"chatId"in s){const{chatId:e,threadId:n=i.l3,url:d}=s;t.openThread({chatId:e,threadId:n,tabId:r}),t.requestWebView({url:d,peerId:e,botId:c?e:a.id,theme:h,buttonText:"",isFromBotMenu:c,startParam:o,tabId:r})}}),(0,w.aJ)("confirmAttachBotInstall",async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,{requestedAttachBotInstall:i}=(0,C.nTw)(e,o),{bot:n,onConfirm:r}=i;e=(0,M.w)(e,{requestedAttachBotInstall:void 0},o),(0,w.UF)(e);const d=(0,C.mBe)(e,n.id);if(d&&(t.markBotTrusted({botId:n.id,isWriteAllowed:a,tabId:o}),await(0,b.px)("toggleAttachBot",{bot:d,isWriteAllowed:a,isEnabled:!0}),r)){const{action:e,payload:s}=r;t[e](s)}}),(0,w.aJ)("requestBotUrlAuth",async(e,t,s)=>{const{chatId:a,buttonId:o,messageId:i,url:n,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a);if(!d)return;const c=await(0,b.px)("requestBotUrlAuth",{chat:d,buttonId:o,messageId:i});c&&(e=(0,w.mS)(),e=(0,M.w)(e,{urlAuth:{url:n,button:{buttonId:o,messageId:i,chatId:d.id}}},r),(0,w.UF)(e),ze(e,t,n,c,r))}),(0,w.aJ)("acceptBotUrlAuth",async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);if(!i.urlAuth?.button)return;const{button:n,url:r}=i.urlAuth,{chatId:d,messageId:c,buttonId:l}=n,h=(0,C.hds)(e,d);if(!h)return;const p=await(0,b.px)("acceptBotUrlAuth",{chat:h,messageId:c,buttonId:l,isWriteAllowed:a});p&&ze(e=(0,w.mS)(),t,r,p,o)}),(0,w.aJ)("requestLinkUrlAuth",async(e,t,s)=>{const{url:a,tabId:o=(0,u.g0)()}=s,i=await(0,b.px)("requestLinkUrlAuth",{url:a});i&&(e=(0,w.mS)(),e=(0,M.w)(e,{urlAuth:{url:a}},o),(0,w.UF)(e),ze(e,t,a,i,o))}),(0,w.aJ)("acceptLinkUrlAuth",async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);if(!i.urlAuth?.url)return;const{url:n}=i.urlAuth,r=await(0,b.px)("acceptLinkUrlAuth",{url:n,isWriteAllowed:a});r&&ze(e=(0,w.mS)(),t,n,r,o)}),(0,w.aJ)("closeUrlAuthModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{urlAuth:void 0},a)}),(0,w.aJ)("setBotInfo",async(e,t,s)=>{const{bot:a,name:o,description:i,tabId:r=(0,u.g0)()}=s;let{langCode:d}=s;d||(d=(0,je.l)(e).language);const{currentUserId:c}=e;c&&a&&(e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.InProgress,r),(0,w.UF)(e),(o||i)&&await(0,b.px)("setBotInfo",{bot:a,langCode:d,name:o,about:i})&&(e=(0,w.mS)(),e=(0,A.TKu)(e,a.id,{firstName:o}),e=(0,A.weB)(e,a.id,{bio:i}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,A.G42)(e,n.TD.Complete,r),(0,w.UF)(e))}),(0,w.aJ)("toggleUserEmojiStatusPermission",async(e,t,s)=>{const{botId:a,isEnabled:o,isBotAccessEmojiGranted:i}=s,n=(0,C.yps)(e,a);a&&n&&await(0,b.px)("toggleUserEmojiStatusPermission",{bot:n,isEnabled:o})&&(e=(0,w.mS)(),e=(0,A.weB)(e,a,{isBotCanManageEmojiStatus:o,isBotAccessEmojiGranted:i}),(0,w.UF)(e))}),(0,w.aJ)("toggleUserLocationPermission",(e,t,s)=>{const{botId:a,isAccessGranted:o}=s,i=(0,C.mBe)(e,a);i&&(e=(0,w.mS)(),e=(0,A.cxc)(e,i.id,{geolocation:o}),(0,w.UF)(e))}),(0,w.aJ)("startBotFatherConversation",async(e,t,s)=>{const{param:i,tabId:n=(0,u.g0)()}=s;if(!We){const t=await(0,o.A$)(e,a.aFH);if(!t)return;We=t.id}i&&t.startBot({botId:We,param:i}),t.openChat({id:We,tabId:n})}),(0,w.aJ)("loadBotFreezeAppeal",async e=>{const t=e.appConfig.freezeAppealUrl;if(!t)return;const s=t?(0,l.l8)(t):void 0;if(!s)return;const a=await(0,o.A$)(e,s);e=(0,w.mS)(),e={...e,botFreezeAppealId:a?.id},(0,w.UF)(e)}),s(26943),(0,w.aJ)("loadPasswordInfo",async e=>{const t=await(0,b.px)("getPasswordInfo");t&&(e=(0,w.mS)(),e=(0,A.qpc)(e,{hasPassword:t.hasPassword}),e=(0,A.keG)(e,{hint:t.hint}),(0,w.UF)(e))}),(0,w.aJ)("checkPassword",async(e,t,s)=>{const{currentPassword:a,onSuccess:o}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const i=await(0,b.px)("checkPassword",a);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),i&&o()}),(0,w.aJ)("clearPassword",async(e,t,s)=>{const{currentPassword:a,onSuccess:o}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const i=await(0,b.px)("clearPassword",a);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),i&&o()}),(0,w.aJ)("updatePassword",async(e,t,s)=>{const{currentPassword:a,password:o,hint:i,email:n,onSuccess:r}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const d=await(0,b.px)("updatePassword",a,o,i,n);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),d&&r()}),(0,w.aJ)("updateRecoveryEmail",async(e,t,s)=>{const{currentPassword:a,email:o,onSuccess:i,tabId:n=(0,u.g0)()}=s;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),e=(0,M.w)(e,{recoveryEmail:o},n),(0,w.UF)(e);const r=await(0,b.px)("updateRecoveryEmail",a,o);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1,waitingEmailCodeLength:void 0}),e=(0,M.w)(e,{recoveryEmail:void 0},n),(0,w.UF)(e),r&&i()}),(0,w.aJ)("provideTwoFaEmailCode",(e,t,s)=>{const{code:a}=s;(0,b.px)("provideRecoveryEmailCode",a)}),(0,w.aJ)("clearTwoFaError",e=>(0,A.keG)(e,{errorKey:void 0}));const $e={missing_payment_information:{field:"cardNumber",message:"Incorrect card number"},invalid_number:{field:"cardNumber",message:"Incorrect card number"},number:{field:"cardNumber",message:"Incorrect card number"},exp_year:{field:"expiry",message:"Incorrect year"},exp_month:{field:"expiry",message:"Incorrect month"},invalid_expiry_year:{field:"expiry",message:"Incorrect year"},invalid_expiry_month:{field:"expiry",message:"Incorrect month"},cvc:{field:"cvv",message:"Incorrect CVV"},invalid_cvc:{field:"cvv",message:"Incorrect CVV"}};var Xe=s(86046);async function Qe(e,t,s,...[o=(0,u.g0)()]){const i=(0,w.ko)(),n="stargiftResale"===t.type&&t.currency===a.ykW,r=n?e.ton?.balance:e.stars?.balance,d=n?a.ykW:a.OUy;if(void 0===r)return;if(r.amount<s)return void i.openStarsBalanceModal({currency:d,tabId:o});const c=(0,Xe.jA)(e,t);if(!c)return;e=(0,M.w)(e,{isPaymentFormLoading:!0},o),(0,w.UF)(e);const l=(0,Je.A)(),h=await(0,b.px)("getPaymentForm",c,l);if(!h)return;if(e=(0,w.mS)(),e=(0,M.w)(e,{isPaymentFormLoading:!1},o),(0,w.UF)(e),"error"in h)return void Ze(h.error,o);const p=h.invoice.totalAmount;p===s?i.sendStarPaymentForm({directInfo:{inputInvoice:t,formId:h.formId},tabId:o}):i.openPriceConfirmModal({originalAmount:s,newAmount:p,currency:d,directInfo:{inputInvoice:t,formId:h.formId},tabId:o})}function Ze(e,t){"SLUG_INVALID"!==e?(0,w.ko)().showDialog({data:{message:e,hasErrorKey:!0},tabId:t}):(0,w.ko)().showNotification({message:{key:"PaymentInvoiceNotFound"},tabId:t})}(0,w.aJ)("validateRequestedInfo",(e,t,s)=>{const{requestInfo:a,saveInfo:o,tabId:i=(0,u.g0)()}=s,r=(0,C.aF2)(e,i);if(!r)return;const d=(0,Xe.jA)(e,r);d&&async function(e,t,s,a,...[o=(0,u.g0)()]){const i=await(0,b.px)("validateRequestedInfo",{inputInvoice:t,requestInfo:s,shouldSave:a});if(!i)return;const{id:r,shippingOptions:d}=i;e=(0,w.mS)(),e=(0,A.bbG)(e,r,o),d?.length?(e=(0,A.oFy)(e,d,o),e=(0,A.lwH)(e,n.tn.Shipping,o)):e=(0,A.lwH)(e,n.tn.Checkout,o),(0,w.UF)(e)}(e,d,a,o,i)}),(0,w.aJ)("openInvoice",async(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,i=(0,Xe.jA)(e,o);if(!i)return;e=(0,M.w)(e,{isPaymentFormLoading:!0},a),(0,w.UF)(e);const r=(0,Je.A)(),d=await(0,b.px)("getPaymentForm",i,r);if(d){if(e=(0,w.mS)(),e=(0,M.w)(e,{isPaymentFormLoading:!1},a),"error"in d)return(0,w.UF)(e),void Ze(d.error,a);"regular"===d.type&&(e=(0,A._$X)(e,{inputInvoice:s,form:d,isPaymentModalOpen:!0,isExtendedMedia:s.isExtendedMedia,status:void 0},a),e=(0,A.lwH)(e,n.tn.Checkout,a)),"stars"===d.type&&(e=(0,M.w)(e,{starsPayment:{inputInvoice:o,form:d,status:"pending"}},a)),(0,w.UF)(e)}}),(0,w.aJ)("sendStarGift",(e,t,s)=>{const{gift:a,peerId:o,message:i,shouldHideName:n,shouldUpgrade:r,tabId:d=(0,u.g0)()}=s;Qe(e,{type:"stargift",peerId:o,giftId:a.id,message:i,shouldHideName:n,shouldUpgrade:r||void 0},a.stars,d)}),(0,w.aJ)("buyStarGift",(e,t,s)=>{const{slug:a,peerId:o,price:i,tabId:n=(0,u.g0)()}=s;Qe(e,{type:"stargiftResale",slug:a,peerId:o,currency:i.currency},i.amount,n)}),(0,w.aJ)("sendPremiumGiftByStars",(e,t,s)=>{const{userId:a,months:o,amount:i,message:n,tabId:r=(0,u.g0)()}=s;Qe(e,{type:"premiumGiftStars",userId:a,months:o,message:n},i,r)}),(0,w.aJ)("getReceipt",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=a&&(0,C.hds)(e,a);if(!o||!n)return;const r=await(0,b.px)("getReceipt",n,o);r&&(e=(0,w.mS)(),e="stars"===r.receipt.type?(0,A.MeL)(e,r.receipt,i):(0,A.lEm)(e,r.receipt,i),(0,w.UF)(e))}),(0,w.aJ)("clearPaymentError",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,a).payment,error:void 0}},a),(0,w.UF)(e)}),(0,w.aJ)("clearReceipt",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{payment:{...(0,C.nTw)(e,a).payment,receipt:void 0}},a)}),(0,w.aJ)("sendCredentialsInfo",(e,t,s)=>{const{credentials:o,tabId:i=(0,u.g0)()}=s,{nativeProvider:r}=(0,C.nTw)(e,i).payment.form,{data:d}=o;if("stripe"===r){const t=(0,C.EGt)(e,i);if(!t)return;!async function(e,t,s,...[a=(0,u.g0)()]){const o=function(e){const t=Object.keys(e).map(t=>`${t}=${e[t]}`).join("&");return t.length>0?`?${t}`:""}({"card[number]":t.cardNumber,"card[exp_month]":t.expiryMonth,"card[exp_year]":t.expiryYear,"card[cvc]":t.cvv,"card[address_zip]":t.zip,"card[address_country]":t.country}),i=await fetch(`https://api.stripe.com/v1/tokens${o}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${s}`}}),r=await i.json();if(r.error){const t=function(e){const{message:t,code:s,param:a}=e,{field:o,message:i}=a?$e[a]:$e[s];return{field:o,message:i,description:t}}(r.error);return e=(0,w.mS)(),e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,a).payment,status:"failed",error:{...t}}},a),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,A.yQW)(e,{type:r.type,id:r.id},a),e=(0,A.lwH)(e,n.tn.Checkout,a),(0,w.UF)(e)}(e,d,t,i)}else if("smartglocal"===r){const t=(0,C.Kt9)(e,i);if(!t)return;!async function(e,t,s,...[o=(0,u.g0)()]){const i={card:{number:t.cardNumber.replace(/\D+/g,""),expiration_month:t.expiryMonth,expiration_year:t.expiryYear,security_code:t.cvv.replace(/\D+/g,"")}},r=(0,C.nTw)(e,o).payment.form?.nativeParams.tokenizeUrl;let d;d=a.qKY?"https://tgb-playground.smart-glocal.com/cds/v1/tokenize/card":"https://tgb.smart-glocal.com/cds/v1/tokenize/card",r?.startsWith("https://")&&r.endsWith(".smart-glocal.com/cds/v1/tokenize/card")&&(d=r);const c=await fetch(d,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-PUBLIC-TOKEN":s},body:JSON.stringify(i)}),l=await c.json();if("ok"!==l.status){const t={descriptionKey:{key:"ErrorUnexpected"}};return e=(0,w.mS)(),e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:{...t}}},o),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,A.Mac)(e,{type:"card",token:l.data.token},o),e=(0,A.lwH)(e,n.tn.Checkout,o),(0,w.UF)(e)}(e,d,t,i)}}),(0,w.aJ)("sendPaymentForm",async(e,t,s)=>{const{shippingOptionId:a,saveCredentials:o,savedCredentialId:i,tipAmount:n,tabId:r=(0,u.g0)()}=s,d=(0,C.PGw)(e,r),c=(0,C.nTw)(e,r).payment,{form:l,temporaryPassword:h,inputInvoice:p}=c;if(!p||!l)return;const{nativeProvider:m,formId:f}=l,g=(0,Xe.jA)(e,p);if(!g)return;e=(0,A._$X)(e,{status:"pending"},r),(0,w.UF)(e);const I={save:o,data:"stripe"===m?(0,C.e7$)(e,r):(0,C.G4m)(e,r)};await(0,b.px)("sendPaymentForm",{inputInvoice:g,formId:f,credentials:I,requestedInfoId:d,shippingOptionId:a,savedCredentialId:i,temporaryPassword:h?.value,tipAmount:n})&&(e=(0,w.mS)(),e=(0,A._$X)(e,{status:"paid"},r),e=(0,A.cYc)(e,r),(0,w.UF)(e),t.apiUpdate({"@type":"updatePaymentStateCompleted",paymentState:c,tabId:r}))}),(0,w.aJ)("sendStarPaymentForm",async(e,t,s)=>{const{directInfo:a,tabId:o=(0,u.g0)()}=s,i=(0,C.Osl)(e,o),n=i?.inputInvoice||a?.inputInvoice;if(!n)return;const r=(0,Xe.jA)(e,n);if(!r)return;const d=i.form?.formId||i.subscriptionInfo?.subscriptionFormId||a?.formId;e=(0,A.nv6)(e,{status:"pending"},o),(0,w.UF)(e);const c=await(0,b.px)("sendStarPaymentForm",{inputInvoice:r,formId:d});if(!c)return e=(0,w.mS)(),e=(0,A.nv6)(e,{status:"failed"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),void t.closeGiftModal({tabId:o});e=(0,w.mS)(),e=(0,A.nv6)(e,{status:"paid"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),"channelId"in c&&t.openChat({id:c.channelId,tabId:o}),t.apiUpdate({"@type":"updateStarPaymentStateCompleted",paymentState:a?{inputInvoice:n}:i,tabId:o}),t.loadStarStatus()}),(0,w.aJ)("setSmartGlocalCardInfo",(e,t,s)=>{const{tabId:a=(0,u.g0)(),type:o,token:i}=s;return(0,A.Mac)(e,{type:o,token:i},a)}),(0,w.aJ)("setPaymentStep",(e,t,s)=>{const{step:a,tabId:o=(0,u.g0)()}=s;return(0,A.lwH)(e,a??n.tn.Checkout,o)}),(0,w.aJ)("closePremiumModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(o.premiumModal)return(0,M.w)(e,{premiumModal:{promo:o.premiumModal.promo,isOpen:!1}},a)}),(0,w.aJ)("openPremiumModal",async(e,t,s)=>{const{initialSection:a,fromUserId:o,isSuccess:i,isGift:n,monthsAmount:r,toUserId:d,gift:c,tabId:l=(0,u.g0)()}=s||{};t.loadPremiumStickers();const h=await(0,b.px)("fetchPremiumPromo");h&&(e=(0,w.mS)(),e=(0,M.w)(e,{premiumModal:{promo:h.promo,initialSection:a,isOpen:!0,fromUserId:o,toUserId:d,isGift:n,monthsAmount:r,isSuccess:i,gift:c}},l),(0,w.UF)(e),t.closeReactionPicker({tabId:l}))}),(0,w.aJ)("openGiveawayModal",async(e,t,s)=>{const{chatId:a,prepaidGiveaway:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;const r=await(0,b.px)("getPremiumGiftCodeOptions",{chat:n}),d=await(0,b.px)("fetchStarsGiveawayOptions");r&&d&&(e=(0,w.mS)(),e=(0,M.w)(e,{giveawayModal:{chatId:a,gifts:r,isOpen:!0,prepaidGiveaway:o,starOptions:d}},i),(0,w.UF)(e))}),(0,w.aJ)("checkCanSendGift",async(e,t,s)=>{const{gift:a,onSuccess:o,tabId:i=(0,u.g0)()}=s;if("starGift"!==a.type||!a.lockedUntilDate)return void o();const n=await(0,b.px)("fetchCheckCanSendGift",{giftId:a.id});n&&(n?.canSend?o():t.openLockedGiftModalInfo({untilDate:"starGift"===a.type?a.lockedUntilDate:void 0,reason:n.reason,tabId:i}))}),(0,w.aJ)("openGiftModal",async(e,t,s)=>{const{forUserId:a,selectedResaleGift:o,tabId:i=(0,u.g0)()}=s;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:i});const n=await(0,b.px)("getPremiumGiftCodeOptions",{});n&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftModal:{forPeerId:a,gifts:n,selectedResaleGift:o}},i),(0,w.UF)(e))}),(0,w.aJ)("openStarsGiftModal",async(e,t,s)=>{const{forUserId:a,tabId:o=(0,u.g0)()}=s||{};if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:o});const i=a?(0,C.hds)(e,a):void 0;if(a&&!i)return;const n=await(0,b.px)("fetchStarsGiftOptions",{chat:i});e=(0,w.mS)(),e=(0,M.w)(e,{starsGiftModal:{isOpen:!0,forUserId:a,starsGiftOptions:n}},o),(0,w.UF)(e)}),(0,w.aJ)("validatePaymentPassword",async(e,t,s)=>{const{password:a,tabId:o=(0,u.g0)()}=s,i=await(0,b.px)("fetchTemporaryPaymentPassword",a);e=(0,w.mS)(),e=i?"error"in i?(0,A._$X)(e,{error:{messageKey:i.messageKey,field:"password"}},o):(0,A._$X)(e,{temporaryPassword:i,step:n.tn.Checkout},o):(0,A._$X)(e,{error:{messageKey:{key:"ErrorUnexpected"},field:"password"}},o),(0,w.UF)(e)}),(0,w.aJ)("openBoostModal",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i||!(0,y.WX)(i)&&!(0,y.Vs)(i))return;e=(0,M.w)(e,{boostModal:{chatId:a}},o),(0,w.UF)(e);const n=await(0,b.px)("fetchBoostStatus",{chat:i});if(!n)return void t.closeBoostModal({tabId:o});e=(0,w.mS)(),e=(0,M.w)(e,{boostModal:{chatId:a,boostStatus:n}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchMyBoosts");if(!r)return;e=(0,w.mS)();const d=(0,C.nTw)(e,o);d.boostModal&&(e=(0,M.w)(e,{boostModal:{...d.boostModal,myBoosts:r.boosts}},o),(0,w.UF)(e))}),(0,w.aJ)("openBoostStatistics",async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;e=(0,M.w)(e,{boostStatistics:{chatId:a}},o),(0,w.UF)(e);const[n,r,d]=await Promise.all([(0,b.px)("fetchBoostList",{chat:i}),(0,b.px)("fetchBoostList",{chat:i,isGifts:!0}),(0,b.px)("fetchBoostStatus",{chat:i})]);if(e=(0,w.mS)(),!n||!r||!d)return e=(0,M.w)(e,{boostStatistics:void 0},o),void(0,w.UF)(e);e=(0,M.w)(e,{boostStatistics:{chatId:a,boostStatus:d,nextOffset:n.nextOffset,boosts:{count:n.count,list:n.boostList},giftedBoosts:{count:r?.count,list:r?.boostList}}},o),(0,w.UF)(e)}),(0,w.aJ)("openMonetizationStatistics",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;(0,C.hds)(e,a)&&(e=(0,M.w)(e,{monetizationStatistics:{chatId:a}},o),(0,w.UF)(e))}),(0,w.aJ)("loadMoreBoosters",async(e,t,s)=>{const{isGifts:a,tabId:o=(0,u.g0)()}=s||{};let i=(0,C.nTw)(e,o);if(!i.boostStatistics)return;const n=(0,C.hds)(e,i.boostStatistics.chatId);if(!n)return;e=(0,M.w)(e,{boostStatistics:{...i.boostStatistics,isLoadingBoosters:!0}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchBoostList",{chat:n,offset:i.boostStatistics.nextOffset,isGifts:a});if(!r)return;if(e=(0,w.mS)(),i=(0,C.nTw)(e,o),!i.boostStatistics)return;const d=(a?i.boostStatistics.giftedBoosts?.list||[]:i.boostStatistics.boosts?.list||[]).concat(r.boostList);e=(0,M.w)(e,{boostStatistics:{...i.boostStatistics,nextOffset:r.nextOffset,isLoadingBoosters:!1,[a?"giftedBoosts":"boosts"]:{count:r.count,list:d}}},o),(0,w.UF)(e)}),(0,w.aJ)("applyBoost",async(e,t,s)=>{const{chatId:a,slots:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;const r=(0,C.AWZ)(e,a),d=r?.boostsApplied||0,c=o.length;let l=(0,C.nTw)(e,i);const h=l.boostModal?.boostStatus;if(h){const t=h.nextLevelBoosts?h.nextLevelBoosts-h.currentLevelBoosts:1,s=h.boosts+c,a=h.nextLevelBoosts&&s>=h.nextLevelBoosts,o=a?h.nextLevelBoosts:h.currentLevelBoosts,n=a?h.nextLevelBoosts+t:h.nextLevelBoosts;e=(0,M.w)(e,{boostModal:{...l.boostModal,boostStatus:{...h,level:a?h.level+1:h.level,currentLevelBoosts:o,nextLevelBoosts:n,hasMyBoost:!0,boosts:s}}},i),(0,w.UF)(e)}e=(0,w.mS)(),l=(0,C.nTw)(e,i);const p=l.boostModal?.myBoosts;if(p){const t=(0,v.Fm)(),s=p.map(e=>o.includes(e.slot)?{...e,chatId:a,date:t,cooldownUntil:t+86400}:e);e=(0,M.w)(e,{boostModal:{...l.boostModal,myBoosts:s}},i),(0,w.UF)(e)}const m=await(0,b.px)("applyBoost",{slots:o,chat:n});if(e=(0,w.mS)(),m)l=(0,C.nTw)(e,i),r&&(e=(0,A.ltr)(e,a,{boostsApplied:d+o.length})),l.boostModal&&(e=(0,M.w)(e,{boostModal:{...l.boostModal,myBoosts:m.boosts}},i)),(0,w.UF)(e);else{const t=(0,C.nTw)(e,i).boostModal;t&&(e=(0,M.w)(e,{boostModal:{...t,boostStatus:h,myBoosts:p}},i),(0,w.UF)(e))}}),(0,w.aJ)("checkGiftCode",async(e,t,s)=>{const{slug:a,message:o,tabId:i=(0,u.g0)()}=s,n=await(0,b.px)("checkGiftCode",{slug:a});n?(e=(0,w.mS)(),e=(0,M.w)(e,{giftCodeModal:{slug:a,info:n.code,message:o}},i),(0,w.UF)(e)):t.showNotification({message:g.yE("lng_gift_link_expired"),tabId:i})}),(0,w.aJ)("applyGiftCode",async(e,t,s)=>{const{slug:a,tabId:o=(0,u.g0)()}=s;await(0,b.px)("applyGiftCode",{slug:a})&&(t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftCodeModal({tabId:o}))}),(0,w.aJ)("launchPrepaidGiveaway",async(e,t,s)=>{const{chatId:a,giveawayId:o,paymentPurpose:i,tabId:n=(0,u.g0)()}=s,r=(0,C.hds)(e,a);if(!r)return;const d=i?.additionalChannelIds?.map(t=>(0,C.hds)(e,t)).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"giveaway",chat:r,areWinnersVisible:i?.areWinnersVisible,additionalChannels:d,countries:i?.countries,prizeDescription:i.prizeDescription,untilDate:i.untilDate,currency:i.currency,amount:i.amount}})&&t.openBoostStatistics({chatId:a,tabId:n})}),(0,w.aJ)("launchPrepaidStarsGiveaway",async(e,t,s)=>{const{chatId:a,giveawayId:o,paymentPurpose:i,tabId:n=(0,u.g0)()}=s,r=(0,C.hds)(e,a);if(!r)return;const d=i?.additionalChannelIds?.map(t=>(0,C.hds)(e,t)).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"starsgiveaway",chat:r,areWinnersVisible:i?.areWinnersVisible,additionalChannels:d,countries:i?.countries,prizeDescription:i.prizeDescription,untilDate:i.untilDate,currency:i.currency,amount:i.amount,stars:i.stars,users:i.users}})&&t.openBoostStatistics({chatId:a,tabId:n})}),(0,w.aJ)("upgradeGift",async(e,t,s)=>{const{gift:a,shouldKeepOriginalDetails:o,upgradeStars:i,tabId:n=(0,u.g0)()}=s,r=(0,Xe.HT)(e,a);if(r){if(e=(0,M.w)(e,{isWaitingForStarGiftUpgrade:!0},n),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftUpgradeModal({tabId:n}),t.closeGiftInfoModal({tabId:n}),!i){const s=await(0,b.px)("upgradeStarGift",{inputSavedGift:r,shouldKeepOriginalDetails:o||void 0});return e=(0,w.mS)(),void(s&&e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId}))}Qe(e,{type:"stargiftUpgrade",inputSavedGift:a,shouldKeepOriginalDetails:o||void 0},i,n)}}),(0,w.aJ)("transferGift",(e,t,s)=>{const{gift:a,recipientId:o,transferStars:i,tabId:n=(0,u.g0)()}=s,r=(0,C.hds)(e,o),d=(0,Xe.HT)(e,a);r&&d&&(e=(0,M.w)(e,{isWaitingForStarGiftTransfer:!0},n),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftTransferModal({tabId:n}),t.closeGiftInfoModal({tabId:n}),i?Qe(e,{type:"stargiftTransfer",inputSavedGift:a,recipientId:o},i,n):(0,b.px)("transferStarGift",{inputSavedGift:d,toPeer:r}))}),(0,w.aJ)("openUniqueGiftBySlug",async(e,t,s)=>{const{slug:a,tabId:o=(0,u.g0)()}=s,i=await(0,b.px)("fetchUniqueStarGift",{slug:a});i?t.openGiftInfoModal({gift:i,tabId:o}):t.showNotification({message:{key:"GiftWasNotFound"},tabId:o})}),(0,w.aJ)("processStarGiftWithdrawal",async(e,t,s)=>{const{gift:a,password:o,tabId:i=(0,u.g0)()}=s;let n=(0,C.nTw)(e,i).giftWithdrawModal;if(!n)return;e=(0,M.w)(e,{giftWithdrawModal:{...n,isLoading:!0,errorKey:void 0}},i),(0,w.UF)(e);const r=(0,Xe.HT)(e,a);if(!r)return;const d=await(0,b.px)("fetchStarGiftWithdrawalUrl",{inputGift:r,password:o});if(d&&(e=(0,w.mS)(),n=(0,C.nTw)(e,i).giftWithdrawModal,n)){if("error"in d)return e=(0,M.w)(e,{giftWithdrawModal:{...n,isLoading:!1,errorKey:d.messageKey}},i),void(0,w.UF)(e);t.openUrl({url:d.url,tabId:i}),t.closeGiftWithdrawModal({tabId:i})}});var et=s(13235);(0,w.aJ)("loadStarStatus",async e=>{const t=e.stars,s=!t?.topupOptions,[o,i,n]=await Promise.all([(0,b.px)("fetchStarsStatus"),(0,b.px)("fetchStarsStatus",{isTon:!0}),s?(0,b.px)("fetchStarsTopupOptions"):void 0]);!o&&!i||s&&!n||(e=(0,w.mS)(),o&&o.balance.currency===a.OUy&&(e={...e,stars:{...t,balance:o.balance,topupOptions:n||t.topupOptions,history:{all:void 0,inbound:void 0,outbound:void 0},subscriptions:void 0}},o.history&&(e=(0,A.Psh)(e,"all",o.history,o.nextHistoryOffset)),o.subscriptions&&(e=(0,A.qEh)(e,o.subscriptions,o.nextSubscriptionOffset))),i?.balance.currency===a.ykW&&(e={...e,ton:{...i,balance:i.balance,history:{all:void 0,inbound:void 0,outbound:void 0}}},e=(0,A.L_F)(e,i.balance),i.history&&(e=(0,A.Psh)(e,"all",i.history,i.nextHistoryOffset,!0))),(0,w.UF)(e))}),(0,w.aJ)("loadStarsTransactions",async(e,t,s)=>{const{type:a,isTon:o}=s,i=o?e.ton?.history[a]:e.stars?.history[a],n=i?.nextOffset;if(i&&!n)return;const r=await(0,b.px)("fetchStarsTransactions",{isInbound:"inbound"===a,isOutbound:"outbound"===a,offset:n||"",isTon:o});r&&(e=(0,w.mS)(),e=(0,A.L_F)(e,r.balance),r.history&&(e=(0,A.Psh)(e,a,r.history,r.nextOffset,o)),(0,w.UF)(e))}),(0,w.aJ)("loadStarGifts",async e=>{const t=await(0,b.px)("fetchStarGifts");if(!t)return;e=(0,w.mS)();const s=(0,h.dU)(t.gifts,"id"),a=Object.keys(s),o=Object.values(s).map(e=>e.availabilityResale?e.id:void 0).filter(Boolean);e={...e,starGifts:{byId:s,idsByCategory:{all:a,resale:o,myCollectibles:[]}}},(0,w.UF)(e)}),(0,w.aJ)("loadMyCollectibleGifts",async(e,t,s)=>{const{shouldRefresh:a}=s||{},o=e.currentUserId;if(!o)return;const i=e.myCollectibleGifts,n=i?.nextOffset;if(i&&!n&&!a)return;const r=(0,C.PVB)(e,o);if(!r)return;const d=await(0,b.px)("fetchSavedStarGifts",{peer:r,offset:a?void 0:n,filter:{sortType:"byDate",shouldIncludeUnique:!0,shouldIncludeUnlimited:!1,shouldIncludeUpgradable:!1,shouldIncludeLimited:!1,shouldIncludeDisplayed:!0,shouldIncludeHidden:!0}});if(!d)return;e=(0,w.mS)();const c=d.gifts,l=(0,h.pA)(c,e=>[e.gift.id,e]),u=c.map(e=>e.gift.id);e={...e,myCollectibleGifts:{byId:{...!a&&(e.myCollectibleGifts?.byId||{}),...l},ids:[...a?[]:e.myCollectibleGifts?.ids||[],...u],nextOffset:d.nextOffset}},(0,w.UF)(e)}),(0,w.aJ)("updateResaleGiftsFilter",(e,t,s)=>{const{filter:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);e=(0,M.w)(e,{resaleGifts:{...i.resaleGifts,filter:a}},o),i.resaleGifts.giftId&&t.loadResaleGifts({giftId:i.resaleGifts.giftId,shouldRefresh:!0,tabId:o}),(0,w.UF)(e)}),(0,w.aJ)("loadResaleGifts",async(e,t,s)=>{const{giftId:a,shouldRefresh:o,tabId:i=(0,u.g0)()}=s;let n=(0,C.nTw)(e,i);if(n.resaleGifts.isLoading||n.resaleGifts.isAllLoaded&&!o)return;e=(0,M.w)(e,{resaleGifts:{...n.resaleGifts,isLoading:!0,...o&&{count:0,nextOffset:void 0,isAllLoaded:!1}}},i),(0,w.UF)(e),e=(0,w.mS)(),n=(0,C.nTw)(e,i);const r=n.resaleGifts.nextOffset,d=n.resaleGifts.attributesHash,c=n.resaleGifts.filter,l=await(0,b.px)("fetchResaleGifts",{giftId:a,offset:r,limit:et.bc,attributesHash:d,filter:c});if(!l)return;const{chats:p,users:m}=l;e=(0,w.mS)(),n=(0,C.nTw)(e,i);const f=n.resaleGifts.gifts,g=o?l.gifts:f.concat(l.gifts),I=n.resaleGifts.updateIteration,v=n.resaleGifts.giftId!==a||o?I+1:I;e=(0,M.w)(e,{resaleGifts:{...n.resaleGifts,giftId:a,count:l.count||n.resaleGifts.count,gifts:g,attributes:l.attributes||n.resaleGifts.attributes,counters:l.counters||n.resaleGifts.counters,attributesHash:l.attributesHash,nextOffset:l.nextOffset,isLoading:!1,isAllLoaded:!l.nextOffset,updateIteration:v}},i),e=(0,A.CKT)(e,(0,h.dU)(m,"id")),e=(0,A.h7P)(e,(0,h.dU)(p,"id")),(0,w.UF)(e)}),(0,w.aJ)("resetResaleGifts",(e,t,s)=>{const{tabId:o=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,o);return(0,M.w)(e,{resaleGifts:{updateIteration:i.resaleGifts.updateIteration+1,filter:a.hYe,count:0,gifts:[]}},o)}),(0,w.aJ)("loadPeerSavedGifts",async(e,t,s)=>{const{peerId:a,shouldRefresh:o,tabId:i=(0,u.g0)()}=s,n=(0,C.PVB)(e,a);if(!n)return;e=(0,w.mS)();const r=(0,C.B59)(e,a,i),d=(0,C.HS0)(e,a,r,i),c=d?.nextOffset;if(!o&&d&&!c)return;const l=(0,C.w0X)(e,a,i),h=await(0,b.px)("fetchSavedStarGifts",{peer:n,offset:o?"":c,filter:l,collectionId:"all"===r?void 0:r});e=(0,w.mS)();const p=(0,C.w0X)(e,a,i),m=(0,C.B59)(e,a,i);if(!h||m!==r||p!==l)return;const f=d&&!o?d.gifts.concat(h.gifts):h.gifts;e=(0,A.xOA)(e,a,f,h.nextOffset,i),(0,w.UF)(e)}),(0,w.aJ)("reloadPeerSavedGifts",(e,t,s)=>{const{peerId:a}=s;Object.values(e.byTabId).forEach(s=>{const o=(0,C.B59)(e,a,s.id);(0,C.HS0)(e,a,o,s.id)&&t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:s.id})}),a===e.currentUserId&&t.loadMyCollectibleGifts({shouldRefresh:!0})}),(0,w.aJ)("loadStarsSubscriptions",async e=>{const t=e.stars?.subscriptions,s=t?.nextOffset;if(t&&!s)return;e=(0,A.Yzx)(e,!0),(0,w.UF)(e);const o=await(0,b.px)("fetchStarsSubscriptions",{offset:s||""});o&&o.balance.currency===a.OUy&&(e=(0,w.mS)(),e=(0,A.L_F)(e,o.balance),e=(0,A.qEh)(e,o.subscriptions,o.nextOffset),(0,w.UF)(e))}),(0,w.aJ)("changeStarsSubscription",async(e,t,s)=>{const{peerId:a,id:o,isCancelled:i}=s,n=a?(0,C.PVB)(e,a):void 0;a&&!n||(await(0,b.px)("changeStarsSubscription",{peer:n,subscriptionId:o,isCancelled:i}),t.loadStarStatus())}),(0,w.aJ)("fulfillStarsSubscription",async(e,t,s)=>{const{peerId:a,id:o}=s,i=a?(0,C.PVB)(e,a):void 0;a&&!i||(await(0,b.px)("fulfillStarsSubscription",{peer:i,subscriptionId:o}),t.loadStarStatus())}),(0,w.aJ)("changeGiftVisibility",async(e,t,s)=>{const{gift:a,shouldUnsave:o,tabId:i=(0,u.g0)()}=s,n="user"===a.type?e.currentUserId:a.chatId,r=(0,Xe.HT)(e,a);if(!r)return;const d=(0,C.B59)(e,n,i),c=(0,C.nTw)(e,i).savedGifts.collectionsByPeerId[n]?.[d];if(c?.gifts?.length){const t=c.gifts.map(e=>e.inputGift&&(0,Xe.j6)(e.inputGift,a)?{...e,isUnsaved:o}:e);e=(0,A.xOA)(e,n,t,c.nextOffset,i),(0,w.UF)(e)}const l=await(0,b.px)("saveStarGift",{inputGift:r,shouldUnsave:o});if(e=(0,w.mS)(),!l)return e=(0,A.xOA)(e,n,c.gifts,c.nextOffset,i),void(0,w.UF)(e);t.reloadPeerSavedGifts({peerId:n})}),(0,w.aJ)("convertGiftToStars",async(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,i=(0,Xe.HT)(e,a);if(!i)return;if(!await(0,b.px)("convertStarGift",{inputSavedGift:i}))return;const n="user"===a.type?e.currentUserId:a.chatId;t.reloadPeerSavedGifts({peerId:n}),t.openStarsBalanceModal({tabId:o})}),(0,w.aJ)("openGiftUpgradeModal",async(e,t,s)=>{const{giftId:a,gift:o,peerId:i,tabId:n=(0,u.g0)()}=s,r=await(0,b.px)("fetchStarGiftUpgradePreview",{giftId:a});r&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftUpgradeModal:{recipientId:i,gift:o,sampleAttributes:r}},n),(0,w.UF)(e))}),(0,w.aJ)("toggleSavedGiftPinned",async(e,t,s)=>{const{gift:a,peerId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.PVB)(e,o);if(!n)return;const r=(0,C.FDg)(e,o,i);if(!r)return;const d=e.appConfig.savedGiftPinLimit,c=r.gifts.filter(e=>e.isPinned),l=a.isPinned?c.filter(e=>e.gift.slug!==a.gift.slug):[...c,a],h=(d?l.slice(-d):l).map(t=>(0,Xe.HT)(e,t.inputGift)).filter(Boolean);await(0,b.px)("toggleSavedGiftPinned",{inputSavedGifts:h,peer:n})&&t.reloadPeerSavedGifts({peerId:o})}),(0,w.aJ)("updateStarGiftPrice",async(e,t,s)=>{const{gift:a,price:o}=s,i=(0,Xe.HT)(e,a);i&&await(0,b.px)("updateStarGiftPrice",{inputSavedGift:i,price:o})&&t.reloadPeerSavedGifts({peerId:e.currentUserId})}),(0,w.aJ)("loadStarGiftCollections",async(e,t,s)=>{const{peerId:a,hash:o}=s,i=(0,C.PVB)(e,a);if(!i)return;const n=await(0,b.px)("fetchStarGiftCollections",{peer:i,hash:o});n&&(e=(0,w.mS)(),e=(0,A.thC)(e,a,n.collections),(0,w.UF)(e))});var tt=s(58554);let st=0;(0,w.aJ)("loadAvailableReactions",async e=>{const t=await(0,b.px)("fetchAvailableReactions");t&&(t.forEach(e=>{e.aroundAnimation&&tt.hd(`sticker${e.aroundAnimation.id}`,i.qZ.BlobUrl),e.centerIcon&&tt.hd(`sticker${e.centerIcon.id}`,i.qZ.BlobUrl),e.appearAnimation&&tt.hd(`sticker${e.appearAnimation.id}`,i.qZ.BlobUrl),e.selectAnimation&&tt.hd((0,y.mr)(e.selectAnimation,"full"),i.qZ.BlobUrl)}),e=(0,w.mS)(),e={...e,reactions:{...e.reactions,availableReactions:t}},(0,w.UF)(e),(0,Re.A)({action:"loadAvailableReactions",payload:void 0},a.npx))}),(0,w.aJ)("loadAvailableEffects",async e=>{const t=await(0,b.px)("fetchAvailableEffects");if(!t)return;const{effects:s,emojis:a,stickers:o}=t,i=[],n=(0,h.dU)(s,"id");for(const e of s)if(e.effectAnimationId){const t={type:"emoji",emoticon:e.emoticon};i.push(t)}e=(0,w.mS)(),e={...e,availableEffectById:n,stickers:{...e.stickers,effect:{stickers:o,emojis:a}},reactions:{...e.reactions,effectReactions:i}},(0,w.UF)(e)}),(0,w.aJ)("interactWithAnimatedEmoji",(e,t,s)=>{const{emoji:a,x:o,y:i,startSize:n,isReversed:r,tabId:d=(0,u.g0)()}=s,c={id:st++,animatedEffect:a,x:Y(e,o)+40*Math.random()-20,y:i+40*Math.random()-20,startSize:n,isReversed:r};return(0,M.w)(e,{activeEmojiInteractions:[...(0,C.nTw)(e,d).activeEmojiInteractions||[],c]},d)}),(0,w.aJ)("sendEmojiInteraction",(e,t,s)=>{const{messageId:a,chatId:o,emoji:i,interactions:n}=s;if("connectionStateReady"!==e.connectionState)return;const r=(0,C.hds)(e,o);r&&i&&!(0,C.nZ4)(e,o)&&(0,b.px)("sendEmojiInteraction",{chat:r,messageId:a,emoticon:i,timestamps:n})}),(0,w.aJ)("sendDefaultReaction",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.nTJ)(e,a),r=(0,C.O5q)(e,a,o);n&&r&&!(0,y.Nb)(r)&&t.toggleReaction({chatId:a,messageId:o,reaction:n,tabId:i})}),(0,w.aJ)("toggleReaction",async(e,t,s)=>{const{chatId:a,reaction:o,shouldAddToRecent:i,tabId:n=(0,u.g0)()}=s;let{messageId:r}=s;const d=(0,C.hds)(e,a);let c=(0,C.O5q)(e,a,r);if(!d||!c)return;const l=(0,C.nZ4)(e,a),m=Boolean(c.groupedId)&&!c.isInAlbum,f=m?(0,C.D_S)(e,a,c.groupedId)[0]:void 0;c=m&&(0,C.O5q)(e,a,f)||c,r=c?.id||r;const g=(0,y.uC)(c),I=g.some(e=>(0,y.a0)(e,o)),v=I?g.filter(e=>!(0,y.a0)(e,o)):[...g,o],S=(0,C.cO5)(e),[A,M]=(0,h.jB)(v,e=>"paid"===e.type),P=M.slice(-S),k=[...A,...P],F=(0,p.bj)(c);(0,C.xYJ)(e,"reactionEffects")&&(I?t.stopActiveReaction({containerId:F,reaction:o,tabId:n}):t.startActiveReaction({containerId:F,reaction:o,tabId:n})),e=G(e,c,k),(0,w.UF)(e);try{await(0,b.px)("sendReaction",{chat:d,messageId:r,reactions:P,shouldAddToRecent:i}),l&&t.loadSavedReactionTags()}catch(t){e=G(e=(0,w.mS)(),c,g),(0,w.UF)(e)}}),(0,w.aJ)("addLocalPaidReaction",(e,t,s)=>{const{chatId:a,messageId:o,count:i,shouldIgnoreDefaultPrivacy:n=!1,tabId:r=(0,u.g0)()}=s,d=e.settings.paidReactionPrivacy,c=n?s.isPrivate:"anonymous"===d?.type,l=n?s.peerId:"peer"===d?.type?d.peerId:void 0,h=(0,C.hds)(e,a),m=(0,C.O5q)(e,a,o);if(!h||!m)return;const f=m.reactions?.results||[],g=(0,y.Ny)(f,i,c,l);e=(0,A.r3y)(e,m.chatId,m.id,{reactions:{...f,results:g}}),(0,w.UF)(e);const I=(0,p.bj)(m);(0,C.xYJ)(e,"reactionEffects")&&t.startActiveReaction({containerId:I,reaction:{type:"paid"},tabId:r})}),(0,w.aJ)("sendPaidReaction",async(e,t,s)=>{const{chatId:a,messageId:o,forcedAmount:i,tabId:n=(0,u.g0)()}=s,r=(0,C.hds)(e,a),d=(0,C.O5q)(e,a,o);if(!r||!d)return;const c=d.reactions?.results?.find(e=>"paid"===e.reaction.type),l=i||c?.localAmount||0;if(l){t.resetLocalPaidReactions({chatId:a,messageId:o});try{await(0,b.px)("sendPaidReaction",{chat:r,messageId:o,count:l,isPrivate:c?.localIsPrivate,peerId:c?.localPeerId})}catch(e){"BALANCE_TOO_LOW"===e.message&&t.openStarsBalanceModal({originReaction:{chatId:a,messageId:o,amount:l},tabId:n})}}}),(0,w.aJ)("startActiveReaction",(e,t,s)=>{const{containerId:a,reaction:o,tabId:i=(0,u.g0)()}=s,n=(0,C.nTw)(e,i);if(!(0,C.xYJ)(e,"reactionEffects"))return;const r=n.activeReactions[a]||[];if(r.some(e=>(0,y.a0)(e,o)))return;const d=r.concat(o);return(0,M.w)(e,{activeReactions:{...n.activeReactions,[a]:d}},i)}),(0,w.aJ)("stopActiveReaction",(e,t,s)=>{const{containerId:a,reaction:o,tabId:i=(0,u.g0)()}=s,n=(0,C.nTw)(e,i),r=n.activeReactions[a]||[],d=o?r.filter(e=>!(0,y.a0)(e,o)):[],c=d.length?{...n.activeReactions,[a]:d}:(0,h.cJ)(n.activeReactions,[a]);return(0,M.w)(e,{activeReactions:c},i)}),(0,w.aJ)("setDefaultReaction",async(e,t,s)=>{const{reaction:a}=s;await(0,b.px)("setDefaultReaction",{reaction:a})&&((e=(0,w.mS)()).config?(e={...e,config:{...e.config,defaultReaction:a}},(0,w.UF)(e)):t.loadConfig())}),(0,w.aJ)("stopActiveEmojiInteraction",(e,t,s)=>{const{id:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{activeEmojiInteractions:(0,C.nTw)(e,o).activeEmojiInteractions?.filter(e=>e.id!==a)},o)}),(0,w.aJ)("loadReactors",async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a,messageId:o,reaction:i}=s,n=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,o);if(!n||!r)return;const d=r.reactors?.nextOffset,c=await(0,b.px)("fetchMessageReactionsList",{reaction:i,chat:n,messageId:o,offset:d});c&&(e=(0,w.mS)(),e=(0,A.r3y)(e,a,o,{reactors:c}),(0,w.UF)(e))}),(0,w.aJ)("loadMessageReactions",(e,t,s)=>{if((0,C.trm)(e))return;const{ids:a,chatId:o}=s,i=(0,C.hds)(e,o);i&&"connectionStateReady"===e.connectionState&&(0,b.px)("fetchMessageReactions",{ids:a,chat:i})}),(0,w.aJ)("sendWatchingEmojiInteraction",(e,t,s)=>{const{chatId:a,emoticon:o,x:i,y:n,startSize:r,isReversed:d,id:c,tabId:l=(0,u.g0)()}=s,h=(0,C.hds)(e,a),p=(0,C.nTw)(e,l);if(h&&p.activeEmojiInteractions?.some(e=>e.id===c)&&!(0,C.nZ4)(e,a))return"connectionStateReady"===e.connectionState&&(0,b.px)("sendWatchingEmojiInteraction",{chat:h,emoticon:o}),(0,M.w)(e,{activeEmojiInteractions:p.activeEmojiInteractions.map(t=>t.id===c?{...t,x:Y(e,i),y:n,startSize:r,isReversed:d}:t)},l)}),(0,w.aJ)("fetchUnreadReactions",async(e,t,s)=>{const{chatId:a,offsetId:o}=s,i=(0,C.hds)(e,a);if(!i)return;const n=await(0,b.px)("fetchUnreadReactions",{chat:i,offsetId:o,addOffset:o?-1:void 0});if(!n||!n.messages.length)return e=V(e=(0,w.mS)(),a,{unreadReactionsCount:0}),void(0,w.UF)(e);const{messages:r}=n,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number);e=(0,w.mS)(),e=V(e=(0,A.o4A)(e,i.id,d),a,{unreadReactions:(0,h.Am)([...i.unreadReactions||[],...c]).sort((e,t)=>t-e)}),(0,w.UF)(e)}),(0,w.aJ)("animateUnreadReaction",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,i=(0,C.meB)(e,o);if(!i)return;if(!i.unreadReactionsCount)return V(e,i.id,{unreadReactions:[]});const n=Math.max(i.unreadReactionsCount-a.length,0),r=(i.unreadReactions||[]).filter(e=>!a.includes(e));e=V(e,i.id,{unreadReactions:r,unreadReactionsCount:n}),(0,w.UF)(e),t.markMessagesRead({messageIds:a,shouldFetchUnreadReactions:!0,tabId:o}),(0,C.xYJ)(e,"reactionEffects")&&(e=(0,w.mS)(),a.forEach(s=>{const a=(0,C.O5q)(e,i.id,s);if(!a)return;const{reaction:o,isOwn:n,isUnread:r}=a.reactions?.recentReactions?.[0]??{};if(o&&r&&!n){const e=(0,p.bj)(a);t.startActiveReaction({containerId:e,reaction:o,tabId:(0,u.g0)()})}}))}),(0,w.aJ)("focusNextReaction",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.meB)(e,a);if(!o?.unreadReactions)return o?.unreadReactionsCount?(0,A.wix)(e,o.id,{unreadReactionsCount:0}):void 0;t.focusMessage({chatId:o.id,messageId:o.unreadReactions[0],tabId:a,scrollTargetPosition:"end"}),t.markMessagesRead({messageIds:[o.unreadReactions[0]],tabId:a})}),(0,w.aJ)("readAllReactions",(e,t,s)=>{const{chatId:a,threadId:o=i.l3}=s,n=(0,C.hds)(e,a);if(n)return(0,b.px)("readAllReactions",{chat:n,threadId:o===i.l3?void 0:o}),o===i.l3?V(e,n.id,{unreadReactionsCount:void 0,unreadReactions:void 0}):void 0}),(0,w.aJ)("loadTopReactions",async e=>{const t=await(0,b.px)("fetchTopReactions",{hash:e.reactions.hash.topReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,topReactions:t.reactions,hash:{...e.reactions.hash,topReactions:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("loadRecentReactions",async e=>{const t=await(0,b.px)("fetchRecentReactions",{hash:e.reactions.hash.recentReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:t.reactions,hash:{...e.reactions.hash,recentReactions:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("clearRecentReactions",async e=>{await(0,b.px)("clearRecentReactions")&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:[]}},(0,w.UF)(e))}),(0,w.aJ)("loadDefaultTagReactions",async e=>{const t=await(0,b.px)("fetchDefaultTagReactions",{hash:e.reactions.hash.defaultTags});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,defaultTags:t.reactions,hash:{...e.reactions.hash,defaultTags:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("loadSavedReactionTags",async e=>{const{hash:t}=e.savedReactionTags||{},s=await(0,b.px)("fetchSavedReactionTags",{hash:t});if(!s)return;e=(0,w.mS)();const a=(0,h.pA)(s.tags,e=>[(0,y.Jj)(e.reaction),e]);e={...e,savedReactionTags:{hash:s.hash,byKey:a}},(0,w.UF)(e)}),(0,w.aJ)("editSavedReactionTag",async(e,t,s)=>{const{reaction:a,title:o}=s;if(!await(0,b.px)("updateSavedReactionTag",{reaction:a,title:o}))return;e=(0,w.mS)();const i=e.savedReactionTags?.byKey;if(!i)return;const n=(0,y.Jj)(a),r={...i[n],title:o};e={...e,savedReactionTags:{...e.savedReactionTags,byKey:{...i,[n]:r}}},(0,w.UF)(e)}),(0,w.aJ)("loadStatistics",async(e,t,s)=>{const{chatId:a,isGroup:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!n||!r)return;const d=await(0,b.px)(o?"fetchGroupStatistics":"fetchChannelStatistics",{chat:n,dcId:r.statisticsDcId});if(!d)return;const{stats:c}=d;if(e=(0,w.mS)(),e=(0,A.n8l)(e,a,c,i),(0,w.UF)(e),"channel"===c.type){const e=c.recentPosts.filter(e=>"message"===e.type),s=c.recentPosts.filter(e=>"story"===e.type);e.length>0&&t.loadMessagesById({chatId:a,messageIds:e.map(e=>e.msgId)}),s.length>0&&t.loadPeerStoriesByIds({peerId:a,storyIds:s.map(e=>e.storyId)})}}),(0,w.aJ)("loadChannelMonetizationStatistics",async(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.PVB)(e,a),n=(0,C.AWZ)(e,a);if(!i)return;const r=n?.statisticsDcId,d=await(0,b.px)("fetchChannelMonetizationStatistics",{peer:i,dcId:r});d&&(e=(0,w.mS)(),e=(0,A.$ry)(e,d,o),(0,w.UF)(e))}),(0,w.aJ)("loadMessageStatistics",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!n||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchMessageStatistics",{chat:n,messageId:o,dcId:d});c||(c={}),e=(0,w.mS)();const{viewsCount:l,forwardsCount:h,reactions:p}=(0,C.zeq)(e,a)[o]||{};c.viewsCount=l,c.forwardsCount=h,c.reactionsCount=p?.results?p?.results.reduce((e,t)=>e+t.count,0):void 0,e=(0,A.gJI)(e,c,i),(0,w.UF)(e),t.loadMessagePublicForwards({chatId:a,messageId:o,tabId:i})}),(0,w.aJ)("loadMessagePublicForwards",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!n||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,i).statistics.currentMessage||{};if(c?.publicForwards&&!c.nextOffset)return;const l=await(0,b.px)("fetchMessagePublicForwards",{chat:n,messageId:o,dcId:d,offset:c.nextOffset}),{forwards:h,nextOffset:p,count:m}=l||{};e=(0,w.mS)(),e=(0,A.gJI)(e,{...c,publicForwards:m||h?.length,publicForwardsData:(c.publicForwardsData||[]).concat(h||[]),nextOffset:p},i),(0,w.UF)(e)}),(0,w.aJ)("loadStatisticsAsyncGraph",async(e,t,s)=>{const{chatId:a,token:o,name:i,isPercentage:n,tabId:r=(0,u.g0)()}=s,d=(0,C.AWZ)(e,a);if(!d)return;const c=d.statisticsDcId,l=await(0,b.px)("fetchStatisticsAsyncGraph",{token:o,dcId:c,isPercentage:n});l&&(e=(0,w.mS)(),e=(0,A.RoI)(e,a,i,l,r),(0,w.UF)(e))}),(0,w.aJ)("loadStoryStatistics",async(e,t,s)=>{const{chatId:a,storyId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!n||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchStoryStatistics",{chat:n,storyId:o,dcId:d});c||(c={}),e=(0,w.mS)();const l=(0,C.Msb)(e,a,o),{forwardsCount:h=0,viewsCount:p=0,reactionsCount:m=0}=l&&"views"in l&&l.views?l.views:{};c.viewsCount=p,c.forwardsCount=h,c.reactionsCount=m,e=(0,w.mS)(),e=(0,A.KXe)(e,c,i),(0,w.UF)(e),t.loadStoryPublicForwards({chatId:a,storyId:o,tabId:i})}),(0,w.aJ)("loadStoryPublicForwards",async(e,t,s)=>{const{chatId:a,storyId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!n||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,i).statistics.currentStory||{};if(c?.publicForwards&&!c.nextOffset)return;const{publicForwards:l,count:h,nextOffset:p}=await(0,b.px)("fetchStoryPublicForwards",{chat:n,storyId:o,dcId:d,offset:c.nextOffset})||{};e=(0,w.mS)(),e=(0,A.KXe)(e,{...c,publicForwards:h||l?.length,publicForwardsData:(c.publicForwardsData||[]).concat(l||[]),nextOffset:p},i),(0,w.UF)(e)}),(0,w.aJ)("processMonetizationRevenueWithdrawalUrl",async(e,t,s)=>{const{peerId:a,currentPassword:o,tabId:i=(0,u.g0)()}=s;e=(0,A.Zct)(e,{isLoading:!0},i),(0,w.UF)(e);const n=(0,C.PVB)(e,a);if(!n)return;const r=await(0,b.px)("fetchMonetizationRevenueWithdrawalUrl",{peer:n,currentPassword:o});r&&(e=(0,w.mS)(),e=(0,A.Zct)(e,{isLoading:!1,errorKey:"error"in r?r.messageKey:void 0},i),(0,w.UF)(e),"url"in r&&(t.openUrl({url:r.url,tabId:i,ignoreDeepLinks:!0}),t.closeMonetizationVerificationModal({tabId:i})))});var at=s(1903);(0,w.aJ)("loadAllStories",async e=>{let t=0;for(;e.stories.hasNext;){if(t++>=100)return void(a.Oig&&console.error("`actions/loadAllStories`: Infinite loop detected"));e=(0,w.mS)();const{stateHash:s,hasNext:o}=e.stories;if(s&&!o)return;const i=await(0,b.px)("fetchAllStories",{isFirstRequest:!s,stateHash:s});if(!i)return;(e=(0,w.mS)()).stories.stateHash=i.state,"peerStories"in i&&(e=(0,A.Niu)(e,i.peerStories),e=(0,A.Gzl)(e,i.peerStories),(e=(0,A.qsx)(e,i.stealthMode)).stories.hasNext=i.hasMore),(0,w.UF)(e)}}),(0,w.aJ)("loadAllHiddenStories",async e=>{let t=0;for(;e.stories.hasNextInArchive;){if(t++>=100)return void(a.Oig&&console.error("`actions/loadAllHiddenStories`: Infinite loop detected"));e=(0,w.mS)();const{archiveStateHash:s,hasNextInArchive:o}=e.stories;if(s&&!o)return;const i=await(0,b.px)("fetchAllStories",{isFirstRequest:!s,stateHash:s,isHidden:!0});if(!i)return;(e=(0,w.mS)()).stories.archiveStateHash=i.state,"peerStories"in i&&(e=(0,A.Niu)(e,i.peerStories),e=(0,A.Gzl)(e,i.peerStories),(e=(0,A.qsx)(e,i.stealthMode)).stories.hasNextInArchive=i.hasMore),(0,w.UF)(e)}}),(0,w.aJ)("loadPeerSkippedStories",async(e,t,s)=>{const{peerId:a}=s,o=(0,C.PVB)(e,a),i=(0,C._bp)(e,a);if(!o||!i)return;const n=Object.values(i.byId).reduce((e,t)=>("content"in t||e.push(t.id),e),[]);if(0===n.length)return;const r=await(0,b.px)("fetchPeerStoriesByIds",{peer:o,ids:n});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,r.stories,r.pinnedIds),(0,w.UF)(e))}),(0,w.aJ)("viewStory",async(e,t,s)=>{const{peerId:a,storyId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.PVB)(e,a),r=(0,C.Msb)(e,a,o);if(!n||!r||!("content"in r))return;e=(0,A.SYp)(e,a,o,i),(0,w.UF)(e);const d=(0,v.Fm)();r.expireDate<d&&r.isInProfile&&(0,b.px)("viewStory",{peer:n,storyId:o}),(e.stories.byPeerId[a].lastReadId||0)<r.id&&await(0,b.px)("markStoryRead",{peer:n,storyId:o})&&(e=(0,w.mS)(),e=(0,A.Ahb)(e,a,o),(0,w.UF)(e))}),(0,w.aJ)("deleteStory",async(e,t,s)=>{const{peerId:a,storyId:o}=s,i=(0,C.PVB)(e,a);i&&await(0,b.px)("deleteStory",{peer:i,storyId:o})&&(e=(0,w.mS)(),e=(0,A.ONz)(e,a,o),(0,w.UF)(e))}),(0,w.aJ)("toggleStoryInProfile",async(e,t,s)=>{const{peerId:a,storyId:o,isInProfile:i}=s,n=(0,C.PVB)(e,a);if(!n)return;const r=(0,C.Msb)(e,a,o),d=r&&"content"in r?r.isInProfile:void 0;e=(0,A.Xzz)(e,a,o,{isInProfile:i}),e=(0,A.KpR)(e,a,o,i),(0,w.UF)(e);const c=await(0,b.px)("toggleStoryInProfile",{peer:n,storyId:o,isInProfile:i});c?.length||(e=(0,w.mS)(),e=(0,A.Xzz)(e,a,o,{isInProfile:d}),e=(0,A.KpR)(e,a,o,d),(0,w.UF)(e))}),(0,w.aJ)("toggleStoryPinnedToTop",async(e,t,s)=>{const{peerId:a,storyId:o}=s,i=(0,C.PVB)(e,a),n=(0,C._bp)(e,a);if(!i||!n)return;const r=(0,C.gVx)(e,a)?.map(e=>e.id)||[],d=r.includes(o)?r.filter(e=>e!==o):[...r,o];e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[a]:{...n,pinnedIds:d.sort((e,t)=>t-e)}}}},(0,w.UF)(e),await(0,b.px)("toggleStoryPinnedToTop",{peer:i,storyIds:d})||(e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[a]:{...n,pinnedIds:r}}}},(0,w.UF)(e))}),(0,w.aJ)("loadPeerStories",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;const i=await(0,b.px)("fetchPeerStories",{peer:o});i&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,i.stories),i.lastReadStoryId&&(e=(0,A.Ahb)(e,a,i.lastReadStoryId)),(0,w.UF)(e))}),(0,w.aJ)("loadPeerProfileStories",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,offsetId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.PVB)(e,a);let r=(0,C._bp)(e,a);if(!n||r?.isFullyLoaded)return;const d=(0,at.tW)(e,i);if("all"!==d){let t=r?.idsByAlbumId?.[d];if(t?.isFullyLoaded)return;const s=await(0,b.px)("fetchAlbumStories",{peer:n,albumId:d,offset:o||0});if(!s)return;return e=(0,w.mS)(),e=(0,A.K4v)(e,a,s.stories,s.pinnedIds,!1,d),r=(0,C._bp)(e,a),t=r?.idsByAlbumId?.[d],(0===Object.values(s.stories).length||t?.ids?.length&&t.ids.length>=s.count)&&(e=(0,A.oeX)(e,a,!0,!1,d)),void(0,w.UF)(e)}const c=await(0,b.px)("fetchPeerProfileStories",{peer:n,offsetId:o});c&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,c.stories,c.pinnedIds),r=(0,C._bp)(e,a),(0===Object.values(c.stories).length||r?.profileIds?.length&&r?.profileIds.length>=c.count)&&(e=(0,A.oeX)(e,a,!0)),(0,w.UF)(e))}),(0,w.aJ)("loadStoriesArchive",async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,offsetId:o}=s,i=(0,C.PVB)(e,a);let n=(0,C._bp)(e,a);if(!i||n?.isArchiveFullyLoaded)return;const r=await(0,b.px)("fetchStoriesArchive",{peer:i,offsetId:o});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,r.stories,void 0,!0),n=(0,C._bp)(e,a),(0===Object.values(r.stories).length||n?.archiveIds?.length&&n?.archiveIds.length>=r.count)&&(e=(0,A.oeX)(e,a,!0,!0)),(0,w.UF)(e))}),(0,w.aJ)("loadPeerStoriesByIds",async(e,t,s)=>{const{peerId:a,storyIds:o}=s,i=(0,C.PVB)(e,a);if(!i)return;const n=await(0,b.px)("fetchPeerStoriesByIds",{peer:i,ids:o});n&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,n.stories),(0,w.UF)(e))}),(0,w.aJ)("loadStoryViews",async(e,t,s)=>{const{peerId:a,storyId:o}=s,i=(0,C.PVB)(e,a);if(!i)return;const n=await(0,b.px)("fetchStoriesViews",{peer:i,storyIds:[o]});n&&(e=(0,w.mS)(),e=(0,A.ZCo)(e,a,o,n.views),(0,w.UF)(e))}),(0,w.aJ)("loadStoryViewList",async(e,t,s)=>{const{peerId:a,storyId:o,offset:i,areReactionsFirst:n,areJustContacts:r,query:d,limit:c,tabId:l=(0,u.g0)()}=s,h=(0,C.PVB)(e,a);if(!h)return;e=(0,A.dxy)(e,!0,l),(0,w.UF)(e);const p=await(0,b.px)("fetchStoryViewList",{peer:h,storyId:o,offset:i,areReactionsFirst:n,areJustContacts:r,limit:c,query:d});if(!p)return e=(0,w.mS)(),e=(0,A.dxy)(e,!1,l),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.X5v)(e,o,p.views,p.nextOffset,l),(0,w.UF)(e)}),(0,w.aJ)("reportStory",async(e,t,s)=>{const{peerId:o,storyId:i,description:n="",option:r="",tabId:d=(0,u.g0)()}=s,c=(0,C.PVB)(e,o);if(!c)return;const l=await(0,b.px)("reportStory",{peer:c,storyId:i,description:n,option:r});if(!l)return;const{result:h,error:p}=l;if(p===a.zLi)return t.showNotification({message:(0,g.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,g.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===r),a={title:h.title,options:h.options,subtitle:s?.text};e=(0,M.w)(e,{reportModal:{messageIds:[i],subject:"story",peerId:o,description:n,sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find(e=>e.option===r),a={isOptional:h.isOptional,option:h.option,title:s?.text};e=(0,M.w)(e,{reportModal:{messageIds:[i],description:n,peerId:o,subject:"story",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}}}),(0,w.aJ)("editStoryPrivacy",(e,t,s)=>{const{peerId:a,storyId:o,privacy:i}=s,n=(0,C.PVB)(e,a);if(!n)return;const r=[...i.allowUserIds,...i.allowChatIds],d=[...i.blockUserIds,...i.blockChatIds],c=(0,y.wT)(e,{visibility:i.visibility,isUnspecified:i.isUnspecified,allowedIds:r,blockedIds:d,botsPrivacy:"none"});(0,b.px)("editStoryPrivacy",{peer:n,id:o,privacy:c})}),(0,w.aJ)("toggleStoriesHidden",async(e,t,s)=>{const{peerId:a,isHidden:o}=s,i=(0,C.PVB)(e,a);i&&await(0,b.px)("toggleStoriesHidden",{peer:i,isHidden:o})&&(e=(0,w.mS)(),e=(0,A.VWO)(e,a,o),(0,w.UF)(e))}),(0,w.aJ)("loadStoriesMaxIds",async(e,t,s)=>{const{peerIds:a}=s,o=a.map(t=>(0,C.PVB)(e,t)).filter(Boolean);if(!o.length)return;const i=await(0,b.px)("fetchStoriesMaxIds",{peers:o});if(!i)return;const n=[];e=(0,w.mS)(),i.forEach((t,s)=>{const a=o[s];e=(0,A.kTB)(e,a.id,{maxStoryId:t,hasStories:0!==t}),0!==t&&n.push(a.id)}),(0,w.UF)(e),n?.forEach(e=>t.loadPeerStories({peerId:e}))}),(0,w.aJ)("sendStoryReaction",async(e,t,s)=>{const{peerId:a,storyId:o,containerId:i,reaction:n,shouldAddToRecent:r,tabId:d=(0,u.g0)()}=s,c=(0,C.PVB)(e,a);if(!c)return;const l=(0,C.Msb)(e,a,o);if(!l||!("content"in l))return;const h=l.sentReaction;e=(0,A.k31)(e,a,o,n),(0,w.UF)(e),n?t.startActiveReaction({containerId:i,reaction:n,tabId:d}):t.stopActiveReaction({containerId:i,tabId:d});const p=await(0,b.px)("sendStoryReaction",{peer:c,storyId:o,reaction:n,shouldAddToRecent:r});e=(0,w.mS)(),p||(e=(0,A.k31)(e,a,o,h)),(0,w.UF)(e)}),(0,w.aJ)("activateStealthMode",(e,t,s)=>{const{isForPast:a=!0,isForFuture:o=!0}=s||{};(0,b.px)("activateStealthMode",{isForPast:a||!0,isForFuture:o||!0})}),(0,w.aJ)("loadStoryAlbums",async(e,t,s)=>{const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;const i=await(0,b.px)("fetchAlbums",{peer:o});i&&(e=(0,w.mS)(),e={...e,stories:{...e.stories,albumsByPeerId:{...e.stories.albumsByPeerId,[a]:i}}},(0,w.UF)(e))}),(0,w.aJ)("selectStoryAlbum",(e,t,s)=>{const{peerId:a,albumId:o,tabId:i=(0,u.g0)()}=s;o&&a&&(e=(0,A.oeX)(e,a,!1)),e=(0,M.w)(e,{selectedStoryAlbumId:o||void 0},i),(0,w.UF)(e),t.loadPeerProfileStories({peerId:a,tabId:i})}),(0,w.aJ)("loadAlbumStories",async(e,t,s)=>{const{peerId:a,albumId:o,offsetId:i}=s,n=(0,C.PVB)(e,a);if(!n)return;const r=await(0,b.px)("fetchAlbumStories",{peer:n,albumId:o,offset:i||0});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,a,r.stories,r.pinnedIds),(0,w.UF)(e))}),(0,w.aJ)("resetSelectedStoryAlbum",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{selectedStoryAlbumId:void 0},a)}),s(88742);var ot=s(66414);function it({global:e,isSameMessageList:t,profileTab:s,forceScrollProfileTab:a,isOwnProfile:o,tabId:i}){const n=(0,C.nTw)(e,i).chatInfo,r=s??(t?n.profileTab:void 0),d=a??(t?n.forceScrollProfileTab:void 0),c=o??(t?n.isOwnProfile:void 0);(0,w.br)(()=>{e=(0,w.mS)(),e=(0,M.w)(e,{...(0,C.nTw)(e,i),chatInfo:{isOpen:!0,profileTab:r,forceScrollProfileTab:d,isOwnProfile:c}},i),e={...e,lastIsChatInfoShown:!0},(0,w.UF)(e)})}(0,w.aJ)("processOpenChatOrThread",(e,t,s)=>{const{chatId:a,threadId:o=i.l3,type:n="thread",shouldReplaceHistory:r=!1,shouldReplaceLast:d=!1,noForumTopicPanel:c,tabId:l=(0,u.g0)()}=s,h=(0,C.Xf0)(e,l),p=(0,C.nTw)(e,l);if(p.premiumModal?.promo&&p.premiumModal?.isOpen&&(e=(0,M.w)(e,{premiumModal:{...p.premiumModal,isOpen:!1}},l)),t.hideEffectInComposer({tabId:l}),t.closeStoryViewer({tabId:l}),t.closeStarsBalanceModal({tabId:l}),t.closeStarsTransactionModal({tabId:l}),t.closeGiftInfoModal({tabId:l}),h&&h.chatId===a&&h.threadId===o&&h.type===n||(a&&(e=(0,A.n4t)(e,a,o,"replyStack",[],l),e=(0,M.w)(e,{activeReactions:{},shouldPreventComposerAnimation:!0},l),e=(0,A._54)(e,a,o,l)),e=(0,A.T4Z)(e,l),e=(0,M.w)(e,{isStatisticsShown:!1,monetizationStatistics:void 0,boostStatistics:void 0,contentToBeScheduled:void 0,...a!==(0,C.nTw)(e,l).forwardMessages.toChatId&&{forwardMessages:{},isShareMessageModalShown:!1},chatInfo:{isOpen:p.chatInfo.isOpen}},l)),a){const s=(0,C.hds)(e,a);s?.isForum&&!c?t.openForumPanel({chatId:a,tabId:l}):a!==(0,C.nTw)(e,l).forumPanelChatId&&t.closeForumPanel({tabId:l})}return t.updatePageTitle({tabId:l}),(0,A.MNF)(e,a,o,n,r,d,l)}),(0,w.aJ)("openChatInNewTab",(e,t,s)=>{const{chatId:a,threadId:o=i.l3}=s,n=(0,ot.dk)(a,"thread",o);window.open(n,"_blank")}),(0,w.aJ)("openPreviousChat",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return t.updatePageTitle({tabId:a}),(0,A.MNF)(e,void 0,void 0,void 0,void 0,void 0,a)}),(0,w.aJ)("openChatWithInfo",(e,t,s)=>{const{profileTab:a,forceScrollProfileTab:o,isOwnProfile:n,tabId:r=(0,u.g0)(),...d}=s,c=(0,C.Xf0)(e,r);it({global:e,isSameMessageList:c?.chatId===d.id&&c?.threadId===i.l3&&c?.type===(d.type||"thread"),profileTab:a,forceScrollProfileTab:o,isOwnProfile:n,tabId:r}),t.openChat({...d,tabId:r})}),(0,w.aJ)("openThreadWithInfo",(e,t,s)=>{const{profileTab:a,forceScrollProfileTab:o,isOwnProfile:i,tabId:n=(0,u.g0)(),...r}=s,d=(0,C.Xf0)(e,n);it({global:e,isSameMessageList:d?.chatId===r.chatId&&d?.threadId===r.threadId&&d?.type===(r.type||"thread"),profileTab:a,forceScrollProfileTab:o,isOwnProfile:i,tabId:n}),t.openThread({...r,tabId:n})}),(0,w.aJ)("openChatWithDraft",(e,t,s)=>{const{chatId:a,text:o,threadId:n=i.l3,files:r,filter:d,tabId:c=(0,u.g0)()}=s;return a&&t.openThread({chatId:a,threadId:n,tabId:c}),(0,M.w)(e,{requestedDraft:{chatId:a,text:o,files:r,filter:d}},c)}),(0,w.aJ)("resetChatCreation",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatCreation:void 0},a)}),(0,w.aJ)("setNewChatMembersDialogState",(e,t,s)=>{const{newChatMembersProgress:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{newChatMembersProgress:a},o)}),(0,w.aJ)("openNextChat",(e,t,s)=>{const{targetIndexDelta:a,orderedIds:o,tabId:i=(0,u.g0)()}=s,{chatId:n}=(0,C.Xf0)(e,i)||{};if(!n)return void t.openChat({id:o[0],tabId:i});const r=o.indexOf(n);if(-1===r)return;const d=o[r+a];t.openChat({id:d,shouldReplaceHistory:!0,tabId:i})}),(0,w.aJ)("closeDeleteChatFolderModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{deleteFolderDialogModal:void 0},a)}),(0,w.aJ)("closeChatlistModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatlistModal:void 0},a)}),(0,w.aJ)("requestChatTranslation",(e,t,s)=>{const{chatId:a,toLanguageCode:o,tabId:i=(0,u.g0)()}=s;return(0,A.lcj)(e,a,o,i)}),(0,w.aJ)("closeChatInviteModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatInviteModal:void 0},a)}),(0,w.aJ)("openWebAppTab",(e,t,s)=>{const{webApp:a,tabId:o=(0,u.g0)()}=s;a&&(e=De(e=(0,w.mS)(),a,!0,!0,o),(0,w.UF)(e))}),(0,w.aJ)("updateWebApp",(e,t,s)=>{const{key:a,update:o,tabId:i=(0,u.g0)()}=s;return Oe(e,a,o,i)}),(0,w.aJ)("closeActiveWebApp",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return e=function(e,...[t=(0,u.g0)()]){const s=(0,C.nTw)(e,t).webApps.activeWebAppKey;return s?Ye(e,s,!1,t):e}(e,a),Ge(e,a)?e:Ve(e,!1,a)}),(0,w.aJ)("openMoreAppsTab",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{webApps:{...o.webApps,activeWebAppKey:void 0,isMoreAppsTabActive:!0}},a)}),(0,w.aJ)("closeMoreAppsTab",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),i=o.webApps.openedWebApps,n=Object.keys(i),r=n.length;return(0,M.w)(e,{webApps:{...o.webApps,isMoreAppsTabActive:!1,activeWebAppKey:r?n[r-1]:void 0,isModalOpen:r>0}},a)}),(0,w.aJ)("closeWebApp",(e,t,s)=>{const{key:a,skipClosingConfirmation:o,tabId:i=(0,u.g0)()}=s||{};return Ge(e=Ye(e,a,o,i),i)?e:Ve(e,!1,i)}),(0,w.aJ)("closeWebAppModal",(e,t,s)=>{const{shouldSkipConfirmation:a,tabId:o=(0,u.g0)()}=s||{},i=!a&&!(0,je.l)(e).shouldSkipWebAppCloseConfirmation&&function(e,...[t=(0,u.g0)()]){return Object.keys((0,C.nTw)(e,t).webApps.openedWebApps).length>1}(e,o);return i?(t.openWebAppsCloseConfirmationModal({tabId:o}),e):(e=function(e,...[t=(0,u.g0)()]){const s=(0,C.nTw)(e,t),a=Object.fromEntries(Object.entries(s.webApps.openedWebApps).filter(([,e])=>e.shouldConfirmClosing)),o=Object.values(a);if(!(o.length>0))return(0,M.w)(e,{webApps:{...s.webApps,activeWebAppKey:void 0,openedWebApps:{},openedOrderedKeys:[],sessionKeys:[]}},t);const i=(0,C.ES7)(e,t),n=i?.shouldConfirmClosing?i:o[0],r=(0,Ne.rp)(n);r&&(a[r]={...n,isCloseModalOpen:!0});const d=s.webApps.openedOrderedKeys.filter(e=>a[e]);return(0,M.w)(e,{webApps:{...s.webApps,activeWebAppKey:r,isMoreAppsTabActive:!1,openedWebApps:a,openedOrderedKeys:d}},t)}(e,o),Ge(e,o)?e:Ve(e,!1,o))}),(0,w.aJ)("changeWebAppModalState",(e,t,s)=>{const{state:a,tabId:o=(0,u.g0)()}=s;return function(e,t,...[s=(0,u.g0)()]){const a=(0,C.nTw)(e,s);return(0,M.w)(e,{webApps:{...a.webApps,modalState:t}},s)}(e,a,o)}),(0,w.aJ)("updateMiniAppCachedPosition",(e,t,s)=>{const{position:a}=s;return(0,A.qoo)(e,{miniAppsCachedPosition:a})}),(0,w.aJ)("updateMiniAppCachedSize",(e,t,s)=>{const{size:a}=s;return(0,A.qoo)(e,{miniAppsCachedSize:a})}),(0,w.aJ)("setWebAppPaymentSlug",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,o=(0,C.ES7)(e,a);if(o?.url)return Oe(e,(0,y.rp)(o),{slug:s.slug},a)}),(0,w.aJ)("cancelBotTrustRequest",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{botTrustRequest:void 0},a)}),(0,w.aJ)("markBotTrusted",(e,t,s)=>{const{botId:a,isWriteAllowed:o,tabId:i=(0,u.g0)()}=s,{trustedBotIds:n}=e,r=new Set(n);r.add(a),e={...e,trustedBotIds:Array.from(r)};const d=(0,C.nTw)(e,i);if(d.botTrustRequest?.onConfirm){const{action:e,payload:s}=d.botTrustRequest.onConfirm;t[e]({...s,isWriteAllowed:o})}e=(0,M.w)(e,{botTrustRequest:void 0},i),(0,w.UF)(e)}),(0,w.aJ)("sendWebAppEvent",(e,t,s)=>{const{event:a,webAppKey:o,tabId:i=(0,u.g0)()}=s,n=(0,C.wtp)(e,o,i);if(!n)return e;const r=n.plannedEvents?[...n.plannedEvents,a]:[a];return t.updateWebApp({key:o,update:{plannedEvents:r},tabId:i}),e}),(0,w.aJ)("cancelAttachBotInstall",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{requestedAttachBotInstall:void 0},a)}),(0,w.aJ)("requestAttachBotInChat",(e,t,s)=>{const{bot:a,filter:o,startParam:i,tabId:n=(0,u.g0)()}=s,r=(0,C.Xf0)(e,n)?.chatId,d=a.attachMenuPeerTypes?.filter(e=>"self"!==e&&o.includes(e));d?.length?(e=(0,M.w)(e,{requestedAttachBotInChat:{bot:a,filter:d,startParam:i}},n),(0,w.UF)(e)):t.callAttachBot({chatId:r||a.id,bot:a,startParam:i,tabId:n})}),(0,w.aJ)("cancelAttachBotInChat",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{requestedAttachBotInChat:void 0},a)}),(0,w.aJ)("openEmojiStatusAccessModal",(e,t,s)=>{const{bot:a,webAppKey:o,tabId:i=(0,u.g0)()}=s;a&&o&&(e=(0,w.mS)(),e=(0,M.w)(e,{emojiStatusAccessModal:{bot:a,webAppKey:o}},i),(0,w.UF)(e))}),(0,w.aJ)("closeEmojiStatusAccessModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{emojiStatusAccessModal:void 0},a)}),(0,w.aJ)("openLocationAccessModal",(e,t,s)=>{const{bot:a,webAppKey:o,tabId:i=(0,u.g0)()}=s;a&&o&&(e=(0,w.mS)(),e=(0,M.w)(e,{locationAccessModal:{bot:a,webAppKey:o}},i),(0,w.UF)(e))}),(0,w.aJ)("closeLocationAccessModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{locationAccessModal:void 0},a)});var nt=s(81954),rt=s(80539),dt=s(3544);function ct(e,t){(0,w.aJ)(e,(e,s,a)=>{const{tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{[t]:void 0},o)})}var lt=s(49086),ut=s(86525),ht=s(56494);const pt=a.OzO+a.xB5;let mt;function ft(e,t,s){const{type:a,threadId:o}=(0,C.Xf0)(e)||{},i=(0,m.Yw)(),n=(0,C.hds)(e,t),r="scheduled"===a?(0,C.yFI)(e,t):(0,C.zeq)(e,t);if(!n||!r||!o)return;const d=s.map(e=>r[e]).filter(t=>(0,C.WAX)(e,t,o).canCopy).sort((e,t)=>e.id-t.id),l=[],u=[];d.forEach(t=>{const s=(0,y.WX)(n)?n:(0,C.Y7C)(e,t),a=`> ${s?(0,S.F9)(i,s):t.forwardInfo?.hiddenUserName||""}:`,o=(0,y.ni)(e,t);l.push(a),l.push(`${function(e,t){const s=(0,w.mS)(),a=(0,dt.Su)(t),o=a?`${a} `:"",i=(0,lt.V)({message:t,shouldRenderAsHtml:!0})?.join(""),n=(0,ut.ni)(s,t);return`${o}${(0,dt.oL)(e,t,n,i,!0)}`}(i,t)}\n`),u.push(a),u.push(`${(0,dt.dS)(i,t,o,!1,0,!0)}\n`)}),(0,c.A)(l.join("\n"),u.join("\n"))}(0,w.aJ)("setScrollOffset",(e,t,s)=>{const{chatId:a,threadId:o,scrollOffset:i,tabId:n=(0,u.g0)()}=s;return e=(0,A.eww)(e,a,o,"lastScrollOffset",i),(0,A.n4t)(e,a,o,"scrollOffset",i,n)}),(0,w.aJ)("setEditingId",(e,t,s)=>{const{messageId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.Xf0)(e,o);if(!i)return;const{chatId:n,threadId:r,type:d}=i,c="scheduled"===d?"editingScheduledId":"editingId";return(0,A.eww)(e,n,r,c,a)}),(0,w.aJ)("setEditingDraft",(e,t,s)=>{const{text:a,chatId:o,threadId:i,type:n}=s,r="scheduled"===n?"editingScheduledDraft":"editingDraft";return(0,A.eww)(e,o,i,r,a)}),(0,w.aJ)("editLastMessage",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:i}=(0,C.Xf0)(e,a)||{};if(!o||!i)return;const n=(0,C.zeq)(e,o),r=(0,C.rA3)(e,o,i,a);if(!n||!r)return;const d=(0,h.Uk)(r,t=>Boolean(n[t]&&(0,C.WAX)(e,n[t],i).canEdit));return d?(0,A.eww)(e,o,i,"editingId",d):void 0}),(0,w.aJ)("replyToNextMessage",(e,t,s)=>{const{targetIndexDelta:a,tabId:o=(0,u.g0)()}=s,{chatId:n,threadId:r}=(0,C.Xf0)(e,o)||{};if(!n||!r)return;const d=(0,C.zeq)(e,n),c=(0,C.rA3)(e,n,r,o);if(!d||!c)return;const l=(0,C.GA4)(e,n,r)?.replyInfo;let h;if((0,C.haw)(e,n,r,o)&&l?.replyToMsgId){const e=Object.keys(d),t=e.indexOf(l.replyToMsgId.toString())+a;h=t<=e.length+1&&t>=0?Number(e[t]):void 0}else if(r===i.l3)h=(0,C.ZZX)(e,n);else{const t=(0,C.Vw0)(e,n,r);h=t?.lastMessageId}t.updateDraftReplyInfo({replyToMsgId:h,replyToPeerId:void 0,quoteText:void 0,tabId:o}),t.focusMessage({chatId:n,threadId:r,messageId:h,tabId:o})}),(0,w.aJ)("openAudioPlayer",(e,t,s)=>{const{chatId:a,threadId:o,messageId:i,origin:n,volume:r,playbackRate:d,isMuted:c,timestamp:l,tabId:h=(0,u.g0)()}=s,p=(0,C.nTw)(e,h);return(0,M.w)(e,{audioPlayer:{chatId:a,threadId:o,messageId:i,timestamp:l,origin:n??p.audioPlayer.origin,volume:r??p.audioPlayer.volume,playbackRate:d||p.audioPlayer.playbackRate||e.audioPlayer.lastPlaybackRate,isPlaybackRateActive:void 0===p.audioPlayer.isPlaybackRateActive?e.audioPlayer.isLastPlaybackRateActive:p.audioPlayer.isPlaybackRateActive,isMuted:c||p.audioPlayer.isMuted}},h)}),(0,w.aJ)("setAudioPlayerVolume",(e,t,s)=>{const{volume:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,volume:a,isMuted:!1}},o)}),(0,w.aJ)("setAudioPlayerPlaybackRate",(e,t,s)=>{const{playbackRate:a,isPlaybackRateActive:o,tabId:i=(0,u.g0)()}=s;return e={...e,audioPlayer:{...e.audioPlayer,lastPlaybackRate:a,isLastPlaybackRateActive:o}},(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,i).audioPlayer,playbackRate:a,isPlaybackRateActive:o}},i)}),(0,w.aJ)("setAudioPlayerMuted",(e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,isMuted:a}},o)}),(0,w.aJ)("setAudioPlayerOrigin",(e,t,s)=>{const{origin:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,origin:a}},o)}),(0,w.aJ)("closeAudioPlayer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{audioPlayer:{volume:o.audioPlayer.volume,playbackRate:o.audioPlayer.playbackRate,isPlaybackRateActive:o.audioPlayer.isPlaybackRateActive,isMuted:o.audioPlayer.isMuted}},a)}),(0,w.aJ)("openPollResults",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.gjV)(e,(0,D.Ny)(),i),r=(0,C.nTw)(e,i);if(n){if(a!==r.pollResults.chatId||o!==r.pollResults.messageId)return(0,M.w)(e,{pollResults:{chatId:a,messageId:o,voters:{}}},i)}else window.setTimeout(()=>{e=(0,w.mS)(),e=(0,M.w)(e,{pollResults:{chatId:a,messageId:o,voters:{}}},i),(0,w.UF)(e)},450)}),(0,w.aJ)("closePollResults",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{pollResults:{}},a)}),(0,w.aJ)("focusLastMessage",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:n,threadId:r,type:d}=o,c=(0,y.cG)(n,r,e.currentUserId);let l;if(r===i.l3)if("pinned"===d){const t=(0,C.fcC)(e,n,i.l3);if(!t?.length)return;l=t[t.length-1]}else l=(0,C.ZZX)(e,n);else if(c)l=(0,C.ZZX)(e,String(r),"saved");else{const t=(0,C.Vw0)(e,n,r);l=t?.lastMessageId}l&&t.focusMessage({chatId:n,threadId:r,messageListType:d,messageId:l,noHighlight:!0,noForumTopicPanel:!0,tabId:a})}),(0,w.aJ)("focusNextReply",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:i,threadId:n}=o,r=(0,C.jp_)(e,i,n,a);if(r&&0!==r.length){const s=r.pop();e=(0,A.n4t)(e,i,n,"replyStack",[...r],a),(0,w.UF)(e),t.focusMessage({chatId:i,threadId:n,messageId:s,tabId:a,noForumTopicPanel:!0})}else t.focusLastMessage({tabId:a})}),(0,w.aJ)("focusMessage",(e,t,s)=>{const{chatId:a,threadId:o=i.l3,messageListType:r="thread",noHighlight:d,groupedId:c,groupedChatId:l,replyMessageId:p,isResizingContainer:m,shouldReplaceHistory:f,noForumTopicPanel:g,quote:I,quoteOffset:v,scrollTargetPosition:b,timestamp:y,tabId:S=(0,u.g0)()}=s;let{messageId:M}=s;if(!(0,C.hds)(e,a))return void t.showNotification({message:{key:"ErrorFocusInaccessibleMessage"},tabId:S});const P=y?()=>t.openMediaFromTimestamp({chatId:a,threadId:o,messageId:M,timestamp:y,tabId:S}):void 0;if(void 0!==c){const t=(0,C.VC8)(e,l,c);t?.length&&([M]=(0,h.oE)(t))}const k=(0,C.Xf0)(e,S),F=!k||a!==k.chatId||o!==k.threadId||r!==k.type;if(mt&&(clearTimeout(mt),mt=void 0),mt=window.setTimeout(()=>{e=(0,w.mS)(),e=(0,A.kV7)({global:e},S),e=(0,A.Xbp)(e,void 0,S),(0,w.UF)(e)},d?pt:1500),e=(0,A.kV7)({global:e,chatId:a,messageId:M,threadId:o,noHighlight:d,isResizingContainer:m,quote:I,quoteOffset:v,scrollTargetPosition:b},S),e=(0,A.Xbp)(e,void 0,S),p){const t=(0,C.jp_)(e,a,o,S)||[];e=(0,A.n4t)(e,a,o,"replyStack",[...t,p],S)}F&&(e=(0,A.Xbp)(e,n.CC.Static,S));const T=(0,C.rA3)(e,a,o,S);if(T&&T.includes(M))return(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:a,threadId:o,type:r,shouldReplaceHistory:f,noForumTopicPanel:g,tabId:S}),void P?.();if(F&&(e=(0,A.n4t)(e,a,o,"viewportIds",void 0,S)),T&&!F){const t=M>T[0]?n.CC.Down:n.CC.Up;e=(0,A.Xbp)(e,t,S)}(0,nt.o8)()&&(0,nt.H$)(),(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:a,threadId:o,type:r,shouldReplaceHistory:f,noForumTopicPanel:g,tabId:S}),t.loadViewportMessages({chatId:a,threadId:o,tabId:S,shouldForceRender:!0,onLoaded:P})}),(0,w.aJ)("setShouldPreventComposerAnimation",(e,t,s)=>{const{shouldPreventComposerAnimation:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{shouldPreventComposerAnimation:a},o)}),(0,w.aJ)("openReplyMenu",(e,t,s)=>{const{fromChatId:a,messageId:o,quoteText:i,quoteOffset:n,tabId:r=(0,u.g0)()}=s;return(0,M.w)(e,{replyingMessage:{fromChatId:a,messageId:o,quoteText:i,quoteOffset:n},isShareMessageModalShown:!0},r)}),(0,w.aJ)("openForwardMenu",(e,t,s)=>{const{fromChatId:a,messageIds:o,storyId:i,groupedId:n,withMyScore:r,tabId:d=(0,u.g0)(),isRemindMe:c}=s;let l;return n&&(l=(0,C.D_S)(e,a,n)),(0,M.w)(e,{forwardMessages:{fromChatId:a,messageIds:l||o,storyId:i,withMyScore:r},isShareMessageModalShown:!c,isRemindMeCalendarShown:c},d)}),(0,w.aJ)("changeRecipient",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,a).forwardMessages,toChatId:void 0,noAuthors:!1,noCaptions:!1},isShareMessageModalShown:!0},a)}),(0,w.aJ)("setForwardNoAuthors",(e,t,s)=>{const{noAuthors:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);return(0,M.w)(e,{forwardMessages:{...i.forwardMessages,noAuthors:a,noCaptions:a&&i.forwardMessages.noCaptions}},o)}),(0,w.aJ)("setForwardNoCaptions",(e,t,s)=>{const{noCaptions:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,o).forwardMessages,noCaptions:a,noAuthors:a}},o)}),(0,w.aJ)("exitForwardMode",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{isShareMessageModalShown:!1,forwardMessages:{},replyingMessage:{}},a),(0,w.UF)(e)}),(0,w.aJ)("openForwardMenuForSelectedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:i,messageIds:n}=o.selectedMessages,r=n.filter(t=>{const s=(0,C.O5q)(e,i,t);return s&&(0,C.R4s)(e,s)});r.length&&t.openForwardMenu({fromChatId:i,messageIds:r,tabId:a})}),(0,w.aJ)("cancelMediaDownload",(e,t,s)=>{const{media:a,tabId:o=(0,u.g0)()}=s,i=(0,y.VO)(a,"download");if(i)return(0,A.IwB)(e,[i],o)}),(0,w.aJ)("cancelMediaHashDownloads",(e,t,s)=>{const{mediaHashes:a,tabId:o=(0,u.g0)()}=s;return(0,A.IwB)(e,a,o)}),(0,w.aJ)("downloadMedia",(e,t,s)=>{const{media:a,originMessage:o,tabId:i=(0,u.g0)()}=s,n=(0,y.VO)(a,"download");if(!n)return;const r={size:"size"in a?a.size:0,format:(0,y.Cz)(a,"download"),filename:(0,y.sd)(a),originChatId:o?.chatId,originMessageId:o?.id};return(0,A.iRS)(e,n,r,i)}),(0,w.aJ)("downloadSelectedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:i,messageIds:n}=o.selectedMessages,{threadId:r}=(0,C.Xf0)(e,a)||{},d=(0,C.zeq)(e,i);d&&r&&n.map(e=>d[e]).filter(t=>(0,C.WAX)(e,t,r).canDownload).forEach(s=>{const o=(0,ht.iS)(e,s);o&&t.downloadMedia({media:o,originMessage:s,tabId:a})})}),(0,w.aJ)("enterMessageSelectMode",(e,t,s)=>{const{messageId:a,tabId:o=(0,u.g0)()}=s||{},i=(0,C.meB)(e,o);return i?(0,A.l3i)(e,i.id,a,o):e}),(0,w.aJ)("toggleMessageSelection",(e,t,s)=>{const{messageId:a,groupedId:o,childMessageIds:i,withShift:n,tabId:r=(0,u.g0)()}=s,c=(0,C.Xf0)(e,r);if(!c)return;const{chatId:l,threadId:h,type:p}=c;e=(0,A.yrN)(e,l,h,p,a,o,i,n,r),(0,w.UF)(e),e.shouldShowContextMenuHint&&(t.disableContextMenuHint(),t.showNotification({message:{key:d.TF?"ContextMenuHintTouch":"ContextMenuHintMouse"},tabId:r}))}),(0,w.aJ)("disableContextMenuHint",e=>{if(e.shouldShowContextMenuHint)return{...e,shouldShowContextMenuHint:!1}}),(0,w.aJ)("exitMessageSelectMode",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.T4Z)(e,a)}),(0,w.aJ)("openPollModal",(e,t,s)=>{const{isQuiz:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{pollModal:{isOpen:!0,isQuiz:a}},o)}),(0,w.aJ)("closePollModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{pollModal:{isOpen:!1}},a)}),(0,w.aJ)("openTodoListModal",(e,t,s)=>{const{chatId:a,messageId:o,forNewTask:i,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{todoListModal:{chatId:a,messageId:o,forNewTask:i}},n)}),ct("closeTodoListModal","todoListModal"),(0,w.aJ)("openQuickReminderModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{quickReminderModal:{isOpen:!0}},a)}),ct("closeQuickReminderModal","quickReminderModal"),(0,w.aJ)("checkVersionNotification",(e,t)=>{if(Date.now()>1760994129119)return;const s="12.0.2".split(".").slice(0,2).join("."),{serviceNotifications:o}=e;if(o.find(({version:e})=>e===s))return;const i={chatId:a.zv8,date:(0,v.Fm)(),content:{text:(0,rt.Ay)("**Telegram Web A Digest**\r\n\r\nOver the past year, many new features and useful optimisations have been added. Here is a brief overview of the developments that have taken place in Web A during those busy months.\r\n\r\n✏️ __General__\r\n• A huge number of design fixes across the app.\r\n• Preview chats and mark them as read.\r\n• Video messages can now be transcribed.\r\n• Track your tasks with the help of [checklists](https://telegram.org/blog/checklists-suggested-posts/#checklists).\r\n• Folder tags are now supported with the help of GitHub contributors.\r\n• [Send photos in HD quality](https://telegram.org/blog/direct-to-channel-trim-voice-and-more#send-photos-in-higher-quality).\r\n• [Global search of public posts](https://telegram.org/blog/post-search-story-albums-and-more#public-post-search).\r\n• Support for channels with enabled auto-translate has been added.\r\n\r\n🎁 __Gifts__\r\n• Added interactions on hover.\r\n• Support for [Gift Marketplace](https://telegram.org/blog/gift-marketplace-and-more).\r\n• Pinned gifts are now displayed in the profile.\r\n\r\n📣 __Channels__\r\n• Accept and send direct messages to channels.\r\n• [Suggest your posts to be published by your favourite channels](https://telegram.org/blog/checklists-suggested-posts#suggest-posts-in-channels).\r\n\r\n👤 __Profile__\r\n• Full redesign of the profile page.\r\n• [Explore other people's gift collections and story albums](https://telegram.org/blog/post-search-story-albums-and-more#story-albums).\r\n• Keep an eye on all your accounts, just like on mobile and desktop clients, with the multi-account feature.\r\n\r\nThere are so many other bugfixes and improvements that it would take forever to describe them all! We're continually working on adding new features and improving the user experience.\r\n",!0)},isOutgoing:!1};t.createServiceNotification({message:i,version:s})}),(0,w.aJ)("createServiceNotification",(e,t,s)=>{const{message:o,version:i}=s,{serviceNotifications:n}=e,r=Math.max((0,C.ZZX)(e,a.zv8)||0,...n.map(({id:e})=>e)),d=(n.length+1)/1e3,c=Math.floor(r)+d;o.previousLocalId=o.id,o.id=c;const l={id:c,message:o,version:i,isUnread:!0};e={...e,serviceNotifications:[...n.slice(-1e3),l]},(0,w.UF)(e),t.apiUpdate({"@type":"newMessage",id:o.id,chatId:o.chatId,message:o})}),(0,w.aJ)("openReactorListModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{reactorModal:{chatId:a,messageId:o}},i)}),(0,w.aJ)("closeReactorListModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{reactorModal:void 0},a)}),(0,w.aJ)("openSeenByModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{seenByModal:{chatId:a,messageId:o}},i)}),(0,w.aJ)("closeSeenByModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{seenByModal:void 0},a)}),(0,w.aJ)("openPrivacySettingsNoticeModal",(e,t,s)=>{const{chatId:a,isReadDate:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{privacySettingsNoticeModal:{chatId:a,isReadDate:o}},i)}),(0,w.aJ)("closePrivacySettingsNoticeModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{privacySettingsNoticeModal:void 0},a)}),(0,w.aJ)("openChatLanguageModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s,n=o?(0,C.Rny)(e,a,o,i):(0,C.qZq)(e,a,i);return(0,M.w)(e,{chatLanguageModal:{chatId:a,messageId:o,activeLanguage:n}},i)}),(0,w.aJ)("closeChatLanguageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{chatLanguageModal:void 0},a)}),(0,w.aJ)("copySelectedMessages",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:i,messageIds:n}=o.selectedMessages;ft(e,i,n)}),(0,w.aJ)("copyMessagesByIds",(e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,i=(0,C.meB)(e,o);a&&0!==a.length&&i&&ft(e,i.id,a)}),(0,w.aJ)("openOneTimeMediaModal",(e,t,s)=>{const{message:a,tabId:o=(0,u.g0)()}=s;e=(0,M.w)(e,{oneTimeMediaModal:{message:a}},o),(0,w.UF)(e)}),(0,w.aJ)("closeOneTimeMediaModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,M.w)(e,{oneTimeMediaModal:void 0},a),(0,w.UF)(e)}),(0,w.aJ)("closeReportAdModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{reportAdModal:void 0},a)}),(0,w.aJ)("closeReportModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{reportModal:void 0},a)}),(0,w.aJ)("openPreviousReportAdModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).reportAdModal;if(o){if(1!==o.sections.length)return(0,M.w)(e,{reportAdModal:{...o,sections:o.sections.slice(0,-1)}},a);t.closeReportAdModal({tabId:a})}}),(0,w.aJ)("openPreviousReportModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).reportModal;if(o){if(1!==o.sections.length)return(0,M.w)(e,{reportModal:{...o,sections:o.sections.slice(0,-1)}},a);t.closeReportModal({tabId:a})}}),(0,w.aJ)("openPaidReactionModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{paidReactionModal:{chatId:a,messageId:o}},i)}),(0,w.aJ)("closePaidReactionModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{paidReactionModal:void 0},a)}),(0,w.aJ)("openSuggestMessageModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{suggestMessageModal:{chatId:a,messageId:o}},i)}),(0,w.aJ)("closeSuggestMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{suggestMessageModal:void 0},a)}),(0,w.aJ)("openSuggestedPostApprovalModal",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{suggestedPostApprovalModal:{chatId:a,messageId:o}},i)}),(0,w.aJ)("closeSuggestedPostApprovalModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{suggestedPostApprovalModal:void 0},a)}),(0,w.aJ)("openDeleteMessageModal",(e,t,s)=>{const{chatId:a,messageIds:o,isSchedule:i,tabId:n=(0,u.g0)()}=s;e=(0,w.mS)(),e=(0,M.w)(e,{deleteMessageModal:{chatId:a,messageIds:o,isSchedule:i}},n),(0,w.UF)(e)}),(0,w.aJ)("closeDeleteMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{deleteMessageModal:void 0},a)}),(0,w.aJ)("openAboutAdsModal",(e,t,s)=>{const{randomId:a,additionalInfo:o,canReport:i,sponsorInfo:n,tabId:r=(0,u.g0)()}=s||{};return(0,M.w)(e,{aboutAdsModal:{randomId:a,canReport:i,additionalInfo:o,sponsorInfo:n}},r)}),(0,w.aJ)("closeAboutAdsModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{aboutAdsModal:void 0},a)}),(0,w.aJ)("closePreparedInlineMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{preparedMessageModal:void 0},a)}),(0,w.aJ)("closeSharePreparedMessageModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{sharePreparedMessageModal:void 0},a)}),(0,w.aJ)("updateSharePreparedMessageModalSendArgs",async(e,t,s)=>{const{args:a,tabId:o=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,o);if(!i.sharePreparedMessageModal)return;if(!a)return e=(0,M.w)(e,{sharePreparedMessageModal:{...i.sharePreparedMessageModal,pendingSendArgs:void 0}},o),void(0,w.UF)(e);const n=await ie(e,a.peerId);e=(0,w.mS)(),e=(0,M.w)(e,{sharePreparedMessageModal:{...i.sharePreparedMessageModal,pendingSendArgs:{peerId:a.peerId,threadId:a.threadId,starsForSendMessage:n}}},o),(0,w.UF)(e)}),(0,w.aJ)("openQuickPreview",(e,t,s)=>{const{id:a,threadId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{quickPreview:{chatId:a,threadId:o}},i)}),(0,w.aJ)("closeQuickPreview",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{quickPreview:void 0},a)}),(0,w.aJ)("setGlobalSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,{chatId:i,currentContent:r}=(0,C.nTw)(e,o).globalSearch,d=a&&r!==n.$C.BotApps&&r!==n.$C.PublicPosts?{chats:!i,messages:!0}:void 0;return t.checkSearchPostsFlood({query:a,tabId:o}),(0,A.b8O)(e,{globalResults:{},localResults:{},resultsByType:void 0,fetchingStatus:d,query:a},o)}),(0,w.aJ)("setGlobalSearchClosing",(e,t,s)=>{const{tabId:a=(0,u.g0)(),isClosing:o}=s||{};return(0,A.b8O)(e,{isClosing:o},a)}),(0,w.aJ)("addRecentlyFoundChatId",(e,t,s)=>{const{id:a}=s,{recentlyFoundChatIds:o}=e;if(!o)return{...e,recentlyFoundChatIds:[a]};const i=o.filter(e=>e!==a);return i.unshift(a),i.length>10&&i.pop(),{...e,recentlyFoundChatIds:i}}),(0,w.aJ)("clearRecentlyFoundChats",e=>({...e,recentlyFoundChatIds:void 0})),(0,w.aJ)("setGlobalSearchContent",(e,t,s)=>{const{content:a,tabId:o=(0,u.g0)()}=s;return(0,A.GQ)(e,a,o)}),(0,w.aJ)("setGlobalSearchChatId",(e,t,s)=>{const{id:a,tabId:o=(0,u.g0)()}=s;return(0,A.b8O)(e,{chatId:a,query:void 0,resultsByType:void 0},o)}),(0,w.aJ)("openMiddleSearch",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:i}=(0,C.Xf0)(e,a)||{};if(o&&i)return(0,A.$RI)(e,o,i,{},a)}),(0,w.aJ)("closeMiddleSearch",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:i}=(0,C.Xf0)(e,a)||{};if(o&&i)return(0,A._54)(e,o,i,a)}),(0,w.aJ)("updateMiddleSearch",(e,t,s)=>{const{update:a,tabId:o=(0,u.g0)()}=s;let n,r;if(s.chatId)n=s.chatId,r=s.threadId||i.l3;else{const t=(0,C.Xf0)(e,o);if(!t)return;n=t.chatId,r=t.threadId}return(0,A.$RI)(e,n,r,a,o)}),(0,w.aJ)("resetMiddleSearch",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:i}=(0,C.Xf0)(e,a)||{};if(o&&i)return(0,A.zde)(e,o,i,a)}),(0,w.aJ)("setSharedMediaSearchType",(e,t,s)=>{const{mediaType:a,tabId:o=(0,u.g0)()}=s,{chatId:i,threadId:n}=(0,C.Xf0)(e,o)||{};if(i&&n)return(0,A.Tu_)(e,i,n,a,o)}),(0,w.aJ)("setStickerSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{stickerSearch:{query:a,resultIds:void 0}},o)}),(0,w.aJ)("setGifSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{gifSearch:{query:a,offset:void 0,results:void 0}},o)}),(0,w.aJ)("openFrozenAccountModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isFrozenAccountModalOpen:!0},a)}),(0,w.aJ)("closeFrozenAccountModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isFrozenAccountModalOpen:!1},a)}),(0,w.aJ)("openDeleteAccountModal",(e,t,s)=>{const{days:a,tabId:o=(0,u.g0)()}=s||{};a&&(e=(0,M.w)(e,{...(0,C.nTw)(e,o),deleteAccountModal:{selfDestructAccountDays:a}},o),(0,w.UF)(e))}),(0,w.aJ)("closeDeleteAccountModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{deleteAccountModal:void 0},a)}),(0,w.aJ)("openAgeVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isAgeVerificationModalOpen:!0},a)}),(0,w.aJ)("closeAgeVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isAgeVerificationModalOpen:!1},a)}),(0,w.aJ)("setUserSearchQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,A.BFh)(e,{globalUserIds:void 0,localUserIds:void 0,fetchingStatus:Boolean(a),query:a},o)}),(0,w.aJ)("openAddContactDialog",(e,t,s)=>{const{userId:a,tabId:o=(0,u.g0)()}=s;return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:o}),e):(0,M.w)(e,{newContact:{userId:a}},o)}),(0,w.aJ)("openNewContactDialog",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:a}),e):(0,M.w)(e,{newContact:{isByPhoneNumber:!0}},a)}),(0,w.aJ)("closeNewContactDialog",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.BOn)(e,a)}),(0,w.aJ)("closeSuggestedStatusModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{suggestedStatusModal:void 0},a)}),ct("closeChatRefundModal","chatRefundModal"),(0,w.aJ)("openProfileRatingModal",(e,t,s)=>{const{userId:a,level:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{profileRatingModal:{userId:a,level:o}},i)}),ct("closeProfileRatingModal","profileRatingModal"),s(11117);var gt=s(63495),It=s(14235);const vt=/^\d+\.\d+(\.\d+)?$/;var bt=s(99375);function yt(e){document.querySelectorAll('link[rel="icon"], link[rel="alternate icon"]').forEach(t=>{e?t.href.includes("favicon-unread")||(t.href=t.href.replace("favicon","favicon-unread")):t.href=t.href.replace("favicon-unread","favicon")})}async function St(e){gt.Vq?await(window.tauri?.setWindowTitle(e)):document.title!==e&&(document.title=e)}const wt=(0,I.sg)(St,200,!1);let At,Mt;(0,w.aJ)("toggleChatInfo",(e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,o).chatInfo,n=void 0!==a?a:!i.isOpen;return n!==i.isOpen&&(e=(0,M.w)(e,{chatInfo:{...i,isOpen:n}},o)),{...e,lastIsChatInfoShown:n}}),(0,w.aJ)("setLeftColumnWidth",(e,t,s)=>{const{leftColumnWidth:a}=s;return{...e,leftColumnWidth:a}}),(0,w.aJ)("resetLeftColumnWidth",e=>({...e,leftColumnWidth:void 0})),(0,w.aJ)("toggleManagement",(e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s||{},{chatId:i}=(0,C.Xf0)(e,o)||{};if(!i)return;const n=(0,C.nTw)(e,o);return(0,M.w)(e,{management:{byChatId:{...n.management.byChatId,[i]:{...n.management.byChatId[i],isActive:void 0!==a?a:!(n.management.byChatId[i]||{}).isActive}}}},o)}),(0,w.aJ)("requestNextManagementScreen",(e,t,s)=>{const{screen:a,tabId:o=(0,u.g0)()}=s||{},{chatId:i}=(0,C.Xf0)(e,o)||{};if(!i)return;const n=(0,C.nTw)(e,o);return(0,M.w)(e,{management:{byChatId:{...n.management.byChatId,[i]:{...n.management.byChatId[i],isActive:!0,nextScreen:a}}}},o)}),(0,w.aJ)("closeManagement",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{};if(!o)return;const i=(0,C.nTw)(e,a);return(0,M.w)(e,{management:{byChatId:{...i.management.byChatId,[o]:{...i.management.byChatId[o],isActive:!1}}}},a)}),(0,w.aJ)("processOpenChatOrThread",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;if((0,D.Ny)()||(0,D.Bb)())return(0,M.w)(e,{isLeftColumnShown:0===(0,C.nTw)(e,a).messageLists.length},a)}),(0,w.aJ)("changeProfileTab",(e,t,s)=>{const{profileTab:a,shouldScrollTo:o,tabId:i=(0,u.g0)()}=s,{chatId:n}=(0,C.Xf0)(e,i)||{};if(!n)return;const r=(0,C.nTw)(e,i).chatInfo;return(0,M.w)(e,{chatInfo:{...r,isOpen:!0,profileTab:a,forceScrollProfileTab:o}},i)}),(0,w.aJ)("toggleStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{isStatisticsShown:!o.isStatisticsShown,statistics:{...o.statistics,currentMessageId:void 0,currentStoryId:void 0}},a)}),(0,w.aJ)("toggleMessageStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)(),messageId:o}=s||{};return(0,M.w)(e,{statistics:{...(0,C.nTw)(e,a).statistics,currentMessageId:o,currentMessage:void 0,currentStoryId:void 0,currentStory:void 0}},a)}),(0,w.aJ)("toggleStoryStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)(),storyId:o}=s||{};return(0,M.w)(e,{statistics:{...(0,C.nTw)(e,a).statistics,currentStoryId:o,currentMessageId:void 0,currentMessage:void 0,currentStory:void 0}},a)}),(0,w.aJ)("toggleLeftColumn",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isLeftColumnShown:!(0,C.nTw)(e,a).isLeftColumnShown},a)}),(0,w.aJ)("addRecentEmoji",(e,t,s)=>{const{emoji:a}=s,{recentEmojis:o}=e;if(!o)return{...e,recentEmojis:[a]};const i=o.filter(e=>e!==a);return i.unshift(a),i.length>32&&i.pop(),{...e,recentEmojis:i}}),(0,w.aJ)("addRecentSticker",(e,t,s)=>{const{sticker:a}=s,{recent:o}=e.stickers;if(!o)return{...e,stickers:{...e.stickers,recent:{hash:"0",stickers:[a]}}};const i=o.stickers.filter(e=>e.id!==a.id);return i.unshift(a),{...e,stickers:{...e.stickers,recent:{...o,stickers:i}}}}),(0,w.aJ)("addRecentCustomEmoji",(e,t,s)=>{const{documentId:a}=s,{recentCustomEmojis:o}=e;if(!o)return{...e,recentCustomEmojis:[a]};const i=o.filter(e=>e!==a);return i.unshift(a),i.length>32&&i.pop(),{...e,recentCustomEmojis:i}}),(0,w.aJ)("clearRecentCustomEmoji",e=>({...e,recentCustomEmojis:[]})),(0,w.aJ)("reorderStickerSets",(e,t,s)=>{const{order:a,isCustomEmoji:o}=s;return{...e,stickers:{...e.stickers,added:{setIds:o?e.stickers.added.setIds:a}},customEmojis:{...e.customEmojis,added:{setIds:o?a:e.customEmojis.added.setIds}}}}),(0,w.aJ)("showNotification",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,i=o.localId;o.localId||=(0,It.A)();const n=[...(0,C.nTw)(e,a).notifications],r=n.findIndex(e=>i?e.localId===o.localId:e.message===o.message);return-1!==r&&n.splice(r,1),n.push(o),(0,M.w)(e,{notifications:n},a)}),(0,w.aJ)("showAllowedMessageTypesNotification",(e,t,s)=>{const{chatId:a,messageListType:o,tabId:i=(0,u.g0)()}=s;if((0,C.WA9)(e,a)&&"scheduled"===o)return void t.showNotification({message:{key:"DescriptionScheduledPaidMessagesNotAllowed"},tabId:i});const n=(0,C.hds)(e,a);if(!n)return;const r=(0,C.AWZ)(e,a),d=a?(0,C.nZ4)(e,a):void 0,c=a?(0,C.ALW)(e,n):void 0,{canSendPlainText:l,canSendPhotos:p,canSendVideos:m,canSendDocuments:f,canSendAudios:I,canSendStickers:v,canSendRoundVideos:b,canSendVoices:S}=(0,y.Q_)(n,r,c,d),w=(0,h.oE)([l?"Chat.SendAllowedContentTypeText":void 0,p?"Chat.SendAllowedContentTypePhoto":void 0,m?"Chat.SendAllowedContentTypeVideo":void 0,S?"Chat.SendAllowedContentTypeVoiceMessage":void 0,b?"Chat.SendAllowedContentTypeVideoMessage":void 0,f?"Chat.SendAllowedContentTypeFile":void 0,I?"Chat.SendAllowedContentTypeMusic":void 0,v?"Chat.SendAllowedContentTypeSticker":void 0]).map(e=>g.yE(e));if(!w.length)return void t.showNotification({message:g.yE("Chat.SendNotAllowedText"),tabId:i});const A=g.yE("AutoDownloadSettings.LastDelimeter"),M=w.join(", ").replace(/,([^,]*)$/,`${A}$1`);t.showNotification({message:g.yE("Chat.SendAllowedContentText",M),tabId:i})}),(0,w.aJ)("dismissNotification",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,o=(0,C.nTw)(e,a).notifications.filter(({localId:e})=>e!==s.localId);return(0,M.w)(e,{notifications:o},a)}),(0,w.aJ)("showDialog",(e,t,s)=>{const{data:a,tabId:o=(0,u.g0)()}=s;if("message"in a&&a.hasErrorKey&&!(0,bt.Ay)(a))return e;const i=[...(0,C.nTw)(e,o).dialogs];if("message"in a){const e=i.findIndex(e=>e.message===a.message);-1!==e&&i.splice(e,1)}return i.push(a),(0,M.w)(e,{dialogs:i},o)}),(0,w.aJ)("dismissDialog",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=[...(0,C.nTw)(e,a).dialogs];return o.pop(),(0,M.w)(e,{dialogs:o},a)}),(0,w.aJ)("toggleSafeLinkModal",(e,t,s)=>{const{url:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{safeLinkModalUrl:a},o)}),(0,w.aJ)("openHistoryCalendar",(e,t,s)=>{const{selectedAt:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{historyCalendarSelectedAt:a},o)}),(0,w.aJ)("closeHistoryCalendar",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{historyCalendarSelectedAt:void 0},a)}),(0,w.aJ)("openGame",(e,t,s)=>{const{url:a,chatId:o,messageId:i,tabId:n=(0,u.g0)()}=s,r=(0,C.O5q)(e,o,i);if(!r)return;const d=r.viaBotId||(0,C.Y7C)(e,r)?.id;if(d){if(!(0,C.nTL)(e,d))return e=(0,M.w)(e,{botTrustRequest:{botId:d,type:"game",onConfirm:{action:"openGame",payload:s}}},n),void(0,w.UF)(e);e=(0,M.w)(e,{openedGame:{url:a,chatId:o,messageId:i}},n),(0,w.UF)(e)}}),(0,w.aJ)("closeGame",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{openedGame:void 0},a)}),(0,w.aJ)("requestConfetti",(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s;if((0,C.PKK)(e))return(0,M.w)(e,{confetti:{lastConfettiTime:Date.now(),...o}},a)}),(0,w.aJ)("requestWave",(e,t,s)=>{const{startX:o,startY:i,tabId:n=(0,u.g0)()}=s;if(!d.J6||!(0,C.PKK)(e))return;const r=(0,C.nTw)(e,n),c=r.wave?.lastWaveTime||0;return Date.now()-c<a.S4O?void 0:(0,M.w)(e,{wave:{lastWaveTime:Date.now(),startX:o,startY:i}},n)}),(0,w.aJ)("updateAttachmentSettings",(e,t,s)=>({...e,attachmentSettings:{...e.attachmentSettings,...s}})),(0,w.aJ)("updateShouldSaveAttachmentsCompression",(e,t,s)=>{const{shouldSave:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{shouldSaveAttachmentsCompression:a},o)}),(0,w.aJ)("applyDefaultAttachmentsCompression",e=>{const{defaultAttachmentCompression:t}=e.attachmentSettings,s="compress"===t;return{...e,attachmentSettings:{...e.attachmentSettings,shouldCompress:s}}}),(0,w.aJ)("requestEffectInComposer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;return(0,M.w)(e,{shouldPlayEffectInComposer:!0},a)}),(0,w.aJ)("hideEffectInComposer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;return(0,M.w)(e,{shouldPlayEffectInComposer:void 0},a)}),(0,w.aJ)("setPaidMessageAutoApprove",e=>({...e,settings:{...e.settings,byKey:{...e.settings.byKey,shouldPaidMessageAutoApprove:!0}}})),(0,w.aJ)("setReactionEffect",(e,t,s)=>{const{chatId:a,threadId:o,reaction:i,tabId:n=(0,u.g0)()}=s,r="emoji"===i?.type&&i.emoticon;if(!r)return;const d=Object.values(e.availableEffectById).find(e=>e.effectAnimationId&&e.emoticon===r),c=d?.id,l=(0,C.g29)(e);!d?.isPremium||l?c&&(t.requestEffectInComposer({tabId:n}),t.saveEffectInDraft({chatId:a,threadId:o,effectId:c})):t.openPremiumModal({initialSection:"effects",tabId:n})}),(0,w.aJ)("openLimitReachedModal",(e,t,s)=>{const{limit:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{limitReachedModal:{limit:a}},o)}),(0,w.aJ)("closeLimitReachedModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{limitReachedModal:void 0},a)}),(0,w.aJ)("closeStickerSetModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{openedStickerSetShortName:void 0},a)}),(0,w.aJ)("openCustomEmojiSets",(e,t,s)=>{const{setIds:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{openedCustomEmojiSetIds:a},o)}),(0,w.aJ)("closeCustomEmojiSets",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{openedCustomEmojiSetIds:void 0},a)}),(0,w.aJ)("updateLastRenderedCustomEmojis",(e,t,s)=>{const{ids:o}=s,{lastRendered:i}=e.customEmojis;return{...e,customEmojis:{...e.customEmojis,lastRendered:(0,h.Am)([...i,...o]).slice(0,a.GW0)}}}),(0,w.aJ)("openCreateTopicPanel",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;return(0,C.meB)(e,o)||t.openChat({id:a,tabId:o}),(0,M.w)(e,{createTopicPanel:{chatId:a}},o)}),(0,w.aJ)("closeCreateTopicPanel",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{createTopicPanel:void 0},a)}),(0,w.aJ)("openEditTopicPanel",(e,t,s)=>{const{chatId:a,topicId:o,tabId:i=(0,u.g0)()}=s;return(0,C.meB)(e,i)||t.openChat({id:a,tabId:i}),(0,M.w)(e,{editTopicPanel:{chatId:a,topicId:o}},i)}),(0,w.aJ)("closeEditTopicPanel",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{editTopicPanel:void 0},a)}),(0,w.aJ)("updateArchiveSettings",(e,t,s)=>{const{archiveSettings:a}=e,{isHidden:o=a.isHidden,isMinimized:i=a.isMinimized}=s;return{...e,archiveSettings:{isHidden:o,isMinimized:i}}}),(0,w.aJ)("openMapModal",(e,t,s)=>{const{geoPoint:a,zoom:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{mapModal:{point:a,zoom:o}},i)}),(0,w.aJ)("closeMapModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{mapModal:void 0},a)}),(0,w.aJ)("checkAppVersion",e=>{fetch(`version.txt?${Date.now()}`).then(e=>e.text()).then(t=>{(function(e,t){const s=e.trim();return!!vt.test(s)&&s!==t})(t=t.trim(),"12.0.2")&&(e=(0,w.mS)(),e={...e,isAppUpdateAvailable:!0},(0,w.UF)(e))}).catch(e=>{a.Oig&&console.error("[checkAppVersion failed] ",e)})}),(0,w.aJ)("afterHangUp",e=>{(0,C.nTw)(e,(0,u.g0)()).multitabNextAction&&(0,u.I)()}),(0,w.aJ)("onTabFocusChange",(e,t,s)=>{const{isBlurred:a,tabId:o=(0,u.g0)()}=s;return a?(At&&clearInterval(At),At=window.setInterval(()=>{t.updatePageTitle({tabId:o})},500)):(clearInterval(At),At=void 0),e=(0,M.w)(e,{isBlurred:a},o),{...e,initialUnreadNotifications:a?(0,Fe.vp)():void 0}}),(0,w.aJ)("updatePageTitle",(e,t,s)=>{const{tabId:o=(0,u.g0)()}=s||{},{canDisplayChatInTitle:i}=(0,je.l)(e),n=e.currentUserId,r=e.config?.isTestServer,d=r?"[T] ":"",c=gt.Vq?a.zGP:a.j0M;if(document.title.includes(a.LaL))return yt(!1),void St(`${d}${c} ${a.LaL}`);if(!gt.Vq&&e.initialUnreadNotifications&&Math.round(Date.now()/1e3)%2==0){const t=(0,Fe.vp)()-e.initialUnreadNotifications;if(t>0)return St(`${d}${t} notification${t>1?"s":""}`),void yt(!0)}yt(!1);const l=(0,C.Xf0)(e,o);if(l&&i&&!e.passcode.isScreenLocked){const{chatId:t,threadId:s}=l,a=(0,C.hds)(e,t);if(a){const o=(0,y.Js)(g.yE,a,t===n),i=(0,C.S0q)(e,t,s);return a.isForum&&i?void wt(`${d}${o} › ${i.title}`):void wt(`${d}${o}`)}}St(`${d}${c}`)}),(0,w.aJ)("closeInviteViaLinkModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s??{};return(0,M.w)(e,{inviteViaLinkModal:void 0},a)}),(0,w.aJ)("closeCollectibleInfoModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s??{};return(0,M.w)(e,{collectibleInfoModal:void 0},a)}),(0,w.aJ)("setShouldCloseRightColumn",(e,t,s)=>{const{value:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{shouldCloseRightColumn:a},o)}),(0,w.aJ)("refreshLangPackFromCache",(e,t,s)=>{(0,m.K1)(s.langCode)}),(0,w.aJ)("processPremiumFloodWait",(e,t,s)=>{const{isUpload:a}=s,{bandwidthPremiumDownloadSpeedup:o,bandwidthPremiumUploadSpeedup:i,bandwidthPremiumNotifyPeriod:n}=e.appConfig,{lastPremiumBandwithNotificationDate:r}=e.settings;if(o&&i&&n&&!(r&&Date.now()<r+1e3*n))return Object.values(e.byTabId).filter(e=>!e.isBlurred).map(e=>e.id).forEach(e=>{t.showNotification({title:g.yE(a?"UploadSpeedLimited":"DownloadSpeedLimited"),message:g.yE(a?"UploadSpeedLimitedMessage":"DownloadSpeedLimitedMessage",a?i:o),duration:6e3,tabId:e})}),{...e,settings:{...e.settings,lastPremiumBandwithNotificationDate:Date.now()}}}),(0,w.aJ)("openCommandPalette",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{commandPalette:{isOpen:!0,query:""}},a)}),(0,w.aJ)("closeCommandPalette",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{commandPalette:{isOpen:!1,query:""}},a)}),(0,w.aJ)("setCommandPaletteQuery",(e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);return(0,M.w)(e,{commandPalette:{...i.commandPalette,query:a}},o)});let Ct,Pt=0;(0,ke.DW)(e=>{const{updatePageTitle:t,updateIsOnline:s}=(0,w.ko)(),a=e.passcode.isScreenLocked!==Mt,o=Object.values(e.byTabId).filter(e=>e.isBlurred).length,i=(0,C.nTw)(e,(0,u.g0)()).isMasterTab;a&&t(),o!==Pt&&i&&(Ct&&clearTimeout(Ct),Ct=window.setTimeout(()=>{e=(0,w.mS)();const t=Object.values(e.byTabId).filter(e=>e.isBlurred).length;s({isOnline:t!==(0,u.gb)().length})},100)),Mt=e.passcode.isScreenLocked,Pt=o}),(0,w.aJ)("closePaymentModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).payment.status||"cancelled",i=(0,C.nTw)(e,a).starsBalanceModal;return t.processOriginStarsPayment({originData:i,status:o,tabId:a}),e=(0,A.GSI)(e,a),(0,A._$X)(e,{status:o},a)}),(0,w.aJ)("resetPaymentStatus",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return e=(0,A._$X)(e,{status:void 0},a),(0,A.nv6)(e,{status:void 0},a)}),(0,w.aJ)("addPaymentError",(e,t,s)=>{const{error:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:a}},o)}),(0,w.aJ)("closeGiveawayModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{giveawayModal:void 0},a)}),(0,w.aJ)("closeGiftCodeModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftCodeModal:void 0},a)}),(0,w.aJ)("updateGiftProfileFilter",(e,t,s)=>{const{filter:a,peerId:o,tabId:i=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,i),r=n.savedGifts.filter;let d={...r,...a};d.shouldIncludeUnlimited||d.shouldIncludeLimited||d.shouldIncludeUnique||d.shouldIncludeUpgradable||(d={...r,shouldIncludeUnlimited:!0,shouldIncludeLimited:!0,shouldIncludeUnique:!0,shouldIncludeUpgradable:!0,...a}),d.shouldIncludeDisplayed||d.shouldIncludeHidden||(d={...r,shouldIncludeDisplayed:!0,shouldIncludeHidden:!0,...a});const c=(0,C.B59)(e,o,i);e=(0,M.w)(e,{savedGifts:{...n.savedGifts,collectionsByPeerId:{[o]:{[c]:n.savedGifts.collectionsByPeerId[o]?.[c]}},filter:d}},i),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:n.id})}),(0,w.aJ)("resetGiftProfileFilter",(e,t,s)=>{const{peerId:o,tabId:i=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,i),r=(0,C.B59)(e,o,i);e=(0,M.w)(e,{savedGifts:{...n.savedGifts,collectionsByPeerId:{[o]:{[r]:n.savedGifts.collectionsByPeerId[o]?.[r]}},filter:{...a.tBS}}},i),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:n.id})}),(0,w.aJ)("openPaymentMessageConfirmDialogOpen",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isPaymentMessageConfirmDialogOpen:!0},a)}),(0,w.aJ)("closePaymentMessageConfirmDialogOpen",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{isPaymentMessageConfirmDialogOpen:!1},a)}),(0,w.aJ)("openPriceConfirmModal",(e,t,s)=>{const{originalAmount:a,newAmount:o,currency:i,directInfo:n,tabId:r=(0,u.g0)()}=s;return(0,M.w)(e,{priceConfirmModal:{originalAmount:a,newAmount:o,currency:i,directInfo:n}},r)}),(0,w.aJ)("closePriceConfirmModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{priceConfirmModal:void 0},a)});var kt=s(12859);(0,w.aJ)("openMediaViewer",(e,t,s)=>{const{chatId:a,threadId:o=i.l3,messageId:n,timestamp:r,mediaIndex:d,isAvatarView:c,isSponsoredMessage:l,origin:h,withDynamicLoading:p,standaloneMedia:m,tabId:f=(0,u.g0)()}=s,g=(0,C.nTw)(e,f);return(0,M.w)(e,{mediaViewer:{...g.mediaViewer,chatId:a,threadId:o,messageId:n,mediaIndex:d||0,isAvatarView:c,isSponsoredMessage:l,origin:h,standaloneMedia:m,isHidden:!1,withDynamicLoading:p,timestamp:r},forwardMessages:{},isShareMessageModalShown:!1},f)}),(0,w.aJ)("closeMediaViewer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{volume:o,isMuted:i,playbackRate:n,isHidden:r}=(0,C.nTw)(e,a).mediaViewer;return(0,M.w)(e,{mediaViewer:{volume:o,isMuted:i,isHidden:r,playbackRate:n}},a)}),(0,w.aJ)("openMediaFromTimestamp",(e,t,s)=>{const{chatId:a,messageId:o,threadId:i,timestamp:r,tabId:d=(0,u.g0)()}=s,c=(0,C.O5q)(e,a,o);if(!c)return;const l=(0,T.Q)(c),h=(0,C.gMr)(e,c),p=(0,ht.ly)(e,c),m=p?.duration;if(m){if(m<=r)return;return"video"===p.mediaType?void t.openMediaViewer({chatId:a,messageId:o,threadId:i,origin:n.TQ.Inline,timestamp:r,tabId:d}):void t.openAudioPlayer({chatId:a,messageId:o,threadId:i,origin:n.d9.Inline,timestamp:r,tabId:d})}const f=h?(0,ht.ly)(e,h):void 0,g=f?.duration;!g||g<=r||("video"!==f.mediaType?t.openAudioPlayer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:n.d9.Inline,timestamp:r,tabId:d}):t.openMediaViewer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:n.TQ.Inline,timestamp:r,tabId:d}))}),(0,w.aJ)("updateLastPlaybackTimestamp",(e,t,s)=>{const{chatId:a,messageId:o,timestamp:i}=s,n=e.messages.playbackByChatId[a]?.byId||{};return i?{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[a]:{byId:{...n,[o]:i}}}}}:{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[a]:{byId:(0,h.cJ)(n,[o])}}}}}),(0,w.aJ)("setMediaViewerVolume",(e,t,s)=>{const{volume:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,volume:a,isMuted:!1}},o)}),(0,w.aJ)("setMediaViewerPlaybackRate",(e,t,s)=>{const{playbackRate:a,tabId:o=(0,u.g0)()}=s;return e={...e,mediaViewer:{...e.mediaViewer,lastPlaybackRate:a}},(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,playbackRate:a}},o)}),(0,w.aJ)("setMediaViewerMuted",(e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isMuted:a}},o)}),(0,w.aJ)("setMediaViewerHidden",(e,t,s)=>{const{isHidden:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isHidden:a}},o)});var Ft=s(70934),Tt=s(57751),Ut=s(42385),xt=s(20714);let Bt=!1;(0,I.yu)(()=>{const e=(0,w.mS)();e.isInited&&e.passcode.hasPasscode&&!Bt&&1===Object.keys(e.byTabId).length&&(0,Tt.rE)()}),(0,w.aJ)("setPasscode",async(e,t,s)=>{const{passcode:a,tabId:o=(0,u.g0)()}=s;e=(0,A.Vg3)(e,{isLoading:!0}),(0,w.UF)(e),await(0,Ft.IG)(a);const i=JSON.stringify({...(0,Tt.CX)(),userId:e.currentUserId});e=(0,w.mS)();const r=(0,Ut.Mm)((0,A.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}));try{await(0,Ft.yp)(i,r),(0,u.ZQ)(),e=(0,w.mS)(),e=(0,A.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}),(0,w.UF)(e),(0,Ut.Bo)(!0)}catch(s){(0,Ft.m)(),e=(0,w.mS)(),e=(0,A.Vg3)(e,{isLoading:!1}),(0,w.UF)(e),t.showNotification({message:"Failed to set passcode",tabId:o}),t.openSettingsScreen({screen:n.VS.PasscodeDisabled,tabId:o})}}),(0,w.aJ)("clearPasscode",e=>((0,Ft.WN)(),localStorage.removeItem(a.ozB),(0,A.XQb)(e))),(0,w.aJ)("unlockScreen",(e,t,s)=>{const a=Object.values(e.byTabId),{sessionJson:o,globalJson:i}=s,n=JSON.parse(o);(0,Tt.AA)(n);const r=e;(e=JSON.parse(i)).byTabId=r.byTabId,(0,Ut.e)(e,(0,h.mg)(xt.HB)),e=(0,A.Vg3)(e,{isScreenLocked:!1,error:void 0,invalidAttemptsCount:0}),(0,w.UF)(e),(0,u.ZQ)(),a.forEach(({id:e,isMasterTab:s})=>t.init({tabId:e,isMasterTab:s})),t.initApi()}),(0,w.aJ)("logInvalidUnlockAttempt",e=>{const t=(e.passcode?.invalidAttemptsCount??0)+1;return(0,A.Vg3)(e,{invalidAttemptsCount:t,timeoutUntil:t>=5?Date.now()+15e3:void 0})}),(0,w.aJ)("resetInvalidUnlockAttempts",e=>(0,A.Vg3)(e,{invalidAttemptsCount:0,timeoutUntil:void 0})),(0,w.aJ)("setPasscodeError",(e,t,s)=>{const{error:a}=s;return(0,A.Vg3)(e,{error:a})}),(0,w.aJ)("clearPasscodeError",e=>(0,A.Vg3)(e,{error:void 0})),(0,w.aJ)("skipLockOnUnload",()=>{Bt=!0}),(0,w.aJ)("processOriginStarsPayment",(e,t,s)=>{const{originData:a,status:o,tabId:i=(0,u.g0)()}=s,{originStarsPayment:n,originReaction:r,originGift:d,topup:c}=a||{};if((n||r||d||c)&&(t.closeStarsBalanceModal({tabId:i}),"paid"===o))return n&&(e=(0,M.w)(e,{starsPayment:n},i)),r&&t.sendPaidReaction({chatId:r.chatId,messageId:r.messageId,forcedAmount:r.amount,tabId:i}),d&&t.sendStarGift({...d,tabId:i}),e}),(0,w.aJ)("openGiftRecipientPicker",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:a}),e):(0,M.w)(e,{isGiftRecipientPickerOpen:!0},a)}),ct("closeGiftRecipientPicker","isGiftRecipientPickerOpen"),(0,w.aJ)("openStarsGiftingPickerModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{starsGiftingPickerModal:{isOpen:!0}},a)}),ct("closeStarsGiftingPickerModal","starsGiftingPickerModal"),(0,w.aJ)("openPrizeStarsTransactionFromGiveaway",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s||{},n=(0,C.O5q)(e,a,o);if(!n)return;const r=(0,Xe.D5)(n);return r?(0,A.V5q)(e,r,i):void 0}),(0,w.aJ)("openStarsBalanceModal",(e,t,s)=>{const{originStarsPayment:o,originReaction:i,originGift:n,topup:r,shouldIgnoreBalance:d,currency:c=a.OUy,tabId:l=(0,u.g0)()}=s||{},h=e.stars?.balance;if(!(!d&&h&&r&&r.balanceNeeded<=h.amount))return e=(0,A.Y1r)(e,l),t.loadStarStatus(),(0,M.w)(e,{starsBalanceModal:{originStarsPayment:o,originReaction:i,originGift:n,topup:r,currency:c}},l);t.showNotification({message:g.yE("StarsTopupLinkEnough"),actionText:g.yE("StarsTopupLinkTopupAnyway"),action:{action:"openStarsBalanceModal",payload:{topup:r,shouldIgnoreBalance:!0,tabId:l}},icon:"star",tabId:l})}),ct("closeStarsBalanceModal","starsBalanceModal"),(0,w.aJ)("closeStarsPaymentModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Osl)(e,a);let i=o?.status;return i&&"pending"!==i||(i="cancelled"),(0,M.w)(e,{starsPayment:{status:i}},a)}),(0,w.aJ)("openStarsTransactionModal",(e,t,s)=>{const{transaction:a,tabId:o=(0,u.g0)()}=s;return(0,A.V5q)(e,a,o)}),(0,w.aJ)("openStarsTransactionFromGift",(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s||{},n=(0,C.O5q)(e,a,o);if(!n)return;const r=(0,Xe.M6)(n);return r?(0,A.V5q)(e,r,i):void 0}),ct("closeStarsTransactionModal","starsTransactionModal"),(0,w.aJ)("openStarsSubscriptionModal",(e,t,s)=>{const{subscription:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{starsSubscriptionModal:{subscription:a}},o)}),ct("closeStarsSubscriptionModal","starsSubscriptionModal"),ct("closeGiftModal","giftModal"),(0,w.aJ)("closeStarsGiftModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{starsGiftModal:{isOpen:!1}},a)}),(0,w.aJ)("openGiftInfoModalFromMessage",async(e,t,s)=>{const{chatId:a,messageId:o,tabId:i=(0,u.g0)()}=s;if(!(0,C.hds)(e,a))return;await(0,w.pv)().loadMessage({chatId:a,messageId:o}),e=(0,w.mS)();const n=(0,C.O5q)(e,a,o);if(!n||!n.content.action)return;const r=n.content.action;if("starGift"!==r.type&&"starGiftUnique"!==r.type)return;const d="starGift"===r.type?r:void 0,c="starGiftUnique"===r.type?r:void 0,l=r.peerId||(n.isOutgoing?n.chatId:e.currentUserId),h=r.savedId?{type:"chat",chatId:a,savedId:r.savedId}:{type:"user",messageId:o},p=r.fromId||(n.isOutgoing?e.currentUserId:n.chatId),m={date:n.date,gift:r.gift,message:d?.message,starsToConvert:d?.starsToConvert,isNameHidden:d?.isNameHidden,isUnsaved:!r.isSaved,fromId:p,messageId:n.id,isConverted:d?.isConverted,upgradeMsgId:d?.upgradeMsgId,canUpgrade:d?.canUpgrade,alreadyPaidUpgradeStars:d?.alreadyPaidUpgradeStars,inputGift:h,canExportAt:c?.canExportAt,savedId:r.savedId,transferStars:c?.transferStars};t.openGiftInfoModal({peerId:l,gift:m,tabId:i})}),(0,w.aJ)("openGiftInfoModal",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,i="peerId"in s?s.peerId:void 0,n="recipientId"in s?s.recipientId:void 0;return(0,M.w)(e,{giftInfoModal:{peerId:i,gift:a,recipientId:n}},o)}),(0,w.aJ)("openLockedGiftModalInfo",(e,t,s)=>{const{untilDate:a,reason:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{lockedGiftModal:{untilDate:a,reason:o}},i)}),ct("closeLockedGiftModal","lockedGiftModal"),(0,w.aJ)("openGiftResalePriceComposerModal",(e,t,s)=>{const{gift:a,peerId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{giftResalePriceComposerModal:{peerId:o,gift:a}},i)}),(0,w.aJ)("openGiftInMarket",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o).giftModal;return t.closeGiftInfoValueModal({tabId:o}),t.closeGiftInfoModal({tabId:o}),i?(0,M.w)(e,{giftModal:{...i,selectedResaleGift:a}},o):(t.openGiftModal({forUserId:e.currentUserId,selectedResaleGift:a,tabId:o}),e)}),(0,w.aJ)("closeResaleGiftsMarket",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};t.resetResaleGifts({tabId:a});const o=(0,C.nTw)(e,a).giftModal;return o?(0,M.w)(e,{giftModal:{...o,selectedResaleGift:void 0}},a):e}),(0,w.aJ)("openGiftInfoValueModal",async(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,i=await(0,b.px)("fetchUniqueStarGiftValueInfo",{slug:a.slug});i&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftInfoValueModal:{valueInfo:i,gift:a}},o),(0,w.UF)(e))}),ct("closeGiftInfoModal","giftInfoModal"),ct("closeGiftInfoValueModal","giftInfoValueModal"),ct("closeGiftResalePriceComposerModal","giftResalePriceComposerModal"),ct("closeGiftUpgradeModal","giftUpgradeModal"),(0,w.aJ)("openGiftWithdrawModal",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftWithdrawModal:{gift:a}},o)}),ct("closeGiftWithdrawModal","giftWithdrawModal"),(0,w.aJ)("openGiftStatusInfoModal",(e,t,s)=>{const{emojiStatus:a,tabId:o=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftStatusInfoModal:{emojiStatus:a}},o)}),(0,w.aJ)("closeGiftStatusInfoModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{giftStatusInfoModal:void 0},a)}),(0,w.aJ)("clearGiftWithdrawError",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),i=o?.giftWithdrawModal;if(i)return(0,M.w)(e,{giftWithdrawModal:{...i,errorKey:void 0}},a)}),(0,w.aJ)("openGiftTransferModal",(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{giftTransferModal:{gift:a}},o)}),ct("closeGiftTransferModal","giftTransferModal"),(0,w.aJ)("openGiftTransferConfirmModal",(e,t,s)=>{const{gift:a,recipientId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{giftTransferConfirmModal:{gift:a,recipientId:o}},i)}),ct("closeGiftTransferConfirmModal","giftTransferConfirmModal"),(0,w.aJ)("updateSelectedGiftCollection",(e,t,s)=>{const{peerId:a,collectionId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.nTw)(e,i);e=(0,M.w)(e,{savedGifts:{...n.savedGifts,activeCollectionByPeerId:{...n.savedGifts.activeCollectionByPeerId,[a]:o}}},i),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:n.id})}),(0,w.aJ)("resetSelectedGiftCollection",(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,activeCollectionByPeerId:{...i.savedGifts.activeCollectionByPeerId,[a]:void 0}}},o),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("processOpenChatOrThread",(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;return a?(0,M.w)(e,{reactionPicker:{chatId:a,messageId:void 0,position:void 0}},o):(0,M.w)(e,{reactionPicker:void 0},o)}),(0,w.aJ)("openMessageReactionPicker",(e,t,s)=>{const{chatId:a,messageId:o,position:i,tabId:n=(0,u.g0)()}=s;return(0,M.w)(e,{reactionPicker:{chatId:a,messageId:o,position:i}},n)}),(0,w.aJ)("openStoryReactionPicker",(e,t,s)=>{const{peerId:a,storyId:o,position:i,sendAsMessage:n,tabId:r=(0,u.g0)()}=s;return(0,M.w)(e,{reactionPicker:{storyPeerId:a,storyId:o,sendAsMessage:n,position:i}},r)}),(0,w.aJ)("openEffectPicker",(e,t,s)=>{const{position:a,chatId:o,tabId:i=(0,u.g0)()}=s;return(0,M.w)(e,{reactionPicker:{position:a,chatId:o,isForEffects:!0}},i)}),(0,w.aJ)("closeReactionPicker",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{reactionPicker:{...o.reactionPicker,messageId:void 0,position:void 0,storyId:void 0,storyPeerId:void 0,isForEffects:void 0}},a)}),(0,w.aJ)("resetLocalPaidReactions",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=(0,C.O5q)(e,a,o);if(!i)return;const{reactions:n}=i;if(!n)return;const r=n.results.map(e=>{if(e.localAmount){if(!e.count)return;return{...e,localAmount:void 0,localPreviousChosenOrder:void 0,chosenOrder:e.localPreviousChosenOrder}}return e}).filter(Boolean);return Object.values(e.byTabId).forEach(({id:e})=>{t.dismissNotification({localId:(0,p.bj)(i),tabId:e})}),(0,A.r3y)(e,a,o,{reactions:{...n,results:r}})}),(0,w.aJ)("openStoryViewer",async(e,t,s)=>{const{peerId:a,storyId:o,isSinglePeer:i,isSingleStory:n,isPrivate:r,isArchive:d,origin:c,tabId:l=(0,u.g0)()}=s,h=(0,C.PVB)(e,a);if(!h)return;const p=(0,C.nTw)(e,l),m=(0,C._bp)(e,a);if(o&&(!m||!m.byId[o])){const t=await(0,b.px)("fetchPeerStoriesByIds",{peer:h,ids:[o]});if(!t)return;e=(0,w.mS)(),e=(0,A.K4v)(e,a,t.stories)}const f=p.storyViewer.storyList||(0,C.R3Q)(e,a,o,n,i,r,d);e=(0,M.w)(e,{storyViewer:{...p.storyViewer,peerId:a,storyId:o||(0,C._$$)(e,a)||(0,C.dNJ)(e,a),isSinglePeer:i,isPrivate:r,isArchive:d,isSingleStory:n,viewModal:void 0,origin:c,storyList:f}},l),(0,w.UF)(e)}),(0,w.aJ)("openStoryViewerByUsername",async(e,t,s)=>{const{username:a,storyId:i,origin:n,tabId:r=(0,u.g0)()}=s,d=await(0,o.A$)(e,a);d&&t.openStoryViewer({peerId:d.id,storyId:i,isSinglePeer:!0,isSingleStory:!0,origin:n,tabId:r})}),(0,w.aJ)("closeStoryViewer",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{isMuted:o,isRibbonShown:i,isArchivedRibbonShown:n,storyId:r}=(0,C.nTw)(e,a).storyViewer;return r?e=(0,M.w)(e,{storyViewer:{isMuted:o,isRibbonShown:i,isArchivedRibbonShown:n,lastViewedByPeerId:void 0,storyList:void 0}},a):e}),(0,w.aJ)("setStoryViewerMuted",(e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,M.w)(e,{storyViewer:{...(0,C.nTw)(e,o).storyViewer,isMuted:a}},o)}),(0,w.aJ)("toggleStoryRibbon",(e,t,s)=>{const{isShown:a,isArchived:o,tabId:i=(0,u.g0)()}=s,n=e.stories.orderedPeerIds[o?"archived":"active"];return n?.length?(0,M.w)(e,{storyViewer:{...(0,C.nTw)(e,i).storyViewer,[o?"isArchivedRibbonShown":"isRibbonShown"]:a}},i):e}),(0,w.aJ)("openPreviousStory",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),{peerId:i,storyId:n,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:a});if(!i||!n)return;const l=(0,C.PVB)(e,i);if(!(0,C._bp)(e,i)||!l)return;const{peerIds:h,storyIdsByPeerId:p}=c,m=(p[i]??[]).indexOf(n);let f,g;if(m>0)f=m-1,g=i;else{const e=h.indexOf(i)-1;if(r||e<0)return;g=h[e],f=(p?.[g]?.length||1)-1}const I=p?.[g]?.[f];return I?(0,M.w)(e,{storyViewer:{...o.storyViewer,peerId:g,storyId:I}},a):void 0}),(0,w.aJ)("openNextStory",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),{peerId:i,storyId:n,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:a});if(!i||!n)return;const l=(0,C.PVB)(e,i);if(!(0,C._bp)(e,i)||!l)return;const{peerIds:h,storyIdsByPeerId:p}=c,m=p[i]??[],f=m.indexOf(n);let g,I;if(f<m.length-1)g=f+1,I=i;else{const e=h.indexOf(i)+1;if(r||e>h.length-1)return void t.closeStoryViewer({tabId:a});I=h[e],g=0}const v=p?.[I]?.[g];return v?(0,M.w)(e,{storyViewer:{...o.storyViewer,peerId:I,storyId:v}},a):void 0}),(0,w.aJ)("openStoryViewModal",(e,t,s)=>{const{storyId:a,tabId:o=(0,u.g0)()}=s,i=(0,C.nTw)(e,o);return(0,M.w)(e,{storyViewer:{...i.storyViewer,viewModal:{storyId:a,nextOffset:"",isLoading:!0}}},o)}),(0,w.aJ)("closeStoryViewModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{storyViewer:(0,h.cJ)(o.storyViewer,["viewModal"])},a)}),(0,w.aJ)("copyStoryLink",async(e,t,s)=>{const{peerId:a,storyId:o,tabId:i=(0,u.g0)()}=s,n=(0,C.PVB)(e,a);if(!n)return;const r=await(0,b.px)("fetchStoryLink",{peer:n,storyId:o});r&&((0,c.eM)(r),t.showNotification({message:g.yE("LinkCopied"),tabId:i}))}),(0,w.aJ)("sendMessage",async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,{storyId:o,peerId:i}=(0,C.V9I)(e,a);if(!Boolean(o&&i))return;if(void 0===await ie(e,i))return;const{gif:n,sticker:r,isReaction:d}=s;let c;c=n?"Story.Tooltip.GifSent":r?"Story.Tooltip.StickerSent":d?"Story.Tooltip.ReactionSent":"Story.Tooltip.MessageSent",t.showNotification({message:g.yE(c),actionText:g.yE("Story.ToastViewInChat"),action:[{action:"closeStoryViewer",payload:void 0},{action:"openChat",payload:{id:i}}],tabId:a})}),(0,w.aJ)("openStoryPrivacyEditor",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!0}},a)}),(0,w.aJ)("closeStoryPrivacyEditor",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,M.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!1}},a)}),(0,w.aJ)("toggleStealthModal",(e,t,s)=>{const{isOpen:a,tabId:o=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,o);return(0,M.w)(e,{storyViewer:{...i.storyViewer,isStealthModalOpen:a}},o)}),(0,w.aJ)("clearStoryViews",(e,t,s)=>{const{isLoading:a,tabId:o=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,o);return i.storyViewer.viewModal?(0,M.w)(e,{storyViewer:{...i.storyViewer,viewModal:{...i.storyViewer.viewModal,views:void 0,isLoading:a,nextOffset:""}}},o):e}),(0,w.aJ)("updateStoryView",(e,t,s)=>{const{userId:a,isUserBlocked:o,areStoriesBlocked:i,tabId:n=(0,u.g0)()}=s,r=(0,C.nTw)(e,n),{viewModal:d}=r.storyViewer;if(!d?.storyId)return;const c=d?.views?.map(e=>e.peerId===a?{...e,isUserBlocked:o||void 0,areStoriesBlocked:i||void 0}:e);return(0,M.w)(e,{storyViewer:{...r.storyViewer,viewModal:{...d,views:c}}},n)}),(0,w.aJ)("closeBoostModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{boostModal:void 0},a)}),(0,w.aJ)("closeBoostStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{boostStatistics:void 0},a)}),(0,w.aJ)("openMonetizationVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)(),chatId:o}=s||{};return(0,M.w)(e,{monetizationVerificationModal:{chatId:o}},a)}),(0,w.aJ)("closeMonetizationVerificationModal",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{monetizationVerificationModal:void 0},a)}),(0,w.aJ)("clearMonetizationVerificationError",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.Zct)(e,{errorKey:void 0},a)}),(0,w.aJ)("closeMonetizationStatistics",(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,M.w)(e,{monetizationStatistics:void 0},a)}),(0,w.aJ)("toggleFocusList",(e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s??{},i=void 0!==a?a:!(0,C.nTw)(e,o).isFocusListShown;return e=(0,M.w)(e,{isFocusListShown:i},o),{...e,lastIsFocusListShown:i}}),(0,w.aJ)("addToFocusList",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=`${a}_${o}`,n=e.focusList.messageIds;return n.includes(i)?e:{...e,focusList:{...e.focusList,messageIds:[...n,i]}}}),(0,w.aJ)("removeFromFocusList",(e,t,s)=>{const{chatId:a,messageId:o}=s,i=`${a}_${o}`;return{...e,focusList:{...e.focusList,messageIds:e.focusList.messageIds.filter(e=>e!==i)}}}),(0,w.aJ)("replaceFocusList",(e,t,s)=>{const{messageKeys:a}=s;return{...e,focusList:{...e.focusList,messageIds:a}}}),s(4990);const Rt=new Set(["boostLevel","isForum","isLinkedInDiscussion","fakeType","restrictionReasons","isJoinToSend","isJoinRequest","type"]);(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateChat":{const a=(0,C.hds)(e,s.id),{isForum:o,lastReadOutboxMessageId:i}=a||{};s.chat.lastReadOutboxMessageId&&i&&s.chat.lastReadOutboxMessageId<i&&(s={...s,chat:(0,h.cJ)(s.chat,["lastReadInboxMessageId"])}),e=(0,A.wix)(e,s.id,s.chat),a?.areStoriesHidden!==s.chat.areStoriesHidden&&(e=(0,A.VWO)(e,s.id,s.chat.areStoriesHidden||!1)),(0,w.UF)(e);const n=(0,C.hds)(e,s.id);if(s.noTopChatsRequest||(0,C.mJZ)(e,s.id)||n?.isNotJoined||t.loadTopChats(),s.chat.id&&(0,F.Kz)({chatId:s.chat.id,lastReadInboxMessageId:s.chat.lastReadInboxMessageId}),Object.values(e.byTabId).forEach(({id:a})=>{const{chatId:i}=(0,C.Xf0)(e,a)||{},n=s;i===n.id&&"isForum"in n.chat&&o!==n.chat.isForum&&(o&&t.closeForumPanel({tabId:a}),t.openChat({id:i,tabId:a}))}),a){const e=s.chat;Object.keys(e).filter(t=>a[t]!==e[t]).some(e=>Rt.has(e))&&t.invalidateFullInfo({peerId:s.id})}return}case"updateChatJoin":{const a=(0,C.P4G)(e,s.id),o=(0,C.hds)(e,s.id);if(e=(0,A.wix)(e,s.id,{isNotJoined:!1}),(0,w.UF)(e),o&&t.requestChatUpdate({chatId:o.id}),t.loadFullChat({chatId:s.id,force:!0}),!a)return;return e=(0,w.mS)(),e=(0,A.ec2)(e,a,[s.id]),void(0,w.UF)(e)}case"updateChatLeave":{e=(0,A.CX_)(e,s.id);const t=(0,C.hds)(e,s.id);if(t&&(0,y.WX)(t)){const a=(0,C.zeq)(e,s.id);if(a){const s=Object.keys(a).map(Number).filter(p.iL);e=(0,A.AH0)(e,t.id,s)}}return e}case"updateChatInbox":return(0,A.wix)(e,s.id,s.chat);case"updateChatTypingStatus":{const{id:t,threadId:a=i.l3,typingStatus:o}=s;return e=(0,A.eww)(e,t,a,"typingStatus",o),(0,w.UF)(e),void setTimeout(()=>{e=(0,w.mS)();const s=(0,C.C5H)(e,t,a,"typingStatus");o&&s&&o.timestamp===s.timestamp&&(e=(0,A.eww)(e,t,a,"typingStatus",void 0),(0,w.UF)(e))},6e3)}case"newMessage":{const{message:t}=s;if((t.senderId?t.senderId===e.currentUserId:t.isOutgoing)&&!t.isFromScheduled)return;const o=(0,p.iL)(t.id),i=(0,C.hds)(e,s.chatId);if(!i)return;const n=Boolean(s.message.id&&s.message.hasUnreadMention);if(!o||i.id===a.zv8){e=(0,A.wix)(e,s.chatId,{unreadCount:i.unreadCount?i.unreadCount+1:1}),n&&(e=(0,A.Wez)(e,s.chatId,i,[s.message.id],!0));const a=i.isForum?(0,C.nkm)(e,t):void 0;a&&(e=(0,A.TwA)(e,s.chatId,a.id,{unreadCount:a.unreadCount?a.unreadCount+1:1}))}return(0,w.UF)(e),void(0,F.Oq)({chat:i,message:t})}case"updateCommonBoxMessages":case"updateChannelMessages":{const{ids:t,messageUpdate:a}=s;return t.forEach(t=>{const o="channelId"in s?s.channelId:(0,C.Egn)(e,t),i=(0,C.hds)(e,o);a.reactions&&i?.unreadReactionsCount&&!(0,y.pU)(e,a.reactions)&&(e=V(e,o,{unreadReactionsCount:Math.max(i.unreadReactionsCount-1,0)||void 0,unreadReactions:i.unreadReactions?.filter(e=>e!==t)})),!a.hasUnreadMention&&i?.unreadMentionsCount&&(e=(0,A.pWt)(e,o,i,[t],!0))}),e}case"updateChatFullInfo":return(0,A.ltr)(e,s.id,s.fullInfo);case"updatePinnedChatIds":{const{ids:o,folderId:i}=s,n=i===a._E9?"archived":"active";return o?{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[n]:o.length?o:void 0}}}:(t.loadPinnedDialogs({listType:n}),e)}case"updatePinnedSavedDialogIds":{const{ids:t}=s;return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:t.length?t:void 0}}}}case"updateChatPinned":{const{id:t,isPinned:o}=s,i=(0,C.P4G)(e,t);if(!i)return;const{[i]:n}=e.chats.orderedPinnedIds;let r=n||[];if(o){if(!r.includes(t)){if("active"===i&&r.length>=a.FZw){const t=e.chats.listIds.active;r=r.filter(e=>t&&t.includes(e))}r=[t,...r]}}else r=r.filter(e=>e!==t);return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[i]:r.length?r:void 0}}}}case"updateSavedDialogPinned":{const{id:t,isPinned:a}=s,{saved:o}=e.chats.orderedPinnedIds;let i=o||[];return a?i.includes(t)||(i=[t,...i]):i=i.filter(e=>e!==t),{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:i.length?i:void 0}}}}case"updateChatListType":{const{id:t,folderId:a}=s;return(0,A.KrP)(e,t,a)}case"updateChatFolder":{const{id:t,folder:a}=s,{byId:o,orderedIds:i}=e.chatFolders,n=void 0===a;Object.values(e.byTabId).forEach(({id:s})=>{const a=(0,C.nTw)(e,s);Object.values(o)[a.activeChatFolder-1]?.id===t&&(e=(0,M.w)(e,{activeChatFolder:0},s))});const r=n?(0,h.cJ)(o,[t]):{...o,[t]:a},d=n?i?.filter(e=>e!==t):i?.includes(t)?i:[...i||[],t];return{...e,chatFolders:{...e.chatFolders,byId:r,orderedIds:d,invites:(0,h.cJ)(e.chatFolders.invites,[t])}}}case"updateChatFoldersOrder":{const{orderedIds:t}=s;return{...e,chatFolders:{...e.chatFolders,orderedIds:t}}}case"updateRecommendedChatFolders":{const{folders:t}=s;return{...e,chatFolders:{...e.chatFolders,recommended:t}}}case"updateChatMembers":{const t=(0,C.AWZ)(e,s.id),{replacedMembers:a,addedMember:o,deletedMemberId:i}=s;if(!t)return;let n=!1,r=t?.members?[...t.members]:[];if(a)r=a,n=!0;else if(o)r.length&&r.some(e=>e.userId===o.userId)||(r.push(o),n=!0);else if(r.length&&i){const e=r.findIndex(e=>e.userId===i);e>-1&&(r.slice(e,1),n=!0)}if(n){const t=r.filter(({isOwner:e,isAdmin:t})=>e||t);return e=(0,A.wix)(e,s.id,{membersCount:r.length}),e=(0,A.ltr)(e,s.id,{members:r,adminMembersById:(0,h.dU)(t,"userId")})}return}case"draftMessage":{const{chatId:t,threadId:a,draft:o}=s;if(!e.chats.byId[t])return;return e=(0,A.eww)(e,t,a||i.l3,"draft",o),e=(0,A.wix)(e,t,{draftDate:o?.date})}case"updatePendingJoinRequests":{const{chatId:a,requestsPending:o,recentRequesterIds:i}=s;if(!e.chats.byId[a])return;return e=(0,A.ltr)(e,a,{requestsPending:o,recentRequesterIds:i}),(0,w.UF)(e),void t.loadChatJoinRequests({chatId:a})}case"updatePinnedTopic":{const{chatId:t,topicId:a,isPinned:o}=s;if(!e.chats.byId[t])return;return e=(0,A.TwA)(e,t,a,{isPinned:o}),void(0,w.UF)(e)}case"updatePinnedTopicsOrder":{const{chatId:t,order:a}=s;if(!e.chats.byId[t])return;return e=(0,A.mPd)(e,t,a),void(0,w.UF)(e)}case"updateTopic":{const{chatId:a,topicId:o}=s,i=(0,C.hds)(e,a);if(!i?.isForum)return;return void t.loadTopicById({chatId:a,topicId:o})}case"updateTopics":{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o?.isForum)return;return void t.loadTopics({chatId:a,force:!0})}case"updateViewForumAsMessages":{const{chatId:t,isEnabled:a}=s,o=(0,C.hds)(e,t);if(!o?.isForum)return;e=(0,A.wix)(e,t,{isForumAsMessages:a}),(0,w.UF)(e);break}case"updateNewProfilePhoto":{const{peerId:a,photo:o}=s;e=(0,A.wix)(e,a,{avatarPhotoId:o.id}),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0});break}case"updateDeleteProfilePhoto":{const{peerId:a,photoId:o}=s,i=(0,C.PVB)(e,a);if(!i)return;o&&i.avatarPhotoId!==o?e=(0,A.sol)(e,a,o):(e=(0,A.wix)(e,a,{avatarPhotoId:void 0}),e=(0,A.Khb)(e,a,void 0)),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0});break}}});const Jt=(0,s(8718).By)(function(){let e=(0,w.mS)();e=(0,A.wWy)(e,{...e.users.statusesById,...Nt}),(0,w.UF)(e),Nt={}});let Nt={};(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"deleteContact":return(0,A.MOQ)(e,s.id);case"updateUser":{Object.values(e.byTabId).forEach(({id:a})=>{(0,C.nZ4)(e,s.id)&&s.user.isPremium!==(0,C.g29)(e)&&(s.user.isPremium&&e.byTabId[a].premiumModal&&t.openPremiumModal({isSuccess:!0,tabId:a}),e={...e,translations:{byChatId:{}}})});const a=(0,C.mBe)(e,s.id);return e=(0,A.TKu)(e,s.id,s.user),s.fullInfo&&(e=(0,A.weB)(e,s.id,s.fullInfo)),a?.areStoriesHidden!==s.user.areStoriesHidden&&(e=(0,A.VWO)(e,s.id,s.user.areStoriesHidden||!1)),e}case"updateRequestUserUpdate":t.loadFullUser({userId:s.id});break;case"updateUserEmojiStatus":return e=(0,A.TKu)(e,s.userId,{emojiStatus:s.emojiStatus}),e=(0,A.wix)(e,s.userId,{emojiStatus:s.emojiStatus});case"updateUserStatus":return Nt[s.userId]=s.status,void Jt();case"updateUserFullInfo":{const{id:t,fullInfo:a}=s;return(0,A.weB)(e,t,a)}case"updateBotMenuButton":{const{botId:t,button:a}=s,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,A.weB)(e,t,{botInfo:{...o.botInfo,menuButton:a}})}case"updateBotCommands":{const{botId:t,commands:a}=s,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,A.weB)(e,t,{botInfo:{...o.botInfo,commands:a}})}case"updatePeerSettings":{const{id:a,settings:o}=s,i=(0,C.vGo)(e,a);return i?.botInfo?e=(0,A.weB)(e,a,{settings:o}):void t.loadFullUser({userId:a})}}}),(0,w.aJ)("apiUpdate",(e,t,s)=>{if("updateStickerSet"===s["@type"])return(0,A.v9P)(e,s.id,s.stickerSet)}),(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateEntities":{const{users:t,chats:a,threadInfos:o,polls:i,webPages:n}=s;t&&(e=(0,A.g18)(e,t)),a&&(e=(0,A.Nl5)(e,a)),o&&(e=(0,A.Ng8)(e,o)),i&&i.forEach(t=>{e=(0,A.J81)(e,t.id,t)}),n&&n.forEach(t=>{e="full"===t.webpageType?(0,A.Cfr)(e,t.id,t):(0,A.o7c)(e,t.id,t)}),(0,w.UF)(e);break}case"updatePeerBlocked":return s.isBlocked?(0,A.P6h)(e,s.id):s.isBlockedFromStories?e:(0,A.OW3)(e,s.id);case"updateResetContactList":e={...e,contactList:{userIds:[]}},(0,w.UF)(e);break;case"updateConfig":t.loadConfig();break;case"updateNewAuthorization":t.loadAuthorizations();break;case"updateFavoriteStickers":t.loadFavoriteStickers();break;case"updateRecentStickers":t.loadRecentStickers();break;case"updateRecentReactions":t.loadRecentReactions();break;case"updateRecentEmojiStatuses":t.loadRecentEmojiStatuses();break;case"updateSavedReactionTags":t.loadSavedReactionTags();break;case"updateMoveStickerSetToTop":{const a=s.isCustomEmoji?e.customEmojis.added.setIds:e.stickers.added.setIds;if(!a?.some(e=>e===s.id))return e;const o=[s.id,...a.filter(e=>e!==s.id)];t.reorderStickerSets({order:o,isCustomEmoji:s.isCustomEmoji});break}case"updateStickerSets":t.loadStickerSets();break;case"updateStickerSetsOrder":{const a=s.order.filter(t=>Boolean(e.stickers.setsById[t]));t.reorderStickerSets({order:a,isCustomEmoji:s.isCustomEmoji});break}case"updateSavedGifs":t.loadSavedGifs();break;case"updatePrivacy":e={...e,settings:{...e.settings,privacy:{...e.settings.privacy,[s.key]:s.rules}}},(0,w.UF)(e);break;case"updatePaymentVerificationNeeded":Object.values(e.byTabId).forEach(({id:t})=>{e=(0,A._te)(e,s.url,t),e=(0,A.lwH)(e,n.tn.ConfirmPayment,t)}),(0,w.UF)(e);break;case"updateWebViewResultSent":Object.values(e.byTabId).forEach(e=>{Object.entries(e.webApps.openedWebApps).forEach(([a,o])=>{o.queryId===s.queryId&&(t.resetDraftReplyInfo({tabId:e.id}),t.closeWebApp({key:a,tabId:e.id}))})});break;case"updateWebPage":{const{webPage:t}=s;e="full"===t.webpageType?(0,A.Cfr)(e,t.id,t):(0,A.o7c)(e,t.id,t),(0,w.UF)(e);break}case"updateStory":e=(0,A.K4v)(e,s.peerId,{[s.story.id]:s.story}),e=(0,A.Gzl)(e,{[s.peerId]:(0,C._bp)(e,s.peerId)}),(0,w.UF)(e);break;case"deleteStory":e=(0,A.ONz)(e,s.peerId,s.storyId),(0,w.UF)(e);break;case"updateReadStories":e=(0,A.Ahb)(e,s.peerId,s.lastReadId),(0,w.UF)(e);break;case"updateSentStoryReaction":{const{peerId:t,storyId:a,reaction:o}=s;if(!(0,C.Msb)(e,t,a))return e;e=(0,A.Xzz)(e,t,a,{sentReaction:o}),(0,w.UF)(e);break}case"updateStealthMode":e=(0,A.qsx)(e,s.stealthMode),(0,w.UF)(e);break;case"updateAttachMenuBots":t.loadAttachBots();break;case"updatePremiumFloodWait":t.processPremiumFloodWait({isUpload:s.isUpload});break;case"updatePaidReactionPrivacy":e={...e,settings:{...e.settings,paidReactionPrivacy:s.private}},(0,w.UF)(e);break;case"updateLangPackTooLong":(0,m.eg)(s.langCode);break;case"updateLangPack":(0,m.DV)(s.version,s.strings,s.keysToRemove);break;case"newMessage":{const o=s.message.content?.action;if(!s.message.isOutgoing&&s.message.chatId!==a.zv8)return;if("starGiftUnique"!==o?.type)return;const i=o.gift;Object.values(e.byTabId).forEach(({id:a})=>{const o=(0,C.nTw)(e,a);if(o.isWaitingForStarGiftUpgrade&&(t.openUniqueGiftBySlug({slug:i.slug,tabId:a}),t.showNotification({title:{key:"GiftUpgradedTitle"},message:{key:"GiftUpgradedDescription"},tabId:a}),t.requestConfetti({withStars:!0,tabId:a}),e=(0,M.w)(e,{isWaitingForStarGiftUpgrade:void 0},a)),o.isWaitingForStarGiftTransfer){const o=s.message.chatId,n=o?(0,C.PVB)(e,o):void 0;n&&(t.focusMessage({chatId:n.id,messageId:s.message.id,tabId:a}),t.showNotification({message:{key:"GiftTransferSuccessMessage",variables:{gift:{key:"GiftUnique",variables:{title:i.title,number:i.number}},peer:(0,S.F9)((0,m.Yw)(),n)}},tabId:a})),t.requestConfetti({withStars:!0,tabId:a}),e=(0,M.w)(e,{isWaitingForStarGiftTransfer:void 0},a),t.reloadPeerSavedGifts({peerId:e.currentUserId})}}),(0,w.UF)(e)}}}),(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateDefaultNotifySettings":return(0,A.p92)(e,s.peerType,s.settings);case"updateChatNotifySettings":{const{chatId:t,settings:a}=s;e=(0,A.m1I)(e,t,a),(0,w.UF)(e);break}case"updateTopicNotifySettings":{const{chatId:t,topicId:a,settings:o}=s;e=(0,A.TwA)(e,t,a,{notifySettings:o}),(0,w.UF)(e);break}}}),(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateTwoFaStateWaitCode":return{...e,twoFaSettings:{...e.twoFaSettings,isLoading:!1,waitingEmailCodeLength:s.length}};case"updateTwoFaError":return{...e,twoFaSettings:{...e.twoFaSettings,errorKey:s.messageKey}}}});var Et=s(80840),Lt=s(71331);(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updateGroupCall":{if("discarded"===s.call.connectionState)return e.groupCalls.activeGroupCallId?void("leaveGroupCall"in t&&t.leaveGroupCall({shouldRemove:!0,tabId:(0,u.g0)()})):(0,Et.um)(e,s.call.id);const a=(0,Lt.Ip)(e,s.call.id),o=a?.chatId;return o&&(e=(0,A.wix)(e,o,{isCallNotEmpty:a.participantsCount>0||Boolean(a.participants?.length)})),(0,Et.h9)(e,s.call.id,(0,h.cJ)(s.call,["connectionState"]),void 0,s.call.participantsCount)}case"updateGroupCallChatId":return(0,C.hds)(e,s.chatId)&&(e=(0,A.ltr)(e,s.chatId,{groupCallId:s.call.id})),e;case"updateGroupCallParticipants":{const{groupCallId:t,participants:a,nextOffset:o}=s,{currentUserId:i}=e;e=(0,w.mS)(),a.forEach(s=>{s.id&&(e=(0,Et.c5)(e,t,s.id,s,Boolean(o)||i===s.id))}),o&&(e=(0,Et.h9)(e,t,{nextOffset:o}));const n=(0,Lt.Ip)(e,t),r=n?.chatId;return r&&(e=(0,A.wix)(e,r,{isCallNotEmpty:n.participantsCount>0||Boolean(n.participants?.length)})),e}case"updatePhoneCall":{if(!d.OL)return;const{phoneCall:a,currentUserId:o}=e,{call:i}=s;if(a)return"discarded"===i.state?(t.playGroupCallSound({sound:"end"}),"hangUp"in t&&t.hangUp({tabId:(0,u.g0)()}),{...e,...i.needRating&&{ratingPhoneCall:i}}):void 0;if(i?.adminId!==o&&"requested"===i.state)return(0,I.aj)(()=>{e=(0,w.mS)();const t=(0,Lt.uu)(e);t&&(0,F.DJ)({call:i,user:t})}),(0,kt.JD)(),(0,kt.re)(e,t,i.isVideo,(0,u.g0)()),e={...e,phoneCall:i},(0,M.w)(e,{isCallPanelVisible:!1},(0,u.g0)())}}});var Ot=s(17142);(0,w.aJ)("apiUpdate",(e,t,s)=>{switch(s["@type"]){case"updatePaymentStateCompleted":{const{paymentState:a,tabId:o}=s,i=a.form,{invoice:n}=i,{totalAmount:r,currency:d}=n,c=a.inputInvoice;if("stars"===c?.type)t.closeStarsBalanceModal({tabId:o}),t.showNotification({message:g.yE("StarsAcquiredInfo",c.stars),title:g.yE("StarsAcquired"),icon:"star",tabId:o}),t.requestConfetti({withStars:!0,tabId:o});else if("giftcode"===c?.type){const s=(0,C.nTw)(e,o).giftModal;s&&c?.userIds[0]===s.forPeerId&&(t.showNotification({message:{key:"GiftSent"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}else t.showNotification({tabId:o,message:g.yE("PaymentInfoHint",[(0,Ot.Ad)(r,d,g.Yw().code),i.title])});(0,w.UF)(e);break}case"updateStarPaymentStateCompleted":{const{paymentState:a,tabId:o}=s,{inputInvoice:i,subscriptionInfo:n,form:r}=a;if("chatInviteSubscription"===i?.type&&n){const e=n.subscriptionPricing.amount;t.showNotification({tabId:o,title:g.yE("StarsSubscriptionCompleted"),message:g.yE("StarsSubscriptionCompletedText",[e,n.title],void 0,e),icon:"star"})}if(r?.invoice.subscriptionPeriod){const e=r.invoice.totalAmount;t.showNotification({tabId:o,title:g.yE("StarsSubscriptionCompleted"),message:g.yE("StarsSubscriptionCompletedText",[e,r.title],void 0,e),icon:"star"})}if("giftcode"===i?.type){if(!i.userIds)return;const s=(0,C.nTw)(e,o).giftModal;s&&i.userIds[0]===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("premiumGiftStars"===i?.type){const s=(0,C.nTw)(e,o).giftModal;s&&i.userId===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("starsgift"===i?.type){if(!i.userId)return;const t=(0,C.nTw)(e,o).starsGiftModal;t?.isOpen&&i.userId===t.forUserId&&(e=(0,M.w)(e,{starsGiftModal:{...t,isCompleted:!0}},o))}if("stargift"===i?.type){if(!i.peerId)return;const s=(0,C.nTw)(e,o).giftModal;s&&i.peerId===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.reloadPeerSavedGifts({peerId:s.forPeerId}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("stargiftResale"===i?.type){const s=(0,C.nTw)(e,o).giftInfoModal;s&&(t.showNotification({message:{key:"StarsGiftBought"},tabId:o}),s.peerId&&t.reloadPeerSavedGifts({peerId:s.peerId}),t.reloadPeerSavedGifts({peerId:i.peerId}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftInfoModal({tabId:o}))}"stargiftUpgrade"===i?.type&&e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId});break}case"updateStarsBalance":e=(0,A.L_F)(e,s.balance),(0,w.UF)(e),t.loadStarStatus()}});var Dt=s(54066);function Yt(e,t){return e={...e,workspaces:{...e.workspaces,...t}},(0,w.UF)(e),e}(0,w.aJ)("openWorkspaceCreator",e=>{Yt(e,{isCreatorOpen:!0,editingWorkspaceId:void 0})}),(0,w.aJ)("openWorkspaceEditor",(e,t,s)=>{Yt(e,{isCreatorOpen:!0,editingWorkspaceId:s?.workspaceId})}),(0,w.aJ)("closeWorkspaceCreator",e=>{Yt(e,{isCreatorOpen:!1,editingWorkspaceId:void 0})}),(0,w.aJ)("createWorkspace",(e,t,s)=>{const{workspace:a}=s;e={...e,workspaces:{...e.workspaces,byId:{...e.workspaces.byId,[a.id]:a},orderedIds:(0,h.Am)([...e.workspaces.orderedIds,a.id])}},(0,w.UF)(e)}),(0,w.aJ)("updateWorkspace",(e,t,s)=>{const{workspace:a}=s;e.workspaces.byId[a.id]&&(e={...e,workspaces:{...e.workspaces,byId:{...e.workspaces.byId,[a.id]:a}}},(0,w.UF)(e))}),(0,w.aJ)("deleteWorkspace",(e,t,s)=>{const{workspaceId:a}=s;if(!e.workspaces.byId[a])return;const{[a]:o,...i}=e.workspaces.byId,n=e.workspaces.orderedIds.filter(e=>e!==a);e={...e,workspaces:{...e.workspaces,byId:i,orderedIds:n,currentWorkspaceId:e.workspaces.currentWorkspaceId===a?Dt.a3:e.workspaces.currentWorkspaceId}},(0,w.UF)(e)}),(0,w.aJ)("setCurrentWorkspace",(e,t,s)=>{const{workspaceId:a}=s;e={...e,workspaces:{...e.workspaces,currentWorkspaceId:a}},(0,w.UF)(e)}),(0,w.aJ)("setExcludeOtherWorkspaces",(e,t,s)=>{const{excludeOtherWorkspaces:a}=s;e={...e,workspaces:{...e.workspaces,excludeOtherWorkspaces:a}},(0,w.UF)(e)});var Gt=s(84051),Vt=s(61433),jt=s(66644),qt=s(87357),Wt=s(25903),Kt=s(55148),zt=s(80089),Ht=s(32625),_t=s(14737),$t=s(30857),Xt=s(2178),Qt=s(39351),Zt=s(17712);const es=document.querySelector('meta[name="viewport"]'),ts=es?.getAttribute("content")||"";function ss(e){e.preventDefault()}var as=s(34201),os=s(35297),is=s(61157),ns=s(60138),rs=s(90423),ds=s(80464),cs=s(20021);const ls=e=>{const{isActive:t}=e,s=(0,ds.A)(zt.ar.Calls,"ActiveCallHeader",!t);return s?(0,cs.Y)(s,{}):void 0},us=e=>{const{groupCallId:t}=e,s=(0,ds.A)(zt.ar.Calls,"GroupCall",!t);return s?(0,cs.Y)(s,{...e}):void 0},hs=e=>{const{isActive:t}=e,s=(0,ds.A)(zt.ar.Calls,"PhoneCall",!t);return s?(0,cs.Y)(s,{}):void 0},ps=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Calls,"RatePhoneCallModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},ms=e=>{const{customEmojiSetIds:t}=e,s=(0,ds.A)(zt.ar.Extra,"CustomEmojiSetsModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},fs=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"DeleteMessageModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},gs=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"StickerSetModal",!t);return s?(0,cs.Y)(s,{...e}):void 0};var Is=s(26120),vs=s(14242),bs=s(74984);const ys=(0,Gt.ph)(({isForAppBadge:e})=>{(0,bs.ic)();const t=(0,Fe.vp)(),s=(0,Qt.A)();if((0,Gt.vJ)(()=>{e&&(0,Is.q)(t)},[e,t]),!e&&t)return(0,cs.Y)("div",{className:"unread-count active",children:(0,vs.Vw)(s,t)})});var Ss=s(11778),ws=s(31460),As=s(55994),Ms=s(31880),Cs=s(29886),Ps=s(41257),ks=s(41036),Fs=s(52745);const Ts=e=>{const t=(0,ds.A)(zt.ar.Extra,"ArchivedChats");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})};var Us=s(11462),xs=s(59030),Bs=s(50680),Rs=s(64493),Js=s(18276),Ns=s(71429),Es=s(24433);const Ls=({isShown:e,onNewPrivateChat:t,onNewChannel:s,onNewGroup:a,isAccountFrozen:o})=>{const[i,n]=(0,Gt.J0)(!1),{openFrozenAccountModal:r}=(0,w.ko)();(0,Gt.vJ)(()=>{e||n(!1)},[e]);const d=(0,xs.A)(),c=(0,qt.A)("NewChatButton",e&&"revealed",i&&"menu-is-open"),l=(0,Gt.hb)(()=>{o?r():n(!i)},[i,o]),u=(0,Gt.hb)(()=>{n(!1)},[]),h=(0,Gt.Kr)(()=>(0,cs.FD)(cs.FK,{children:[(0,cs.Y)(Es.A,{icon:"channel",onClick:s,children:d("NewChannel")}),(0,cs.Y)(Es.A,{icon:"group",onClick:a,children:d("NewGroup")}),(0,cs.Y)(Es.A,{icon:"user",onClick:t,children:d("NewMessageTitle")})]}),[d,s,a,t]);return(0,cs.FD)("div",{className:c,dir:d.isRtl?"rtl":void 0,children:[(0,cs.FD)(Rs.A,{round:!0,color:"primary",className:i?"active":"",onClick:l,ariaLabel:d(i?"Close":"NewMessageTitle"),tabIndex:-1,children:[(0,cs.Y)(Js.A,{name:"new-chat-filled"}),(0,cs.Y)(Js.A,{name:"close"})]}),(0,cs.Y)(Ns.A,{isOpen:i,positionX:d.isRtl?"left":"right",positionY:"bottom",autoClose:!0,onClose:u,children:h})]})},Os=e=>{const t=(0,ds.A)(zt.ar.Extra,"LeftSearch");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})};var Ds=s(50442),Ys=s(79824),Gs=s(18501),Vs=s(19129),js=s(26072),qs=s(24680),Ws=s(51067);const Ks=(0,Gt.ph)((0,w.EK)(e=>{const{chatFolders:{byId:t,orderedIds:s,invites:a},chats:{listIds:{archived:o}},stories:{orderedPeerIds:{archived:i}},activeSessions:{byHash:n},currentUserId:r,archiveSettings:d,focusMode:c}=e,{animationLevel:l}=(0,je.l)(e),{shouldSkipHistoryAnimations:u,activeChatFolder:h}=(0,C.nTw)(e),{storyViewer:{isRibbonShown:p}}=(0,C.nTw)(e),m=(0,C.trm)(e);return{chatFoldersById:t,folderInvitesById:a,orderedFolderIds:s,activeChatFolder:h,currentUserId:r,animationLevel:l,shouldSkipHistoryAnimations:u,hasArchivedChats:Boolean(o?.length),hasArchivedStories:Boolean(i?.length),maxFolders:(0,ge.d)(e,"dialogFilters"),maxFolderInvites:(0,ge.d)(e,"chatlistInvites"),maxChatLists:(0,ge.d)(e,"chatlistJoined"),archiveSettings:d,isStoryRibbonShown:p,sessions:n,isAccountFrozen:m,focusMode:c,currentWorkspace:(0,Dt.XK)(e),currentWorkspaceId:(0,Dt.C9)(e),excludeOtherWorkspaces:(0,Dt.fw)(e),allWorkspaces:(0,Dt.Vj)(e)}})(({foldersDispatch:e,chatFoldersById:t,orderedFolderIds:s,activeChatFolder:o,currentUserId:i,isForumPanelOpen:r,animationLevel:c,shouldSkipHistoryAnimations:l,maxFolders:u,maxChatLists:h,shouldHideFolderTabs:p,folderInvitesById:m,maxFolderInvites:f,hasArchivedChats:g,hasArchivedStories:I,archiveSettings:v,isStoryRibbonShown:b,sessions:y,isAccountFrozen:S,focusMode:A,currentWorkspace:M,currentWorkspaceId:P,excludeOtherWorkspaces:k,allWorkspaces:F})=>{const{loadChatFolders:T,setActiveChatFolder:U,openChat:x,openShareChatFolderModal:B,openDeleteChatFolderModal:R,openEditChatFolder:J,openLimitReachedModal:N,markChatMessagesRead:E,openSettingsScreen:L}=(0,w.ko)(),O=(0,Gt.li)(),D=(0,Qt.A)();(0,Gt.vJ)(()=>{T()},[]);const{ref:Y,shouldRender:G,getIsClosing:V}=(0,as.A)({isOpen:b,className:!1,withShouldRender:!0}),j=((0,Vs.A)(V),(0,Zt.A)(()=>{const e=Y.current?.querySelector(".chat-list.Transition_slide-active");e?.scrollTo({top:0,behavior:"smooth"})})),q=(0,Gt.Kr)(()=>({id:a.DSF,title:{text:s?.[0]===a.DSF?D("FilterAllChatsShort"):D("FilterAllChats")},includedChatIds:Ys.p,excludedChatIds:Ys.p}),[s,D]),W=(0,Gt.Kr)(()=>{if(s)return s.map(e=>{if(e===a.DSF&&P===Dt.a3)return q;if(P===Dt.a3&&k&&F.some(t=>t.foldersIds.includes(e)))return null;const s=t[e]||q;return s&&(P===Dt.a3||M.foldersIds.includes(e))?s:null}).filter(Boolean)},[t,q,s,P,M.foldersIds,k,F]),K=W?.findIndex(e=>e.id===a.DSF),z=K===o,H=0===o,_=(0,bs.Jm)(),$=(0,Zt.A)(e=>{const t=_[e];t?.length&&t.forEach(e=>{E({id:e})})}),X=(0,bs.ic)(),Q=(0,Gt.Kr)(()=>{if(P!==Dt.a3||!k)return X;const e=F.flatMap(e=>e.foldersIds),t={...X},s=_[a.DSF];if(s){const o=s.filter(t=>!e.some(e=>(0,Fe.YA)(e)?.includes(t)));t[a.DSF]&&(t[a.DSF]={...t[a.DSF],chatsCount:o.length})}return t},[X,P,k,F,_]),Z=(0,Gt.Kr)(()=>{if(W&&W.length)return W.map((e,s)=>{const{id:o,title:i}=e,r=o!==a.DSF&&s>u-1,d=[];return(0,C.w5O)((0,w.mS)(),o)&&d.push({title:D("FilterShare"),icon:"link",handler:()=>{Object.values(t).reduce((e,t)=>e+(t.isChatList?1:0),0)>=h&&!e.isChatList?N({limit:"chatlistJoined"}):m[o]?.length>=f?N({limit:"chatlistInvites"}):B({folderId:o})}}),o===a.DSF?(d.push({title:D("FilterEditFolders"),icon:"edit",handler:()=>{L({screen:n.VS.Folders})}}),_[o]?.length&&d.push({title:D("ChatListMarkAllAsRead"),icon:"readchats",handler:()=>$(e.id)})):(d.push({title:D("EditFolder"),icon:"edit",handler:()=>{J({folderId:o})}}),_[o]?.length&&d.push({title:D("ChatListMarkAllAsRead"),icon:"readchats",handler:()=>$(e.id)}),d.push({title:D("FilterMenuDelete"),icon:"delete",destructive:!0,handler:()=>{R({folderId:o})}})),{id:o,title:(0,Gs.fd)({text:i.text,entities:i.entities,noCustomEmojiPlayback:e.noTitleAnimations}),badgeCount:A?0:Q[o]?.chatsCount,isBadgeActive:!A&&Boolean(Q[o]?.notificationsCount),isBlocked:r,contextActions:d?.length?d:void 0}})},[W,u,Q,D,t,h,m,f,_,L,A]),ee=(0,Zt.A)(e=>{U({activeChatFolder:e},{forceOnHeavyAnimation:!0}),o===e&&j()});(0,Gt.vJ)(()=>{Z?.length&&o>=Z.length&&U({activeChatFolder:0})},[o,Z,U]),(0,Gt.vJ)(()=>{if(d.TF&&Z?.length&&!r)return(0,Ds.wJ)(O.current,{selectorToPreventScroll:".chat-list",onSwipe:(e,t)=>t===Ds.ez.Left?(U({activeChatFolder:Math.min(o+1,Z.length-1)},{forceOnHeavyAnimation:!0}),!0):t===Ds.ez.Right&&(U({activeChatFolder:Math.max(0,o-1)},{forceOnHeavyAnimation:!0}),!0)})},[o,Z,r,U]);const te=(0,Gt.li)();te.current=!H,(0,Gt.vJ)(()=>te.current?(0,Ss.A)(()=>{te.current&&U({activeChatFolder:0})}):void 0,[o,U]),(0,js.A)({isActive:!H,onBack:()=>U({activeChatFolder:0},{forceOnHeavyAnimation:!0})}),(0,Gt.vJ)(()=>{const e=e=>{if(e.ctrlKey&&e.shiftKey&&e.code.startsWith("Digit")&&Z){const[,t]=e.code.match(/Digit(\d)/)||[];if(!t)return;if("0"===t)return void x({id:i,shouldReplaceHistory:!0});const s=Number(t)-1;if(s>Z.length-1)return;U({activeChatFolder:s},{forceOnHeavyAnimation:!0}),e.preventDefault()}};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[i,Z,x,U]);const{ref:se,shouldRender:ae}=(0,as.A)({isOpen:!s,noMountTransition:!0,withShouldRender:!0}),oe=Z&&Z.length>1;return(0,cs.FD)("div",{ref:Y,className:(0,qt.A)("ChatFolders",oe&&p&&"ChatFolders--tabs-hidden",G&&"with-story-ribbon"),children:[oe?(0,cs.Y)(qs.A,{contextRootElementSelector:"#LeftColumn",tabs:Z,activeTab:o,onSwitchTab:ee}):ae?(0,cs.Y)("div",{ref:se,className:"tabs-placeholder"}):void 0,(0,cs.Y)(ks.Ay,{ref:O,name:(0,ws.P)("slideOptimized",c,l,D.isRtl),activeKey:o,renderCount:oe?Z.length:void 0,children:function(s){const a=Object.values(t).find(({id:e})=>e===Z[o].id),i=a&&!z;return(0,cs.Y)(Ws.A,{folderType:i?"folder":"all",folderId:i?a.id:void 0,isActive:s,isForumPanelOpen:r,foldersDispatch:e,isMainList:!0,canDisplayArchive:(g||I)&&!v.isHidden,archiveSettings:v,sessions:y,isAccountFrozen:S,withTags:!0},`${P}-${o}`)}})]})})),zs=e=>{const t=(0,ds.A)(zt.ar.Extra,"ContactList");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})};var Hs=s(90054),_s=s(76786),$s=s(37661),Xs=s(24920),Qs=s(10187),Zs=s(22699),ea=s(36393),ta=s(26607),sa=s(57474);const aa=(0,Gt.ph)(({connectionStatus:e,connectionStatusText:t,onClick:s})=>{const a=(0,xs.A)();return(0,cs.FD)("div",{id:"ConnectionStatusOverlay",dir:a.isRtl?"rtl":void 0,onClick:s,children:[(0,cs.Y)(sa.A,{color:"black"}),(0,cs.Y)("div",{className:"state-text",children:(0,cs.Y)(ks.Ay,{activeKey:e,name:"slideFade",children:t})}),(0,cs.Y)(Rs.A,{round:!0,size:"tiny",color:"translucent-black",children:(0,cs.Y)(Js.A,{name:"close"})})]})});var oa=s(54639),ia=s(60859),na=s(63152),ra=s(629),da=s(4350),ca=s(93855),la=s(21849),ua=s(34431);const ha=(0,Gt.ph)(({currentUser:e,totalLimit:t,onSelectCurrent:s})=>{const{showNotification:a}=(0,w.ko)(),o=(0,Qt.A)(),i=(0,ca.A)(e),n=(0,y.Em)(),r=(0,y.SM)(),d=(0,Gt.Kr)(()=>Object.values(i).find(t=>t.userId===e.id),[i,e.id]),c=n>=r,l=(0,Zt.A)(()=>{a({title:o("PremiumLimitAccountsTitle"),message:e.isPremium?o("PremiumLimitAccounts"):o("PremiumLimitAccountsNoPremium"),duration:7e3})}),u=(0,Gt.Kr)(()=>{if(!Object.values(i).length)return;if(n===t)return;let e=1;for(;i[e];)e+=1;return(0,da.Nv)(e,!0)},[i,n,t]);return(0,cs.FD)(cs.FK,{children:[Object.entries(i||{}).sort(([,t])=>t.userId===e.id?-1:1).map(([t,a],o,i)=>{const n=a.isTest===d?.isTest,r={title:[a.firstName,a.lastName].filter(Boolean).join(" "),isCustomPeer:!0,peerColorId:a.color,emojiStatusId:n?a.emojiStatusId:void 0,isPremium:a.isPremium},c=a.userId===e.id&&(u||i.length>1);return(0,cs.FD)(cs.FK,{children:[(0,cs.FD)(Es.A,{className:"account-menu-item",customIcon:(0,cs.Y)(la.A,{size:"mini",className:"account-avatar",peer:r,previewUrl:a.avatarUri}),onClick:a.userId===e.id?s:void 0,href:a.userId!==e.id?(0,da.Nv)(Number(t)):void 0,children:[a.isTest&&(0,cs.Y)("span",{className:"account-menu-item-test",children:"T"}),(0,cs.Y)(ua.A,{peer:r,withEmojiStatus:!0,emojiStatusSize:x.$})]}),c&&(0,cs.Y)(ia.A,{})]})}),u&&(0,cs.Y)(Es.A,{icon:"add",rel:"noopener",href:c?void 0:u,onClick:c?l:void 0,children:o("MenuAddAccount")})]})}),pa=(0,Gt.ph)((0,w.EK)(e=>{const{currentUserId:t,archiveSettings:s,focusMode:a}=e,{animationLevel:o}=(0,je.l)(e),i=e.attachMenu.bots;return{currentUserId:t,currentUser:(0,C.mBe)(e,t),theme:(0,C.SJA)(e),animationLevel:o,archiveSettings:s,attachBots:i,accountsTotalLimit:(0,ge.B)(e,"moreAccounts"),focusMode:a}})(({archiveSettings:e,animationLevel:t,theme:s,attachBots:o,currentUser:i,accountsTotalLimit:n,focusMode:r,onSelectArchived:d,onSelectContacts:c,onSelectSettings:l,onBotMenuOpened:u,onBotMenuClosed:h})=>{const{setSharedSettingOption:p,updatePerformanceSettings:m,setFocusMode:f}=(0,w.ko)(),g=(0,Qt.A)(),I=t!==a.dnp?t===a.zP3?"max":"mid":"min",v=(0,bs.ic)()[a._E9]?.chatsCount||0,b=(0,Gt.Kr)(()=>Object.values(o).filter(e=>e.isForSideMenu),[o]),y=(0,Zt.A)(e=>{e.stopPropagation(),p({theme:"light"===s?"dark":"light"}),p({shouldUseSystemTheme:!1})}),S=(0,Zt.A)(e=>{e.stopPropagation();let s=t+1;s>a.zP3&&(s=a.dnp);const o=s===a.dnp?xt.PI:s===a.zP3?xt.LH:xt.tS;p({animationLevel:s,wasAnimationLevelSetManually:!0}),m(o)}),A=(0,Zt.A)(()=>{window.open(a.qGQ,"_blank","noopener,noreferrer")}),M=(0,Zt.A)(e=>{e.stopPropagation(),f(r?"noDistraction"!==r?{mode:void 0}:{mode:"deepWork"}:{mode:"noDistraction"})});return(0,cs.FD)(cs.FK,{children:[gt.vM&&i&&(0,cs.FD)(cs.FK,{children:[(0,cs.Y)(ha,{currentUser:i,totalLimit:n,onSelectCurrent:l}),(0,cs.Y)(ia.A,{})]}),e.isHidden&&(0,cs.FD)(Es.A,{icon:"archive",onClick:d,children:[(0,cs.Y)("span",{className:"menu-item-name",children:g("MenuArchivedChats")}),v>0&&(0,cs.Y)("div",{className:"right-badge",children:v})]}),(0,cs.Y)(Es.A,{icon:"group",onClick:c,children:g("MenuContacts")}),b.map(e=>(0,cs.Y)(oa.A,{bot:e,theme:s,isInSideMenu:!0,canShowNew:!0,onMenuOpened:u,onMenuClosed:h})),(0,cs.Y)(Es.A,{icon:"settings",onClick:l,children:g("MenuSettings")}),(0,cs.FD)(Es.A,{icon:"darkmode",onClick:y,children:[(0,cs.Y)("span",{className:"menu-item-name",children:g("MenuNightMode")}),(0,cs.Y)(na.A,{id:"darkmode",label:g("dark"===s?"AriaMenuDisableNightMode":"AriaMenuEnableNightMode"),checked:"dark"===s,noAnimation:!0})]}),(0,cs.FD)(Es.A,{icon:"mute",onClick:M,children:[(0,cs.Y)("span",{className:"menu-item-name",children:g("MenuFocusMode")}),(0,cs.Y)(ra.A,{value:(e=>e?"noDistraction"===e?"mid":"max":"min")(r)})]}),(0,cs.FD)(Es.A,{icon:"animations",onClick:S,children:[(0,cs.Y)("span",{className:"menu-item-name capitalize",children:g("MenuAnimationsSwitch")}),(0,cs.Y)(ra.A,{value:I})]}),a.Cmz&&(0,cs.Y)(Es.A,{icon:"permissions",onClick:A,children:g("MenuBetaChangelog")})]})}));var ma=s(82117),fa=s(87412),ga=s(95773),Ia=s(9267),va=s(83594);const ba=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"StatusPickerMenu",!t);return s?(0,cs.Y)(s,{...e}):void 0},ya=(0,Gt.ph)((0,w.EK)(e=>{const{currentUserId:t}=e,s=t?(0,C.mBe)(e,t):void 0,a=e.collectibleEmojiStatuses?.statuses,o=(0,C.trm)(e);return{emojiStatus:s?.emojiStatus,collectibleStatuses:a,isAccountFrozen:o}})(({emojiStatus:e,collectibleStatuses:t,isAccountFrozen:s})=>{const{setEmojiStatus:o,loadCurrentUser:i,openFrozenAccountModal:n}=(0,w.ko)(),r=(0,Gt.li)(),[d,c,l]=(0,$s.A)(!1),[u,h,p]=(0,$s.A)(!1),[m,f,g]=(0,$s.A)(!1),{isMobile:I}=(0,D.Ay)(),b="collectible"===e?.type?e:void 0,y=e?.until?1e3*(e.until-(0,v.Fm)()):void 0;(0,_t.A)(i,y),(0,ma.A)(([t])=>{d&&e&&e.documentId!==t?.documentId&&(h(),l())},[e,d,h,l]);const S=(0,Gt.hb)(e=>{const s=t?.find(t=>"collectibleId"in t&&t.documentId===e.id);c(),o({emojiStatus:s||{type:"regular",documentId:e.id}})},[c,o,t]);(0,_t.A)(p,u?1500:void 0);const A=(0,Gt.hb)(()=>{s?n():f()},[f,s]);return(0,cs.FD)("div",{className:"StatusButton extra-spacing",children:[Boolean(u&&e)&&(0,cs.Y)(va.A,{reaction:e,isLottie:!0,className:"emoji-status-effect"}),(0,cs.Y)(Rs.A,{round:!0,ref:r,ripple:!I,size:"smaller",color:"translucent",className:"emoji-status",onClick:A,children:e?(0,cs.Y)(ga.A,{withSparkles:Boolean(b),sparklesClassName:"statusSparkles",sparklesColor:b?.textColor,children:(0,cs.Y)(fa.A,{documentId:e.documentId,size:24,loopLimit:a.J$1},e.documentId)}):(0,cs.Y)(Ia.A,{})}),(0,cs.Y)(ba,{statusButtonRef:r,isOpen:m,onEmojiStatusSelect:S,onClose:g})]})})),Sa={date:void 0},wa={id:void 0},Aa=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{query:s,fetchingStatus:a,chatId:o,minDate:i}=t.globalSearch,{connectionState:n,isSyncing:r,isFetchingDifference:d}=e,{isConnectionStatusMinimized:c}=(0,je.l)(e);return{searchQuery:s,isLoading:!!a&&Boolean(a.chats||a.messages||a.publicPosts),globalSearchChatId:o,searchDate:i,theme:(0,C.SJA)(e),connectionState:n,isSyncing:r,isFetchingDifference:d,isMessageListOpen:Boolean((0,C.Xf0)(e)),isConnectionStatusMinimized:c,isCurrentUserPremium:(0,C.g29)(e),areChatsLoaded:Boolean(e.chats.listIds.active),hasPasscode:Boolean(e.passcode.hasPasscode),canSetPasscode:(0,C.Ntz)(e)}})(({shouldHideSearch:e,content:t,contactsFilter:s,isClosingSearch:o,searchQuery:i,isLoading:r,isCurrentUserPremium:c,shouldSkipTransition:l,globalSearchChatId:u,searchDate:h,theme:p,connectionState:m,isSyncing:f,isFetchingDifference:g,isMessageListOpen:I,isConnectionStatusMinimized:v,areChatsLoaded:b,hasPasscode:y,canSetPasscode:S,onSearchQuery:A,onSelectSettings:M,onSelectContacts:C,onSelectArchived:P,onReset:k})=>{const{setGlobalSearchDate:F,setSharedSettingOption:T,setGlobalSearchChatId:U,lockScreen:x,openSettingsScreen:B,searchMessagesGlobal:R}=(0,w.ko)(),J=(0,xs.A)(),N=(0,Qt.A)(),{isMobile:E}=(0,D.Ay)(),[L,O,Y]=(0,$s.A)(),G=(n.Bn.Contacts,t===n.Bn.ChatList),V=(0,Gt.Kr)(()=>h?(0,Se.A)(new Date(1e3*h)):void 0,[h]),{connectionStatus:j,connectionStatusText:q,connectionStatusPosition:W}=(0,_s.A)(J,m,f||g,I,v,!b),K=(0,Zt.A)(e=>{e.preventDefault(),e.stopPropagation(),y?x():B({screen:n.VS.PasscodeDisabled})});(0,Xt.v)((0,Gt.Kr)(()=>S?{"Ctrl+Shift+L":K,"Alt+Shift+L":K,"Meta+Shift+L":K,...d.lE&&{"Mod+L":K}}:void 0,[S]));const z=(0,Gt.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,cs.Y)(Rs.A,{round:!0,ripple:G&&!E,size:"smaller",color:"translucent",className:t?"active":"",onClick:G?e:()=>k(),ariaLabel:G?J("AccDescrOpenMenu2"):"Return to chat list",children:(0,cs.Y)("div",{className:(0,qt.A)("animated-menu-icon",!G&&"state-back",l&&"no-animation")})}),[G,E,J,k,l]),H=(0,Zt.A)(()=>{i||A("")}),_=(0,Zt.A)(()=>{T({isConnectionStatusMinimized:!v})}),$=(0,Zt.A)(()=>{x()}),X=(0,Zt.A)(()=>{i&&t===n.Bn.GlobalSearch&&R({type:"publicPosts",shouldResetResultsByType:!0})}),Q=Boolean(u)||t===n.Bn.GlobalSearch||t===n.Bn.Contacts,Z=E?!I&&Q:Q;(0,Gt.vJ)(()=>Z?(0,Ss.A)(()=>k()):void 0,[Z,k]);const ee=t===n.Bn.Contacts?N("SearchFriends"):N("Search"),te=a.Cmz?"12.0.2 Beta (master#398a2f8)":a.Oig?"master#398a2f8":"12.0.2",se=(0,rs.zk)(),{shouldDisableDropdownMenuTransitionRef:ae,handleDropdownMenuTransitionEnd:oe}=(0,Xs.A)(e),ie=(0,Gt.Kr)(()=>(0,cs.FD)(cs.FK,{children:[V&&(0,cs.Y)(Qs.A,{icon:"calendar",title:V,canClose:!0,isMinimized:Boolean(u),className:"left-search-picker-item",onClick:F,isCloseNonDestructive:!0,clickArg:Sa}),u&&(0,cs.Y)(Qs.A,{className:"left-search-picker-item",peerId:u,onClick:U,canClose:!0,isMinimized:!0,clickArg:wa})]}),[u,V]),ne=(0,Gt.Kr)(()=>{let e="";return gt.Vq&&window.tauri.version&&(e=`Tauri ${window.tauri.version} | `),e+=`${a.C39} ${te}`,e},[te]);return(0,cs.Y)("div",{className:"LeftMainHeader",children:(0,cs.FD)("div",{id:"LeftMainHeader",className:"left-header","data-tauri-drag-region":!(!gt.Vq||!d.MP)||void 0,children:[J.isRtl&&(0,cs.Y)("div",{className:"DropdownMenuFiller"}),(0,cs.Y)(Zs.A,{trigger:z,footer:ne,className:(0,qt.A)("main-menu",J.isRtl&&"rtl",e&&J.isRtl&&"right-aligned",ae.current&&J.isRtl&&"disable-transition"),forceOpen:L,positionX:e&&J.isRtl?"right":"left",transformOriginX:gt.Vq&&d.MP&&!se?90:void 0,onTransitionEnd:J.isRtl?oe:void 0,children:(0,cs.Y)(pa,{onSelectArchived:P,onSelectContacts:C,onSelectSettings:M,onBotMenuOpened:O,onBotMenuClosed:Y})}),(0,cs.Y)(ea.A,{inputId:"telegram-search-input",resultsItemSelector:".LeftSearch .ListItem-button",className:(0,qt.A)(u||h?"with-picker-item":void 0,e&&"SearchInput--hidden"),value:o?void 0:s||i,focused:Z,isLoading:r||"minimized"===W,spinnerColor:"minimized"===W?"yellow":void 0,spinnerBackgroundColor:"minimized"===W&&"light"===p?"light":void 0,placeholder:ee,autoComplete:"off",canClose:Boolean(u||h),onChange:A,onReset:k,onFocus:H,onSpinnerClick:"minimized"===W?_:void 0,onEnter:X,children:ie}),c&&(0,cs.Y)(ya,{}),y&&(0,cs.Y)(Rs.A,{round:!0,ripple:!E,size:"smaller",color:"translucent",ariaLabel:`${J("ShortcutsController.Others.LockByPasscode")} (Ctrl+Shift+L)`,onClick:$,className:(0,qt.A)(!c&&"extra-spacing"),children:(0,cs.Y)(Js.A,{name:"lock"})}),(0,cs.Y)(ta.A,{isOpen:"overlay"===W,isCustom:!0,className:"connection-state-wrapper",children:(0,cs.Y)(aa,{connectionStatus:j,connectionStatusText:q,onClick:_})})]})})}));var Ma=s(19926);const Ca=(0,Gt.ph)(({workspace:e,currentUser:t,size:s,isRectangular:a=!0})=>e.id===Dt.a3?(0,cs.Y)(la.A,{isRectangular:a,peer:t,size:s}):(0,cs.Y)(la.A,{isRectangular:a,size:s,text:e.name})),Pa=(0,Gt.ph)((0,w.EK)(e=>({currentUser:(0,Ma.mB)(e,e.currentUserId),allWorkspaces:(0,Dt.Vj)(e),currentWorkspace:(0,Dt.XK)(e),excludeOtherWorkspaces:(0,Dt.fw)(e)}))(({currentUser:e,allWorkspaces:t,currentWorkspace:s,excludeOtherWorkspaces:a})=>{const{openWorkspaceCreator:o,openWorkspaceEditor:i,setActiveChatFolder:n,setCurrentWorkspace:r,setExcludeOtherWorkspaces:d}=(0,w.ko)(),c=(0,Gt.hb)(e=>{r({workspaceId:e.id}),n({activeChatFolder:0},{forceOnHeavyAnimation:!0})},[r,n]),l=(0,Gt.hb)(()=>{o()},[o]),u=(0,Gt.hb)(e=>{e.stopPropagation(),d({excludeOtherWorkspaces:!a})},[a,d]),h=(0,Gt.hb)(({onTrigger:t,isOpen:a})=>(0,cs.FD)("div",{onClick:t,className:(0,qt.A)("WorkspaceManager-trigger",a&&"active"),children:[(0,cs.Y)(Ca,{workspace:s,currentUser:e,size:"tiny"}),s.name]},s.id),[s,e]);return(0,cs.FD)(Zs.A,{className:"WorkspaceManager-dropdown",trigger:h,positionX:"left",children:[t.map(t=>(0,cs.FD)(Es.A,{onClick:()=>c(t),className:"WorkspaceManager-workspace",customIcon:(0,cs.Y)(Ca,{workspace:t,currentUser:e,size:"mini"}),children:[t.name,t.id===s.id&&(0,cs.Y)(Js.A,{name:"check"})]},t.id)),(0,cs.Y)(ia.A,{}),(0,cs.Y)(Es.A,{icon:"add",onClick:l,children:"New Workspace"}),s.id!==Dt.a3&&(0,cs.Y)(Es.A,{icon:"settings",onClick:()=>i({workspaceId:s.id}),children:"Workspace settings"}),s.id===Dt.a3&&t.length>1&&(0,cs.FD)(Es.A,{className:"WorkspaceManager-excludeOther",onClick:u,children:[(0,cs.Y)(na.A,{checked:a,label:"Exclude folders and chats from other workspaces"}),"Exclude others"]})]})})),ka=(0,Gt.ph)((0,w.EK)(e=>{const t=e.currentUserId,s=(0,C.meB)(e),a=(0,C.hds)(e,t)?.unreadCount;return{currentUserId:t,isActive:!!s&&s.id===t,savedMesagesUnreadCount:a}})(({currentUserId:e,isActive:t,savedMesagesUnreadCount:s})=>{const{openChat:a,focusLastMessage:o}=(0,w.ko)();return(0,cs.FD)("div",{onClick:()=>{a({id:e}),o()},className:(0,qt.A)("SavedMessages-trigger",t&&"active"),children:[(0,cs.Y)(Js.A,{name:"saved-messages"}),"Saved",void 0!==s&&0!==s&&(0,cs.Y)("span",{className:"count",children:s})]})}));var Fa=s(97768);const Ta=(0,Gt.ph)(()=>(0,cs.FD)("div",{className:"CustomButtons",children:[(0,cs.Y)("div",{className:"workspace-manager",children:(0,cs.Y)(Pa,{})}),(0,cs.Y)(ka,{}),(0,cs.Y)(Fa.A,{})]})),Ua=Object.keys(n.Bn).length/2;let xa;const Ba=(0,Gt.ph)(({content:e,searchQuery:t,searchDate:s,isClosingSearch:o,contactsFilter:i,shouldSkipTransition:r,foldersDispatch:c,isAppUpdateAvailable:l,isForumPanelOpen:u,onSearchQuery:h,onReset:p,onTopicSearch:m,isAccountFrozen:f})=>{const{closeForumPanel:g,openLeftColumnContent:I}=(0,w.ko)(),[v,b]=(0,Gt.J0)(d.TF),[y,S]=(0,Gt.J0)(),[A,M]=(0,Gt.J0)(!1),{shouldRenderForumPanel:C,handleForumPanelAnimationEnd:P,handleForumPanelAnimationStart:k,isAnimationStarted:F}=(0,Us.A)(u),T=u&&e===n.Bn.ChatList,U=T&&F,{shouldRender:x,transitionClassNames:B}=(0,Bs.A)(l||Boolean(y)),R=(0,Gt.li)(!1),J=(0,Zt.A)(()=>{e===n.Bn.ChatList&&(R.current=!0,b(!0))}),N=(0,Zt.A)(()=>{R.current=!1,xa&&(clearTimeout(xa),xa=void 0),xa=window.setTimeout(()=>{R.current||b(!1)},250)}),E=(0,Zt.A)(()=>{I({contentKey:n.Bn.Settings})}),L=(0,Zt.A)(()=>{I({contentKey:n.Bn.Contacts})}),O=(0,Zt.A)(()=>{I({contentKey:n.Bn.Archived}),g()}),D=(0,Zt.A)(async()=>{if(y)try{M(!0),await y.downloadAndInstall(),M(!1),await(window.tauri?.relaunch())}catch(e){console.error("Failed to download and install Tauri update",e)}finally{M(!1)}else window.location.reload()}),Y=(0,Zt.A)(()=>{I({contentKey:n.Bn.NewChannelStep1})}),G=(0,Zt.A)(()=>{I({contentKey:n.Bn.NewGroupStep1})});(0,Gt.vJ)(()=>{let t;return e!==n.Bn.ChatList?t=window.setTimeout(()=>{b(!1)},250):(R.current||d.TF)&&b(!0),()=>{t&&(clearTimeout(t),t=void 0)}},[e]);const V=(0,Zt.A)(()=>{window.tauri?.checkUpdate().then(e=>S(e??void 0)).catch(e=>{console.error("Tauri update check failed:",e)})});(0,Gt.vJ)(()=>{V()},[]),(0,Ht.A)(V,gt.Vq&&!a.Oig?6e5:void 0);const j=(0,xs.A)();return(0,cs.FD)("div",{id:"LeftColumn-main",onMouseEnter:d.TF?void 0:J,onMouseLeave:d.TF?void 0:N,children:[(0,cs.Y)(Aa,{shouldHideSearch:U,content:e,contactsFilter:i,onSearchQuery:h,onSelectSettings:E,onSelectContacts:L,onSelectArchived:O,onReset:p,shouldSkipTransition:r,isClosingSearch:o}),(0,cs.Y)(Ta,{}),(0,cs.Y)(ks.Ay,{name:r?"none":"zoomFade",renderCount:Ua,activeKey:e,shouldCleanup:!0,cleanupExceptionKey:n.Bn.ChatList,shouldWrap:!0,wrapExceptionKey:n.Bn.ChatList,children:a=>{switch(e){case n.Bn.ChatList:return(0,cs.Y)(Ks,{shouldHideFolderTabs:U,foldersDispatch:c,isForumPanelOpen:U});case n.Bn.GlobalSearch:return(0,cs.Y)(Os,{searchQuery:t,searchDate:s,isActive:a,onReset:p});case n.Bn.Contacts:return(0,cs.Y)(zs,{filter:i,isActive:a,onReset:p});default:return}}}),x&&(0,cs.Y)(Rs.A,{fluid:!0,badge:!0,className:(0,qt.A)("btn-update",B),onClick:D,isLoading:A,children:j("lng_update_telegram")}),C&&(0,cs.Y)(Hs.A,{isOpen:u,isHidden:!T,onTopicSearch:m,onOpenAnimationStart:k,onCloseAnimationEnd:P}),(0,cs.Y)(Ls,{isShown:v,onNewPrivateChat:L,onNewChannel:Y,onNewGroup:G,isAccountFrozen:f})]})}),Ra=e=>{const t=(0,ds.A)(zt.ar.Extra,"NewChat");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})},Ja=e=>{const t=(0,ds.A)(zt.ar.Extra,"Settings");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})};var Na=function(e){return e[e.Main=0]="Main",e[e.Settings=1]="Settings",e[e.Archived=2]="Archived",e[e.NewGroup=3]="NewGroup",e[e.NewChannel=4]="NewChannel",e}(Na||{});const Ea=Object.keys(Na).length/2,La=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{globalSearch:{query:s,minDate:a},shouldSkipHistoryAnimations:o,activeChatFolder:i,leftColumn:n,nextFoldersAction:r,storyViewer:{isArchivedRibbonShown:d}}=t,{currentUserId:c,passcode:{hasPasscode:l},isAppUpdateAvailable:u,archiveSettings:h}=e,{animationLevel:p}=(0,je.l)(e),m=(0,C.meB)(e),f=Boolean(m?.id),g=(0,C.clw)(e),I=t.forumPanelChatId,v=(0,C.trm)(e);return{searchQuery:s,searchDate:a,isFirstChatFolderActive:0===i,animationLevel:p,shouldSkipHistoryAnimations:o,currentUserId:c,hasPasscode:l,nextFoldersAction:r,isChatOpen:f,isAppUpdateAvailable:u,isForumPanelOpen:g,forumPanelChatId:I,isClosingSearch:t.globalSearch.isClosing,archiveSettings:h,isArchivedStoryRibbonShown:d,isAccountFrozen:v,contentKey:n.contentKey,settingsScreen:n.settingsScreen}})(function({ref:e,contentKey:t,settingsScreen:s,searchQuery:a,searchDate:o,isFirstChatFolderActive:i,animationLevel:r,shouldSkipHistoryAnimations:c,currentUserId:l,hasPasscode:u,nextFoldersAction:h,isChatOpen:p,isAppUpdateAvailable:m,isForumPanelOpen:f,forumPanelChatId:g,isClosingSearch:I,archiveSettings:v,isArchivedStoryRibbonShown:b,isAccountFrozen:y}){const{setGlobalSearchQuery:S,setGlobalSearchClosing:A,setGlobalSearchChatId:M,resetChatCreation:C,setGlobalSearchDate:P,loadPasswordInfo:k,clearTwoFaError:F,openChat:T,openLeftColumnContent:U,openSettingsScreen:x}=(0,w.ko)(),[B,R]=(0,Gt.J0)(""),[J,N]=(0,Ms.A)(),[E,L]=(0,Gt.J0)(0);let O=Na.Main;switch(t){case n.Bn.Archived:O=Na.Archived;break;case n.Bn.Settings:O=Na.Settings;break;case n.Bn.NewChannelStep1:case n.Bn.NewChannelStep2:O=Na.NewChannel;break;case n.Bn.NewGroupStep1:case n.Bn.NewGroupStep2:O=Na.NewGroup}const D=(0,Zt.A)(e=>{function a(){U({contentKey:void 0}),x({screen:void 0}),R(""),A({isClosing:!0}),C(),setTimeout(()=>{S({query:""}),P({date:void 0}),M({id:void 0}),A({isClosing:!1}),L(Date.now())},250)}if(!0!==e)if(t!==n.Bn.NewGroupStep2)if(t!==n.Bn.NewChannelStep2){if(t===n.Bn.NewGroupStep1){const e=document.getElementById("new-group-picker-search");e&&e.blur()}if(t===n.Bn.Settings)switch(s){case n.VS.EditProfile:case n.VS.Folders:case n.VS.General:case n.VS.Notifications:case n.VS.DataStorage:case n.VS.Privacy:case n.VS.Performance:case n.VS.ActiveSessions:case n.VS.Language:case n.VS.Stickers:case n.VS.Experimental:return void x({screen:n.VS.Main});case n.VS.GeneralChatBackground:return void x({screen:n.VS.General});case n.VS.GeneralChatBackgroundColor:return void x({screen:n.VS.GeneralChatBackground});case n.VS.PrivacyPhoneNumber:case n.VS.PrivacyAddByPhone:case n.VS.PrivacyLastSeen:case n.VS.PrivacyProfilePhoto:case n.VS.PrivacyBio:case n.VS.PrivacyBirthday:case n.VS.PrivacyGifts:case n.VS.PrivacyPhoneCall:case n.VS.PrivacyPhoneP2P:case n.VS.PrivacyForwarding:case n.VS.PrivacyGroupChats:case n.VS.PrivacyVoiceMessages:case n.VS.PrivacyMessages:case n.VS.PrivacyBlockedUsers:case n.VS.ActiveWebsites:case n.VS.TwoFaDisabled:case n.VS.TwoFaEnabled:case n.VS.TwoFaCongratulations:case n.VS.PasscodeDisabled:case n.VS.PasscodeEnabled:case n.VS.PasscodeCongratulations:return void x({screen:n.VS.Privacy});case n.VS.PasscodeNewPasscode:return void x({screen:u?n.VS.PasscodeEnabled:n.VS.PasscodeDisabled});case n.VS.PasscodeChangePasscodeCurrent:case n.VS.PasscodeTurnOff:return void x({screen:n.VS.PasscodeEnabled});case n.VS.PasscodeNewPasscodeConfirm:return void x({screen:n.VS.PasscodeNewPasscode});case n.VS.PasscodeChangePasscodeNew:return void x({screen:n.VS.PasscodeChangePasscodeCurrent});case n.VS.PasscodeChangePasscodeConfirm:return void x({screen:n.VS.PasscodeChangePasscodeNew});case n.VS.PrivacyPhoneNumberAllowedContacts:case n.VS.PrivacyPhoneNumberDeniedContacts:return void x({screen:n.VS.PrivacyPhoneNumber});case n.VS.PrivacyLastSeenAllowedContacts:case n.VS.PrivacyLastSeenDeniedContacts:return void x({screen:n.VS.PrivacyLastSeen});case n.VS.PrivacyProfilePhotoAllowedContacts:case n.VS.PrivacyProfilePhotoDeniedContacts:return void x({screen:n.VS.PrivacyProfilePhoto});case n.VS.PrivacyBioAllowedContacts:case n.VS.PrivacyBioDeniedContacts:return void x({screen:n.VS.PrivacyBio});case n.VS.PrivacyBirthdayAllowedContacts:case n.VS.PrivacyBirthdayDeniedContacts:return void x({screen:n.VS.PrivacyBirthday});case n.VS.PrivacyGiftsAllowedContacts:case n.VS.PrivacyGiftsDeniedContacts:return void x({screen:n.VS.PrivacyGifts});case n.VS.PrivacyPhoneCallAllowedContacts:case n.VS.PrivacyPhoneCallDeniedContacts:return void x({screen:n.VS.PrivacyPhoneCall});case n.VS.PrivacyPhoneP2PAllowedContacts:case n.VS.PrivacyPhoneP2PDeniedContacts:return void x({screen:n.VS.PrivacyPhoneP2P});case n.VS.PrivacyForwardingAllowedContacts:case n.VS.PrivacyForwardingDeniedContacts:return void x({screen:n.VS.PrivacyForwarding});case n.VS.PrivacyVoiceMessagesAllowedContacts:case n.VS.PrivacyVoiceMessagesDeniedContacts:return void x({screen:n.VS.PrivacyVoiceMessages});case n.VS.PrivacyGroupChatsAllowedContacts:case n.VS.PrivacyGroupChatsDeniedContacts:return void x({screen:n.VS.PrivacyGroupChats});case n.VS.TwoFaNewPassword:return void x({screen:n.VS.TwoFaDisabled});case n.VS.TwoFaNewPasswordConfirm:return void x({screen:n.VS.TwoFaNewPassword});case n.VS.TwoFaNewPasswordHint:return void x({screen:n.VS.TwoFaNewPasswordConfirm});case n.VS.TwoFaNewPasswordEmail:return void x({screen:n.VS.TwoFaNewPasswordHint});case n.VS.TwoFaNewPasswordEmailCode:return void x({screen:n.VS.TwoFaNewPasswordEmail});case n.VS.TwoFaChangePasswordCurrent:case n.VS.TwoFaTurnOff:case n.VS.TwoFaRecoveryEmailCurrentPassword:return void x({screen:n.VS.TwoFaEnabled});case n.VS.TwoFaChangePasswordNew:return void x({screen:n.VS.TwoFaChangePasswordCurrent});case n.VS.TwoFaChangePasswordConfirm:return void x({screen:n.VS.TwoFaChangePasswordNew});case n.VS.TwoFaChangePasswordHint:return void x({screen:n.VS.TwoFaChangePasswordConfirm});case n.VS.TwoFaRecoveryEmail:return void x({screen:n.VS.TwoFaRecoveryEmailCurrentPassword});case n.VS.TwoFaRecoveryEmailCode:return void x({screen:n.VS.TwoFaRecoveryEmail});case n.VS.FoldersCreateFolder:case n.VS.FoldersEditFolder:return void x({screen:n.VS.Folders});case n.VS.FoldersShare:return void x({screen:n.VS.FoldersEditFolder});case n.VS.FoldersIncludedChatsFromChatList:case n.VS.FoldersExcludedChatsFromChatList:return void x({screen:n.VS.FoldersEditFolderFromChatList});case n.VS.FoldersEditFolderFromChatList:case n.VS.FoldersEditFolderInvites:return U({contentKey:n.Bn.ChatList}),void x({screen:n.VS.Main});case n.VS.QuickReaction:case n.VS.CustomEmoji:return void x({screen:n.VS.Stickers});case n.VS.DoNotTranslate:return void x({screen:n.VS.Language});case n.VS.PrivacyNoPaidMessages:return void x({screen:n.VS.PrivacyMessages})}t===n.Bn.ChatList&&i?U({contentKey:n.Bn.GlobalSearch}):a()}else U({contentKey:n.Bn.NewChannelStep1});else U({contentKey:n.Bn.NewGroupStep1});else a()}),Y=(0,Zt.A)(e=>{t!==n.Bn.Contacts?(U({contentKey:n.Bn.GlobalSearch}),e!==a&&S({query:e})):R(e)}),G=(0,Zt.A)(()=>{U({contentKey:n.Bn.GlobalSearch}),S({query:""}),M({id:g})});(0,Gt.vJ)(()=>{const e=t===n.Bn.Archived,s=t===n.Bn.ChatList,a=!p&&!f;return e&&a||!s&&!e||i&&a?(0,Ss.A)(()=>{D()}):void 0},[i,t,D,p,f]);const V=(0,Zt.A)(e=>{t!==n.Bn.GlobalSearch&&(e.preventDefault(),U({contentKey:n.Bn.GlobalSearch}))}),j=(0,Zt.A)(e=>{e.preventDefault(),T({id:l,shouldReplaceHistory:!0})}),q=(0,Zt.A)(e=>{e.preventDefault(),U({contentKey:n.Bn.Archived})}),W=(0,Zt.A)(e=>{e.preventDefault(),U({contentKey:n.Bn.Settings})});(0,Xt.v)((0,Gt.Kr)(()=>({"Mod+Shift+F":V,...!d.$M&&{"Mod+Shift+S":j},...d.lE&&{"Mod+0":j,"Mod+9":q},...d.MP&&d.lE&&{"Mod+,":W}}),[])),(0,Gt.vJ)(()=>{F(),s===n.VS.Privacy&&k()},[F,k,s]),(0,os.A)(()=>{h&&N(h)},[N,h]);const K=(0,Ps.i)((0,Cs.A)(O===Na.Settings?s:-1));return(0,Gt.vJ)(()=>{if(d.TF)return(0,As.P)(e.current,{excludedClosestSelector:".ProfileInfo, .color-picker, .hue-picker",selectorToPreventScroll:"#Settings .custom-scroll",onSwipeRightStart:D,onCancel:()=>{U({contentKey:n.Bn.Settings}),x({screen:K.current})}})},[K,e]),(0,cs.Y)(ks.Ay,{ref:e,name:(0,ws.P)("layers",r,c),renderCount:Ea,activeKey:O,shouldCleanup:!0,cleanupExceptionKey:Na.Main,shouldWrap:!0,wrapExceptionKey:Na.Main,id:"LeftColumn",withSwipeControl:!0,children:function(e){switch(O){case Na.Archived:return(0,cs.Y)(Ts,{isActive:e,onReset:D,onTopicSearch:G,foldersDispatch:N,isForumPanelOpen:f,archiveSettings:v,isStoryRibbonShown:b});case Na.Settings:return(0,cs.Y)(Ja,{isActive:e,currentScreen:s,foldersState:J,foldersDispatch:N,animationLevel:r,shouldSkipTransition:c,onReset:D});case Na.NewChannel:return(0,cs.Y)(Ra,{isActive:e,isChannel:!0,content:t,animationLevel:r,onReset:D},E);case Na.NewGroup:return(0,cs.Y)(Ra,{isActive:e,content:t,animationLevel:r,onReset:D},E);default:return(0,cs.Y)(Ba,{content:t,isClosingSearch:I,searchQuery:a,searchDate:o,contactsFilter:B,foldersDispatch:N,onSearchQuery:Y,onReset:D,shouldSkipTransition:c,isAppUpdateAvailable:m,isForumPanelOpen:f,onTopicSearch:G,isAccountFrozen:y})}}})})),Oa=({isOpen:e})=>{const t=(0,ds.A)(zt.ar.Extra,"MediaViewer",!e);return t?(0,cs.Y)(t,{}):void 0},Da=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"ReactionPicker",!t);return s?(0,cs.Y)(s,{...e}):void 0},Ya=(0,Gt.ph)((0,w.EK)(e=>({messageLists:(0,C.nTw)(e).messageLists}))(({messageLists:e})=>{const{openChat:t}=(0,w.ko)(),s=()=>{t({id:void 0},{forceSyncOnIOs:!0})},a=({chatId:e,type:t,threadId:a})=>{(0,js.A)({isActive:!0,hash:(0,ot.az)(e,t,a),onBack:s})};return(0,cs.Y)("div",{children:e?.map((e,t)=>(0,cs.Y)(a,{...e},`${e.chatId}_${e.threadId}_${e.type}_${t}`))})}));var Ga=s(95807),Va=s(65632),ja=s(23565),qa=s(73767),Wa=s(39751),Ka=s(67054),za=s(83414);let Ha,_a;function $a(e){return Math.max(0,e)}var Xa=s(48196),Qa=s(22081);const Za=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"PrivacySettingsNoticeModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},eo=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"SeenByModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},to=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"UnpinAllMessagesModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},so=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"ChatLanguageModal",!t);return s?(0,cs.Y)(s,{...e}):void 0};var ao=s(41510);const oo=e=>{const{activeEmojiInteraction:t}=e,s=(0,ds.A)(zt.ar.Extra,"EmojiInteractionAnimation",!t);return s?(0,cs.Y)(s,{...e}):void 0};var io=s(10722);const no=(0,Gt.ph)(({icon:e,ariaLabelLang:t,unreadCount:s,onClick:a,onReadAll:o,className:i})=>{const n=(0,xs.A)(),r=(0,Qt.A)(),d=(0,Gt.li)(),{isContextMenuOpen:c,handleContextMenu:l,handleContextMenuClose:u,handleContextMenuHide:h}=(0,io.A)(d,!o);return(0,cs.FD)("div",{className:(0,qt.A)("Y2NKrpKj",i),ref:d,children:[(0,cs.Y)(Rs.A,{color:"secondary",round:!0,className:"cxwA6gDO",onClick:a,onContextMenu:l,ariaLabel:n(t),children:(0,cs.Y)(Js.A,{name:e,className:"F4zNUFhH"})}),Boolean(s)&&(0,cs.Y)("div",{className:"GovSzpfQ",children:(0,vs.Vw)(r,s)}),o&&(0,cs.Y)(Ns.A,{isOpen:c,onClose:u,onCloseAnimationEnd:h,autoClose:!0,positionX:"right",positionY:"bottom",children:(0,cs.Y)(Es.A,{icon:"readchats",onClick:o,children:n("MarkAllAsRead")})})]})}),ro="UMXbiYB3",co=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.Xf0)(e);if(!t)return{};const{chatId:s,threadId:a,type:o}=t,n=(0,C.hds)(e,s),r=Boolean((0,C.TCk)(e)),d=n&&a===i.l3&&"thread"===o&&!r;return{messageListType:o,chatId:s,threadId:a,reactionsCount:d?n.unreadReactionsCount:void 0,unreadReactions:d?n.unreadReactions:void 0,unreadMentions:d?n.unreadMentions:void 0,mentionsCount:d?n.unreadMentionsCount:void 0,unreadCount:d?n.unreadCount:void 0}})(({withScrollDown:e,canPost:t,messageListType:s,chatId:a,threadId:o,unreadCount:i,unreadReactions:n,unreadMentions:r,reactionsCount:d,mentionsCount:c,withExtraShift:l})=>{const{focusNextReply:u,focusNextReaction:h,focusNextMention:p,fetchUnreadReactions:m,readAllMentions:f,readAllReactions:g,fetchUnreadMentions:I}=(0,w.ko)(),v=(0,Gt.li)(),b=Boolean(d),y=Boolean(c),S=(0,Zt.A)(()=>{a&&g({chatId:a,threadId:o})}),A=(0,Zt.A)(()=>{a&&f({chatId:a,threadId:o})});(0,Gt.vJ)(()=>{b&&a&&!n?.length&&m({chatId:a})},[a,m,b,n?.length]),(0,Gt.vJ)(()=>{b&&a&&m({chatId:a})},[a,m,b]),(0,Gt.vJ)(()=>{y&&a&&!r?.length&&I({chatId:a})},[a,I,y,r?.length]),(0,Gt.vJ)(()=>{y&&a&&I({chatId:a})},[a,I,y]);const M=(0,Zt.A)(()=>{if(e)if("thread"===s)u();else{const e=v.current.parentElement.querySelector(".Transition_slide-active > .MessageList"),t=e.querySelectorAll(".message-list-item"),s=t[t.length-1];if(!s)return;(0,nt.Ay)({container:e,element:s,position:"end",margin:20})}}),C=(0,qt.A)("VWoOZCD5",(e||Boolean(d)||Boolean(c))&&"iozW83la",(Boolean(d)||Boolean(c))&&!e&&"UBa5kAK5",!t&&"yzzjqibi",!l&&"wDwOdyQH");return(0,cs.FD)("div",{ref:v,className:C,children:[(0,cs.Y)(no,{icon:"heart-outline",ariaLabelLang:"AccDescrReactionMentionDown",onClick:h,onReadAll:S,unreadCount:d,className:(0,qt.A)("eO_Fz8SD",!b&&ro,!y&&"gn3iLVq1")}),(0,cs.Y)(no,{icon:"mention",ariaLabelLang:"AccDescrMentionDown",onClick:p,onReadAll:A,unreadCount:c,className:!y&&ro}),(0,cs.Y)(no,{icon:"arrow-down",ariaLabelLang:"AccDescrPageDown",onClick:M,unreadCount:i,className:"u62x81QI"})]})})),lo=(0,Gt.ph)(function(){const e=(0,Qt.A)(),{openFrozenAccountModal:t}=(0,w.ko)(),s=(0,Zt.A)(()=>{t()});return(0,cs.FD)("div",{className:"GuZke_HG",onClick:s,children:[(0,cs.Y)("div",{className:"oLWeN4mA",children:e("ComposerTitleFrozenAccount")}),(0,cs.Y)("div",{className:"ZxTe54MY",children:e("ComposerSubtitleFrozenAccount")})]})});var uo=s(32952);const ho=e=>{const{isActive:t}=e,s=(0,ds.A)(zt.ar.Extra,"MessageSelectToolbar",!t);return s?(0,cs.Y)(s,{...e}):void 0};var po=s(38218),mo=s(51083),fo=s(17751),go=s(48553),Io=s(53827),vo=s(49642),bo=s(4961),yo=s(35749),So=s(88792),wo=s(14),Ao=s(24909),Mo=s(56863),Co=s(62587);const Po=s.p+"telegram-logo-filled.67469f6dc5e301e8e0bd.svg",ko={width:200,height:200},Fo=115;var To=s(48885),Uo=s(82497),xo=s(42452);const Bo={.5:.66,.75:.8,1:1,1.5:1.4,2:1.8},Ro=Object.keys(Bo).sort().map(Number);function Jo(e){const{title:t,performer:s,fileName:a}=e;return(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("div",{className:"title",dir:"auto",children:(0,bo.A)(t||a)}),s&&(0,cs.Y)("div",{className:"subtitle",dir:"auto",children:(0,bo.A)(s)})]})}function No(e,t){return(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("div",{className:"title",dir:"auto",children:t&&(0,bo.A)(t)}),(0,cs.Y)("div",{className:"subtitle",dir:"auto",children:e})]})}const Eo=(0,w.EK)((e,{isHidden:t})=>{const{audioPlayer:s}=(0,C.nTw)(e),{chatId:a,messageId:o}=s,i=!t&&a&&o?(0,C.O5q)(e,a,o):void 0,n=i&&(0,C.Y7C)(e,i),r=i&&(0,C.hds)(e,i.chatId),{volume:d,playbackRate:c,isMuted:l,isPlaybackRateActive:u,timestamp:h}=(0,C.nTw)(e).audioPlayer;return{message:i,sender:n,chat:r,volume:d,playbackRate:c,isPlaybackRateActive:u,isMuted:l,timestamp:h,mediaDuration:i?(0,ht.Y9)(e,i):void 0}})(({message:e,mediaDuration:t,className:s,noUi:o,sender:i,chat:n,volume:r,playbackRate:c,isPlaybackRateActive:l,isMuted:u,isFullWidth:h,timestamp:p,onPaneStateChange:m})=>{const{setAudioPlayerVolume:f,setAudioPlayerPlaybackRate:g,setAudioPlayerMuted:I,focusMessage:v,closeAudioPlayer:b}=(0,w.ko)(),A=(0,xs.A)(),{isMobile:M}=(0,D.Ay)(),C=(0,wo.A)(e),{audio:P,voice:k,video:F}=C?(0,y.r_)(C):{},T=Boolean(k||F),U=T||(P?.duration||0)>a.CVm,B=i?(0,S.F9)(A,i):void 0,R=(0,yo.A)(C,"inline"),J=R&&tt.Ih(R),N=((e,t,s)=>{const a=(0,xs.A)(),{audio:o,voice:i}=e?(0,y.r_)(e):{},n=o?o.title||o.fileName:i?"Voice message":"",r=o?.performer||t&&(0,S.F9)(a,t),d=s&&(0,y.Js)(a,s)||"Telegram",c=o&&(0,y.AB)(o)&&(0,y.VO)(o,"pictogram"),l=t&&(0,y.cP)(t,"big"),u=o&&c||i&&l,h=(0,Co.A)(u),p=(0,Gt.Kr)(()=>function(e,t,s){if(!s)return ko;if(e){if(!e.thumbnailSizes?.length)return;const t=e.thumbnailSizes.find(e=>"m"===e.type);return t||e.thumbnailSizes[0]}return t?x.cf:void 0}(o,i,h),[o,h,i]),{result:m}=(0,Mo.A)(()=>function(e,t){if(!e)return Promise.resolve(Po);if(!t)return(0,Ao.y)(e,Fo,Fo);const s=Math.min(t.width,t.height);if(s<Fo){const t=Fo/s;return(0,Ao.s)(e,t)}return Promise.resolve(e)}(h,p),[h,p],Po);return(0,Gt.Kr)(()=>(0,vo.wp)({title:n,artist:r,album:d,artwork:[{src:m}]}),[d,r,n,m])})(C,i,n),{playPause:E,stop:L,isPlaying:O,requestNextTrack:Y,requestPreviousTrack:G,isFirst:V,isLast:j,setVolume:q,toggleMuted:W,setPlaybackRate:K,setCurrentTime:z}=(0,So.A)(e&&(0,Io.dj)(e),t||0,T?"voice":"audio",J,void 0,N,void 0,!0,void 0,void 0,e&&(0,y.Nb)(e),!0),H=Boolean(e),{ref:_}=(0,as.A)({isOpen:H,shouldForceOpen:h}),{ref:$,shouldRender:X}=(0,To.A)({isOpen:H,isDisabled:!h,ref:_,onStateChange:m}),{isContextMenuOpen:Q,handleBeforeContextMenu:Z,handleContextMenu:ee,handleContextMenuClose:te,handleContextMenuHide:se}=(0,io.A)(_,!X);(0,Gt.vJ)(()=>{p&&z(p)},[p,z]),(0,Gt.vJ)(()=>{O&&e?.isDeleting&&E()},[O,e?.isDeleting,E]);const ae=(0,Zt.A)(()=>{const{chatId:e,id:t}=C;v({chatId:e,messageId:t})}),oe=(0,Zt.A)(()=>{L&&(O&&E(),b(),(0,vo.Eg)(),L())}),ie=(0,Zt.A)(e=>{q&&(f({volume:e/100}),q(e/100))}),ne=(0,Zt.A)(()=>{d.TF&&!d.pz||W&&(W(),I({isMuted:!u}))}),re=(0,Zt.A)((e,t=!0)=>{if(!K)return;const s=Bo[e],a=1!==e&&t;g({playbackRate:s,isPlaybackRateActive:a}),K(a?s:1)}),de=(0,Zt.A)(()=>{te();const e=Number(Object.entries(Bo).find(([,e])=>e===c)?.[0])||1,t=!l;re(t&&1===e?2:e,t)}),ce=(0,Zt.A)(()=>{const e=Object.entries(Bo).find(([,e])=>e===c)?.[0]||1,t=`${1===c?2:e}Х`;return(0,cs.FD)("div",{className:"playback-wrapper",children:[Q&&(0,cs.Y)("div",{className:"playback-backdrop",onClick:te}),(0,cs.Y)(Rs.A,{round:!0,className:(0,qt.A)("playback-button",l&&"applied",Q&&"on-top"),color:"translucent",size:"smaller",ariaLabel:"Playback Rate",ripple:!M,onMouseEnter:ee,onClick:de,onMouseDown:Z,onContextMenu:ee,children:(0,cs.Y)("span",{className:(0,qt.A)("playback-button-inner",4===t.length&&"small",5===t.length&&"tiny"),children:t})})]})}),le=(0,Gt.Kr)(()=>0===r||u?"muted":r<.3?"volume-1":r<.6?"volume-2":"volume-3",[r,u]);if(!o&&X)return(0,cs.FD)("div",{className:(0,qt.A)("AudioPlayer",h?"full-width-player":"mini-player",s),dir:A.isRtl?"rtl":void 0,ref:$,children:[(0,cs.FD)("div",{className:"AudioPlayer-content",onClick:ae,children:[P?Jo(P):No(A("AttachAudio"),B),(0,cs.Y)(xo.A,{})]}),(0,cs.Y)(Rs.A,{round:!0,ripple:!M,color:"translucent",size:"smaller",className:"player-button",disabled:V?.(),onClick:G,ariaLabel:"Previous track",children:(0,cs.Y)(Js.A,{name:"skip-previous"})}),(0,cs.FD)(Rs.A,{round:!0,ripple:!M,color:"translucent",size:"smaller",className:(0,qt.A)("toggle-play","player-button",O?"pause":"play"),onClick:E,ariaLabel:O?"Pause audio":"Play audio",children:[(0,cs.Y)(Js.A,{name:"play"}),(0,cs.Y)(Js.A,{name:"pause"})]}),(0,cs.Y)(Rs.A,{round:!0,ripple:!M,color:"translucent",size:"smaller",className:"player-button",disabled:j?.(),onClick:Y,ariaLabel:"Next track",children:(0,cs.Y)(Js.A,{name:"skip-next"})}),(0,cs.FD)("div",{className:"volume-button-wrapper",children:[(0,cs.Y)(Rs.A,{round:!0,className:"player-button volume-button",color:"translucent",size:"smaller",ariaLabel:"Volume",onClick:ne,ripple:!M,children:(0,cs.Y)(Js.A,{name:le})}),!d.pz&&(0,cs.FD)("div",{className:"volume-slider-wrapper",children:[(0,cs.Y)("div",{className:"volume-slider-spacer"}),(0,cs.Y)("div",{className:"volume-slider",children:(0,cs.Y)(Uo.A,{bold:!0,value:u?0:100*r,onChange:ie})})]})]}),U&&(0,cs.Y)(Zs.A,{forceOpen:Q,positionX:"right",positionY:"top",className:"playback-rate-menu",trigger:ce,onClose:te,onHide:se,onMouseEnterBackdrop:te,children:Ro.map(e=>function(e,t,s,a){const o=t===Bo[e]&&a||1===e&&!a;return(0,cs.FD)(Es.A,{onClick:()=>s(e),icon:o?"check":void 0,customIcon:o?void 0:(0,cs.Y)(Js.A,{name:"placeholder"}),children:[e,"X"]},e)}(e,c,re,l))}),(0,cs.Y)(Rs.A,{round:!0,className:"player-close",color:"translucent",size:"smaller",onClick:oe,ariaLabel:"Close player",children:(0,cs.Y)(Js.A,{name:"close"})})]})});var Lo=s(85449),Oo=s(2338),Do=s(49746),Yo=s(11217),Go=s(93809),Vo=s(68292),jo=s(27860),qo=s(18653),Wo=s(94189);const Ko={"pinned-message-border":"L5TQCriM",pinnedMessageBorder:"L5TQCriM","pinned-message-border-wrapper-1":"v5sJGzfS",pinnedMessageBorderWrapper1:"v5sJGzfS","pinned-message-border-wrapper":"p6PQhvds",pinnedMessageBorderWrapper:"p6PQhvds","pinned-message-border-mark":"M2PQZgBd",pinnedMessageBorderMark:"M2PQZgBd"};function zo(e,t,s,a,o){return`M${e},${t+o}a${o},${o},0,0,1,\n  ${s},0v${a-2*o}a${o},${o},0,0,1,${-s},0Z`}const Ho=(0,Gt.ph)(({count:e,index:t})=>{const s=(0,Gt.li)(),a=(0,Gt.Kr)(()=>function(e,t){const s=e-t-1,a=function(e){let t=8;return 1===e?t=36:2===e?t=17:3===e?t=11:(4===e||e>3)&&(t=7.5),t}(e),o=function(e,t){let s=36;return 1===e?s=36:2===e?s=17:3===e?s=1===t?12:11:(4===e||e>3)&&(s=7.5),s}(e,s),i=function(e,t){return e<=3?36:t*e+2*(e-1)}(e,a),n=`clipPath${e}`,r=function(e,t,s){let a="";if(3===s)a=zo(0,0,2,t,1)+zo(0,12,2,t+1,1)+zo(0,25,2,t,1);else for(let e=0;e<s;e++)a+=zo(0,(t+2)*e,2,t,1);return`<clipPath id="${e}">\n      <path d="${a}" />\n    </clipPath>`}(n,a,e),d=function(e,t,s){return 1===s?0:2===s?0===e?0:t+2:3===s?0===e?0:1===e?12:25:(t+2)*e}(s,a,e),c=function(e,t,s,a){return t<=4||e<=1?0:e>=t-2?a-36:(s+4)/2+(e-2)*(s+2)}(s,e,a,i);return{markHeight:o,clipPath:r,markTranslateY:d,trackTranslateY:c,trackHeight:i,clipPathId:n}}(e,t),[e,t]);if((0,Gt.Nf)(()=>{if(!s.current)return;const{trackHeight:e,trackTranslateY:t,markHeight:o,markTranslateY:i,clipPathId:n,clipPath:r}=a,d=s.current.firstElementChild;if(s?.current){const a=s.current,{style:c}=a;c.height=`${e}px`,c.transform=`translateY(-${t}px)`,c.clipPath=`url("#${n}")`;const l=a.querySelector("svg"),u=a.querySelector("div"),h=a.querySelector("defs");l||d&&(d.innerHTML=`<svg height="0" width="0"><defs> ${r} </defs></svg>`),h&&(h.innerHTML=r),u&&(u.style.height=`${o}px`,u.style.transform=`translateY(${i}px)`)}},[a]),1===e)return(0,cs.Y)("div",{className:Ko.pinnedMessageBorder,children:(0,cs.Y)("div",{className:Ko.pinnedMessageBorderWrapper1,ref:s})});const{trackHeight:o,trackTranslateY:i,markHeight:n,markTranslateY:r,clipPathId:d}=a;return(0,cs.Y)("div",{className:(0,qt.A)(Ko.pinnedMessageBorder,e>4&&Ko.pinnedMessageBorderMask),children:(0,cs.FD)("div",{className:Ko.pinnedMessageBorderWrapper,ref:s,style:`clip-path: url("#${d}"); width: 2px;\n          height: ${o}px; transform: translateY(-${i}px);`,children:[(0,cs.Y)("span",{}),(0,cs.Y)("div",{className:Ko.pinnedMessageBorderMark,style:`--height: ${n}px; --translate-y: ${r}px; --translate-track: ${i}px;`})]})})}),_o="LFRysfVa",$o="E_C4DXKN",Xo="ljzqevcj",Qo=1.125*x.$,Zo=(0,Gt.ph)((0,w.EK)((e,{chatId:t,threadId:s,messageListType:a})=>{const o=(0,C.hds)(e,t),n=e.isSynced,r=(0,y.cG)(t,s,e.currentUserId),d=(0,C.zeq)(e,t),c={chat:o,isSynced:n};if("thread"!==a||!d)return c;if(s!==i.l3&&!r&&!o?.isForum){const a=Number(s),o=a?(0,C.O5q)(e,t,a):void 0,i=o?(0,C.Szq)(e,o):void 0;return{...c,pinnedMessageIds:a,messagesById:d,canUnpin:!1,topMessageSender:i}}const l=r?void 0:(0,C.fcC)(e,t,s);if(l?.length){const t=d[l[0]],{canUnpin:a=!1}=t&&1===l.length&&(0,C.WAX)(e,t,s)||{};return{...c,pinnedMessageIds:l,messagesById:d,canUnpin:a}}return c})(({chatId:e,threadId:t,canUnpin:s,getLoadingPinnedId:a,pinnedMessageIds:o,messagesById:n,isFullWidth:r,topMessageSender:c,getCurrentPinnedIndex:l,className:u,chat:h,isSynced:p,shouldHide:m,onPaneStateChange:f,onFocusPinnedMessage:g})=>{const{clickBotInlineButton:I,focusMessage:v,openThread:b,pinMessage:A,loadPinnedMessages:M}=(0,w.ko)(),C=(0,Qt.A)(),P=(0,Vs.A)(l),k=Array.isArray(o)?o[P]:o,F=n&&k?n[k]:void 0,T=Array.isArray(o)?o.length:o?1:0,U=Math.max(T-P,1),B=c?(0,S.F9)(C,c):void 0,R=F&&(0,y.zX)(F),J=R?.isGif?R:void 0,N=Boolean(J&&!J.previewPhotoSizes?.length),E=(0,Oo.A)(F),L=(0,yo.A)(F,N?"full":"pictogram"),O=(0,Co.A)(L),D=F&&(0,y.y2)(F),Y=Boolean((0,Vs.A)(a)),G=(0,Go.A)([Y],450)&&Y,V=(0,wo.A)(F,!0);(0,Gt.vJ)(()=>{p&&(t===i.l3||h?.isForum)&&M({chatId:e,threadId:t})},[e,t,p,h?.isForum]),(0,Do.A)(e,k,F);const j=Boolean(F)&&!m,{ref:q}=(0,as.A)({isOpen:j,noOpenTransition:!0,shouldForceOpen:r}),{ref:W,shouldRender:K}=(0,To.A)({isOpen:j,isDisabled:!r,ref:q,onStateChange:f}),[z,H,_]=(0,$s.A)(),$=(0,Zt.A)(()=>{_(),A({chatId:e,messageId:F.id,isUnpin:!0})}),X=F&&(0,y.rK)(F),Q=(0,Zt.A)(()=>{X&&I({chatId:F.chatId,messageId:F.id,button:X})}),Z=(0,Zt.A)(()=>{b({chatId:e,threadId:t,type:"pinned"})}),ee=(0,Zt.A)(s=>{const i=s.shiftKey&&Array.isArray(o)?o[(0,Ka.A)(o.length,o.indexOf(k)-2)]:k;a()||(v({chatId:e,threadId:t,messageId:i,noForumTopicPanel:!0}),g(i))}),[te,se,ae]=(0,$s.A)(),{handleClick:oe,handleMouseDown:ie}=(0,Yo.Q)(ee);if(K&&V)return(0,cs.FD)("div",{ref:W,className:(0,qt.A)("HeaderPinnedMessageWrapper","tE8PJzpv",r?"gutn4asD":"lrBhOgvf",u),children:[(T>1||G)&&(0,cs.FD)(Rs.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:C("EventLogFilterPinnedMessages"),onClick:G?void 0:Z,children:[Y&&(0,cs.Y)(sa.A,{color:"blue",className:(0,qt.A)("yvd9_9PF",_o,!G&&$o)}),(0,cs.Y)(Js.A,{name:"pin-list",className:(0,qt.A)(_o,G&&$o)})]}),s&&(0,cs.Y)(Rs.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:C("UnpinMessageAlertTitle"),onClick:H,children:(0,cs.Y)(Js.A,{name:"close"})}),(0,cs.Y)(Wo.A,{isOpen:z,onClose:_,text:C("PinnedConfirmUnpin"),confirmLabel:C("DialogUnpin"),confirmHandler:$}),(0,cs.FD)("div",{className:(0,qt.A)("ayLUtX1S",te&&"WVjde2rq"),onClick:oe,onMouseDown:ie,dir:C.isRtl?"rtl":void 0,children:[(0,cs.Y)(Ho,{count:T,index:P}),(0,cs.Y)(ks.Ay,{activeKey:V.id,name:"slideVertical",className:"Gp431jU4",children:function(e,t,s,a){const{width:o,height:i}=(0,x.mr)(),n=t||e,r=s&&t;return(0,cs.FD)("div",{className:"XjjZeOUy",children:[e&&!a&&!r&&(0,cs.Y)("img",{className:Xo,src:n,width:o,height:i,alt:"",draggable:!1}),r&&!a&&(0,cs.Y)("video",{src:t,width:o,height:i,playsInline:!0,disablePictureInPicture:!0,className:Xo}),e&&(0,cs.Y)(jo.A,{thumbDataUri:n,isVisible:Boolean(a),width:o,height:i})]})}(E,O,N,D)}),(0,cs.FD)("div",{className:(0,qt.A)("ETMw73qH",E&&"BWZytkCB"),dir:C.isRtl?"rtl":void 0,children:[(0,cs.FD)("div",{className:"IWpRWVBg",dir:C.isRtl?"rtl":void 0,children:[!B&&(0,cs.Y)(Vo.A,{text:1===T?C("PinnedMessageTitleSingle"):C("PinnedMessageTitle",{index:U},{pluralValue:T})}),B&&(0,bo.A)(B)]}),(0,cs.Y)(ks.Ay,{activeKey:V.id,name:"slideVerticalFade",className:"mA1i07pG",children:(0,cs.Y)("p",{dir:"auto",className:"k19QLKaH",children:(0,cs.Y)(qo.A,{message:V,truncateLength:256,noEmoji:Boolean(E),emojiSize:Qo})})})]}),(0,cs.Y)(xo.A,{}),X&&(0,cs.Y)(Rs.A,{size:"tiny",className:"fpQMpARI",onClick:Q,shouldStopPropagation:!0,onMouseEnter:d.TF?void 0:se,onMouseLeave:d.TF?void 0:ae,children:(0,Lo.A)(C,X)})]})]})})),ei=(0,Gt.ph)((0,w.EK)((e,{chatId:t,threadId:s,messageListType:a,isMobile:o})=>{const{isLeftColumnShown:n,shouldSkipHistoryAnimations:r,audioPlayer:d,messageLists:c}=(0,C.nTw)(e),l=(0,C.hds)(e,t),u=(0,C.PVB)(e,t),{chatId:h,messageId:p}=d,m=h&&p?(0,C.O5q)(e,h,p):void 0;let f;if("pinned"===a){const a=(0,C.fcC)(e,t,s);f=a?.length}else if("scheduled"===a){const a=(0,C.K3w)(e,t,s);f=a?.length}else if("thread"===a&&s!==i.l3){const a=(0,C.Vw0)(e,t,s);f=a?.messagesCount||0}const g=(0,C.C5H)(e,t,s,"typingStatus"),I=u?.emojiStatus,v=I&&(0,C.O8F)(e,I.documentId),b="collectible"===I?.type?I.slug:void 0,S=(0,y.cG)(t,s,e.currentUserId),w=(0,C.nZ4)(e,t);return{typingStatus:g,isLeftColumnShown:n,isRightColumnShown:(0,C.gjV)(e,o),isSelectModeActive:(0,C.rTV)(e),audioMessage:m,chat:l,messagesCount:f,isChatWithSelf:(0,C.nZ4)(e,t),shouldSkipHistoryAnimations:r,currentTransitionKey:Math.max(0,c.length-1),connectionState:e.connectionState,isSyncing:e.isSyncing,isFetchingDifference:e.isFetchingDifference,emojiStatusSticker:v,emojiStatusSlug:b,isSavedDialog:S,isSavedMessages:w}})(({chatId:e,threadId:t,messageListType:s,isMobile:o,typingStatus:n,isSelectModeActive:r,isLeftColumnShown:c,audioMessage:l,chat:u,messagesCount:h,isComments:p,isChatWithSelf:m,shouldSkipHistoryAnimations:f,currentTransitionKey:g,connectionState:I,isSyncing:v,isFetchingDifference:b,getCurrentPinnedIndex:y,getLoadingPinnedId:S,emojiStatusSticker:A,emojiStatusSlug:M,isSavedDialog:C,onFocusPinnedMessage:P,isSavedMessages:F})=>{const{openThreadWithInfo:T,openChat:U,openPreviousChat:x,toggleLeftColumn:B,exitMessageSelectMode:R,openPremiumModal:J,openStickerSet:N,updateMiddleSearch:E,openSavedDialog:L,focusLastMessage:O,openUniqueGiftBySlug:Y}=(0,w.ko)(),G=(0,xs.A)(),V=(0,Gt.li)(!0),{isDesktop:j,isTablet:q}=(0,D.Ay)(),{width:W}=(0,Wa.A)(),K=W<=a.j7z,z=q&&c,H=(0,Gt.li)(),_=(0,Zt.A)(()=>{E({chatId:e,threadId:t,update:{}})}),$=(0,Zt.A)(s=>{s.target.closest(".title > .custom-emoji")||T({chatId:e,threadId:t,isOwnProfile:!1})}),{onMouseDown:X,onMouseUp:Q,onMouseLeave:Z,onTouchStart:ee,onTouchEnd:te}=(0,po.A)({onStart:_,onClick:$,threshold:500}),se=((0,Zt.A)(()=>{L({chatId:e}),O()}),(0,Zt.A)(()=>{setTimeout(()=>{V.current=!0},450)})),ae=(0,Zt.A)(()=>{M?Y({slug:M}):J({fromUserId:e})}),oe=(0,Zt.A)(()=>{M?Y({slug:M}):N({stickerSetInfo:A.stickerSetInfo})}),ie=(0,Zt.A)(e=>{if(V.current){if(V.current=!1,o){const e=document.querySelector(a.m$5);e?.blur()}if(r)return R(),void se();if("thread"===s&&0===g)return!q||z?(e.stopPropagation(),U({id:void 0},{forceOnHeavyAnimation:!0})):B(),void se();x(),se()}}),ne=(0,qa.A)(g),re=void 0!==ne&&ne<g?ne:void 0,de=Boolean(l),ce=j&&de,le=de||!j,{connectionStatusText:ue}=(0,_s.A)(G,I,v||b,!0);function he(e=!1,t=!1){return(0,cs.FD)("div",{className:"back-button",children:[(0,cs.Y)(Rs.A,{round:!0,size:"smaller",color:"translucent",onClick:ie,ariaLabel:G(e?"Close":"Back"),children:(0,cs.Y)("div",{className:(0,qt.A)("animated-close-icon",!e&&"state-back")})}),t&&(0,cs.Y)(ys,{})]})}return(0,cs.FD)("div",{className:"MiddleHeader",ref:H,"data-tauri-drag-region":!(!gt.Vq||!d.MP)||void 0,children:[!1,(0,cs.Y)(ks.Ay,{name:f?"none":"slideFade",activeKey:g,shouldCleanup:!0,cleanupExceptionKey:re,children:"thread"===s&&(t===i.l3||C||u?.isForum)?function(){const s=C?G("SavedMessages"):void 0,a=C?String(t):e,o=u?.isMonoforum?u.linkedMonoforumId:a;return(0,cs.FD)(cs.FK,{children:[(K||g>0)&&he(z,!C),(0,cs.Y)("div",{className:"chat-info-wrapper",onMouseDown:X,onMouseUp:Q,onMouseLeave:Z,onTouchStart:ee,onTouchEnd:te,children:(0,k.L8)(o)?(0,cs.Y)(fo.A,{userId:o,typingStatus:n,status:ue||s,withDots:Boolean(ue),withFullInfo:!0,withMediaViewer:!0,withUpdatingStatus:!0,isSavedDialog:C,emojiStatusSize:22,noRtl:!0,onEmojiStatusClick:ae},o):(0,cs.Y)(mo.A,{chatId:o,threadId:C?void 0:t,typingStatus:n,withMonoforumStatus:u?.isMonoforum,status:ue||s,withDots:Boolean(ue),withMediaViewer:t===i.l3,withFullInfo:t===i.l3,withUpdatingStatus:!0,isSavedDialog:C,emojiStatusSize:22,onEmojiStatusClick:oe,noRtl:!0},o)})]})}():(0,cs.FD)(cs.FK,{children:[he(),(0,cs.Y)("h3",{children:void 0!==h?"thread"===s?h?G(p?"Comments":"Replies",h,"i"):G(p?"CommentsTitle":"RepliesTitle"):"pinned"===s?G("PinnedMessagesCount",h,"i"):"scheduled"===s?m?G("Reminders"):G("messages",h,"i"):void 0:G("Loading")})]})}),!le&&(0,cs.Y)(Zo,{chatId:e,threadId:t,messageListType:s,onFocusPinnedMessage:P,getLoadingPinnedId:S,getCurrentPinnedIndex:y},e),(0,cs.FD)("div",{className:"header-tools",children:[ce&&(0,cs.Y)(Eo,{}),(0,cs.Y)(go.A,{chatId:e,threadId:t,messageListType:s,isMobile:o,canExpandActions:!ce})]})]})}));var ti=s(15283),si=s(5718),ai=s(63744),oi=s(35049),ii=s(81949),ni=s(89873);const ri=(0,Gt.ph)((0,w.EK)((e,{chatId:t})=>{const s=(0,C.yps)(e,t),a=(0,C.v8U)(e,t);return{isBot:Boolean(s),sponsoredMessage:a}})(({chatId:e,isBot:t,messageListType:s,sponsoredMessage:a,onPaneStateChange:o})=>{const{viewSponsored:i,openUrl:n,clickSponsored:r,openAboutAdsModal:d}=(0,w.ko)(),c=(0,Qt.A)(),l=Boolean(t&&a&&"thread"===s),u=(0,wo.A)(a),{ref:h,shouldRender:p}=(0,To.A)({isOpen:l,withResizeObserver:!0,onStateChange:o}),{isContextMenuOpen:m,contextMenuAnchor:f,handleBeforeContextMenu:g,handleContextMenu:I,handleContextMenuClose:v,handleContextMenuHide:b}=(0,io.A)(h,!p,!0),y=(0,Zt.A)(()=>{u&&(r({randomId:u.randomId}),n({url:u.url,shouldSkipModal:!0}))}),S=(0,Zt.A)(e=>{if(!u)return;const{randomId:t,additionalInfo:s,canReport:a,sponsorInfo:o}=u;e.stopPropagation(),d({randomId:t,additionalInfo:s,canReport:a,sponsorInfo:o})});if((0,Gt.vJ)(()=>{p&&u&&i({randomId:u.randomId})},[p,u,e]),!p||!u)return;const{randomId:A,canReport:M,additionalInfo:C,sponsorInfo:P}=u,{peerColor:k,content:F,photo:T,title:U}=u;return(0,cs.FD)(cs.FK,{children:[(0,cs.FD)("div",{ref:h,className:"yMkfzjus",onClick:y,onMouseDown:g,onContextMenu:I,children:[(0,cs.FD)("div",{className:(0,qt.A)("__w9Ejd3",k&&(0,oi.a)(k)),children:[(0,cs.FD)("span",{className:"wdU19Be7",children:[c("SponsoredMessageAd"),(0,cs.Y)(ii.A,{onClick:S,className:"SrgXYpPk",children:c("SponsoredMessageAdWhatIsThis")})]}),(0,cs.Y)("div",{className:"u2vIptvT",children:U}),F.text&&(0,cs.Y)("div",{className:"SVG6BaX3",children:(0,Gs.fd)({text:F.text.text,entities:F.text.entities})})]}),T&&(0,cs.Y)(la.A,{size:"large",photo:T,className:"AQFE1t4V"})]}),f&&(0,cs.Y)(ni.A,{isOpen:m,anchor:f,triggerRef:h,randomId:A,additionalInfo:C,canReport:M,sponsorInfo:P,onClose:v,onCloseAnimationEnd:b})]})})),di=(0,Gt.ph)((0,w.EK)((e,{peerId:t})=>{const s=(0,C.kBv)(e,t),a=s?.botVerification;return{botVerification:a,wasShown:e.settings.botVerificationShownPeerIds.includes(t)}})(({peerId:e,wasShown:t,botVerification:s,onPaneStateChange:a})=>{const o=Boolean(!t&&s),{markBotVerificationInfoShown:i}=(0,w.ko)(),{ref:n,shouldRender:r}=(0,To.A)({isOpen:o,onStateChange:a}),d=(0,Zt.A)(()=>{i({peerId:e})});if((0,_t.A)(d,t?void 0:5e3),r&&s)return(0,cs.FD)("div",{ref:n,className:"sAWttcxl",children:[(0,cs.Y)("span",{className:"tK9d2y8u",children:(0,cs.Y)(fa.A,{documentId:s.iconId,size:16})}),s.description]})}));var ci=s(19806);const li=(0,Gt.ph)((0,w.EK)((e,{chatId:t})=>({currentUserId:e.currentUserId,peer:(0,C.PVB)(e,t)}))(({chatId:e,className:t,isAutoArchived:s,canReportSpam:a,canAddContact:o,canBlockContact:i,peer:n,currentUserId:r,onPaneStateChange:d})=>{const{openAddContactDialog:c,blockUser:l,reportSpam:u,deleteChat:h,leaveChannel:p,deleteChatUser:m,deleteHistory:f,toggleChatArchived:g,hidePeerSettingsBar:I}=(0,w.ko)(),v=(0,xs.A)(),[b,A,M]=(0,$s.A)(),[C,P]=(0,Gt.J0)(!0),[k,F]=(0,Gt.J0)(!0),T=(0,wo.A)(n),U=T&&(0,S.vj)(T)?T:void 0,x=T&&(0,S.mO)(T)?T:void 0,B=U&&(0,y.yn)(U),R=(0,wo.A)(o),J=(0,wo.A)(i),N=(0,wo.A)(a),E=(0,wo.A)(s),L=(0,Zt.A)(()=>{c({userId:e}),E&&g({id:e})}),O=(0,Zt.A)(()=>{M(),l({userId:e}),N&&C&&u({chatId:e}),k&&h({chatId:e})}),D=(0,Zt.A)(()=>{I({peerId:e})}),Y=(0,Zt.A)(()=>{M(),u({chatId:e}),B?(m({chatId:e,userId:r}),f({chatId:e,shouldDeleteForAll:!1})):p({chatId:e})}),G=Boolean((o||i||a)&&n);(0,Gt.vJ)(()=>{G||M()},[G]);const{ref:V,shouldRender:j}=(0,To.A)({isOpen:G,onStateChange:d});if(j)return(0,cs.FD)("div",{ref:V,className:(0,qt.A)("ChatReportPane",t),dir:v.isRtl?"rtl":void 0,children:[R&&(0,cs.Y)(Rs.A,{isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:L,children:v("lng_new_contact_add")}),J&&(0,cs.Y)(Rs.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:A,children:v("lng_new_contact_block")}),N&&!J&&(0,cs.Y)(Rs.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:A,children:v("lng_report_spam_and_leave")}),(0,cs.Y)(Rs.A,{round:!0,ripple:!0,size:"smaller",color:"translucent",onClick:D,ariaLabel:v("Close"),children:(0,cs.Y)(Js.A,{name:"close"})}),(0,cs.FD)(Wo.A,{isOpen:b,onClose:M,title:v("BlockUserTitle",x?(0,y.u0)(x):(0,y.Js)(v,U)),text:x?v("UserInfo.BlockConfirmationTitle",(0,y.Yg)(x)):v("Chat.Confirm.ReportSpam.Channel"),confirmIsDestructive:!0,confirmLabel:v("Block"),confirmHandler:x?O:Y,children:[x&&(0,cs.Y)(ci.A,{className:"dialog-checkbox",label:v("DeleteThisChat"),checked:k,onCheck:F}),x&&a&&(0,cs.Y)(ci.A,{className:"ChatReportPane--Checkbox dialog-checkbox",label:v("ReportChat"),checked:C,onCheck:P})]})]})})),ui={root:"xqcWnBH4",message:"CJhqoyif",messageStars:"sZR8zqEk",messageStarIcon:"AKXOpk8S"},hi=(0,Gt.ph)((0,w.EK)((e,{peerId:t})=>{const s=(0,C.hds)(e,t),a=(0,C.vGo)(e,t),o=a?.settings?.chargedPaidMessageStars;return{chargedPaidMessageStars:o,chat:s}})(({chargedPaidMessageStars:e,chat:t,peerId:s,onPaneStateChange:a})=>{const o=Boolean(e),i=(0,Qt.A)(),{openChatRefundModal:n}=(0,w.ko)(),{ref:r,shouldRender:d}=(0,To.A)({isOpen:o,onStateChange:a}),c=(0,Zt.A)(()=>{n({userId:s})});if(!d||!e)return;const l=i("PaneMessagePaidMessageCharge",{peer:t?(0,S.F9)(i,t):void 0,amount:(0,f.U2)(i,e,{asFont:!0,className:ui.messageStarIcon,containerClassName:ui.messageStars})},{withMarkdown:!0,withNodes:!0});return(0,cs.FD)("div",{ref:r,className:ui.root,children:[(0,cs.Y)("div",{className:ui.message,children:l}),(0,cs.Y)(Rs.A,{isText:!0,noForcedUpperCase:!0,pill:!0,fluid:!0,size:"tiny",className:ui.button,onClick:c,children:i("RemoveFeeTitle")})]})})),pi={height:0},mi=(0,Gt.ph)((0,w.EK)((e,{chatId:t})=>{const{audioPlayer:s}=(0,C.nTw)(e),a=(0,C.hds)(e,t),o=(0,C.vGo)(e,t),{chatId:i,messageId:n}=s,r=i&&n?(0,C.O5q)(e,i,n):void 0,d=Boolean((0,C.TCk)(e));return{chat:a,userFullInfo:o,isAudioPlayerRendered:Boolean(r),isMiddleSearchOpen:d,withRightColumnAnimation:(0,C.MBp)(e)}})(({className:e,chatId:t,threadId:s,messageListType:a,chat:o,userFullInfo:n,getCurrentPinnedIndex:r,getLoadingPinnedId:d,isAudioPlayerRendered:c,isMiddleSearchOpen:l,withRightColumnAnimation:u,onFocusPinnedMessage:h})=>{const{settings:p}=n||{},{isDesktop:m}=(0,D.Ay)(),[f,g]=(0,Gt.Ul)(pi),[I,v]=(0,Gt.Ul)(pi),[b,y]=(0,Gt.Ul)(pi),[S,w]=(0,Gt.Ul)(pi),[A,M]=(0,Gt.Ul)(pi),[C,P]=(0,Gt.Ul)(pi),[k,F]=(0,Gt.Ul)(pi),T=c||!m,U=(0,Gt.li)(!0),{shouldRender:x,ref:B}=(0,as.A)({isOpen:!l,withShouldRender:!0,noMountTransition:!0});if((0,ti.A)(()=>{U.current=!1}),(0,si.R)(()=>{const e=f(),t=C(),s=I(),a=[e,b(),S(),t,s,A(),k()],o=U.current,i=a.reduce((e,t)=>e+t.height,0),n=document.getElementById("MiddleColumn");n&&((0,To.S)(a,o),(0,Vt.Tv)(n,{"--middle-header-panes-height":`${i}px`}))},[f,b,I,S,A,C,k]),x)return(0,cs.FD)("div",{ref:B,className:(0,qt.A)("oCUr3DTX",u&&"YPrc0luK",e),children:[(0,cs.Y)(Eo,{isFullWidth:!0,onPaneStateChange:g,isHidden:m}),s===i.l3&&!o?.isForum&&(0,cs.Y)(ai.A,{chatId:t,onPaneStateChange:y}),(0,cs.Y)(li,{chatId:t,canAddContact:p?.canAddContact,canBlockContact:p?.canBlockContact,canReportSpam:p?.canReportSpam,isAutoArchived:p?.isAutoArchived,onPaneStateChange:w}),(0,cs.Y)(di,{peerId:t,onPaneStateChange:P}),(0,cs.Y)(hi,{peerId:t,onPaneStateChange:F}),(0,cs.Y)(Zo,{chatId:t,threadId:s,messageListType:a,onFocusPinnedMessage:h,getLoadingPinnedId:d,getCurrentPinnedIndex:r,onPaneStateChange:v,isFullWidth:!0,shouldHide:!T}),(0,cs.Y)(ri,{chatId:t,messageListType:a,onPaneStateChange:M})]})}));var fi=s(96530);const gi=(0,Gt.ph)((0,w.EK)((e,{userId:t})=>{const s=(0,C.mBe)(e,t);return{userName:(0,y.u0)(s)}})(function({userName:e}){const t=(0,xs.A)(),{openPremiumModal:s}=(0,w.ko)(),a=(0,Zt.A)(()=>s());return(0,cs.FD)("div",{children:[(0,cs.Y)("div",{children:t("Chat.MessagingRestrictedPlaceholder",e)}),(0,cs.Y)(fi.A,{isPrimary:!0,onClick:a,children:t("Chat.MessagingRestrictedPlaceholderAction")})]})})),Ii=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"ReactorListModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},vi=e=>{const{isActive:t}=e,s=(0,ds.A)(zt.ar.Extra,"MiddleSearch",!t,!0);return s?(0,cs.Y)(s,{...e}):void 0};var bi=s(38353);const yi=450+a.xB5,Si=(0,Gt.ph)((0,w.EK)((e,{isMobile:t})=>{const s=(0,C.SJA)(e),{isBlurred:o,background:n,backgroundColor:r,patternColor:d}=(0,C.Gyz)(e,s)||{},{messageLists:c,isLeftColumnShown:l,activeEmojiInteractions:u,seenByModal:h,reactorModal:p,shouldSkipHistoryAnimations:m,chatLanguageModal:f,privacySettingsNoticeModal:g}=(0,C.nTw)(e),I=(0,C.Xf0)(e),{leftColumnWidth:v}=e,b={theme:s,customBackground:n,backgroundColor:r,patternColor:d,isLeftColumnShown:l,isRightColumnShown:(0,C.gjV)(e,t),isBackgroundBlurred:o,hasActiveMiddleSearch:Boolean((0,C.TCk)(e)),isSelectModeActive:(0,C.rTV)(e),isSeenByModalOpen:Boolean(h),isPrivacySettingsNoticeModalOpen:Boolean(g),isReactorListModalOpen:Boolean(p),isChatLanguageModalOpen:Boolean(f),animationLevel:(0,je.l)(e).animationLevel,withInterfaceAnimations:(0,C.PKK)(e),withRightColumnAnimation:(0,C.MBp)(e),currentTransitionKey:Math.max(0,c.length-1),activeEmojiInteractions:u,leftColumnWidth:v};if(!I)return b;const{chatId:S,threadId:w,type:A}=I,M=(0,k.L8)(S),P=(0,C.hds)(e,S),F=(0,C.yps)(e,S),T=(0,C.fcC)(e,S,w),U=S?(0,C.AWZ)(e,S):void 0,x=S?(0,C.vGo)(e,S):void 0,B=(0,C.Ys6)(e,S,w),R=(0,C.Vw0)(e,S,w),J=Boolean(!R?.isCommentsInfo&&R?.fromChannelId),N=(0,C.S0q)(e,S,w),E=P&&(0,y.__)(P,N,J,U),L=(0,C.I_m)(e,S),O="pinned"===A,D="thread"===A&&w===i.l3,Y=Boolean(P&&(0,y.WX)(P)),G=Boolean(P&&D&&(Y||(0,y.Vs)(P))&&P.isNotJoined&&!P.joinRequests&&!P.isMonoforum),V=Boolean(P?.isNotJoined&&P.isJoinToSend),j=Boolean(P?.isNotJoined&&P.isJoinRequest),q=!!M&&(0,C.apd)(e,S),W=Boolean(F&&q),K=!W&&L,z=q&&!F,H=Boolean(P&&(0,y.YE)(P)&&!U),_=(0,C.GA4)(e,S,w)?.replyInfo,$=!!P?.isForum&&w===i.l3&&!_&&(0,C.S0q)(e,S,a.HxB)?.isClosed,X=(0,C.ODG)(e,S),Q=Boolean(P?.isMonoforum&&!_&&X&&!B),Z=(0,C.pSx)(e,S),ee=(0,y.cG)(S,w,e.currentUserId),te=ee&&w!==a.Ckz,se=P&&(M||P?.isCreator||!Y&&!(0,y.Sq)(P,"pinMessages")||(0,y.ub)(P,"pinMessages")),ae=(0,C.vGo)(e,S),oe=ae?.isContactRequirePremium,ie=(0,C.WA9)(e,S),ne=(0,C.trm)(e),re=e.botFreezeAppealId,de=re?(0,C.hds)(e,re):void 0;return{...b,chatId:S,threadId:w,messageListType:A,chat:P,draftReplyInfo:_,isPrivate:M,arePeerSettingsLoaded:Boolean(x?.settings),isComments:J,canPost:!O&&(!P||E)&&!L&&!(V&&P?.isNotJoined)&&!$&&!Q&&!ee&&(!ne||de?.id===S),isPinnedMessageList:O,currentUserBannedRights:P?.currentUserBannedRights,defaultBannedRights:P?.defaultBannedRights,pinnedMessagesCount:T?T.length:0,shouldSkipHistoryAnimations:m,isChannel:Y,canSubscribe:G,canStartBot:K,canRestartBot:W,shouldJoinToSend:V,shouldSendJoinRequest:j,shouldLoadFullChat:H,pinnedIds:T,canUnpin:se,canUnblock:z,isSavedDialog:ee,canShowOpenChatButton:te,isContactRequirePremium:oe,topics:Z,paidMessagesStars:ie,isAccountFrozen:ne,freezeAppealChat:de,shouldBlockSendInMonoforum:Q}})(function({leftColumnRef:e,chatId:t,threadId:s,isComments:o,messageListType:i,isMobile:n,chat:r,draftReplyInfo:c,isPrivate:l,isPinnedMessageList:u,canPost:p,currentUserBannedRights:m,defaultBannedRights:f,pinnedMessagesCount:g,customBackground:I,theme:v,backgroundColor:b,patternColor:S,isLeftColumnShown:A,isRightColumnShown:M,isBackgroundBlurred:P,leftColumnWidth:k,hasActiveMiddleSearch:F,isSelectModeActive:T,isSeenByModalOpen:U,isPrivacySettingsNoticeModalOpen:L,isReactorListModalOpen:O,isChatLanguageModalOpen:Y,animationLevel:G,withInterfaceAnimations:V,withRightColumnAnimation:j,shouldSkipHistoryAnimations:q,currentTransitionKey:W,isChannel:K,arePeerSettingsLoaded:z,canSubscribe:H,canStartBot:_,canRestartBot:$,activeEmojiInteractions:X,shouldJoinToSend:Q,shouldSendJoinRequest:Z,shouldLoadFullChat:ee,pinnedIds:te,canUnpin:se,canUnblock:ae,isSavedDialog:oe,canShowOpenChatButton:ie,isContactRequirePremium:ne,topics:re,paidMessagesStars:de,isAccountFrozen:ce,freezeAppealChat:le,shouldBlockSendInMonoforum:ue}){const{openChat:he,openPreviousChat:pe,unpinAllMessages:me,loadUser:fe,loadPeerSettings:ge,exitMessageSelectMode:Ie,joinChannel:ve,sendBotCommand:be,restartBot:ye,showNotification:Se,loadFullChat:we,setLeftColumnWidth:Ae,resetLeftColumnWidth:Me,unblockUser:Ce}=(0,w.ko)(),{width:Pe}=(0,Wa.A)(),{isTablet:ke,isDesktop:Fe}=(0,D.Ay)(),Te=(0,xs.A)(),Ue=(0,Qt.A)(),[xe,Be]=(0,Gt.J0)(ao.I.None),[Re,Je]=(0,Gt.J0)(!1),Ne=Re&&(!n||!F),[Ee,Le]=(0,Gt.J0)(),[Oe,De]=(0,Gt.J0)(!1),{handleIntersectPinnedMessage:Ye,handleFocusPinnedMessage:Ge,getCurrentPinnedIndex:Ve,getLoadingPinnedId:je}=function(e,t,s){const[a,o]=(0,Gt.Ul)({}),[i,n]=(0,Gt.Ul)(),r=e?`${e}_${t}`:void 0,d=(0,za.A)(()=>a()[r]??0,[a,r]);return(0,Gt.vJ)(()=>{Ha=void 0,n(void 0)},[e,o,n,t]),(0,Gt.vJ)(()=>{if(!r)return;const e=a()[r],t=s?.length||0;e>=t&&o({...a(),[r]:$a(t-1)})},[a,r,s?.length,o]),{handleIntersectPinnedMessage:(0,Zt.A)(({viewportPinnedIdsToAdd:d=[],viewportPinnedIdsToRemove:c=[],shouldCancelWaiting:l})=>{if(!(e&&t&&r&&s?.length))return;if(l)return _a=void 0,void n(void 0);const u=i();if(u){const e=s.indexOf(u);o({...a(),[r]:$a(e)}),n(void 0)}Ha=(0,h.Am)((Ha?.filter(e=>!c.includes(e))??[]).concat(d));const p=(0,C.kdX)((0,w.mS)(),e)||_a;if(_a&&Ha.includes(_a)&&(_a=void 0),p){const e=s.findIndex(e=>e<p);o({...a(),[r]:$a(e)})}else if(Ha.length){const e=Math.max(...Ha),t=s.indexOf(e);o({...a(),[r]:$a(t)})}}),handleFocusPinnedMessage:(0,Zt.A)(i=>{if(!e||!t||!s?.length)return;_a=i;const d=(0,w.mS)(),c=(0,C.gCU)(d,e,t),l=c?.includes(i)||(0,C.Lzh)(d,e,t,i),u=s.indexOf(i),h=(0,Ka.A)(s.length,u+1);l?o({...a(),[r]:h}):n(s[h])}),getCurrentPinnedIndex:d,getLoadingPinnedId:i}}(t,s,te),qe=n?yi:void 0,We=(0,ja.A)(t,qe),Ke=(0,ja.A)(s,qe),ze=(0,ja.A)(i,qe),He=(0,ja.A)(H,qe),_e=(0,ja.A)(_,qe),$e=(0,ja.A)($,qe),Xe=(0,ja.A)(ae,qe),Qe=(0,ja.A)(p,qe)&&!$e&&!_e&&!He&&!Xe&&t!==a.Xab&&!ne,Ze=(0,ja.A)(Ne,qe)&&t!==a.Xab,et=(0,ja.A)(K,qe),tt=(0,ja.A)(Q,qe),st=(0,ja.A)(Z,qe),at=(0,ja.A)(t?Ye:void 0,qe),ot=(0,qa.A)(W),it=void 0!==ot&&ot<W?ot:void 0,{isReady:nt,handleCssTransitionEnd:rt,handleSlideTransitionStop:dt}=function(e,t,s,a,o){const[i,n]=(0,Gt.J0)(!o),r=(0,$t.A)(),d=void 0!==s&&s!==t;return d&&(e?(n(!1),setTimeout(()=>{n(!0)},yi)):r()),(0,os.A)(()=>{e||n(!0)},[e]),{isReady:i&&!d,handleCssTransitionEnd:e?function(e){"transform"===e.propertyName&&e.target===e.currentTarget&&n(Boolean(a))}:void 0,handleSlideTransitionStop:e?function(){n(!0)}:void 0}}(!q&&V,W,ot,t,n);(0,Gt.vJ)(()=>t?(0,Ss.A)(()=>{he({id:void 0})}):void 0,[t,he]),(0,os.A)(()=>{Be(ao.I.None),Le(void 0)},[t]),(0,Gt.vJ)(()=>{if(!d.pz&&!d.Ni)return;const{visualViewport:e}=window;if(!e)return;const t=()=>{const t=e.height!==document.documentElement.clientHeight;(0,jt.RK)(()=>{document.body.classList.toggle("keyboard-visible",t),(0,jt.YS)(()=>{!t&&e.offsetTop&&(0,jt.RK)(()=>{window.scrollTo({top:0})})})})};return e.addEventListener("resize",t),()=>{e.removeEventListener("resize",t)}},[]),(0,Gt.vJ)(()=>{l&&fe({userId:t})},[t,l,fe]),(0,Gt.vJ)(()=>{z||ge({peerId:t})},[t,l,z]),(0,Gt.vJ)(()=>{t&&ee&&nt&&we({chatId:t})},[ee,t,nt,we]);const{initResize:ct,resetResize:lt,handleMouseUp:ut}=function(e,t,s,a,o){const[i,n,r]=(0,$s.A)(),[d,c]=(0,Gt.J0)(0),[l,u]=(0,Gt.J0)(0),h=(0,Zt.A)(t=>{(0,jt.RK)(()=>{if(!e.current)return;const s=t?`${t}px`:"";e.current.style.width=s,o&&e.current.style.setProperty(o,s)})});function p(){(0,jt.RK)(()=>{document.body.classList.remove("cursor-ew-resize")})}return(0,Gt.Nf)(()=>{e.current&&a&&h(a)},[o,e,a,h]),(0,Gt.vJ)(()=>{if(!i)return;const s=e=>{const t=Math.ceil(l+e.clientX-d);h(t)};function a(){o(),t(e.current.offsetWidth)}function o(){p(),document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",a,!1),document.removeEventListener("blur",a,!1),r()}return document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",a,!1),document.addEventListener("blur",a,!1),o},[l,d,e,t,i,r,h]),{initResize:function(t){t.preventDefault(),(0,jt.RK)(()=>{document.body.classList.add("cursor-ew-resize")}),c(t.clientX),u(e.current.offsetWidth),n()},resetResize:function(e){e.preventDefault(),h(void 0),s()},handleMouseUp:p}}(e,e=>Ae({leftColumnWidth:e}),Me,k,"--left-column-width"),ht=(0,Zt.A)(e=>{const{items:t}=e.dataTransfer||{},s=d.Yw||t&&t.length>0&&Array.from(t).filter(e=>"text/uri-list"!==e.type).every(e=>function(e){return"file"===e.kind&&e.type&&a.gex.has(e.type)}(e)||function(e){return"file"===e.kind&&e.type&&a.fNs.has(e.type)}(e));Be(s?ao.I.QuickFile:ao.I.Document)}),pt=(0,Zt.A)(()=>{Be(ao.I.None)}),mt=(0,Zt.A)(()=>{De(!0)}),ft=(0,Zt.A)(()=>{De(!1)}),It=(0,Zt.A)(()=>{he({id:String(s)})}),vt=(0,Zt.A)(()=>{me({chatId:t,threadId:s}),ft(),pe()}),bt=(0,Zt.A)(()=>{he({id:t})}),yt=(0,Zt.A)(()=>{ve({chatId:t}),st&&Se({message:Te(K?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")})}),St=(0,Zt.A)(()=>{be({command:"/start"})}),wt=(0,Zt.A)(()=>{ye({chatId:t})}),At=(0,Zt.A)(()=>{Ce({userId:t})}),Mt=(0,Va.A)(v,I),Ct=(0,qt.A)(d.So?"mask-image-disabled":"mask-image-enabled"),Pt=(0,qt.A)(bi.A.background,j&&bi.A.withTransition,I&&bi.A.customBgImage,b&&bi.A.customBgColor,I&&P&&bi.A.blurred,M&&bi.A.withRightColumn),kt=(0,qt.A)("messaging-disabled",!T&&"shown"),Ft=(0,y.gU)(Te,m,f),Tt=(0,y.zc)(Te,r,s,re,Boolean(c)),Ut=Ft||Tt||(ue?Ue("MonoforumComposerPlaceholder"):void 0)||(ne?(0,cs.Y)(gi,{userId:t}):void 0)||(ce&&le?.id!==t?(0,cs.Y)(lo,{}):void 0),{composerHiddenScale:xt,toolbarHiddenScale:Bt,composerTranslateX:Rt,toolbarTranslateX:Jt,unpinHiddenScale:Nt,toolbarForUnpinHiddenScale:Et}=(0,Gt.Kr)(()=>function(e,t){const s=e<=a.c2m?x.$:2*x.$,o=function(e){if(e>a.gQx){const t=Math.min(Math.max(.25*e,N),J),s=Math.min(.25*e,J);return Math.min(e-t-s,R)}if(e>a.j7z){const t=Math.min(Math.max(.4*e,N),J);return Math.min(e-t,R)}return e>R?R:e}(e),i=3*x.$,n=t?o-s-i:o-s,r=e>a.c2m?Math.min(o-s,B):o-s,d=r/n,c=n/r;return{composerHiddenScale:d,toolbarHiddenScale:c,composerTranslateX:t?i/2*c:0,toolbarTranslateX:t?i/2*-1*d:0,unpinHiddenScale:r/E,toolbarForUnpinHiddenScale:E/r}}(Pe,Qe),[Qe,Pe]),Lt=(0,qt.A)("middle-column-footer",!Qe&&"no-composer",Qe&&Ee&&!T&&"with-notch");(0,js.A)({isActive:T,onBack:Ie}),(0,Xa.A)(S);const Ot=Boolean(!u&&!oe&&!Qe&&!$e&&!_e&&!He&&Ut)||ce&&le?.id!==t,Dt=Boolean($e||He||st||_e||u&&se||ie||Xe),Yt=Boolean(Ot||T);return(0,cs.FD)("div",{id:"MiddleColumn",className:Ct,onTransitionEnd:rt,style:(0,Ga.A)(`--composer-hidden-scale: ${xt}`,`--toolbar-hidden-scale: ${Bt}`,`--unpin-hidden-scale: ${Nt}`,`--toolbar-unpin-hidden-scale: ${Et}`,`--composer-translate-x: ${Rt}px`,`--toolbar-translate-x: ${Jt}px`,`--pattern-color: ${S}`,b&&`--theme-background-color: ${b}`),onClick:ke&&A?bt:void 0,children:[Fe&&(0,cs.Y)("div",{className:"resize-handle",onMouseDown:ct,onMouseUp:ut,onDoubleClick:lt}),(0,cs.Y)("div",{className:Pt,style:Mt?`--custom-background: ${Mt}`:void 0,"data-tauri-drag-region":!(!gt.Vq||!d.MP||We&&Ke)||void 0}),(0,cs.Y)("div",{id:"middle-column-portals"}),Boolean(We&&Ke)&&(0,cs.FD)(cs.FK,{children:[(0,cs.FD)("div",{className:"messages-layout",onDragEnter:Qe?ht:void 0,children:[(0,cs.Y)(mi,{chatId:We,threadId:Ke,messageListType:ze,getCurrentPinnedIndex:Ve,getLoadingPinnedId:je,onFocusPinnedMessage:Ge},We),(0,cs.Y)(ei,{chatId:We,threadId:Ke,messageListType:ze,isComments:o,isMobile:n,getCurrentPinnedIndex:Ve,getLoadingPinnedId:je,onFocusPinnedMessage:Ge}),(0,cs.FD)(ks.Ay,{name:(0,ws.P)("slide",G,q||!V),activeKey:W,shouldCleanup:!0,cleanupExceptionKey:it,isBlockingAnimation:!0,onStop:dt,children:[(0,cs.Y)(uo.A,{chatId:We,threadId:Ke,type:ze,isComments:o,canPost:Qe,onScrollDownToggle:Je,onNotchToggle:Le,isReady:nt,isContactRequirePremium:ne,paidMessagesStars:de,withBottomShift:Dt,withDefaultBg:Boolean(!I&&!b),onIntersectPinnedMessage:at},`${We}-${Ke}-${ze}`),(0,cs.FD)("div",{className:Lt,children:[(0,cs.Y)(co,{withScrollDown:Ze,canPost:Qe,withExtraShift:Yt}),Qe&&(0,cs.Y)(Qa.A,{type:"messageList",chatId:We,threadId:Ke,messageListType:ze,dropAreaState:xe,onDropHide:pt,isReady:nt,isMobile:n,editableInputId:a.CfG,editableInputCssSelector:a.m$5,inputId:"message-input-text"}),u&&se&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.FD)(Rs.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button unpin-all-button",onClick:mt,children:[(0,cs.Y)(Js.A,{name:"unpin"}),(0,cs.Y)("span",{children:Te("Chat.Pinned.UnpinAll",g,"i")})]})}),ie&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.Y)(Rs.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button open-chat-button",onClick:It,children:(0,cs.Y)("span",{children:Te("SavedOpenChat")})})}),Ot&&(0,cs.Y)("div",{className:kt,children:(0,cs.Y)("div",{className:"messaging-disabled-inner",children:(0,cs.Y)("span",{children:Ut})})}),n&&(He||tt&&!st)&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.Y)(Rs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:yt,children:Te(et?"ProfileJoinChannel":"ProfileJoinGroup")})}),n&&st&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.Y)(Rs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:yt,children:Te("ChannelJoinRequest")})}),n&&_e&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.Y)(Rs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:St,children:Te("BotStart")})}),n&&$e&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.Y)(Rs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:wt,children:Te("BotRestart")})}),n&&Xe&&(0,cs.Y)("div",{className:"middle-column-footer-button-container",dir:Te.isRtl?"rtl":void 0,children:(0,cs.Y)(Rs.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:At,children:Te("Unblock")})}),(0,cs.Y)(ho,{messageListType:ze,isActive:T,canPost:Qe}),(0,cs.Y)(eo,{isOpen:U}),(0,cs.Y)(Za,{isOpen:L}),(0,cs.Y)(Ii,{isOpen:O}),d.CM&&(0,cs.Y)(so,{isOpen:Y})]})]})]}),(0,cs.Y)(vi,{isActive:Boolean(F)})]}),t&&(0,cs.Y)(to,{isOpen:Oe,chatId:t,pinnedMessagesCount:g,onClose:ft,onUnpin:vt}),(0,cs.Y)("div",{teactFastList:!0,children:X?.map((e,t)=>(0,cs.Y)(oo,{teactOrderKey:t,activeEmojiInteraction:e},e.id))})]})})),wi=(0,Gt.ph)(e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"AgeVerificationModal",!t);return s?(0,cs.Y)(s,{...e}):void 0}),Ai=(0,Gt.ph)(e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"QuickPreviewModal",!t);return s?(0,cs.Y)(s,{...e}):void 0});var Mi=s(22337),Ci=s(40664),Pi=s(45780);const ki="Jr5CfmFt",Fi="adxoMAFa",Ti="kZxT0KmD",Ui=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{commandPalette:s}=t,a=[...e.chats.listIds.active||[],...e.chats.listIds.archived||[]];return{isOpen:s?.isOpen,query:s?.query,chatIds:a,chatsById:e.chats.byId,currentUserId:e.currentUserId,currentUser:e.currentUserId?e.users.byId[e.currentUserId]:void 0,focusMode:e.focusMode,allWorkspaces:(0,Dt.Vj)(e),currentWorkspaceId:(0,Dt.C9)(e)}})(({isOpen:e,query:t="",chatIds:s,chatsById:a,currentUserId:o,currentUser:i,focusMode:n,allWorkspaces:r,currentWorkspaceId:d})=>{const c=(0,Qt.A)(),{closeCommandPalette:l,setCommandPaletteQuery:u,openChat:h}=(0,w.ko)(),p=(0,Gt.li)(),m=(0,Gt.li)(),[f,g]=(0,Gt.J0)(0),I=(0,Gt.Kr)(()=>function(e,t,s,a){const{setFocusMode:o,setCurrentWorkspace:i,openQuickReminderModal:n}=(0,w.ko)(),r=[];if(a){r.push({id:"disable-focus-mode",title:"Disable Focus Mode",subtitle:"Currently: "+("noDistraction"===a?"No Distraction":"Deep Work"),icon:"unmute",keywords:["turn off","exit"],action:()=>{o({mode:void 0})}});const e="noDistraction"===a?"deepWork":"noDistraction",t="noDistraction"===e?"No Distraction":"Deep Work",s="noDistraction"===e?"eye-crossed":"mute";r.push({id:`switch-focus-${e}`,title:`Switch to ${t}`,subtitle:"Currently: "+("noDistraction"===a?"No Distraction":"Deep Work"),icon:s,keywords:["focus",t.toLowerCase(),e.toLowerCase()],action:()=>{o({mode:e})}})}else r.push({id:"enable-focus-no-distraction",title:"Focus: No Distraction",subtitle:"Hide muted chat badges and online status",icon:"eye-crossed",keywords:["enable","nodistraction"],action:()=>{o({mode:"noDistraction"})}}),r.push({id:"enable-focus-deep-work",title:"Focus: Deep Work",subtitle:"Hide all chat badges and online status",icon:"mute",keywords:["enable","deepwork"],action:()=>{o({mode:"deepWork"})}});const d=[];return r.length>0&&d.push(...r),e.length>1&&d.push(...e.filter(e=>e.id!==t).map(e=>({id:`switch-workspace-${e.id}`,title:`Switch to ${e.name}`,avatar:(0,Gt.n)(Ca,{workspace:e,currentUser:s,size:"tiny",isRectangular:!1}),keywords:["workspace",e.name.toLowerCase(),...e.id===Dt.a3?["default"]:[]],action:()=>{i({workspaceId:e.id})}}))),d.push({id:"quick-reminder",title:"Quick Reminder",subtitle:"Schedule a message for yourself",icon:"schedule",keywords:["schedule"],action:()=>{n()}}),d}(r,d,i,n),[n,r,d,i]),v=(0,Gt.Kr)(()=>function(e,t){if(!t)return e;const s=t.toLowerCase().trim(),a=[];return e.forEach(e=>{const t=e.title.toLowerCase().includes(s),o=e.keywords?.some(e=>e.toLowerCase().includes(s));(t||o)&&a.push(e)}),a}(I,t),[I,t]),b=(0,Gt.Kr)(()=>{if(!s||!a)return[];const e=t.toLowerCase().trim(),o=s.map(e=>({id:e,title:a[e]?.title||"",chat:a[e]})).filter(e=>e.title);return e?o.filter(t=>t.title.toLowerCase().includes(e)):o.slice(0,10)},[t,s,a]),y=v.length+b.length;(0,Gt.vJ)(()=>{e&&(g(0),p.current&&p.current.focus())},[e]),(0,Gt.vJ)(()=>{g(0)},[t]),(0,Gt.vJ)(()=>{if(!m.current)return;const e=m.current.querySelector(`[data-index="${f}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},[f,y]);const S=(0,Zt.A)(e=>{u({query:e.target.value})}),A=(0,Zt.A)(e=>{if("Escape"!==e.key){if("ArrowDown"===e.key)return e.preventDefault(),void g(e=>Math.min(e+1,y-1));if("ArrowUp"===e.key)return e.preventDefault(),void g(e=>Math.max(e-1,0));if("Enter"===e.key&&y>0)if(e.preventDefault(),f<v.length)v[f].action(),l();else{const e=f-v.length,t=b[e];t&&(h({id:t.id,shouldReplaceHistory:!0}),l())}}else l()}),M=(0,Zt.A)(e=>{h({id:e,shouldReplaceHistory:!0}),l()}),C=(0,Zt.A)(e=>{e.action(),l()});if(e)return(0,cs.Y)(Mi.A,{className:"opTvtryk",isOpen:e,onClose:l,noBackdrop:!1,noBackdropClose:!1,children:(0,cs.FD)("div",{className:"IaVn3kMQ",children:[(0,cs.Y)("div",{className:"tfgKztap",children:(0,cs.Y)(Ci.A,{ref:p,placeholder:c("CommandPaletteSearchPlaceholder"),value:t,onChange:S,onKeyDown:A,teactExperimentControlled:!0})}),(0,cs.Y)("div",{className:(0,qt.A)("qyJpq854","custom-scroll"),children:0===y?(0,cs.Y)("div",{className:"KkY1SDLj",children:c("CommandPaletteNoResults")}):(0,cs.FD)("div",{className:"i2jC9728",ref:m,children:[0===v.length?null:(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("div",{className:ki,children:"Commands"}),v.map((e,t)=>(0,cs.Y)("div",{"data-index":t,children:(0,cs.Y)(Pi.A,{className:(0,qt.A)(Fi,t===f&&Ti),title:e.title,subtitle:e.subtitle,avatarElement:e.avatar?e.avatar:e.icon?(0,cs.Y)("div",{className:"XnPr0Les",children:(0,cs.Y)(Js.A,{name:e.icon})}):void 0,ripple:!0,onClick:()=>C(e)})},e.id))]}),0===b.length?null:(0,cs.FD)(cs.FK,{children:[v.length>0&&(0,cs.Y)("div",{className:ki,children:"Chats"}),b.map((e,t)=>{const s=e.id===o,a=v.length+t;return(0,cs.Y)("div",{"data-index":a,children:(0,cs.Y)(Pi.A,{className:(0,qt.A)(Fi,a===f&&Ti),title:(0,cs.Y)("div",{className:"title-wrapper",children:(0,cs.Y)(ua.A,{className:"item-title",peer:e.chat,isSavedMessages:s})}),avatarElement:e.chat&&(0,cs.Y)(la.A,{peer:e.chat,size:"tiny",isSavedMessages:s}),ripple:!0,onClick:()=>M(e.id)})},e.id)})]})]})})]})})})),xi={giftCodeModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"GiftCodeModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},boostModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"BoostModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},chatlistModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"ChatlistModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},urlAuth:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"UrlAuthModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},oneTimeMediaModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"OneTimeMediaModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},inviteViaLinkModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"InviteViaLinkModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},requestedAttachBotInstall:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"AttachBotInstallModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},reportAdModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"ReportAdModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},reportModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"ReportModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},webApps:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"WebAppModal",!t?.isModalOpen);return s?(0,cs.Y)(s,{...e}):void 0},collectibleInfoModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"CollectibleInfoModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},mapModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"MapModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},starsPayment:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"StarPaymentModal",!t?.inputInvoice);return s?(0,cs.Y)(s,{...e}):void 0},starsBalanceModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"StarsBalanceModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},starsTransactionModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"StarsTransactionInfoModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},chatInviteModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"ChatInviteModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},paidReactionModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"PaidReactionModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},suggestMessageModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"SuggestMessageModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},suggestedPostApprovalModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"SuggestedPostApprovalModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},starsSubscriptionModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"StarsSubscriptionModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},starsGiftModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"StarsGiftModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},isGiftRecipientPickerOpen:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftRecipientPicker",!t);return s?(0,cs.Y)(s,{...e}):void 0},isWebAppsCloseConfirmationModalOpen:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"WebAppsCloseConfirmationModal",!t);return s?(0,cs.Y)(s,{isOpen:t}):void 0},giftInfoModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftInfoModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftInfoValueModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftInfoValueModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},lockedGiftModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftLockedModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftResalePriceComposerModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftResalePriceComposerModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},suggestedStatusModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"SuggestedStatusModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},emojiStatusAccessModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"EmojiStatusAccessModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},locationAccessModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"LocationAccessModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},aboutAdsModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"AboutAdsModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftUpgradeModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftUpgradeModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},monetizationVerificationModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"VerificationMonetizationModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftWithdrawModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftWithdrawModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftStatusInfoModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftStatusInfoModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},preparedMessageModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"PreparedMessageModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},sharePreparedMessageModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"SharePreparedMessageModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftTransferModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftTransferModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},giftTransferConfirmModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"GiftTransferConfirmModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},chatRefundModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Stars,"ChatRefundModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},priceConfirmModal:({modal:e})=>{const t=(0,ds.A)(zt.ar.Stars,"PriceConfirmModal",!e);return t?(0,cs.Y)(t,{modal:e}):void 0},isFrozenAccountModalOpen:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"FrozenAccountModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},deleteAccountModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"DeleteAccountModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},isAgeVerificationModalOpen:wi,profileRatingModal:e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"ProfileRatingModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},quickPreview:Ai,commandPalette:()=>(0,cs.Y)(Ui,{}),quickReminderModal:(0,Gt.ph)(e=>{const{modal:t}=e,s=(0,ds.A)(zt.ar.Extra,"QuickReminderModal",!t);return s?(0,cs.Y)(s,{...e}):void 0})},Bi=Object.keys(xi),Ri=Object.entries(xi),Ji=(0,Gt.ph)((0,w.EK)(e=>(0,h.Up)((0,C.nTw)(e),Bi))(e=>Ri.map(([t,s])=>(0,cs.Y)(s,{modal:e[t]},t)))),Ni=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"PaymentModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},Ei=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"ReceiptModal",!t);return s?(0,cs.Y)(s,{...e}):void 0};var Li=s(37859),Oi=s(60406),Di=s(79582),Yi=s(54960),Gi=s(12933);const Vi=(0,Gt.ph)((0,w.EK)((e,{chatId:t})=>{const s=(0,C.hds)(e,t),{userIds:a}=e.contactList||{},{newChatMembersProgress:o}=(0,C.nTw)(e),{currentUserId:i}=e,r=s&&(0,y.WX)(s),{query:d,fetchingStatus:c,globalUserIds:l,localUserIds:u}=(0,C.nTw)(e).userSearch;return{isChannel:r,members:(0,C.AWZ)(e,t)?.members,currentUserId:i,localContactIds:a,searchQuery:d,isSearching:c,isLoading:o===n.D7.Loading,globalUserIds:l,localUserIds:u}})(({isChannel:e,members:t,onNextStep:s,currentUserId:a,localContactIds:o,isLoading:i,searchQuery:n,isSearching:r,localUserIds:d,globalUserIds:c,onClose:l,isActive:u})=>{const{setUserSearchQuery:p}=(0,w.ko)(),m=(0,xs.A)(),[f,g]=(0,Gt.J0)([]),I=(0,qa.A)(f)===f;(0,js.A)({isActive:u,onBack:l});const v=(0,Gt.Kr)(()=>t?t.map(e=>e.userId):[],[t]),b=(0,Gt.hb)(e=>{p({query:e})},[p]),A=(0,Gt.Kr)(()=>{const t=(0,w.mS)().users.byId,s=(0,S.PU)({ids:(0,h.Am)([...o||[],...d||[],...c||[]]),query:n,type:"user"});return(0,Di.A)(s.filter(s=>{const o=t[s];return!v.includes(s)&&s!==a&&(!o||!(0,y.tv)(o)||!e&&o.canBeInvitedToGroup)}))},[o,n,d,c,a,v,e]),M=(0,Gt.hb)(()=>{f.length&&(p({query:""}),s(f))},[f,p,s]);return(0,cs.Y)("div",{className:"AddChatMembers",children:(0,cs.FD)("div",{className:"AddChatMembers-inner",children:[(0,cs.Y)(Yi.A,{itemIds:A,selectedIds:f,filterValue:n,filterPlaceholder:m("lng_channel_add_users"),searchInputId:"new-members-picker-search",isLoading:r,onSelectedIdsChange:g,onFilterChange:b,isSearchable:!0,withDefaultPadding:!0,noScrollRestore:I,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,cs.Y)(Gi.A,{isShown:Boolean(f.length),disabled:i,ariaLabel:m("lng_channel_add_users"),onClick:M,children:i?(0,cs.Y)(sa.A,{color:"white"}):(0,cs.Y)(Js.A,{name:"arrow-right"})})]})})})),ji=e=>{const t=(0,ds.A)(zt.ar.Extra,"CreateTopic");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})},qi=e=>{const t=(0,ds.A)(zt.ar.Extra,"EditTopic");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})},Wi=()=>{const e=(0,ds.A)(zt.ar.Extra,"GifSearch");return e?(0,cs.Y)(e,{}):(0,cs.Y)(Fs.A,{})},Ki=e=>{const t=(0,ds.A)(zt.ar.Extra,"Management");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})},zi=()=>{const e=(0,ds.A)(zt.ar.Extra,"PollResults");return e?(0,cs.Y)(e,{}):(0,cs.Y)(Fs.A,{})};var Hi=s(55475),_i=s(35104);class $i{hierarchy=[];constructor(e){this.hierarchy=[...e||[]]}with(e){return new $i([...this.hierarchy,e])}getTypes(){return this.hierarchy}}const Xi=new $i(["rightColumn"]),Qi=Xi.with("profileAvatar"),Zi=Qi.with("profileExpand"),en=Qi.with("profileCollapse"),tn=Xi.with("profileGifts");var sn=s(58443),an=s(55429),on=s(68323),nn=s(41385),rn=s(23459),dn=s(83868);const cn="no-overscroll",ln="no-touch",un={lastDeltas:new Array(7).fill(0),lastAverageDelta:0,isStartedAtTop:!1,resetStartTopAt:void 0,timeout:void 0};var hn=s(5912),pn=s(66230);const mn=(0,I.nF)(e=>e(),250,!1);let fn=!1;function gn(e){switch(e){case"members":return n.zW.MemberList;case"gifts":return n.zW.GiftList;case"stories":return n.zW.StoryList;case"dialogs":return n.zW.SavedDialogs;default:return n.zW.SharedMedia}}var In=s(96374);function vn(e,t){const[s,o]=(0,In.A)(e,t,void 0,a.nnT);return[s,o,!(!s||!t||s[0]===t[0])]}function bn(e,t,s,o,i,n){const r=(0,Gt.li)();(0,os.A)(()=>{r.current=void 0},[n]),(0,os.A)(()=>{t===e&&o&&i&&(r.current=(0,y.lH)(o,i,e))},[o,i,t,e]);const[d,c]=(0,In.A)(s,r.current,void 0,"media"===e?a.Um:a.gXr);return[d,c,!(!d||!r.current||d[0]===r.current[0])]}var yn=s(64489),Sn=s(65240),wn=s(55723),An=s(58968),Mn=s(66833),Cn=s(82855),Pn=s(40558),kn=s(25404),Fn=s(87049);const Tn="LLQBJODm",Un="_TMVTkD4",xn=(0,Gt.ph)((0,w.EK)((e,{peerId:t,gift:s})=>{const a=s.fromId?(0,C.PVB)(e,s.fromId):void 0,o=(0,C.hds)(e,t),i=o&&(0,y.ub)(o,"postMessages"),n=e.currentUserId,r=n?(0,C.mBe)(e,n):void 0,d=r?.emojiStatus,c=e.collectibleEmojiStatuses?.statuses;return{fromPeer:a,hasAdminRights:i,currentUserId:n,currentUserEmojiStatus:d,collectibleEmojiStatuses:c}})(({peerId:e,gift:t,style:s,fromPeer:o,currentUserId:i,hasAdminRights:n,collectibleEmojiStatuses:r,currentUserEmojiStatus:c,className:l,observeIntersection:u})=>{const{openGiftInfoModal:h}=(0,w.ko)(),p=(0,Gt.li)(),m=(0,Gt.li)(),g=(0,Qt.A)(),[I,v,b]=(0,$s.A)(),y=e===i||n,S=(0,Mn.UC)(t.gift),A=t.gift,M="starGiftUnique"===A.type?A:void 0,C=(0,Gt.Kr)(()=>{if(M?.resellPrice)return M.resaleTonOnly?M.resellPrice.find(e=>e.currency===a.ykW):M.resellPrice.find(e=>e.currency===a.OUy)},[M]),P=M?.resellPrice?g("GiftRibbonSale"):t.isPinned&&M?g("GiftSavedNumber",{number:M.number}):S?g("ActionStarGiftLimitedRibbon",{total:(0,vs.Vw)(g,S)}):void 0,k=M?.resellPrice?"green":"blue",{isContextMenuOpen:F,contextMenuAnchor:T,handleBeforeContextMenu:U,handleContextMenu:x,handleContextMenuClose:B,handleContextMenuHide:R}=(0,io.A)(p),J=(0,Zt.A)(()=>p.current),N=(0,Zt.A)(()=>p.current.closest(".custom-scroll")),E=(0,Zt.A)(()=>document.querySelector("#portals")?.querySelector(".saved-gift-context-menu .bubble")),L=(0,Zt.A)(()=>({withPortal:!0})),O=(0,Zt.A)(()=>{h({peerId:e,gift:t})}),D=t.isNameHidden&&!o?An.I5:o,Y=(0,Mn.yQ)(t.gift),G=(0,Gt.Kr)(()=>(0,Mn.uc)(t.gift),[t.gift]),{backdrop:V,pattern:j}=G||{},q=(0,Gt.Kr)(()=>{if(!V||!j)return;const e=[V.centerColor,V.edgeColor],t=V.patternColor;return(0,cs.Y)(Pn.A,{className:"_I9aOdGr",backgroundColors:e,patternColor:t,patternIcon:j.sticker,patternSize:14,ringsCount:1,ovalFactor:1})},[V,j]);if(Y)return(0,cs.FD)("div",{ref:p,className:(0,qt.A)("interactive-gift scroll-item","HN4dYXIk",l),style:s,onClick:O,onContextMenu:x,onMouseDown:U,onMouseEnter:d.TF?void 0:v,onMouseLeave:d.TF?void 0:b,children:[q,!q&&(0,cs.Y)(la.A,{className:Un,peer:D,size:"micro"}),t.isPinned&&(0,cs.Y)(Js.A,{name:"pinned-message",className:Un}),(0,cs.Y)("div",{ref:m,className:"NYuBBB9j",style:"width: 90px; height: 90px",children:Y&&(0,cs.Y)(Cn.A,{containerRef:m,sticker:Y,size:90,shouldLoop:I,shouldPreloadPreview:!0,observeIntersectionForPlaying:u,observeIntersectionForLoading:u})}),t.isUnsaved&&(0,cs.Y)("div",{className:"xY4yqqYA",children:(0,cs.Y)(Js.A,{name:"eye-crossed-outline"})}),C&&(0,cs.Y)(Rs.A,{className:"haa6STaT",nonInteractive:!0,size:"tiny",withSparkleEffect:!0,noSparkleAnimation:!0,pill:!0,fluid:!0,children:"TON"===C.currency?(0,f.Ms)(g,C.amount,{shouldConvertFromNanos:!0,className:Tn}):(0,f.U2)(g,C.amount,{asFont:!0,className:Tn})}),P&&(0,cs.Y)(Fn.A,{color:k,text:P}),void 0!==T&&(0,cs.Y)(Ns.A,{isOpen:F,anchor:T,className:"saved-gift-context-menu",autoClose:!0,withPortal:!0,getMenuElement:E,getTriggerElement:J,getRootElement:N,getLayout:L,onClose:B,onCloseAnimationEnd:R,children:(0,cs.Y)(kn.A,{peerId:e,gift:t,canManage:y,collectibleEmojiStatuses:r,currentUserEmojiStatus:c})})]})}));var Bn=s(81524),Rn=s(42827),Jn=s(83057);const Nn=(0,Gt.ph)(({media:e,idPrefix:t="preview-media",isProtected:s,observeIntersection:a,onClick:o,index:i})=>{const n=(0,Gt.li)(),r=(0,hn.Vz)(n,a),d=(0,Oo.A)(e),c=(0,yo.A)(e,"preview"),l=(0,Co.A)(c,!r),u=(0,Jn.A)(l),h=e.content.video,p=(0,Zt.A)(()=>{o(i)});return(0,cs.FD)("div",{ref:n,id:`${t}${i}`,className:"Media scroll-item",onClick:p,children:[(0,cs.Y)("img",{src:d,className:"media-miniature",alt:"",draggable:!s,decoding:"async",onContextMenu:s?dn.A:void 0}),(0,cs.Y)("img",{src:l,className:(0,qt.A)("full-media","media-miniature",u),alt:"",draggable:!s,decoding:"async",onContextMenu:s?dn.A:void 0}),h&&(0,cs.Y)("span",{className:"video-duration",children:h.isGif?"GIF":(0,Se.QO)(h.duration)}),s&&(0,cs.Y)("span",{className:"protector"})]})});var En=s(44784),Ln=s(87970),On=s(37378),Dn=s(54464),Yn=s(59816);const Gn="NOCaj4mx",Vn=(0,Gt.ph)((0,w.EK)((e,{story:t})=>{const s=(0,C.hds)(e,t.peerId),a=s?.isProtected,{maxPinnedStoriesCount:o}=e.appConfig,i="isOut"in t&&t.isOut,n=(0,C.gVx)(e,t.peerId),r=n?.some(e=>e.id===t.id);return{isProtected:a,isPinned:r,canPin:i&&(!o||(n?.length||0)<o)}})(function({story:e,isProtected:t,isArchive:s,isPinned:a,canPin:o}){const{openStoryViewer:i,loadPeerSkippedStories:n,toggleStoryInProfile:r,toggleStoryPinnedToTop:d,showNotification:c}=(0,w.ko)(),l=(0,xs.A)(),u=(0,Gt.li)(),h=(0,Zt.A)(()=>u.current),p=(0,Zt.A)(()=>document.body),m=(0,Zt.A)(()=>document.querySelector("#portals .story-context-menu .bubble")),f=(0,Zt.A)(()=>({withPortal:!0,isDense:!0})),g=e&&e.peerId,I=e&&"content"in e,v=I&&e.isOut,b=e&&"isDeleted"in e,S=I?e.content.video:void 0,A=S&&(0,Se.QO)(S.duration),M=I?(0,y.EN)(e):void 0,C=(0,Co.A)(M)||S?.thumbnail?.dataUri;(0,Gt.vJ)(()=>{!e||I||b||n({peerId:e.peerId})},[b,I,e]);const{isContextMenuOpen:P,contextMenuAnchor:k,handleBeforeContextMenu:F,handleContextMenu:T,handleContextMenuClose:U,handleContextMenuHide:x}=(0,io.A)(u,!v),B=(0,Gt.hb)(()=>{i({peerId:e.peerId,storyId:e.id,isSinglePeer:!0,isPrivate:!0,isArchive:s})},[s,e.id,e.peerId]),R=(0,Zt.A)(e=>{(0,Dn.u)(e),F(e)}),J=(0,Zt.A)(t=>{(0,dn.A)(t),r({peerId:g,storyId:e.id,isInProfile:!0}),c({message:l("Story.ToastSavedToProfileText")}),U()}),N=(0,Zt.A)(t=>{(0,dn.A)(t),r({peerId:g,storyId:e.id,isInProfile:!1}),c({message:l("Story.ToastRemovedFromProfileText")}),U()}),E=(0,Zt.A)(()=>{d({peerId:g,storyId:e.id}),U()});return(0,cs.FD)("div",{ref:u,className:(0,qt.A)("kxMIqtqr","scroll-item"),onMouseDown:R,onClick:B,onContextMenu:T,children:[b&&(0,cs.FD)("span",{children:[(0,cs.Y)(Js.A,{className:"cq7jTRkg",name:"story-expired"}),l("ExpiredStory")]}),a&&(0,cs.Y)(Js.A,{className:(0,qt.A)(Gn,"GTWFQyJx"),name:"pin-badge"}),I&&Boolean(e.views?.viewsCount)&&(0,cs.FD)("span",{className:(0,qt.A)(Gn,"g09Rb4Ps"),children:[(0,cs.Y)(Js.A,{name:"eye"}),e.views.viewsCount]}),A&&(0,cs.Y)("span",{className:(0,qt.A)(Gn,"lM_2MMyQ"),children:A}),(0,cs.FD)("div",{className:"D6Yajvjx",children:[C&&(0,cs.Y)("img",{src:C,alt:"",className:"cV_QL3N5",draggable:!1}),I&&(0,cs.Y)(Yn.A,{story:e}),t&&(0,cs.Y)("span",{className:"protector"})]}),void 0!==k&&(0,cs.FD)(Ns.A,{isOpen:P,anchor:k,getTriggerElement:h,getRootElement:p,getMenuElement:m,getLayout:f,className:(0,qt.A)("UAfI9izT","story-context-menu"),autoClose:!0,onClose:U,onCloseAnimationEnd:x,withPortal:!0,children:[s&&(0,cs.Y)(Es.A,{icon:"archive",onClick:J,children:l("StoryList.SaveToProfile")}),!s&&(0,cs.Y)(Es.A,{icon:"archive",onClick:N,children:l("Story.Context.RemoveFromProfile")}),!s&&!a&&o&&(0,cs.Y)(Es.A,{icon:"pin",onClick:E,children:l("StoryList.ItemAction.Pin")}),!s&&a&&(0,cs.Y)(Es.A,{icon:"unpin",onClick:E,children:l("StoryList.ItemAction.Unpin")})]})]})}));var jn=s(46222),qn=s(22720),Wn=s(285),Kn=s(36838),zn=s(93545),Hn=s(79577);const _n=(0,Gt.ph)(({id:e,title:t,sticker:s,onClick:a})=>{const o=(0,Zt.A)(()=>{a?.(e)});return(0,cs.FD)("div",{className:"_KBrROQt",onClick:o,children:[s&&(0,cs.Y)(Hn.A,{className:"Y3vEed9M",sticker:s,size:20,forcePreview:!0}),t]})}),$n=(0,Gt.ph)(({items:e,selectedItemId:t,animationLevel:s,onItemSelect:o,className:i})=>{const n=(0,Gt.li)(),r=(0,Gt.li)(),d=e.findIndex(e=>e.id===t)||0,[c,l]=(0,Gt.J0)(""),u=s>a.dnp;(0,Kn.A)(n,!e.length,!0);const h=(0,Zt.A)(()=>{const e=r.current,t=d>=0&&e?.childNodes[d];if(e&&t&&e.offsetWidth>0){const{offsetLeft:s,offsetWidth:a}=t,o=e.offsetWidth,i=(s/o*100).toFixed(1),n=((o-(s+a))/o*100).toFixed(1);l(`inset(0 ${n}% 0 ${i}% round 1rem)`)}});if((0,Gt.vJ)(()=>{h()},[d,e]),(0,zn.A)(r,h),e.length)return(0,cs.FD)("div",{ref:n,className:(0,qt.A)("UQ6pUmuC","no-scrollbar",i,c&&"_Nw3GzkO"),children:[e.map(e=>(0,cs.Y)(_n,{id:e.id,title:e.title,sticker:e.sticker,onClick:o},e.id)),(0,cs.Y)("div",{ref:r,className:(0,qt.A)("c397ZVz4","clip-path-container",!u&&"zNFdzcTe"),style:c?`clip-path: ${c}`:void 0,"aria-hidden":!0,children:e.map((e,t)=>(0,cs.Y)(_n,{id:e.id,title:e.title,sticker:e.sticker,onClick:o},e.id))})]})}),Xn=(0,Gt.ph)((0,w.EK)((e,{peerId:t})=>{const{starGiftCollections:s}=e,a=s?.byPeerId?.[t];return{collections:a,activeCollectionId:(0,C.B59)(e,t),animationLevel:(0,je.l)(e).animationLevel}})(({peerId:e,className:t,collections:s,activeCollectionId:a,animationLevel:o})=>{const{updateSelectedGiftCollection:i,resetSelectedGiftCollection:n}=(0,w.ko)(),r=(0,Qt.A)(),d=(0,Zt.A)(t=>{if("all"===t)n({peerId:e});else{const s=Number(t);i({peerId:e,collectionId:s})}});if(!s||0===s.length)return;const c=(0,Gt.Kr)(()=>[{id:"all",title:r("AllGiftsCategory")},...s.map(e=>({id:String(e.collectionId),title:e.title,sticker:e.icon}))],[s,r]),l=a?String(a):"all";return(0,cs.Y)($n,{items:c,selectedItemId:l,animationLevel:o,onItemSelect:d,className:(0,qt.A)("pvf61Tbm",t)})})),Qn=(0,Gt.ph)((0,w.EK)((e,{peerId:t})=>{const{stories:s}=e,a=s?.albumsByPeerId?.[t];return{albums:a,selectedAlbumId:(0,at.tW)(e),animationLevel:(0,je.l)(e).animationLevel}})(({peerId:e,className:t,albums:s,selectedAlbumId:a,animationLevel:o})=>{const{selectStoryAlbum:i,resetSelectedStoryAlbum:n}=(0,w.ko)(),r=(0,Qt.A)(),d=(0,Zt.A)(t=>{if("all"===t)n();else{const s=Number(t);i({peerId:e,albumId:s})}});if(!s?.length)return;const c=(0,Gt.Kr)(()=>[{id:"all",title:r("AllStoriesCategory")},...s.map(e=>({id:String(e.albumId),title:e.title}))],[s,r]),l=a?String(a):"all";return(0,cs.Y)($n,{items:c,selectedItemId:l,animationLevel:o,onItemSelect:d,className:(0,qt.A)("GgK8T6WN",t)})})),Zn=[{type:"media",key:"ProfileTabMedia"},{type:"documents",key:"ProfileTabFiles"},{type:"links",key:"ProfileTabLinks"},{type:"audio",key:"ProfileTabMusic"},{type:"gif",key:"ProfileTabGifs"}],er=new Set(["stories","gifts","media","documents","audio","voice","links","gif"]),tr=new Set(["stories","gifts"]),sr=new Set(["media","documents","links","audio","voice","gif"]),ar=(0,Gt.ph)((0,w.EK)((e,{chatId:t,threadId:s,isMobile:a})=>{const o=(0,C.mBe)(e,t),n=(0,C.hds)(e,t),r=(0,C.AWZ)(e,t),d=(0,C.vGo)(e,t),c=(0,C.zeq)(e,t),l=(0,C.nTw)(e),{chatInfo:u,savedGifts:h}=l,{isOwnProfile:p}=u,{animationLevel:m,shouldWarnAboutFiles:f}=(0,je.l)(e),{currentType:g,resultsByType:I}=(0,C.BU_)(e)||{},{foundIds:v}=I&&g&&I[g]||{},b=Boolean(n?.isForum&&s&&s!==i.l3),{byId:S,statusesById:w}=e.users,{byId:A}=e.chats,M=t===e.currentUserId&&!p,P=p?void 0:(0,y.cG)(t,s,e.currentUserId),k=n&&(0,y.YE)(n),F=n&&(0,y.WX)(n),T=o&&(0,y.tv)(o),U=!b&&!P&&k&&!n?.isMonoforum,x=r?.members,B=r?.adminMembersById,R=U&&n&&(n.isForbidden||r&&!r.canViewMembers),J=U&&n&&((0,y.ub)(n,"inviteUsers")||!F&&!(0,y.Sq)(n,"inviteUsers")||n.isCreator),N=U&&n&&((0,y.ub)(n,"banUsers")||n.isCreator),E=(0,C.yuw)(e),{similarChannelIds:L}=(0,C.dg4)(e,t)||{},{similarBotsIds:O}=(0,C.AOG)(e,t)||{},D=(0,C.g29)(e),Y=o||n,G=d||r,V=o&&!o.isSelf&&!(0,y.tv)(o)&&!M&&Boolean(d?.commonChatsCount),j=(0,C.Ua4)(e,t),q=d?.botInfo?.hasPreviewMedia,W=e.users.previewMediaByBotId[t],K=Y&&(o?.isSelf||!Y.areStoriesHidden&&G?.hasPinnedStories)&&!M,z=K?(0,C._bp)(e,Y.id):void 0,H=(0,at.tW)(e),_="all"!==H?z?.idsByAlbumId?.[H]?.ids:z?.profileIds,$=z?.pinnedIds,X=z?.byId,Q=z?.archiveIds,Z=Boolean(G?.starGiftCount)&&!M,ee=(0,Hi.B5)(e,t),te=h.collectionsByPeerId[t]?.[ee],se=e.stories.albumsByPeerId?.[t],ae=e.starGiftCollections?.byPeerId?.[t],oe=(0,C.k2W)(e,t),ie=n&&(0,C._ls)(e,n.id),ne=Boolean(Y?.avatarPhotoId),re=(0,C.xYJ)(e,"autoplayGifs");return{theme:(0,C.SJA)(e),isChannel:F,isBot:T,messagesById:c,foundIds:v,mediaSearchType:g,hasCommonChatsTab:V,hasStoriesTab:K,hasMembersTab:U,hasPreviewMediaTab:q,areMembersHidden:R,canAddMembers:J,canDeleteMembers:N,currentUserId:e.currentUserId,isRightColumnShown:(0,C.gjV)(e,a),isRestricted:ie,activeDownloads:E,usersById:S,userStatusesById:w,chatsById:A,storyIds:_,hasGiftsTab:Z,gifts:te?.gifts,storyAlbums:se,giftCollections:ae,pinnedStoryIds:$,archiveStoryIds:Q,storyByIds:X,selectedStoryAlbumId:H,activeCollectionId:ee,giftsFilter:h.filter,isChatProtected:n?.isProtected,chatInfo:u,animationLevel:m,shouldWarnAboutFiles:f,similarChannels:L,similarBots:O,botPreviewMedia:W,isCurrentUserPremium:D,isTopicInfo:b,isSavedDialog:P,isSavedMessages:M,isSynced:e.isSynced,limitSimilarPeers:(0,ge.B)(e,"recommendedChannels"),members:U?x:void 0,adminMembersById:U?B:void 0,commonChatIds:j?.ids,monoforumChannel:oe,hasAvatar:ne,mainTab:G?.mainTab,canUpdateMainTab:(0,C.ySL)(e,t),canAutoPlayGifs:re}})(({chatId:e,isActive:t,threadId:s,chatInfo:o,profileState:r,theme:c,monoforumChannel:l,isChannel:u,isBot:h,currentUserId:p,messagesById:m,foundIds:f,storyIds:g,pinnedStoryIds:I,archiveStoryIds:v,storyByIds:b,selectedStoryAlbumId:S,activeCollectionId:A,giftsFilter:M,mediaSearchType:C,hasCommonChatsTab:F,hasStoriesTab:T,hasMembersTab:U,hasPreviewMediaTab:x,hasGiftsTab:B,gifts:R,storyAlbums:J,giftCollections:N,botPreviewMedia:E,areMembersHidden:L,canAddMembers:O,canDeleteMembers:D,commonChatIds:Y,members:G,adminMembersById:V,usersById:j,userStatusesById:q,chatsById:W,isRightColumnShown:K,isRestricted:z,activeDownloads:H,isChatProtected:_,animationLevel:$,shouldWarnAboutFiles:X,similarChannels:Q,similarBots:Z,isCurrentUserPremium:ee,limitSimilarPeers:te,isTopicInfo:se,isSavedDialog:ae,isSavedMessages:oe,isSynced:ie,hasAvatar:ne,mainTab:re,canUpdateMainTab:de,canAutoPlayGifs:ce,onProfileStateChange:le})=>{const{setSharedMediaSearchType:ue,loadMoreMembers:he,loadCommonChats:pe,openChat:me,searchSharedMediaMessages:fe,openMediaViewer:ge,openAudioPlayer:Ie,focusMessage:ve,setNewChatMembersDialogState:be,loadPeerProfileStories:ye,loadStoriesArchive:Se,openPremiumModal:we,loadChannelRecommendations:Ae,loadBotRecommendations:Me,loadPreviewMedias:Ce,loadPeerSavedGifts:Pe,resetGiftProfileFilter:ke,loadStarGiftCollections:Fe,loadStoryAlbums:Te,resetSelectedStoryAlbum:Ue,changeProfileTab:xe,setMainProfileTab:Be}=(0,w.ko)(),Re=(0,Gt.li)(),Je=(0,Gt.li)(),Ne=(0,Gt.li)(!1),Ee=(0,xs.A)(),Le=(0,Qt.A)(),[Oe,De]=(0,Gt.J0)(),[Ye,Ge,Ve]=(0,$s.A)(),je=!o.isOpen,{profileTab:qe,forceScrollProfileTab:We,isOwnProfile:Ke}=o,ze=ae?String(s):e,He=oe&&!ae,[_e,$e,Xe]=(0,$s.A)(),[Qe,Ze]=(0,Gt.J0)(0),et=(0,k.L8)(e)?tr:er,tt=(0,Gt.Kr)(()=>{const t=[];if(He&&t.push({type:"dialogs",key:"ProfileTabSavedDialogs"}),T&&t.push({type:"stories",key:"ProfileTabStories"}),B&&t.push({type:"gifts",key:"ProfileTabGifts"}),T&&Ke&&t.push({type:"storiesArchive",key:"ProfileTabStoriesArchive"}),U&&!Ke&&t.push({type:"members",key:"ProfileTabMembers"}),x&&!Ke&&t.push({type:"previewMedia",key:"ProfileTabBotPreview"}),Ke||t.push(...Zn),se||Ke||t.push({type:"voice",key:"ProfileTabVoice"}),F&&!Ke&&t.push({type:"commonChats",key:"ProfileTabSharedGroups"}),u&&Q?.length&&!Ke&&t.push({type:"similarChannels",key:"ProfileTabSimilarChannels"}),h&&Z?.length&&!Ke&&t.push({type:"similarBots",key:"ProfileTabSimilarBots"}),t.length||t.push(Zn[0]),re){const e=t.findIndex(e=>e.type===re);if(-1!==e){const s=t[e];t.splice(e,1),t.unshift(s)}}return t.map(t=>{const s=de&&re!==t.type&&et.has(t.type)?[{title:Le("ProfileMenuSetMainTab"),icon:"replace",handler:()=>{Be({chatId:e,tab:t.type})}}]:void 0;return{type:t.type,title:Le(t.key),contextActions:s}})},[He,T,B,U,x,se,F,u,h,Q?.length,Z?.length,Le,Ke,re,e,de,et]),[st,at,ot]=(0,$s.A)(!1),it=(0,Zt.A)(e=>{je||(xe({profileTab:e}),ue({mediaType:sr.has(e)?e:void 0}))});(0,Gt.vJ)(()=>{je||(qe?xe({profileTab:qe,shouldScrollTo:void 0}):it(tt[0].type))},[je,qe,tt]),(0,ma.A)(([e])=>{!e&&re&&it(re)},[re]);const rt=(0,Gt.hb)(e=>{at(),it(tt[e].type)},[tt]);(0,Gt.vJ)(()=>{x&&!E&&Ce({botId:e})},[e,E,x]),(0,Gt.vJ)(()=>{u&&!Q&&ie&&Ae({chatId:e})},[e,u,Q,ie]),(0,Gt.vJ)(()=>{h&&!Z&&ie&&Me({userId:e})},[e,h,Z,ie]),(0,Gt.vJ)(()=>{Ue()},[e]),(0,os.A)(()=>{Ge()},[M]),(0,os.A)(()=>{Ve()},[R]),(0,Gt.vJ)(()=>{B&&ie&&(Fe({peerId:e}),Te({peerId:e}))},[e,B,ie]);const[dt,ct]=(0,Gt.J0)(R),{startViewTransition:lt}=(0,on.Y)(),{createVtnStyle:ut}=(0,nn.k)(),pt=(0,Gt.Kr)(()=>dt?.map(e=>(0,_i.p)(e)),[dt]),mt=(0,Gt.Kr)(()=>{const e=tt.findIndex(({type:e})=>e===qe);return-1===e?0:e},[qe,tt]);Ne.current&&(Ne.current=!1),(0,pn.A)(([e,t])=>{e===qe&&t!==mt&&(Ne.current=!0)},[qe,mt]);const ft=tt[mt].type,gt=(0,Gt.hb)(()=>{pe({userId:e})},[e]),It=(0,Gt.hb)(({offsetId:t})=>{ye({peerId:e,offsetId:t})},[e]),vt=(0,Gt.hb)(({offsetId:t})=>{Se({peerId:e,offsetId:t})},[e]),bt=(0,Gt.hb)(()=>{Pe({peerId:e})},[e]),yt=(0,Gt.hb)(()=>{he({chatId:e})},[e,he]);(0,ma.A)(([e])=>{if((0,P.T)(R,e))return;if(!R||!e||!Ye)return void ct(R);const t=e.map(e=>(0,_i.p)(e)),s=R.map(e=>(0,_i.p)(e));t.some((e,t)=>e!==s[t])?lt(tn,()=>{ct(R)}):ct(R)},[R,lt,Ye]);const[St,wt,At,Mt]=function({loadMoreMembers:e,loadCommonChats:t,searchMessages:s,loadStories:a,loadStoriesArchive:o,loadMoreGifts:i,tabType:n,mediaSearchType:r,groupChatMembers:d,commonChatIds:c,usersById:l,userStatusesById:u,chatsById:h,chatMessages:p,foundIds:m,threadId:f,storyIds:g,giftIds:I,pinnedStoryIds:v,archiveStoryIds:b,similarChannels:S,similarBots:w}){const A="members"!==n&&r?r:n,M=(0,Gt.Kr)(()=>{if(d&&l&&u)return(0,y.UB)(d.map(({userId:e})=>e),l,u)},[d,l,u]),C=(0,Gt.Kr)(()=>{if(c&&h)return(0,Di.A)(c,!0)},[h,c]),[P,k,F]=vn(e,M),[T,U,x]=bn("media",A,s,p,m,f),[B,R,J]=bn("gif",A,s,p,m,f),[N,E,L]=bn("documents",A,s,p,m,f),[O,D,Y]=bn("links",A,s,p,m,f),[G,V,j]=bn("audio",A,s,p,m,f),[q,W,K]=bn("voice",A,s,p,m,f),[z,H,_]=vn(t,C),$=(0,Gt.Kr)(()=>{if(!g?.length)return g;const e=new Set(v);return g.slice().sort((t,s)=>{const a=e.has(t),o=e.has(s);return a&&!o?-1:!a&&o?1:s-t})},[g,v]),[X,Q,Z]=vn(a,$),[ee,te,se]=vn(o,b);let ae,oe,ie=!1;switch(A){case"members":ae=P,oe=k,ie=F;break;case"commonChats":ae=z,oe=H,ie=_;break;case"media":ae=T,oe=U,ie=x;break;case"gif":ae=B,oe=R,ie=J;break;case"documents":ae=N,oe=E,ie=L;break;case"links":ae=O,oe=D,ie=Y;break;case"audio":ae=G,oe=V,ie=j;break;case"voice":ae=q,oe=W,ie=K;break;case"stories":ae=X,oe=Q,ie=Z;break;case"storiesArchive":ae=ee,oe=te,ie=se;break;case"similarChannels":ae=S;break;case"similarBots":ae=w;break;case"gifts":ae=I,oe=i;break;case"dialogs":ie=!0}return[A,ae,oe,ie]}({loadMoreMembers:yt,searchMessages:fe,loadStories:It,loadStoriesArchive:vt,loadMoreGifts:bt,loadCommonChats:gt,tabType:ft,mediaSearchType:C,groupChatMembers:G,commonChatIds:Y,usersById:j,userStatusesById:q,chatsById:W,chatMessages:m,foundIds:f,threadId:s,storyIds:g,giftIds:pt,pinnedStoryIds:I,archiveStoryIds:v,similarChannels:Q,similarBots:Z}),Ct=!Mt&&!oe,Pt=tt[0].type===St,kt=tt.findIndex(({type:e})=>e===St),[Ft,Tt,Ut]=(0,$s.A)(!1),[xt,Bt,Rt]=(0,$s.A)(!1),Jt=N&&N.length>0,Nt=J&&J.length>0,Et="gifts"===St&&Jt||"stories"===St&&Nt;(0,Gt.vJ)(()=>{Jt?setTimeout(()=>{Tt()},300):Ut(),Nt?setTimeout(()=>{Bt()},300):Rt()},[Jt,Nt,Tt,Bt]),(0,rn.A)("members"===St?wt:void 0);const Lt=(0,Zt.A)(()=>{ot()}),Ot=(0,Zt.A)(()=>{_e||lt(Zi,()=>{$e()})}),Dt=(0,Zt.A)(()=>{_e&&lt(en,()=>{Xe()})}),{handleScroll:Yt}=function({containerRef:e,tabType:t,profileState:s,onProfileStateChange:a,forceScrollProfileTab:o=!1,allowAutoScrollToTabs:i=!1,handleStopAutoScrollToTabs:r}){(0,ma.A)(([s])=>{if(s&&s!==t&&i||t&&o){const s=e.current,o=s.querySelector(".TabList");r(),s.scrollTop<o.offsetTop&&(a(gn(t)),fn=!0,(0,nt.Ay)({container:s,element:o,position:"start",forceDuration:300}),setTimeout(()=>{fn=!1},350))}},[t,a,e,o,i,r]),(0,ma.A)(([t])=>{if(s!==n.zW.Profile||s===t)return;const a=e.current;if(!a)return;const o=a.querySelector(".TabList");!o||o.offsetTop>a.scrollTop||(fn=!0,(0,nt.Ay)({container:a,element:a.firstElementChild,position:"start",maxDistance:2*a.offsetHeight}),setTimeout(()=>{fn=!1},350))},[s,e]);const d=(0,Zt.A)(()=>{const o=e.current;if(!o)return;const i=o.querySelector(".TabList");if(!i)return;let r=n.zW.Profile;Math.ceil(o.scrollTop)>=i.offsetTop&&(r=gn(t)),r!==s&&a(r)});return(0,Gt.vJ)(()=>{fn||d()},[d,t]),{handleScroll:(0,Zt.A)(()=>{fn||mn(d)})}}({containerRef:Re,tabType:St,profileState:r,forceScrollProfileTab:We,allowAutoScrollToTabs:st,onProfileStateChange:le,handleStopAutoScrollToTabs:Lt});!function(e,t=".Transition.shared-media-transition"){(0,Gt.vJ)(()=>{function s(){const s=e.current,a=s.querySelector(t),o=s.querySelector(".TabList");if(a&&o){const e=s.clientHeight-o.offsetHeight;(0,jt.RK)(()=>{a.style.minHeight=`${e}px`})}}return s(),window.addEventListener("resize",s,!1),()=>{window.removeEventListener("resize",s,!1)}},[e,t])}(Re);const[Vt,Wt]=(()=>{const[e,t]=(0,Gt.J0)(0);return[e,(0,Gt.hb)(()=>{t(e=>e+1)},[])]})(),{observe:Kt}=(0,hn.BL)({rootRef:Re,throttleMs:500}),zt=(0,Zt.A)(()=>{be({newChatMembersProgress:n.D7.InProgress})}),Ht=(0,Zt.A)(e=>{ge({chatId:ze,threadId:i.l3,messageId:e,origin:n.TQ.SharedMedia})}),_t=(0,Zt.A)(e=>{ge({standaloneMedia:E?.flatMap(e=>e?.content.photo||e?.content.video).filter(Boolean),origin:n.TQ.PreviewMedia,mediaIndex:e})}),$t=(0,Zt.A)(e=>{Ie({chatId:ze,messageId:e})}),Xt=(0,Zt.A)(e=>{me({id:e})}),es=(0,Zt.A)(e=>{ve({chatId:e.chatId,messageId:e.id})}),ts=(0,Zt.A)(()=>{De(void 0)}),ss=(0,Zt.A)(()=>{ke({peerId:e})});let as;!function({containerRef:e,isOverscrolled:t,isDisabled:s,onOverscroll:a,onReset:o}){const[i,n]=(0,Gt.Ul)("normal"),r=(0,Gt.li)({...un}),d=(0,Gt.li)(),c=(0,Gt.li)(),l=(0,Zt.A)(()=>{clearTimeout(d.current),n("overscroll"),a?.()}),u=(0,Zt.A)(()=>{n("animating"),d.current=window.setTimeout(()=>{n("normal")},350),o?.()}),h=(0,Zt.A)(e=>{clearTimeout(r.current.timeout),r.current.timeout=window.setTimeout(()=>{r.current={...un}},e)}),p=(0,Zt.A)(t=>{const s=e.current;if(!s||t.defaultPrevented)return;const{deltaY:a}=t,{scrollTop:o}=s,n=i(),d=r.current,c=d.lastAverageDelta,p=0===d.lastDeltas.at(-1)||d.resetStartTopAt&&Date.now()>=d.resetStartTopAt;0===o&&p&&(d.isStartedAtTop=!0,d.resetStartTopAt=void 0);const m=r.current.lastDeltas.slice();m.push(a),m.length>7&&m.shift(),r.current.lastDeltas=m;const f=m.reduce((e,t)=>e+t,0)/m.length;r.current.lastAverageDelta=f;const g=Math.abs(f)-Math.abs(c)>7;return h(100),0===o&&a<0&&"overscroll"!==n?(d.resetStartTopAt||(d.resetStartTopAt=Date.now()+100),void(g&&d.isStartedAtTop&&l())):"animating"===n&&a>0?void(0,dn.A)(t):"overscroll"===n&&a>0?(u(),void(0,dn.A)(t)):void 0}),m=(0,Zt.A)(t=>{const s=e.current;if(!s||1!==t.touches.length)return;const{scrollTop:a}=s,o=i();0!==a&&"overscroll"!==o||(c.current=t.touches[0].clientY)}),f=(0,Zt.A)(t=>{const s=e.current,a=c.current;if(!s||void 0===a||1!==t.touches.length)return;const{scrollTop:o}=s,n=i(),r=t.touches[0].clientY-a;return"animating"!==n?0===o&&r>75&&"overscroll"!==n?(l(),void(c.current=void 0)):"overscroll"===n&&r<-75?(u(),void(c.current=void 0)):void 0:void 0}),g=(0,Zt.A)(()=>{c.current=void 0});(0,Gt.vJ)(()=>{const t=e.current;if(!s&&t)return(0,jt.RK)(()=>{t.classList.add(cn)}),()=>{(0,jt.RK)(()=>{t.classList.remove(cn)})}},[e,s]),(0,Gt.vJ)(()=>{const t=e.current;if(!s&&t)return(0,jt.RK)(()=>{t.classList.toggle(ln,"normal"!==i())}),()=>{(0,jt.RK)(()=>{t.classList.remove(ln)})}},[e,s,i]),(0,Gt.vJ)(()=>{n(t?"overscroll":"normal")},[t,n]),(0,Gt.vJ)(()=>{const t=e.current;if(!s&&t)return t.addEventListener("wheel",p,{passive:"normal"===i()}),t.addEventListener("touchstart",m,{passive:!0}),t.addEventListener("touchmove",f,{passive:!0}),t.addEventListener("touchend",g,{passive:!0}),t.addEventListener("touchcancel",g,{passive:!0}),()=>{t.removeEventListener("wheel",p),t.removeEventListener("touchstart",m),t.removeEventListener("touchmove",f),t.removeEventListener("touchend",g),t.removeEventListener("touchcancel",g);const e=r.current;e?.timeout&&clearTimeout(e.timeout)}},[e,p,m,f,g,i,s])}({containerRef:Re,onOverscroll:Ot,onReset:Dt,isOverscrolled:_e,isDisabled:!ne||!Ct}),(0,Gt.vJ)(()=>{if(Je.current&&d.TF)return(0,Ds.wJ)(Je.current,{selectorToPreventScroll:".Profile",onSwipe:(e,t)=>{if(t===Ds.ez.Left){const e=Math.min(mt+1,tt.length-1);return it(tt[e].type),!0}if(t===Ds.ez.Right){const e=Math.max(0,mt-1);return it(tt[e].type),!0}return!1}})},[mt,tt]),Pt?as=K?0:1e3:(!wt&&!E||!R?.length&&"gifts"===St)&&(as=a.jhd);const is=(0,Go.A)([e,s,St,mt,A,S],as);const ns="stories"===St||"gifts"===St,rs="stories"===St?"all"===S?0:S:"gifts"===St?"all"===A?0:A:0,ds=(0,Zt.A)(()=>{Ze(Qe+1)});function ls(t,s){const a=function(t,s){if(t){const e=Boolean("members"===St&&L);return(0,cs.FD)("div",{className:"content empty-list",children:[!s&&!e&&(0,cs.Y)(sa.A,{}),e&&(0,cs.Y)(Rn.A,{text:Le("ChatMemberListNoAccess")})]})}const a=wt&&!wt?.length;if(a&&"gifts"===St)return(0,cs.FD)("div",{className:"nothing-found-gifts",children:[(0,cs.Y)(yn.A,{size:160,tgsUrl:sn.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,cs.Y)("div",{className:"description",children:Le("GiftSearchEmpty")}),(0,cs.Y)(fi.A,{className:"date",onClick:ss,children:Le("GiftSearchReset")})]});if(a){let e;switch(St){case"members":e=Le(L?"ChatMemberListNoAccess":"NoMembersFound");break;case"commonChats":e=Ee("NoGroupsInCommon");break;case"documents":e=Ee("lng_media_file_empty");break;case"links":e=Ee("lng_media_link_empty");break;case"audio":e=Ee("lng_media_song_empty");break;case"voice":e=Ee("lng_media_audio_empty");break;case"stories":e=Ee("StoryList.SavedEmptyState.Title");break;case"storiesArchive":e=Ee("StoryList.ArchivedEmptyState.Title");break;case"gif":e=Ee("lng_media_gif_empty");break;default:e=Ee("SharedMedia.EmptyTitle")}return(0,cs.Y)("div",{className:"content empty-list",children:(0,cs.Y)(Rn.A,{text:e})})}if(!m)return;const o="gifts"===St?Ft:"stories"===St&&xt;return(0,cs.Y)("div",{className:(0,qt.A)(`content ${St}-list`,Et&&"showContentPanel",o&&"noTransition"),dir:!Le.isRtl||"media"!==St&&"gif"!==St?void 0:"rtl",teactFastList:!0,children:"media"===St||"gif"===St?wt.map(e=>m[e]&&(0,cs.Y)(Bn.A,{message:m[e],isProtected:_||m[e].isProtected,canAutoPlay:ce,observeIntersection:Kt,onClick:Ht},e)):"stories"===St||"storiesArchive"===St?wt.map((e,t)=>b?.[e]&&(0,cs.Y)(Vn,{teactOrderKey:t,story:b[e],isArchive:"storiesArchive"===St},`${St}_${e}`)):"documents"===St?wt.map(e=>m[e]&&(0,cs.Y)(wn.A,{document:(0,y.zC)(m[e]),datetime:m[e].date,smaller:!0,className:"scroll-item",isDownloading:(0,y.$r)(H,(0,y.zC)(m[e])),observeIntersection:Kt,onDateClick:es,message:m[e],shouldWarnAboutFiles:X},e)):"links"===St?wt.map(e=>m[e]&&(0,cs.Y)(On.A,{message:m[e],isProtected:_||m[e].isProtected,observeIntersection:Kt,onMessageClick:es},e)):"audio"===St?wt.map(e=>m[e]&&(0,cs.Y)(Sn.Ay,{theme:c,message:m[e],origin:n.d9.SharedMedia,date:m[e].date,className:"scroll-item",onPlay:$t,onDateClick:es,canDownload:!_&&!m[e].isProtected,isDownloading:(0,y.$r)(H,m[e].content.audio)},e)):"voice"===St?wt.map(e=>{const t=(0,w.mS)(),s=m[e];if(!s)return;const a=(0,ht.iS)(t,s);return m[e]&&(0,cs.Y)(Sn.Ay,{theme:c,message:s,senderTitle:(0,an.N)(Ee,s,W,j),origin:n.d9.SharedMedia,date:s.date,className:"scroll-item",onPlay:$t,onDateClick:es,canDownload:!_&&!s.isProtected,isDownloading:(0,y.$r)(H,a)},e)}):"members"===St?wt.map((e,t)=>{return(0,cs.Y)(qn.A,{teactOrderKey:t,className:"chat-item-clickable contact-list-item scroll-item small-icon",onClick:()=>Xt(e),contextActions:(s=e,s!==p&&D?[{title:Ee("lng_context_remove_from_group"),icon:"stop",handler:()=>{De(s)}}]:void 0),children:(0,cs.Y)(fo.A,{userId:e,adminMember:V?.[e],forceShowSelf:!0})},e);var s}):"commonChats"===St?wt.map((e,t)=>(0,cs.Y)(qn.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item small-icon",onClick:()=>me({id:e}),children:(0,cs.Y)(mo.A,{chatId:e})},e)):"previewMedia"===St?E.map((e,t)=>(0,cs.Y)(Nn,{media:e,isProtected:_,observeIntersection:Kt,onClick:_t,index:t},e.date)):"similarChannels"===St?(0,cs.FD)("div",{children:[wt.map((e,t)=>(0,cs.Y)(qn.A,{teactOrderKey:t,className:(0,qt.A)("chat-item-clickable search-result",!ee&&t===Q.length-1&&"blured"),onClick:()=>me({id:e}),children:(0,cs.Y)(mo.A,{avatarSize:"large",chatId:e,withFullInfo:!0})},e)),!ee&&(0,cs.FD)(cs.FK,{children:[(0,cs.FD)(Rs.A,{className:"show-more-channels",onClick:()=>we(),children:[Ee("UnlockSimilar"),(0,cs.Y)(Js.A,{name:"unlock-badge"})]}),(0,cs.Y)("div",{className:"more-similar",children:(0,bo.A)(Ee("MoreSimilarText",te),["simple_markdown"])})]})]},St):"similarBots"===St?(0,cs.FD)("div",{children:[wt.map((e,t)=>(0,cs.Y)(qn.A,{teactOrderKey:t,className:(0,qt.A)("chat-item-clickable search-result",!ee&&t===Z.length-1&&"blured"),onClick:()=>me({id:e}),children:(0,cs.Y)(fo.A,{userId:e,avatarSize:"medium"})},e)),!ee&&(0,cs.FD)(cs.FK,{children:[(0,cs.FD)(Rs.A,{className:"show-more-bots",onClick:()=>we(),children:[Le("UnlockMoreSimilarBots"),(0,cs.Y)(Js.A,{name:"unlock-badge"})]}),(0,cs.Y)("div",{className:"more-similar",children:(0,bo.A)(Le("MoreSimilarBotsDescription",{count:te},{withNodes:!0,withMarkdown:!0,pluralValue:te}))})]})]},St):"gifts"===St?dt?.map(t=>(0,cs.Y)(xn,{peerId:e,className:"saved-gift",style:ut((0,_i.p)(t)),gift:t,observeIntersection:Kt},(0,_i.p)(t))):void 0})}(t,s),o=t&&!s;return ns?(0,cs.Y)(ks.Ay,{className:`${St}-list`,activeKey:rs,name:(0,ws.P)("slideOptimized",$,void 0,Le.isRtl),shouldCleanup:!0,shouldRestoreHeight:!0,restoreHeightKey:Qe,contentSelector:".Transition > .Transition_slide-active > .content",children:(0,cs.Y)(ks.Ay,{activeKey:o?0:1,name:"fade",shouldCleanup:!0,shouldRestoreHeight:!0,restoreHeightKey:Qe,contentSelector:".content",onStop:ds,children:a})}):(0,cs.Y)(ks.Ay,{activeKey:o?0:1,name:"fade",shouldCleanup:!0,shouldRestoreHeight:!0,children:a})}const us=".shared-media-transition > .Transition_slide-active",hs=ns?`${us} > .Transition > .Transition_slide-active > .Transition > .Transition_slide-active > .${St}-list > .scroll-item`:`${us} .${St}-list > .scroll-item`;return(0,cs.FD)(jn.A,{ref:Re,className:"Profile custom-scroll",itemSelector:hs,items:is?wt:void 0,cacheBuster:Vt,sensitiveArea:a.ZhW,preloadBackwards:is?"members"===St?a.nnT:a.Um:0,noScrollRestoreOnTop:!0,noFastList:!0,onLoadMore:At,onScroll:Yt,children:[!Mt&&!oe&&(ps=l?.id||ze,ms=K&&is,(0,cs.FD)("div",{className:"profile-info",children:[(0,cs.Y)(Ln.A,{isExpanded:_e,peerId:ps,canPlayVideo:ms,isForMonoforum:Boolean(l),onExpand:Ot}),(0,cs.Y)(En.A,{chatOrUserId:ze,isSavedDialog:ae,isOwnProfile:Ke,style:ut("chatExtra")})]})),!z&&(0,cs.FD)("div",{className:"shared-media",style:ut("sharedMedia"),children:[(0,cs.Y)(ks.Ay,{ref:Je,name:Ne.current?"none":(0,ws.P)("slideOptimized",$,void 0,Le.isRtl),activeKey:kt,renderCount:tt.length,shouldRestoreHeight:!0,className:"shared-media-transition",onStop:Wt,restoreHeightKey:ns?Qe:void 0,contentSelector:ns?".Transition > .Transition_slide-active > .Transition > .Transition_slide-active > .content":void 0,children:function(){if("dialogs"===St)return(0,cs.Y)(Ws.A,{className:"saved-dialogs",folderType:"saved",isActive:!0});const t=!wt&&!E||!is||!m,s=Pt&&!is;return(0,cs.FD)("div",{children:["gifts"===St?(0,cs.Y)("div",{className:(0,qt.A)("contentCategoriesPanel",!Et&&"hiddenPanel",Ft&&"noTransition"),children:(0,cs.Y)(Xn,{peerId:e})}):"stories"===St?(0,cs.Y)("div",{className:(0,qt.A)("contentCategoriesPanel",!Et&&"hiddenPanel",xt&&"noTransition"),children:(0,cs.Y)(Qn,{peerId:e})}):void 0,ls(t,s)]})}()}),(0,cs.Y)(qs.A,{activeTab:mt,tabs:tt,onSwitchTab:rt})]}),O&&(0,cs.Y)(Gi.A,{className:(0,qt.A)(!t&&"hidden"),isShown:is,onClick:zt,ariaLabel:Ee("lng_channel_add_users"),children:(0,cs.Y)(Js.A,{name:"add-user-filled"})}),D&&(0,cs.Y)(Wn.A,{isOpen:Boolean(Oe),userId:Oe,onClose:ts})]});var ps,ms})),or=450+a.xB5;var ir=function(e){return e[e.Profile=0]="Profile",e[e.MemberList=1]="MemberList",e[e.GiftList=2]="GiftList",e[e.SharedMedia=3]="SharedMedia",e[e.StoryList=4]="StoryList",e[e.Search=5]="Search",e[e.Statistics=6]="Statistics",e[e.MessageStatistics=7]="MessageStatistics",e[e.StoryStatistics=8]="StoryStatistics",e[e.BoostStatistics=9]="BoostStatistics",e[e.MonetizationStatistics=10]="MonetizationStatistics",e[e.Management=11]="Management",e[e.ManageInitial=12]="ManageInitial",e[e.ManageChannelSubscribers=13]="ManageChannelSubscribers",e[e.ManageChatAdministrators=14]="ManageChatAdministrators",e[e.ManageChatPrivacyType=15]="ManageChatPrivacyType",e[e.ManageDiscussion=16]="ManageDiscussion",e[e.ManageGroupPermissions=17]="ManageGroupPermissions",e[e.ManageGroupRemovedUsers=18]="ManageGroupRemovedUsers",e[e.ManageChannelRemovedUsers=19]="ManageChannelRemovedUsers",e[e.ManageGroupUserPermissionsCreate=20]="ManageGroupUserPermissionsCreate",e[e.ManageGroupUserPermissions=21]="ManageGroupUserPermissions",e[e.ManageGroupRecentActions=22]="ManageGroupRecentActions",e[e.ManageGroupAdminRights=23]="ManageGroupAdminRights",e[e.ManageGroupNewAdminRights=24]="ManageGroupNewAdminRights",e[e.ManageGroupMembers=25]="ManageGroupMembers",e[e.ManageGroupAddAdmins=26]="ManageGroupAddAdmins",e[e.StickerSearch=27]="StickerSearch",e[e.GifSearch=28]="GifSearch",e[e.PollResults=29]="PollResults",e[e.AddingMembers=30]="AddingMembers",e[e.ManageInvites=31]="ManageInvites",e[e.ManageEditInvite=32]="ManageEditInvite",e[e.ManageReactions=33]="ManageReactions",e[e.ManageInviteInfo=34]="ManageInviteInfo",e[e.ManageJoinRequests=35]="ManageJoinRequests",e[e.CreateTopic=36]="CreateTopic",e[e.EditTopic=37]="EditTopic",e[e.SavedDialogs=38]="SavedDialogs",e[e.NewDiscussionGroup=39]="NewDiscussionGroup",e[e.FocusList=40]="FocusList",e}(ir||{});const nr=(0,w.EK)((e,{chatId:t,isProfile:s,isManagement:a,threadId:o})=>{const n=(0,C.nTw)(e),{query:r}=(0,C.BmE)(e)||{},{query:d}=(0,C.Wy7)(e)||{},c=t?(0,C.hds)(e,t):void 0,l=s&&t&&(0,k.L8)(t)?(0,C.mBe)(e,t):void 0,u=c&&(0,y.WX)(c),h=c?.isForum&&Boolean(o&&o!==i.l3),p=h?(0,C.S0q)(e,t,o):void 0,m=h&&p&&(0,y.l1)(c,p),f=l&&(0,y.tv)(l),g=n.chatInfo?.isOwnProfile,I=t&&!g?(0,C.nZ4)(e,t):void 0,v=f&&l?.canEditBot,b=l&&(0,y.Gh)(l),S=Boolean(!a&&s&&t&&(0,C.e5V)(e,t)),w=Boolean(t&&n.management.byChatId[t]?.editingInvite),A=!h&&t?(0,C.AWZ)(e,t)?.canViewStatistics:void 0,M=t?n.management.byChatId[t]?.inviteInfo?.invite:void 0,P=n.savedGifts.filter,F=!!t&&(0,C.rtZ)(e,t),T=!!t&&(0,C.ERc)(e,t);return{canManage:S,canAddContact:b,canViewStatistics:A,isChannel:u,isBot:f,isInsideTopic:h,canEditTopic:m,userId:l?.id,isSelf:l?.isSelf,stickerSearchQuery:r,gifSearchQuery:d,isEditingInvite:w,currentInviteInfo:M,isSavedMessages:I,shouldSkipHistoryAnimations:n.shouldSkipHistoryAnimations,canEditBot:v,giftProfileFilter:P,canUseGiftFilter:F,canUseGiftAdminFilter:T,isOwnProfile:g}})(({chatId:e,threadId:t,isColumnOpen:s,isProfile:o,isManagement:i,isStatistics:r,isMessageStatistics:c,isStoryStatistics:l,isMonetizationStatistics:u,isBoostStatistics:h,isStickerSearch:p,isGifSearch:m,isPollResults:f,isCreatingTopic:g,isEditingTopic:I,isAddingChatMembers:v,isFocusList:b,profileState:y,managementScreen:S,canAddContact:A,userId:M,isSelf:C,canManage:P,isChannel:k,stickerSearchQuery:F,gifSearchQuery:T,isEditingInvite:U,canViewStatistics:x,currentInviteInfo:B,shouldSkipHistoryAnimations:R,isBot:J,isInsideTopic:N,canEditTopic:E,isSavedMessages:L,canEditBot:O,giftProfileFilter:Y,canUseGiftFilter:G,canUseGiftAdminFilter:V,isOwnProfile:j,onClose:q,onScreenSelect:W})=>{const{setStickerSearchQuery:K,setGifSearchQuery:z,toggleManagement:H,openAddContactDialog:_,toggleStatistics:$,setEditingExportedInvite:X,deleteExportedChatInvite:Q,openEditTopicPanel:Z,updateGiftProfileFilter:ee,openSettingsScreen:te}=(0,w.ko)(),[se,ae,oe]=(0,$s.A)(),{isMobile:ie}=(0,D.Ay)(),{createVtnStyle:ne}=(0,nn.k)(),{sortType:re,shouldIncludeUnlimited:de,shouldIncludeLimited:ce,shouldIncludeUpgradable:le,shouldIncludeUnique:ue,shouldIncludeDisplayed:he,shouldIncludeHidden:pe}=Y,me=(0,bs.g5)(),fe=(0,Zt.A)(()=>{X({chatId:e,invite:B}),W(n.je.EditInvite)}),ge=(0,Zt.A)(()=>{Q({chatId:e,link:B.link}),W(n.je.Invites),oe()}),Ie=(0,Zt.A)(e=>{K({query:e})}),ve=(0,Zt.A)(e=>{z({query:e})}),be=(0,Zt.A)(()=>{_({userId:M})}),ye=(0,Zt.A)(()=>{e&&t&&Z({chatId:e,topicId:Number(t)})}),Se=(0,Zt.A)(()=>{H()}),we=(0,Zt.A)(()=>{$()}),Ae=(0,Zt.A)(()=>{te({screen:n.VS.EditProfile})}),Me=(0,Zt.A)(()=>{q(!L)}),[Ce,Pe]=(0,Gt.J0)(!s);(0,Gt.vJ)(()=>{setTimeout(()=>{Pe(!s)},or)},[s]);const ke=(0,xs.A)(),Fe=(0,Qt.A)(),Te=o?y===n.zW.Profile?ir.Profile:y===n.zW.SharedMedia?ir.SharedMedia:y===n.zW.MemberList?ir.MemberList:y===n.zW.GiftList?ir.GiftList:y===n.zW.StoryList?ir.StoryList:y===n.zW.SavedDialogs?ir.SavedDialogs:-1:f?ir.PollResults:p?ir.StickerSearch:m?ir.GifSearch:v?ir.AddingMembers:i?S===n.je.Initial?ir.ManageInitial:S===n.je.ChatPrivacyType?ir.ManageChatPrivacyType:S===n.je.Discussion?ir.ManageDiscussion:S===n.je.ChannelSubscribers?ir.ManageChannelSubscribers:S===n.je.GroupPermissions?ir.ManageGroupPermissions:S===n.je.ChatAdministrators?ir.ManageChatAdministrators:S===n.je.GroupRemovedUsers?ir.ManageGroupRemovedUsers:S===n.je.ChannelRemovedUsers?ir.ManageChannelRemovedUsers:S===n.je.GroupUserPermissionsCreate?ir.ManageGroupUserPermissionsCreate:S===n.je.GroupUserPermissions?ir.ManageGroupUserPermissions:S===n.je.GroupRecentActions?ir.ManageGroupRecentActions:S===n.je.ChatAdminRights?ir.ManageGroupAdminRights:S===n.je.ChatNewAdminRights?ir.ManageGroupNewAdminRights:S===n.je.GroupMembers?ir.ManageGroupMembers:S===n.je.Invites?ir.ManageInvites:S===n.je.EditInvite?ir.ManageEditInvite:S===n.je.GroupAddAdmins?ir.ManageGroupAddAdmins:S===n.je.Reactions?ir.ManageReactions:S===n.je.InviteInfo?ir.ManageInviteInfo:S===n.je.JoinRequests?ir.ManageJoinRequests:S===n.je.NewDiscussionGroup?ir.NewDiscussionGroup:void 0:r?ir.Statistics:c?ir.MessageStatistics:l?ir.StoryStatistics:h?ir.BoostStatistics:g?ir.CreateTopic:I?ir.EditTopic:u?ir.MonetizationStatistics:b?ir.FocusList:void 0,Ue=(0,wo.A)(Te,!0)??-1,xe=(0,Gt.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,cs.Y)(Rs.A,{round:!0,ripple:!ie,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:Fe("AccDescrOpenMenu2"),children:(0,cs.Y)(Js.A,{name:"more"})}),[ie,Fe]),Be=ie||!L&&(Te===ir.SharedMedia||Te===ir.GiftList||Te===ir.MemberList||Te===ir.StoryList||Te===ir.AddingMembers||Te===ir.MessageStatistics||Te===ir.StoryStatistics||i),Re=(0,qt.A)("animated-close-icon",Be&&"state-back",(Ce||R)&&"no-transition");return(0,cs.FD)("div",{className:"RightHeader","data-tauri-drag-region":!(!gt.Vq||!d.MP)||void 0,style:ne("rightHeader",!0),children:[(0,cs.Y)(Rs.A,{className:"close-button",round:!0,color:"translucent",size:"smaller",onClick:Me,ariaLabel:ke(Be?"Common.Back":"Common.Close"),children:(0,cs.Y)("div",{className:Re})}),(0,cs.Y)(ks.Ay,{name:Ce||R?"none":"slideFade",activeKey:Ue,children:function(){if(-1!==Ue)switch(Ue){case ir.PollResults:return(0,cs.Y)("h3",{className:"title",children:ke("PollResults")});case ir.AddingMembers:return(0,cs.Y)("h3",{className:"title",children:ke(k?"ChannelAddSubscribers":"GroupAddMembers")});case ir.ManageInitial:return(0,cs.Y)("h3",{className:"title",children:ke("Edit")});case ir.ManageChatPrivacyType:return(0,cs.Y)("h3",{className:"title",children:ke(k?"ChannelTypeHeader":"GroupTypeHeader")});case ir.ManageDiscussion:return(0,cs.Y)("h3",{className:"title",children:ke("Discussion")});case ir.ManageChatAdministrators:return(0,cs.Y)("h3",{className:"title",children:ke("ChannelAdministrators")});case ir.ManageGroupRecentActions:return(0,cs.Y)("h3",{className:"title",children:ke("Group.Info.AdminLog")});case ir.ManageGroupAdminRights:return(0,cs.Y)("h3",{className:"title",children:ke("EditAdminRights")});case ir.ManageGroupNewAdminRights:return(0,cs.Y)("h3",{className:"title",children:ke("SetAsAdmin")});case ir.ManageGroupPermissions:return(0,cs.Y)("h3",{className:"title",children:ke("ChannelPermissions")});case ir.ManageGroupRemovedUsers:return(0,cs.Y)("h3",{className:"title",children:ke("BlockedUsers")});case ir.ManageChannelRemovedUsers:return(0,cs.Y)("h3",{className:"title",children:ke("ChannelBlockedUsers")});case ir.ManageGroupUserPermissionsCreate:return(0,cs.Y)("h3",{className:"title",children:ke("ChannelAddException")});case ir.ManageGroupUserPermissions:return(0,cs.Y)("h3",{className:"title",children:ke("UserRestrictions")});case ir.ManageInvites:return(0,cs.Y)("h3",{className:"title",children:ke("lng_group_invite_title")});case ir.ManageEditInvite:return(0,cs.Y)("h3",{className:"title",children:ke(U?"EditLink":"NewLink")});case ir.ManageInviteInfo:return(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("h3",{className:"title",children:ke("InviteLink")}),(0,cs.FD)("section",{className:"tools",children:[B&&!B.isRevoked&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ke("Edit"),onClick:fe,children:(0,cs.Y)(Js.A,{name:"edit"})}),B&&B.isRevoked&&(0,cs.FD)(cs.FK,{children:[(0,cs.Y)(Rs.A,{round:!0,color:"danger",size:"smaller",ariaLabel:ke("Delete"),onClick:ae,children:(0,cs.Y)(Js.A,{name:"delete"})}),(0,cs.Y)(Wo.A,{isOpen:se,onClose:oe,title:ke("DeleteLink"),text:ke("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:ke("Delete"),confirmHandler:ge})]})]})]});case ir.ManageJoinRequests:return(0,cs.Y)("h3",{className:"title",children:ke(k?"SubscribeRequests":"MemberRequests")});case ir.ManageGroupAddAdmins:return(0,cs.Y)("h3",{className:"title",children:ke("Channel.Management.AddModerator")});case ir.StickerSearch:return(0,cs.Y)(ea.A,{value:F,placeholder:ke("SearchStickersHint"),autoFocusSearch:!0,onChange:Ie});case ir.GifSearch:return(0,cs.Y)(ea.A,{value:T,placeholder:ke("SearchGifsTitle"),autoFocusSearch:!0,onChange:ve});case ir.Statistics:return(0,cs.Y)("h3",{className:"title",children:ke(k?"ChannelStats.Title":"GroupStats.Title")});case ir.MessageStatistics:return(0,cs.Y)("h3",{className:"title",children:ke("Stats.MessageTitle")});case ir.StoryStatistics:return(0,cs.Y)("h3",{className:"title",children:ke("Stats.StoryTitle")});case ir.BoostStatistics:return(0,cs.Y)("h3",{className:"title",children:ke("Boosts")});case ir.MonetizationStatistics:return(0,cs.Y)("h3",{className:"title",children:ke("lng_channel_earn_title")});case ir.SharedMedia:return(0,cs.Y)("h3",{className:"title",children:ke("SharedMedia")});case ir.ManageChannelSubscribers:return(0,cs.Y)("h3",{className:"title",children:ke("ChannelSubscribers")});case ir.MemberList:case ir.ManageGroupMembers:return(0,cs.Y)("h3",{className:"title",children:ke("GroupMembers")});case ir.StoryList:return(0,cs.Y)("h3",{className:"title",children:ke(C?"Settings.MyStories":"PeerInfo.PaneStories")});case ir.SavedDialogs:return(0,cs.FD)("div",{className:"header",children:[(0,cs.Y)("h3",{className:"title",children:ke("SavedMessagesTab")}),(0,cs.Y)("div",{className:"subtitle",children:ke("Chats",me[a.pX9])})]});case ir.ManageReactions:return(0,cs.Y)("h3",{className:"title",children:ke("Reactions")});case ir.CreateTopic:return(0,cs.Y)("h3",{className:"title",children:ke("NewTopic")});case ir.EditTopic:return(0,cs.Y)("h3",{className:"title",children:ke("EditTopic")});case ir.FocusList:return(0,cs.Y)("h3",{className:"title",children:"Priority"});case ir.GiftList:return(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("h3",{className:"title",children:Fe("ProfileTabGifts")}),G&&e&&(0,cs.Y)("section",{className:"tools",children:(0,cs.FD)(Zs.A,{trigger:xe,positionX:"right",autoClose:!1,children:[(0,cs.Y)(Es.A,{icon:"byDate"===re?"cash-circle":"calendar-filter",onClick:()=>ee({peerId:e,filter:{sortType:"byDate"===re?"byValue":"byDate"}}),children:Fe("byDate"===re?"GiftSortByValue":"GiftSortByDate")}),(0,cs.Y)(ia.A,{}),(0,cs.Y)(Es.A,{icon:de?"check":"placeholder",onClick:()=>ee({peerId:e,filter:{shouldIncludeUnlimited:!de}}),children:Fe("GiftFilterUnlimited")}),(0,cs.Y)(Es.A,{icon:ce?"check":"placeholder",onClick:()=>ee({peerId:e,filter:{shouldIncludeLimited:!ce}}),children:Fe("GiftFilterLimited")}),(0,cs.Y)(Es.A,{icon:le?"check":"placeholder",onClick:()=>ee({peerId:e,filter:{shouldIncludeUpgradable:!le}}),children:Fe("GiftFilterUpgradable")}),(0,cs.Y)(Es.A,{icon:ue?"check":"placeholder",onClick:()=>ee({peerId:e,filter:{shouldIncludeUnique:!ue}}),children:Fe("GiftFilterUnique")}),V&&(0,cs.FD)(cs.FK,{children:[(0,cs.Y)(ia.A,{}),(0,cs.Y)(Es.A,{icon:he?"check":"placeholder",onClick:()=>ee({peerId:e,filter:{shouldIncludeDisplayed:!he}}),children:Fe("GiftFilterDisplayed")}),(0,cs.Y)(Es.A,{icon:pe?"check":"placeholder",onClick:()=>ee({peerId:e,filter:{shouldIncludeHidden:!pe}}),children:Fe("GiftFilterHidden")})]})]})})]});case ir.NewDiscussionGroup:return(0,cs.Y)("h3",{className:"title",children:ke("NewGroup")});default:return(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("h3",{className:"title",children:j?Fe("MyProfileHeader"):ke(L?"SavedMessages":N?"AccDescrTopic":k?"Channel.TitleInfo":M?J?"lng_info_bot_title":"lng_info_user_title":"GroupInfo.Title")}),(0,cs.FD)("section",{className:"tools",children:[A&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ke("AddContact"),onClick:be,children:(0,cs.Y)(Js.A,{name:"add-user"})}),P&&!N&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ke("Edit"),onClick:Se,children:(0,cs.Y)(Js.A,{name:"edit"})}),O&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ke("Edit"),onClick:Se,children:(0,cs.Y)(Js.A,{name:"edit"})}),E&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ke("EditTopic"),onClick:ye,children:(0,cs.Y)(Js.A,{name:"edit"})}),x&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ke("Statistics"),onClick:we,children:(0,cs.Y)(Js.A,{name:"stats"})}),j&&(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("Edit"),onClick:Ae,children:(0,cs.Y)(Js.A,{name:"edit"})})]})]})}}()})]})});var rr=s(55317),dr=s(47058),cr=s(20333),lr=s(71950);const ur={root:"gk6pIryJ",noResults:"WP4wRUbm","section-header":"LWcgK3OX",sectionHeader:"LWcgK3OX",section:"C8KF95yU",user:"oMy5KOFr",stats:"GOzrl0zF",down:"QuLtxDUV",loadMoreSpinner:"ln5zB7KK",status:"r3zLiaXx",info:"Eo1qQlxx",month:"McSPvm0N",quantity:"s1yf_GJa",floatingBadge:"oSCjRZtx",floatingBadgeButtonColor:"duVpAT_e",floatingBadgeWarning:"DsJMXNNk",floatingBadgeButton:"urrWJVYB",floatingBadgeIcon:"hcA9VPeV",floatingBadgeValue:"hHkCO4Ge",content:"SG00REIA",boostSection:"ETgjBS4d",giveawayButton:"wOCtp5Kk",giveawayIcon:"B9GF4NDB",primaryLink:"GXmXwIbx",copy:"rB0gc1GX",boostInfo:"BhoA3MT6"};var hr=s(72078),pr=s(68153),mr=s(65741),fr=s(45318);const gr={3:pr,6:hr,12:mr},Ir={isCustomPeer:!0,avatarIcon:"star",peerColorId:1},vr={isCustomPeer:!0,titleKey:"BoostingToBeDistributed",avatarIcon:"user",withPremiumGradient:!0},br=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e).boostStatistics,s=(0,C.hc)(e),a=t&&t.chatId,o=a?(0,C.hds)(e,a):void 0,i=o&&(0,y.WX)(o),n=e.appConfig.giveawayBoostsPerPremium,{animationLevel:r}=(0,je.l)(e);return{boostStatistics:t,isGiveawayAvailable:s,chatId:a,giveawayBoostsPerPremium:n,isChannel:i,animationLevel:r}})(({boostStatistics:e,isGiveawayAvailable:t,chatId:s,giveawayBoostsPerPremium:o,isChannel:i,animationLevel:n})=>{const{openChat:r,loadMoreBoosters:d,closeBoostStatistics:c,openGiveawayModal:l,showNotification:u}=(0,w.ko)(),h=(0,xs.A)(),p=(0,Gt.li)(),m=e?.boostStatus,f=m?e.boostStatus:void 0,g=!(e&&e?.boosts?.count===e?.giftedBoosts?.count)&&e?.giftedBoosts&&e?.giftedBoosts?.list?.length>0,{currentLevel:I,hasNextLevel:v,boosts:b,levelProgress:y,remainingBoosts:S}=(0,Gt.Kr)(()=>f?(0,rr.z)(f):{currentLevel:0,hasNextLevel:!1,boosts:0,levelProgress:0,remainingBoosts:0,prepaidGiveaways:[]},[f]),A=(0,Gt.Kr)(()=>{if(f)return{level:I,boosts:b,premiumSubscribers:f.premiumSubscribers,remainingBoosts:S,prepaidGiveaways:f.prepaidGiveaways}},[f,b,I,S]),M=(0,Gt.Kr)(()=>g?[{type:"boostList",title:h("BoostingBoostsCount",e?.boosts?.count,"i")},{type:"giftedBoostList",title:h("BoostingGiftsCount",e?.giftedBoosts?.count,"i")}]:[],[g,h,e?.boosts?.count,e?.giftedBoosts?.count]),C=(0,Gt.Kr)(()=>e?.boosts&&e.boosts?.list.length>0?1:0,[e]),[P,k]=(0,Gt.J0)(C),F=P>M.length-1?M.length-1:P,T=M[F]?.type,U=M.findIndex(({type:e})=>e===T),x=(0,Gt.Kr)(()=>{if(!e)return;const t=g?"boostList"===T?e.boosts:e.giftedBoosts:e.boosts;if(!t?.count)return;const s=t.list.reduce((e,t)=>e+(t.multiplier||1),0),a=t.count-s;return a>0?a:void 0},[g,e,T]),B=(0,Zt.A)(e=>(0,cs.Y)("div",{className:ur.quantity,children:(0,cs.FD)("div",{className:(0,qt.A)(ur.floatingBadge,ur.floatingBadgeButtonColor),children:[(0,cs.Y)(Js.A,{name:"boost",className:ur.floatingBadgeIcon}),(0,cs.Y)("div",{className:ur.floatingBadgeValue,children:e})]})})),R=(0,Zt.A)(e=>{if(e.isFromGiveaway||e.isGift)return(0,cs.Y)("div",{className:ur.quantity,children:(0,cs.FD)("div",{className:(0,qt.A)(ur.floatingBadge,!e.isFromGiveaway&&ur.floatingBadgeWarning,ur.floatingBadgeButtonColor,ur.floatingBadgeButton),children:[(0,cs.Y)(Js.A,{name:"gift",className:ur.floatingBadgeIcon}),(0,cs.Y)("div",{className:ur.floatingBadgeValue,children:h(e.isFromGiveaway?"BoostingGiveaway":"BoostingGift")})]})})}),J=(0,Zt.A)(e=>{e?(r({id:e}),c()):u({message:h("BoostingRecipientWillBeSelected")})}),N=(0,Zt.A)(e=>{let t;return Boolean(e?.stars)&&(t={...Ir,title:h("Stars",e.stars)}),e.userId||(t=vr),(0,cs.Y)(qn.A,{className:(0,qt.A)(ur.boostInfo,"chat-item-clickable"),onClick:()=>J(e.userId),children:(0,cs.Y)(fo.A,{className:ur.user,userId:e.userId,customPeer:t,status:h("BoostExpireOn",(0,Se.U)(h,1e3*e.expires)),noEmojiStatus:!0,forceShowSelf:!0,noFake:!0,noVerified:!0,iconElement:e.multiplier?B(e.multiplier):void 0,rightElement:R(e)})})}),E=(0,Zt.A)(()=>{l({chatId:s})}),L=(0,Zt.A)(e=>{e.preventDefault(),d({isGifts:"giftedBoostList"===T})}),O=(0,Zt.A)(e=>{l({chatId:s,prepaidGiveaway:e})});return(0,cs.FD)("div",{className:(0,qt.A)(ur.root,"panel-content custom-scroll"),children:[!m&&(0,cs.Y)(Fs.A,{}),m&&A&&(0,cs.FD)(cs.FK,{children:[(0,cs.FD)("div",{className:ur.section,children:[(0,cs.Y)(cr.A,{leftText:h("BoostsLevel",I),rightText:v?h("BoostsLevel",I+1):void 0,progress:y,floatingBadgeText:(0,vs.Sm)(b),floatingBadgeIcon:"boost"}),(0,cs.Y)(lr.A,{className:ur.stats,statistics:A,type:"boost"})]}),A.prepaidGiveaways&&(0,cs.FD)("div",{className:ur.section,children:[(0,cs.Y)("h4",{className:ur.sectionHeader,dir:h.isRtl?"rtl":void 0,children:h("BoostingPreparedGiveaways")}),A?.prepaidGiveaways?.map(e=>{const t="stars"in e;return(0,cs.Y)(qn.A,{className:"chat-item-clickable",onClick:()=>O(e),children:(0,cs.FD)("div",{className:(0,qt.A)(ur.status,"status-clickable"),children:[(0,cs.Y)("div",{children:t?(0,cs.Y)("img",{src:fr,className:ur.giveawayIcon,alt:h("GiftStar")}):(0,cs.Y)("img",{src:gr[e.months]||gr[3],className:ur.giveawayIcon,alt:h("Giveaway")})}),(0,cs.FD)("div",{className:ur.info,children:[(0,cs.Y)("h3",{children:t?h("Giveaway.Stars.Prepaid.Title",e.stars):h("BoostingTelegramPremiumCountPlural",e.quantity)}),(0,cs.Y)("p",{className:ur.month,children:t?h("Giveaway.Stars.Prepaid.Desc",e.quantity):h("PrepaidGiveawayMonths",e.months)})]}),(0,cs.Y)("div",{className:ur.quantity,children:(0,cs.FD)("div",{className:(0,qt.A)(ur.floatingBadge,ur.floatingBadgeButtonColor,ur.floatingBadgeButton),children:[(0,cs.Y)(Js.A,{name:"boost",className:ur.floatingBadgeIcon}),(0,cs.Y)("div",{className:ur.floatingBadgeValue,dir:h.isRtl?"rtl":void 0,children:t?e.boosts:e.quantity*(o??a.CQG)})]})})]})},e.id)}),(0,cs.Y)("p",{className:"text-muted hint",children:h("BoostingSelectPaidGiveaway")},"links-hint")]}),(0,cs.FD)("div",{className:ur.section,children:[g?(0,cs.FD)("div",{className:(0,qt.A)(ur.boostSection,ur.content),children:[(0,cs.Y)(ks.Ay,{ref:p,name:(0,ws.P)("slideOptimized",n,void 0,h.isRtl),activeKey:U,renderCount:M.length,shouldRestoreHeight:!0,children:function(){let t;if("boostList"===T?t=e?.boosts?.list:"giftedBoostList"===T&&(t=e?.giftedBoosts?.list),!t||t?.length)return(0,cs.Y)("div",{className:ur.section,children:t?.map(e=>N(e))})}()}),(0,cs.Y)(qs.A,{activeTab:F,tabs:M,onSwitchTab:k})]}):(0,cs.FD)(cs.FK,{children:[(0,cs.Y)("h4",{className:ur.sectionHeader,dir:h.isRtl?"rtl":void 0,children:h("BoostingBoostsCount",e?.boosts?.count)}),!e?.boosts?.list?.length&&(0,cs.Y)("div",{className:ur.noResults,children:h(i?"NoBoostersHint":"NoBoostersGroupHint")}),e?.boosts?.list?.map(e=>N(e))]}),Boolean(x)&&(0,cs.FD)(qn.A,{className:ur.showMore,disabled:e?.isLoadingBoosters,onClick:L,children:[e?.isLoadingBoosters?(0,cs.Y)(sa.A,{className:ur.loadMoreSpinner}):(0,cs.Y)(Js.A,{name:"down",className:ur.down}),h("ShowVotes",x,"i")]},"load-more")]}),(0,cs.Y)(dr.A,{className:ur.section,link:f.boostUrl,withShare:!0,title:h("LinkForBoosting")}),t&&(0,cs.FD)("div",{className:ur.section,children:[(0,cs.Y)(qn.A,{icon:"gift",onClick:E,className:ur.giveawayButton,children:h("BoostingGetBoostsViaGifts")},"load-more"),(0,cs.Y)("p",{className:"text-muted hint",children:h(i?"BoostingGetMoreBoosts":"BoostingGetMoreBoostsGroup")},"links-hint")]})]})]})})),yr=e=>{const t=(0,ds.A)(zt.ar.Extra,"MessageStatistics");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})};var Sr=s(75319);const wr=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"AboutMonetizationModal",!t);return s?(0,cs.Y)(s,{...e}):void 0};var Ar=s(84685);const Mr={root:"vBPv6lUS",graph:"EbPbvB1I",hidden:"nsPIlLYL",ready:"s6qyDhkE",section:"cB2IkwY6",topText:"FLOpxZd1",availableReward:"emE6bAD8",rewardValue:"eyDAxGDU",decimalPart:"jkRV_L7b",integer:"xE9kfGi7",decimalUsdPart:"hWMnYdxX",toncoinIcon:"ubDl9CvS",textBottom:"P3qZJJzF"};let Cr,Pr;const kr={topHoursGraph:"ChannelStats.Graph.ViewsByHours",revenueGraph:"lng_channel_earn_chart_revenue"},Fr=Object.keys(kr),Tr=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{settings:{byKey:{hasPassword:s}}}=e,a=t.monetizationStatistics,o=a&&a.chatId,i=o?(0,C.hds)(e,o):void 0,n=(0,C.AWZ)(e,o)?.statisticsDcId,r=Boolean(i?.isCreator);return{chatId:o,dcId:n,statistics:t.statistics.monetization,isCreator:r,isChannelRevenueWithdrawalEnabled:e.appConfig.isChannelRevenueWithdrawalEnabled,hasPassword:s}})(({chatId:e,dcId:t,statistics:a,isCreator:o,isChannelRevenueWithdrawalEnabled:i,hasPassword:n})=>{const{loadChannelMonetizationStatistics:r,openMonetizationVerificationModal:d,loadPasswordInfo:c}=(0,w.ko)(),l=(0,xs.A)(),u=(0,Qt.A)(),h=(0,Gt.li)(),[p,m]=(0,Gt.J0)(!1),f=(0,Gt.li)(new Set),g=(0,Gt.li)(new Set),I=(0,$t.A)(),[v,b,y]=(0,$s.A)(!1),[S,A,M]=(0,$s.A)(),C=a?.balances?.availableBalance,P=a?.balances?.isWithdrawalEnabled,k=o&&i&&Boolean(C)&&P;(0,Gt.vJ)(()=>{e&&(r({peerId:e}),c())},[e,r]),(0,Gt.vJ)(()=>{(async()=>{await async function(){return Cr||(Cr=s.e(4810).then(s.bind(s,24810)),Pr=await Cr),Cr}(),p?(h.current&&Array.from(h.current.children).forEach(e=>{e.innerHTML="",e.classList.add(Mr.hidden)}),f.current.clear(),g.current.clear(),a&&h.current&&(Fr.forEach((e,t)=>{const s=a[e];if(!(0,Sr.R)(s))return;const o="async"===s.graphType,i="error"===s.graphType;if(!o&&!f.current.has(e)){if(i)return f.current.add(e),void g.current.add(e);Pr.create(h.current.children[t],{title:l(kr[e]),...s}),f.current.add(e),h.current.children[t].classList.remove(Mr.hidden)}}),I())):m(!0)})()},[p,a,l,e,t,I]);const F=(0,Gt.Kr)(()=>{const e=l("LearnMore");return u("ChannelEarnAbout",{link:(0,cs.FD)(fi.A,{isPrimary:!0,onClick:b,children:[e,(0,cs.Y)(Js.A,{name:"next"})]})},{withNodes:!0})},[u,l]),T=(0,Gt.Kr)(()=>{const e=l("LearnMore");return u("MonetizationBalanceZeroInfo",{link:(0,cs.FD)(Ar.A,{url:l("MonetizationProceedsInfoLink"),text:e,children:[e,(0,cs.Y)(Js.A,{name:"next"})]})},{withNodes:!0})},[u,l]),U=(0,Zt.A)(()=>{n?d({chatId:e}):A()});return p&&a?(0,cs.FD)("div",{className:(0,qt.A)(Mr.root,"custom-scroll",p&&Mr.ready),children:[(0,cs.Y)("div",{className:(0,qt.A)(Mr.section,Mr.topText),children:F}),(0,cs.Y)(lr.A,{statistics:a,isToncoin:!0,type:"monetization",title:l("MonetizationOverview"),subtitle:(0,cs.Y)("div",{className:Mr.textBottom,children:l("MonetizationProceedsTONInfo")})}),!f.current.size&&(0,cs.Y)(Fs.A,{}),(0,cs.Y)("div",{ref:h,className:Mr.section,children:Fr.filter(Boolean).map(e=>(0,cs.Y)("div",{className:(0,qt.A)(Mr.graph,Mr.hidden)},e))}),(0,cs.FD)("div",{className:Mr.section,children:[l("lng_channel_earn_balance_title"),function(){const e=C?(0,Ot.wD)(C.amount):0,[t,s]=e.toFixed(4).split("."),[o,i]=C&&a?.usdRate?(e*a.usdRate).toFixed(2).split("."):[0];return(0,cs.FD)("div",{className:Mr.availableReward,children:[(0,cs.FD)("div",{className:Mr.toncoin,children:[(0,cs.Y)(Js.A,{className:Mr.toncoinIcon,name:"toncoin"}),(0,cs.FD)("b",{className:Mr.rewardValue,children:[t,s?(0,cs.FD)("span",{className:Mr.decimalPart,children:[".",s]}):void 0]})]})," ",(0,cs.FD)("span",{className:Mr.integer,children:["≈ $",o,i?(0,cs.FD)("span",{className:Mr.decimalUsdPart,children:[".",i]}):void 0]})]})}(),(0,cs.Y)(Rs.A,{type:"button",onClick:U,disabled:!k,children:l("MonetizationWithdraw")}),(0,cs.Y)("div",{className:Mr.textBottom,children:T})]}),(0,cs.Y)(wr,{isOpen:v,onClose:y}),(0,cs.Y)(Wo.A,{isOnlyConfirm:!0,isOpen:S,onClose:M,confirmHandler:M,confirmLabel:u("OK"),children:(0,cs.Y)("p",{children:(0,bo.A)(l("Monetization.Withdraw.Error.Text"),["br"])})})]}):(0,cs.Y)(Fs.A,{})})),Ur=e=>{const t=(0,ds.A)(zt.ar.Extra,"Statistics");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})},xr=e=>{const t=(0,ds.A)(zt.ar.Extra,"StoryStatistics");return t?(0,cs.Y)(t,{...e}):(0,cs.Y)(Fs.A,{})},Br=()=>{const e=(0,ds.A)(zt.ar.Extra,"StickerSearch");return e?(0,cs.Y)(e,{}):(0,cs.Y)(Fs.A,{})};var Rr=s(34690),Jr=s(80401),Nr=s(90596);const Er=(0,Gt.ph)((0,w.EK)(e=>{const t=(0,C.SJA)(e),{patternColor:s}=(0,C.Gyz)(e,t)||{};return{focusMessages:(0,C.DUQ)(e),patternColor:s}})(({isActive:e,focusMessages:t,patternColor:s})=>{const{focusMessage:a,replaceFocusList:o}=(0,w.ko)(),[n,r]=(0,Gt.J0)({messageHeights:{}});(0,Gt.vJ)(()=>{if(t){const e=t.map(e=>`${e.chatId}_${e.id}`);r(t=>({...t,orderedMessageKeys:e,dragOrderMessageKeys:e}))}},[t]);const d=(0,Gt.hb)((e,t)=>{if(e&&!n.messageHeights[t]){const s=e.offsetHeight;s>0&&r(e=>({...e,messageHeights:{...e.messageHeights,[t]:s}}))}},[]),c=(0,Gt.hb)(e=>{a({chatId:e.chatId,messageId:e.id})},[a]),l=(0,Gt.hb)(e=>n.messageHeights[e]||80,[n.messageHeights]),u=(0,Gt.hb)((e,t)=>{let s=0;for(let a=0;a<t;a++)s+=l(e[a]);return s},[l]),h=(0,Gt.hb)((e,t)=>{if(!n.orderedMessageKeys)return;const s=t,a=n.orderedMessageKeys.indexOf(s);if(-1===a)return;let o=a;if(e.y>0){let t=e.y;for(let e=a+1;e<n.orderedMessageKeys.length;e++){const s=l(n.orderedMessageKeys[e]);if(!(t>s/2))break;t-=s,o=e}}else if(e.y<0){let t=-e.y;for(let e=a-1;e>=0;e--){const s=l(n.orderedMessageKeys[e]);if(!(t>s/2))break;t-=s,o=e}}const i=n.orderedMessageKeys.filter(e=>e!==s);i.splice(o,0,s),r(e=>({...e,draggedKey:s,dragOrderMessageKeys:i}))},[l,n.orderedMessageKeys]),p=(0,Gt.hb)(()=>{n.dragOrderMessageKeys&&(r(e=>({...e,draggedKey:void 0,dragOrderMessageKeys:e.dragOrderMessageKeys,orderedMessageKeys:e.dragOrderMessageKeys})),o({messageKeys:n.dragOrderMessageKeys}))},[o,n.dragOrderMessageKeys]);if(!e||!t||!n.dragOrderMessageKeys)return;const m=(0,Gt.Kr)(()=>t.map(e=>`${e.chatId}_${e.id}`).reduce((e,t)=>e+l(t),0),[t,l]);return(0,cs.Y)("div",{className:"FocusList",style:(0,Ga.A)(`--pattern-color: ${s}`),children:(0,cs.Y)("div",{className:"FocusList__content custom-scroll",children:0===t.length?(0,cs.Y)("div",{className:"FocusList__empty",children:(0,cs.Y)(Rn.A,{text:"No messages in Priority",description:"Add important messages to your Priority list for quick access"})}):(0,cs.Y)("div",{className:"FocusList__messages",style:`min-height: ${m}px`,children:t.map((s,a)=>{const o=`${s.chatId}_${s.id}`,r=(0,ut.sj)(s),l=!0,m=n.draggedKey===o,f=n.orderedMessageKeys?.indexOf(o)??a,g=n.dragOrderMessageKeys?.indexOf(o)??a,I=u(n.orderedMessageKeys||[],f),v=u(n.dragOrderMessageKeys||[],g);return(0,cs.Y)(Jr.A,{id:o,onDrag:h,onDragEnd:p,style:`top: ${m?I:v}px;`,isDisabled:!e,children:(0,cs.Y)("div",{ref:e=>d(e,o),className:"FocusList__message-item",onClick:()=>c(s),children:(0,cs.Y)(Rr.A,{id:`focus-message-group-${r}`,message:s,withAvatar:l,appearanceOrder:-1,isInFocusList:!0,children:(0,cs.Y)(Nr.A,{message:s,withAvatar:l,withSenderName:!0,threadId:i.l3,messageListType:"thread",noComments:!0,noReplies:!0,noReactions:!0,appearAsNotOwn:!0,appearanceOrder:-1,isJustAdded:!1,isFirstInGroup:!0,isLastInGroup:!0,isFirstInDocumentGroup:!0,isLastInDocumentGroup:!0,isLastInList:g===t.length-1,isInFocusList:!0})},`sender-${r}`)})},o)})})})})})),Lr=450+a.xB5,Or=Object.keys(n.Ul).length/2,Dr=Object.keys(n.je).length/2;function Yr(){const e=document.querySelector(".RightHeader .SearchInput input");e&&e.blur()}const Gr=(0,Gt.ph)((0,w.EK)((e,{isMobile:t})=>{const{chatId:s,threadId:a}=(0,C.Xf0)(e)||{},o=(0,C.bE$)(e),{animationLevel:i}=(0,je.l)(e),{management:n,shouldSkipHistoryAnimations:r,shouldCloseRightColumn:d,chatInfo:c}=(0,C.nTw)(e),l=s?n.byChatId[s]?.nextScreen:void 0,u=c?.isOwnProfile,h=s&&!u?(0,C.nZ4)(e,s):void 0,p=s?(0,y.cG)(s,a,e.currentUserId):void 0;return{contentKey:(0,C.t75)(e,t),chatId:s,threadId:a,isChatSelected:Boolean(s&&o),animationLevel:i,shouldSkipHistoryAnimations:r,nextManagementScreen:l,shouldCloseRightColumn:d,isSavedMessages:h,isSavedDialog:p,isOwnProfile:u}})(({contentKey:e,chatId:t,threadId:s,isMobile:o,isChatSelected:i,animationLevel:r,shouldSkipHistoryAnimations:d,nextManagementScreen:c,shouldCloseRightColumn:l,isSavedMessages:u,isSavedDialog:h,isOwnProfile:p})=>{const{toggleChatInfo:m,toggleManagement:f,setStickerSearchQuery:g,setGifSearchQuery:I,closePollResults:v,addChatMembers:b,setNewChatMembersDialogState:y,setEditingExportedInvite:S,toggleStatistics:A,toggleMessageStatistics:M,toggleStoryStatistics:C,setOpenedInviteInfo:P,requestNextManagementScreen:k,closeCreateTopicPanel:F,closeEditTopicPanel:T,closeBoostStatistics:U,setShouldCloseRightColumn:x,closeMonetizationStatistics:B,toggleFocusList:R}=(0,w.ko)(),J=(0,Gt.li)(),{width:N}=(0,Wa.A)(),[E,L]=(0,Gt.J0)(u&&!h?n.zW.SavedDialogs:n.zW.Profile),[O,D]=(0,Gt.J0)(n.je.Initial),[Y,G]=(0,Gt.J0)(),[V,j]=(0,Gt.J0)(),q=E!==n.zW.Profile,W=void 0!==e,K=e===n.Ul.ChatInfo,z=e===n.Ul.Management,H=e===n.Ul.Statistics,_=e===n.Ul.MessageStatistics,$=e===n.Ul.StoryStatistics,X=e===n.Ul.BoostStatistics,Q=e===n.Ul.MonetizationStatistics,Z=e===n.Ul.StickerSearch,ee=e===n.Ul.GifSearch,te=e===n.Ul.PollResults,se=e===n.Ul.AddingMembers,ae=e===n.Ul.CreateTopic,oe=e===n.Ul.EditTopic,ie=e===n.Ul.FocusList,ne=N<=a.gQx,[re,de]=(0,Gt.J0)(!W),ce=(0,wo.A)(e,!0,!i)??-1;(0,Oi.A)({containerRef:J,selector:":scope .custom-scroll, :scope .panel-content"},[e,O,t,s]);const le=(0,Zt.A)((s=!0)=>{switch(e){case n.Ul.AddingMembers:y({newChatMembersProgress:n.D7.Closed});break;case n.Ul.ChatInfo:if(q&&s&&!u){L(n.zW.Profile);break}m({force:!1},{forceSyncOnIOs:!0});break;case n.Ul.Management:switch(O){case n.je.Initial:f();break;case n.je.ChatPrivacyType:case n.je.Discussion:case n.je.GroupPermissions:case n.je.GroupType:case n.je.ChatAdministrators:case n.je.ChannelSubscribers:case n.je.GroupMembers:case n.je.Invites:case n.je.Reactions:case n.je.JoinRequests:case n.je.ChannelRemovedUsers:D(n.je.Initial);break;case n.je.GroupUserPermissionsCreate:case n.je.GroupRemovedUsers:case n.je.GroupUserPermissions:D(n.je.GroupPermissions),G(void 0),j(void 0);break;case n.je.NewDiscussionGroup:D(n.je.Discussion);break;case n.je.ChatAdminRights:case n.je.ChatNewAdminRights:case n.je.GroupAddAdmins:case n.je.GroupRecentActions:D(n.je.ChatAdministrators);break;case n.je.EditInvite:case n.je.InviteInfo:D(n.je.Invites),P({chatId:t,invite:void 0}),S({chatId:t,invite:void 0})}break;case n.Ul.MessageStatistics:M();break;case n.Ul.StoryStatistics:C();break;case n.Ul.Statistics:A();break;case n.Ul.BoostStatistics:U();break;case n.Ul.MonetizationStatistics:B();break;case n.Ul.StickerSearch:Yr(),g({query:void 0});break;case n.Ul.GifSearch:Yr(),I({query:void 0});break;case n.Ul.PollResults:v();break;case n.Ul.CreateTopic:F();break;case n.Ul.EditTopic:T();break;case n.Ul.FocusList:R({force:!1})}}),ue=(0,Zt.A)((e,t)=>{G(e),j(t)}),he=(0,Zt.A)(e=>{b({chatId:t,memberIds:e})});return(0,Gt.vJ)(()=>W&&t?(0,Ss.A)(le):void 0,[W,le,t]),(0,Gt.vJ)(()=>{setTimeout(()=>{de(!W)},Lr)},[W]),(0,Gt.vJ)(()=>{c&&(D(c),k(void 0))},[c]),(0,Gt.vJ)(()=>{l&&(le(),x({value:void 0}))},[l]),(0,Gt.vJ)(()=>{W&&ne&&le()},[ne]),(0,Li.A)(([e,a])=>{e===t&&a===s||(L(u&&!h?n.zW.SavedDialogs:n.zW.Profile),D(n.je.Initial))},[t,s,h,u]),(0,js.A)({isActive:i&&(e===n.Ul.ChatInfo||e===n.Ul.Management||e===n.Ul.AddingMembers||e===n.Ul.CreateTopic||e===n.Ul.EditTopic),onBack:()=>le(!1)}),(0,cs.FD)("div",{id:"RightColumn-wrapper",className:i||ie?void 0:"is-hidden",children:[ne&&(0,cs.Y)("div",{className:"overlay-backdrop",onClick:le}),(0,cs.FD)("div",{id:"RightColumn",children:[(0,cs.Y)(nr,{chatId:t,threadId:s,isColumnOpen:W,isProfile:K,isManagement:z,isStatistics:H,isBoostStatistics:X,isMonetizationStatistics:Q,isMessageStatistics:_,isStoryStatistics:$,isStickerSearch:Z,isGifSearch:ee,isPollResults:te,isCreatingTopic:ae,isEditingTopic:oe,isAddingChatMembers:se,isFocusList:ie,profileState:E,managementScreen:O,onClose:le,onScreenSelect:D}),(0,cs.Y)(ks.Ay,{ref:J,name:(0,ws.P)("layers",r,re||d),renderCount:Or+Dr,activeKey:z?Or+O:ce,shouldCleanup:!0,cleanupExceptionKey:ce===n.Ul.MessageStatistics||ce===n.Ul.StoryStatistics?n.Ul.Statistics:void 0,children:function(e){if(-1!==ce)switch(ce){case n.Ul.AddingMembers:return(0,cs.Y)(Vi,{chatId:t,isActive:W&&e,onNextStep:he,onClose:le},`add_chat_members_${t}`);case n.Ul.ChatInfo:return(0,cs.Y)(ar,{chatId:t,threadId:s,profileState:E,isMobile:o,isActive:W&&e,onProfileStateChange:L},`profile_${t}_${s}_${Boolean(p)}`);case n.Ul.Management:return(0,cs.Y)(Ki,{chatId:t,currentScreen:O,isPromotedByCurrentUser:V,selectedChatMemberId:Y,isActive:W&&e,onScreenSelect:D,onChatMemberSelect:ue,onClose:le},`management_${t}_${O}`);case n.Ul.Statistics:return(0,cs.Y)(Ur,{chatId:t});case n.Ul.BoostStatistics:return(0,cs.Y)(br,{});case n.Ul.MonetizationStatistics:return(0,cs.Y)(Tr,{});case n.Ul.MessageStatistics:return(0,cs.Y)(yr,{chatId:t,isActive:W&&e});case n.Ul.StoryStatistics:return(0,cs.Y)(xr,{chatId:t,isActive:W&&e});case n.Ul.StickerSearch:return(0,cs.Y)(Br,{onClose:le,isActive:W&&e});case n.Ul.GifSearch:return(0,cs.Y)(Wi,{onClose:le,isActive:W&&e});case n.Ul.PollResults:return(0,cs.Y)(zi,{onClose:le,isActive:W&&e});case n.Ul.CreateTopic:return(0,cs.Y)(ji,{onClose:le,isActive:W&&e});case n.Ul.EditTopic:return(0,cs.Y)(qi,{onClose:le,isActive:W&&e});case n.Ul.FocusList:return(0,cs.Y)(Er,{isActive:W&&e})}}})]})]})})),Vr=(0,Gt.ph)(({isOpen:e})=>{const t=(0,ds.A)(zt.ar.Extra,"StoryViewer",!e);return t?(0,cs.Y)(t,{}):void 0}),jr=e=>{const{requestedAttachBotInChat:t}=e,s=(0,ds.A)(zt.ar.Extra,"AttachBotRecipientPicker",!t);return s?(0,cs.Y)(s,{...e}):void 0},qr=e=>{const{bot:t}=e,s=(0,ds.A)(zt.ar.Extra,"BotTrustModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},Wr=e=>{const{folder:t}=e,s=(0,ds.A)(zt.ar.Extra,"DeleteFolderDialog",!t);return s?(0,cs.Y)(s,{...e}):void 0},Kr=({isOpen:e})=>{const t=(0,ds.A)(zt.ar.Extra,"Dialogs",!e);return t?(0,cs.Y)(t,{}):void 0};var zr=s(95362),Hr=s(56133);const _r=new Set,$r=new Set,Xr=(0,Gt.ph)((0,w.EK)(e=>({activeDownloads:(0,C.nTw)(e).activeDownloads}))(({activeDownloads:e})=>{const{cancelMediaHashDownloads:t,showNotification:s}=(0,w.ko)(),a=(0,Hr.A)(1e3,!0),o=(0,Zt.A)(e=>{$r.add(e),a(()=>{$r.size&&(t({mediaHashes:Array.from($r)}),$r.clear())})});(0,Gt.vJ)(()=>{Object.keys(e).length?Object.entries(e).forEach(([e,t])=>{if(_r.has(e))return;_r.add(e);const{size:a,filename:n,format:r}=t,c=tt.Ih(e);if(c)return(0,zr.A)(c,n),void o(e);if(a>d.kn&&!d.l5&&!d.Tz)return s({message:"Downloading files bigger than 2GB is not supported in your browser."}),void o(e);const l=()=>{(0,C.nTw)((0,w.mS)()).activeDownloads[e]||tt.ch(l)};tt.hd(e,r,!0,l,(0,It.A)()).then(t=>{if(r===i.qZ.DownloadUrl){const e=new URL(t,window.document.baseURI);e.searchParams.set("filename",encodeURIComponent(n));const a=window.open(e.toString());a?.addEventListener("beforeunload",()=>{s({message:"Download started. Please, do not close the app before it is finished."})})}else t&&(0,zr.A)(t,n);o(e)})}):_r.clear()},[e])})),Qr=e=>{const{requestedDraft:t}=e,s=(0,ds.A)(zt.ar.Extra,"DraftRecipientPicker",!t);return s?(0,cs.Y)(s,{...e}):void 0},Zr=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"ForwardRecipientPicker",!t);return s?(0,cs.Y)(s,{...e}):void 0};var ed=s(73172);const td=(0,Gt.ph)((0,w.EK)((e,{openedGame:t})=>{const{chatId:s}=t||{},a=s&&(0,C.hds)(e,s),o=s?(0,C.AWZ)(e,s):void 0;return{canPost:Boolean(a)&&(0,y.__)(a,void 0,void 0,o)}})(({openedGame:e,gameTitle:t,canPost:s})=>{const{closeGame:a,openForwardMenu:o}=(0,w.ko)(),i=(0,xs.A)(),{url:n,chatId:r,messageId:d}=e||{},c=Boolean(n),l=(0,ed.A)(r);(0,Ht.A)(()=>{l({type:"playingGame"})},c&&s?5e3:void 0);const u=(0,Gt.hb)(e=>{if(r&&d)try{const t=JSON.parse(e.data);"share_score"===t.eventType&&(o({fromChatId:r,messageIds:[d],withMyScore:!0}),a()),"share_game"===t.eventType&&(o({fromChatId:r,messageIds:[d]}),a())}catch(e){}},[r,a,d,o]),h=(0,Gt.hb)(e=>{e.currentTarget.focus()},[]);return(0,Gt.vJ)(()=>(window.addEventListener("message",u),()=>window.removeEventListener("message",u)),[u]),(0,cs.Y)(Mi.A,{className:"GameModal",isOpen:c,onClose:a,title:t,hasCloseButton:!0,children:c&&(0,cs.Y)("iframe",{className:"game-frame",onLoad:h,src:n,title:i("AttachGame"),sandbox:"allow-scripts allow-same-origin allow-orientation-lock",allow:"fullscreen"})})})),sd=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"HistoryCalendar",!t);return s?(0,cs.Y)(s,{...e}):void 0},ad=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"NewContactModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},od=({isOpen:e})=>{const t=(0,ds.A)(zt.ar.Extra,"Notifications",!e);return t?(0,cs.Y)(t,{}):void 0},id=e=>{const{limit:t}=e,s=(0,ds.A)(zt.ar.Extra,"PremiumLimitReachedModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},nd=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"GiveawayModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},rd=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Extra,"PremiumMainModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},dd=e=>{const{isOpen:t}=e,s=(0,ds.A)(zt.ar.Stars,"StarsGiftingPickerModal",!t);return s?(0,cs.Y)(s,{...e}):void 0},cd=e=>{const{url:t}=e,s=(0,ds.A)(zt.ar.Extra,"SafeLinkModal",!t);return s?(0,cs.Y)(s,{...e}):void 0};var ld=s(63527);const ud=({isOpen:e,workspaceId:t})=>{const s=(0,w.mS)(),{setActiveChatFolder:a,closeWorkspaceCreator:o,createWorkspace:i,updateWorkspace:n,deleteWorkspace:r,setCurrentWorkspace:d}=(0,w.ko)(),c=s.chatFolders.byId,l=s.chatFolders.orderedIds,u=l?l.map(e=>c[e]).filter(Boolean):[],[h,p]=(0,Gt.J0)(""),[m,f]=(0,Gt.J0)([]),g=(0,ld.A)(e=>t?(0,Dt.YQ)(e,t):void 0),I=(0,Qt.A)(),v=t;(0,Gt.vJ)(()=>{g?(p(g.name),f(g.foldersIds||[])):(p(""),f([]))},[g]);const b=m.length>0&&""!==h.trim(),y=(0,Gt.hb)(e=>{e.preventDefault();const t=h.trim();if(b){if(v)n({workspace:{id:v,name:t,foldersIds:m}});else{const e={id:Date.now().toString(),name:t,foldersIds:m};i({workspace:e}),d({workspaceId:e.id})}a({activeChatFolder:0},{forceOnHeavyAnimation:!0}),o()}},[h,m,v,b,i,n,d,a,o]),S=(0,Gt.hb)(e=>{p(e.target.value)},[]),A=(0,Gt.hb)(e=>t=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),M=(0,Gt.hb)(()=>{v&&(r({workspaceId:v}),d({workspaceId:Dt.a3}),o())},[v,r,d,o]),C=(0,Gt.hb)(()=>{o()},[o]),P=(0,Gt.hb)(()=>{const e=v?"Edit Workspace":"Create Workspace";return(0,cs.FD)("div",{className:"modal-header-condensed",children:[(0,cs.Y)(Rs.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:I("Cancel"),onClick:C,children:(0,cs.Y)(Js.A,{name:"close"})}),(0,cs.Y)("div",{className:"modal-title",children:e}),(0,cs.Y)(Rs.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:y,disabled:!b,children:v?"Save":"Create"})]})},[v,b,y,C,I]);return(0,cs.Y)(Mi.A,{isOpen:e,onClose:C,header:P(),className:"WorkspaceModal",children:(0,cs.FD)("div",{className:"workspace-form",children:[(0,cs.Y)(Ci.A,{id:"workspace-name",value:h,onChange:S,label:"Workspace name"}),(0,cs.FD)("div",{className:"workspace-folder-selection",children:[(0,cs.Y)("h3",{className:"workspace-folder-selection-title",children:"Select folders:"}),u.map(e=>(0,cs.Y)(ci.A,{label:e.title.text,checked:m.includes(e.id),onChange:A(e.id)},e.id))]}),v&&(0,cs.Y)(Rs.A,{color:"danger",onClick:M,children:"Delete workspace"})]})})},hd={root:"YUAfqWPN"},pd=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"],md=new Path2D("M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z"),fd=(0,Gt.ph)((0,w.EK)(e=>(0,h.Up)((0,C.nTw)(e),["confetti"]))(({confetti:e})=>{const t=(0,Gt.li)(),s=(0,Gt.li)([]),a=(0,Gt.li)(!1),o=(0,Wa.A)(),i=(0,$t.A)(),{isMobile:n}=(0,D.Ay)(),r=n?50:100,{lastConfettiTime:d,top:c,width:l,left:u,height:h,style:p="poppers"}=e||{},m=(0,Zt.A)((t,a,o=r)=>{for(let i=0;i<o;i++){const{position:o,velocity:n}=gd(p,t,a,i),r=10+Id(5),d=pd[Math.floor(Math.random()*pd.length)];s.current.push({pos:o,size:r,color:d,velocity:n,flicker:r,flickerFrequency:.2*Math.random(),rotation:0,lastDrawnAt:Date.now(),frameCount:0,isStar:e?.withStars&&Math.random()>.8})}}),f=(0,Zt.A)(()=>{if(!t.current||!a.current)return;const e=t.current,o=e.getContext("2d");if(!o)return;const{width:i,height:n}=e;o.clearRect(0,0,i,n);const r=[];s.current.forEach((e,t)=>{const{pos:a,velocity:i,size:d,color:c,flicker:l,flickerFrequency:u,rotation:h,lastDrawnAt:p,frameCount:m}=e,f=(Date.now()-p)/1e3,g={x:a.x+i.x*f,y:a.y+i.y*f},I={x:i.x*.5**(f/1),y:i.y+=1e3*f},v=d*Math.abs(Math.sin(m*u)),b=5*m*u*(Math.PI/180),y=m+1,S=Date.now();if(g.y>n+e.size)return void r.push(e);const w={...e,pos:g,velocity:I,flicker:v,rotation:b,lastDrawnAt:S,frameCount:y};s.current[t]=w,o.fillStyle=c,e.isStar?(o.save(),o.translate(a.x,a.y),o.scale(d/10*1.5,d/10*1.5),o.rotate(h),o.fill(md),o.restore()):(o.beginPath(),o.ellipse(a.x,a.y,d,l,h,0,2*Math.PI),o.fill())}),s.current=s.current.filter(e=>!r.includes(e)),s.current.length?(0,jt.YS)(f):a.current=!1});if((0,os.A)(([e])=>{let t;return e!==d&&(m(l||o.width,h||o.height),t=setTimeout(i,1e4),a.current||(a.current=!0,(0,jt.YS)(f))),()=>{clearTimeout(t)}},[d,i,f]),!d||Date.now()-d>1e4)return;const g=(0,Ga.A)(Boolean(c)&&`top: ${c}px`,Boolean(u)&&`left: ${u}px`,Boolean(l)&&`width: ${l}px`,Boolean(h)&&`height: ${h}px`);return(0,cs.Y)("div",{id:"Confetti",className:hd.root,style:g,children:(0,cs.Y)("canvas",{ref:t,className:hd.canvas,width:o.width,height:o.height})})}));function gd(e,t,s,a){if("poppers"===e){const e=a%2,o={x:t*(e?-.1:1.1),y:.66*s},i=Math.random()*t;return{position:o,velocity:{x:e?i:-1*i,y:-s-Id(.75*s)}}}return{position:{x:Math.random()*t,y:-20},velocity:{x:Id(t),y:-s*Math.random()*1.25}}}function Id(e=1){return Math.random()*e-e/2}var vd=s(15006),bd=s(28470);const yd=s.p+"wave_ripple.5d7d9fa793232bef56c0.jpg",Sd="wave-filter",wd=(0,Gt.ph)((0,w.EK)(e=>({waveInfo:(0,C.nTw)(e).wave}))(({waveInfo:e})=>{const[t,s]=(0,Gt.J0)([]),o=(0,Zt.A)(e=>{t.length>=7||s(t=>[...t,e])});return(0,Gt.vJ)(()=>{if(!e)return;const{startX:t,startY:s}=e,{width:a,height:i}=U.A.get(),n=1.73*Math.max(a-t,i-s,t,s),r=s-n/2,d=t-n/2;o({startTime:e.lastWaveTime,waveWidth:n,top:r,left:d})},[e]),(0,Gt.vJ)(()=>((0,bd.z)((0,cs.FD)("filter",{x:"0",y:"0",width:"1",height:"1","color-interpolation-filters":"sRGB",xmlns:a.jNX,children:[(0,cs.Y)("feImage",{href:yd,result:"waveImage"}),(0,cs.Y)("feDisplacementMap",{in:"SourceGraphic",in2:"waveImage",scale:"20",xChannelSelector:"R",yChannelSelector:"B"})]}),Sd),()=>{(0,bd.e)(Sd)}),[]),(0,cs.Y)("div",{className:(0,qt.A)("RMsQzedH"),teactFastList:!0,children:t.map(e=>(0,cs.Y)("div",{className:"YLR2Oh2f",style:(0,Ga.A)(`--wave-width: ${e.waveWidth}px`,`--wave-pos-top: ${e.top}px`,`--wave-pos-left: ${e.left}px`),onAnimationEnd:()=>s(t=>t.filter(t=>t!==e))},e.startTime))})}));let Ad=!1;const Md=(0,Gt.ph)((0,w.EK)((e,{isMobile:t})=>{const{currentUserId:s}=e,{botTrustRequest:a,requestedAttachBotInChat:o,requestedDraft:i,safeLinkModalUrl:n,openedStickerSetShortName:r,openedCustomEmojiSetIds:d,shouldSkipHistoryAnimations:c,openedGame:l,isLeftColumnShown:u,historyCalendarSelectedAt:h,notifications:p,dialogs:m,newContact:f,ratingPhoneCall:g,premiumModal:I,giveawayModal:v,deleteMessageModal:b,starsGiftingPickerModal:y,isMasterTab:S,payment:w,limitReachedModal:A,deleteFolderDialogModal:M}=(0,C.nTw)(e),{wasTimeFormatSetManually:P}=(0,je.l)(e),k=l&&(0,C.O5q)(e,l.chatId,l.messageId),F=k?.content.game?.title,{chatId:T}=(0,C.Xf0)(e)||{},U=!(0,C.xYJ)(e,"rightColumnAnimations")||!(0,C.PKK)(e),x=M?(0,C.$aQ)(e,M):void 0,B=(0,C.trm)(e);return{currentUserId:s,isLeftColumnOpen:u,isMiddleColumnOpen:Boolean(T),isRightColumnOpen:(0,C.gjV)(e,t),isFocusListOpen:(0,C.nTw)(e).isFocusListShown,isMediaViewerOpen:(0,C.F4N)(e),isStoryViewerOpen:(0,C.gd2)(e),isForwardModalOpen:(0,C.p5z)(e),isReactionPickerOpen:(0,C.Ani)(e),hasNotifications:Boolean(p.length),hasDialogs:Boolean(m.length),safeLinkModalUrl:n,isHistoryCalendarOpen:Boolean(h),shouldSkipHistoryAnimations:c,openedStickerSetShortName:r,openedCustomEmojiSetIds:d,isServiceChatReady:(0,C.dqr)(e),activeGroupCallId:S?e.groupCalls.activeGroupCallId:void 0,withInterfaceAnimations:(0,C.PKK)(e),wasTimeFormatSetManually:P,isPhoneCallActive:S?Boolean(e.phoneCall):void 0,addedSetIds:e.stickers.added.setIds,addedCustomEmojiIds:e.customEmojis.added.setIds,newContactUserId:f?.userId,newContactByPhoneNumber:f?.isByPhoneNumber,openedGame:l,gameTitle:F,isRatePhoneCallModalOpen:Boolean(g),botTrustRequest:a,botTrustRequestBot:a&&(0,C.mBe)(e,a.botId),requestedAttachBotInChat:o,isCurrentUserPremium:(0,C.g29)(e),isPremiumModalOpen:I?.isOpen,isGiveawayModalOpen:v?.isOpen,isDeleteMessageModalOpen:Boolean(b),isStarsGiftingPickerModal:y?.isOpen,limitReached:A?.limit,isPaymentModalOpen:w.isPaymentModalOpen,isReceiptModalOpen:Boolean(w.receipt),deleteFolderDialog:x,isMasterTab:S,requestedDraft:i,noRightColumnAnimation:U,isSynced:e.isSynced,isAccountFrozen:B,isAppConfigLoaded:e.isAppConfigLoaded,isWorkspaceCreatorOpen:e.workspaces.isCreatorOpen,editingWorkspaceId:e.workspaces.editingWorkspaceId}})(({isMobile:e,isLeftColumnOpen:t,isMiddleColumnOpen:o,isFocusListOpen:i,isRightColumnOpen:n,isMediaViewerOpen:r,isStoryViewerOpen:c,isForwardModalOpen:l,hasNotifications:u,hasDialogs:h,activeGroupCallId:p,safeLinkModalUrl:m,isHistoryCalendarOpen:f,shouldSkipHistoryAnimations:g,limitReached:I,openedStickerSetShortName:v,openedCustomEmojiSetIds:b,isServiceChatReady:y,withInterfaceAnimations:S,wasTimeFormatSetManually:A,addedSetIds:M,addedCustomEmojiIds:C,isPhoneCallActive:P,newContactUserId:k,newContactByPhoneNumber:F,openedGame:T,gameTitle:U,isRatePhoneCallModalOpen:x,botTrustRequest:B,botTrustRequestBot:R,requestedAttachBotInChat:J,requestedDraft:N,isPremiumModalOpen:E,isGiveawayModalOpen:L,isDeleteMessageModalOpen:O,isStarsGiftingPickerModal:Y,isPaymentModalOpen:G,isReceiptModalOpen:V,isReactionPickerOpen:j,isCurrentUserPremium:q,deleteFolderDialog:W,isMasterTab:K,noRightColumnAnimation:z,isSynced:H,currentUserId:_,isAccountFrozen:$,isAppConfigLoaded:X,isWorkspaceCreatorOpen:Q,editingWorkspaceId:Z})=>{const{initMain:ee,loadAnimatedEmojis:te,loadBirthdayNumbersStickers:se,loadRestrictedEmojiStickers:ae,loadNotificationSettings:oe,loadNotificationExceptions:ie,updateIsOnline:ne,onTabFocusChange:re,loadTopInlineBots:de,loadEmojiKeywords:ce,loadCountryList:le,loadAvailableReactions:ue,loadStickerSets:he,loadPremiumGifts:pe,loadTonGifts:me,loadStarGifts:fe,loadMyCollectibleGifts:ge,loadDefaultTopicIcons:Ie,loadAddedStickers:ve,loadFavoriteStickers:be,loadDefaultStatusIcons:ye,ensureTimeFormat:Se,closeStickerSetModal:we,closeCustomEmojiSets:Ae,checkVersionNotification:Me,loadConfig:Ce,loadAppConfig:Pe,loadAttachBots:ke,loadContactList:Fe,loadCustomEmojis:Te,loadGenericEmojiEffects:Ue,closePaymentModal:xe,clearReceipt:Be,checkAppVersion:Re,openThread:Je,toggleLeftColumn:Ne,loadRecentEmojiStatuses:Ee,loadUserCollectibleStatuses:Le,updatePageTitle:Oe,loadTopReactions:De,loadRecentReactions:Ye,loadDefaultTagReactions:Ge,loadFeaturedEmojiStickers:Ve,loadAuthorizations:je,loadPeerColors:qe,loadSavedReactionTags:We,loadTimezones:Ke,loadQuickReplies:ze,loadStarStatus:He,loadAvailableEffects:_e,loadTopBotApps:$e,loadPaidReactionPrivacy:Xe,loadPasswordInfo:Qe,loadBotFreezeAppeal:Ze,loadAllChats:et,loadAllStories:tt,loadAllHiddenStories:st,loadContentSettings:at}=(0,w.ko)();a.Oig&&!Ad&&(Ad=!0,console.log(">>> RENDER MAIN"));const it=(0,Qt.A)();(0,_t.A)(()=>{(0,zt.po)(zt.ar.Calls)},5e3);const nt=(0,Gt.li)(),rt=(0,Gt.li)(),{isDesktop:dt}=(0,D.Ay)();var ct,lt;(0,Gt.vJ)(()=>{t||o||dt?t&&o&&e&&Ne():Ne()},[dt,t,o,e,Ne]),(0,Ht.A)(Re,K?3e5:void 0,!0),(0,Gt.vJ)(()=>{K&&H&&(ne({isOnline:!0}),Ce(),Pe(),qe(),ee(),Fe(),Re(),je(),Qe())},[K,H]),(0,Gt.vJ)(()=>{K&&H&&X&&!$&&(et({listType:"saved"}),tt(),st(),at(),Ye(),Ge(),ke(),oe(),ie(),de(),De(),He(),ce({language:a.cUY}),Ve(),We(),$e(),Xe(),Ie(),te(),ue(),Le(),Ue(),pe(),me(),fe(),ge(),_e(),se(),ae(),ze(),Ke())},[K,H,X,$]),(0,Gt.vJ)(()=>{K&&q&&X&&!$&&(ye(),Ee())},[q,K,X,$]),(0,Gt.vJ)(()=>{K&&(it.code!==a.cUY&&ce({language:it.code}),le({langCode:it.code}))},[it,K]),(0,Gt.vJ)(()=>{K&&Te({ids:Object.keys((0,w.mS)().customEmojis.byId),ignoreCache:!0})},[K]),(0,Gt.vJ)(()=>{K&&H&&X&&!$&&(M&&C||(he(),be()),M&&C&&ve())},[M,C,K,H,X,$]),(0,Gt.vJ)(()=>{Ze()},[X]),(0,Gt.vJ)(()=>{y&&K&&Me()},[y,K]),(0,Gt.vJ)(()=>{A||Se()},[A]),(0,Gt.vJ)(()=>{if(!H)return;Oe();const e=(0,ot.f4)();e?.tgaddr&&(0,Kt._)(decodeURIComponent(e.tgaddr))},[H]),ct="deeplink",lt=e=>{try{const t=e.payload||"",s=decodeURIComponent(t);(0,Kt._)(s)}catch(e){a.Oig&&console.error("Failed to process deep link",e)}},(0,Gt.vJ)(()=>{if(!gt.Vq)return;let e;return(async()=>{const{listen:t}=await s.e(8925).then(s.bind(s,8925));e=await t(ct,e=>{lt(e)})})().catch(e=>{console.error(`Could not set up window event listener. ${e}`)}),()=>{e?.()}},[ct,lt]),(0,Gt.vJ)(()=>{const e=(0,ot.xV)(_);e&&Je({chatId:e.chatId,threadId:e.threadId,type:e.type})},[_]),(0,Gt.Nf)(()=>{const e=nt.current;1===e.parentNode.childElementCount&&(0,Vt.YM)(e,"Transition_slide-active")},[]),(0,as.A)({ref:nt,isOpen:t,noCloseTransition:g,prefix:"left-column-"});const ut=(0,Gt.li)(!1),ht=(0,$t.A)();(0,os.A)(([e])=>{if(void 0===e||t===e||!S)return;ut.current=!0,d.Ni&&(0,jt.Uz)(()=>{document.body.classList.toggle("android-left-blackout-open",!t)});const s=(0,Gt.VK)();(0,Wt.j)(document.getElementById("MiddleColumn"),()=>{s(),ut.current=!1,ht()})},[t,S,ht]),(0,as.A)({ref:nt,isOpen:n,noCloseTransition:g,prefix:"right-column-"});const pt=(0,Gt.li)(!1),[mt,ft]=(0,Gt.J0)(n),It=(0,rs.zk)();(0,os.A)(([e,t])=>{if(void 0===t||n===t)return;if(!e||z)return void ft(n);pt.current=!0;const s=(0,Gt.VK)();(0,Wt.j)(document.getElementById("RightColumn"),()=>{s(),pt.current=!1,ht(),ft(n)})},[o,n,z,ht]);const vt=(0,qt.A)(ut.current&&"left-column-animating",pt.current&&"right-column-animating",mt&&"narrow-message-list",g&&"history-animation-disabled",It&&"is-fullscreen",i&&"focus-list-open"),{openCommandPalette:bt,toggleFocusList:St}=(0,w.ko)();(0,Xt.v)((0,Gt.Kr)(()=>({"Mod+K":e=>{e.preventDefault(),bt()},"Mod+P":e=>{e.preventDefault(),St()}}),[]));const wt=(0,Zt.A)(()=>{re({isBlurred:!0})}),At=(0,Zt.A)(()=>{re({isBlurred:!1}),document.title.includes(a.LaL)||Oe(),yt(!1)}),Mt=(0,Zt.A)(()=>{we()}),Ct=(0,Zt.A)(()=>{Ae()});return(0,is.Ay)(wt,At,gt.Vq),(0,ns.A)(wt),function(e=!1){(0,Gt.vJ)(()=>{if(d.TF){if(!e)return es?.setAttribute("content",ts),d.pz&&!d._7&&document.addEventListener("gesturestart",ss),()=>{es?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no"),d.pz&&!d._7&&document.removeEventListener("gesturestart",ss)};es?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover")}},[e])}(r||c),(0,cs.FD)("div",{ref:nt,id:"Main",className:vt,children:[(0,cs.Y)(La,{ref:rt}),(0,cs.Y)(Si,{leftColumnRef:rt,isMobile:e}),(0,cs.Y)(Gr,{isMobile:e}),(0,cs.Y)(Oa,{isOpen:r}),(0,cs.Y)(Vr,{isOpen:c}),(0,cs.Y)(Zr,{isOpen:l}),(0,cs.Y)(Qr,{requestedDraft:N}),(0,cs.Y)(od,{isOpen:u}),(0,cs.Y)(Kr,{isOpen:h}),(0,cs.Y)(Eo,{noUi:!0}),(0,cs.Y)(Ji,{}),(0,cs.Y)(cd,{url:m}),(0,cs.Y)(sd,{isOpen:f}),(0,cs.Y)(gs,{isOpen:Boolean(v),onClose:Mt,stickerSetShortName:v}),(0,cs.Y)(ms,{customEmojiSetIds:b,onClose:Ct}),p&&(0,cs.Y)(us,{groupCallId:p}),(0,cs.Y)(ls,{isActive:Boolean(p||P)}),(0,cs.Y)(ad,{isOpen:Boolean(k||F),userId:k,isByPhoneNumber:F}),(0,cs.Y)(td,{openedGame:T,gameTitle:U}),(0,cs.Y)(Xr,{}),(0,cs.Y)(fd,{}),d.J6&&(0,cs.Y)(wd,{}),(0,cs.Y)(vd.A,{}),(0,cs.Y)(hs,{isActive:P}),(0,cs.Y)(ys,{isForAppBadge:!0}),(0,cs.Y)(ps,{isOpen:x}),(0,cs.Y)(qr,{bot:R,type:B?.type,shouldRequestWriteAccess:B?.shouldRequestWriteAccess}),(0,cs.Y)(jr,{requestedAttachBotInChat:J}),(0,cs.Y)(Ya,{}),(0,cs.Y)(rd,{isOpen:E}),(0,cs.Y)(nd,{isOpen:L}),(0,cs.Y)(dd,{isOpen:Y}),(0,cs.Y)(id,{limit:I}),(0,cs.Y)(Ni,{isOpen:G,onClose:xe}),(0,cs.Y)(Ei,{isOpen:V,onClose:Be}),(0,cs.Y)(Wr,{folder:W}),(0,cs.Y)(Da,{isOpen:j}),(0,cs.Y)(fs,{isOpen:O}),(0,cs.Y)(ud,{isOpen:Boolean(Q),workspaceId:Z})]})}));var Cd=s(15535);var Pd=s(89704);const kd=(0,Gt.ph)((0,w.EK)(e=>({passcodeSettings:e.passcode}))(({isLocked:e,passcodeSettings:t})=>{const{unlockScreen:s,signOut:a,logInvalidUnlockAttempt:o,resetInvalidUnlockAttempts:i}=(0,w.ko)(),{invalidAttemptsCount:n,timeoutUntil:r,isLoading:d}=t,c=(0,xs.A)(),[l,u]=(0,Gt.J0)(""),[h,p]=(0,Gt.J0)(!1),[m,f,g]=(0,$s.A)(!1),{shouldRender:I}=(0,Bs.A)(e);(0,_t.A)(i,r?r-Date.now():void 0);const v=(0,Gt.hb)(()=>{u("")},[]),b=(0,Gt.hb)(e=>{void 0===r?(u(""),(0,Ft.UQ)(e).then(s,e=>{e instanceof Ft.Mv&&a({forceInitApi:!0}),o(),u(c("lng_passcode_wrong"))})):u(c("FloodWait"))},[c,r]);(0,Gt.vJ)(()=>{void 0!==r?u(c("FloodWait")):0===n&&u("")},[r,c,n]);const y=(0,Gt.hb)(()=>{g(),a({forceInitApi:!0})},[g,a]);if(I)return(0,cs.FD)("div",{className:"bdKGCai4",children:[(0,cs.FD)("div",{className:"BIi4Pl4Z",dir:c.isRtl?"rtl":void 0,children:[(0,cs.Y)(yn.A,{tgsUrl:sn.w.Lock,previewUrl:Pd,size:160,className:"JwlsF2tF"}),(0,cs.Y)(Cd.A,{shouldShowSubmit:!0,shouldDisablePasswordManager:!0,isLoading:d,error:l,placeholder:c("Passcode.EnterPasscodePlaceholder"),submitLabel:c("Next"),onClearError:v,isPasswordVisible:h,noRipple:!0,onChangePasswordVisibility:p,onSubmit:b},"password-form"),(0,cs.FD)("div",{className:"VlXFyC_a",children:[(0,cs.FD)("p",{children:[(0,cs.Y)(fi.A,{onClick:f,children:"Log out"})," ","if you don't remember your passcode."]}),(0,cs.Y)("p",{children:(0,cs.Y)(Rs.A,{color:"translucent",size:"tiny",isText:!0,onClick:f,children:c("AccountSettings.Logout")})})]})]}),(0,cs.Y)(Wo.A,{isOpen:m,onClose:g,text:c("lng_sure_logout"),confirmLabel:c("AccountSettings.Logout"),confirmHandler:y,confirmIsDestructive:!0})]})}));a.Oig&&console.log(">>> FINISH LOAD MAIN BUNDLE")}}]);
//# sourceMappingURL=7768.54191f2293e62553551e.js.map