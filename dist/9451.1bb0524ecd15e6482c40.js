"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[9451],{3178:(e,t,i)=>{i.d(t,{A:()=>p});var n=i(84051),s=i(31481),a=i(58443),o=i(14737),r=i(43874),l=i(37661),c=i(18104),d=i(20021);const h=[0,50],u=[0,20],m=[20,0],p=(0,n.ph)(({isPasswordVisible:e,isBig:t})=>{const[i,p]=(0,l.A)(!1),[v,g]=(0,l.A)(!1),{isMobile:A}=(0,r.Ay)(),f=A?s.UyP:s.H6l;(0,o.A)(g,2e3);const b=(0,n.hb)(p,[p]);return(0,d.FD)("div",{id:"monkey",className:t?"big":"",children:[!i&&(0,d.Y)("div",{className:"monkey-preview"}),(0,d.Y)(c.A,{size:t?s.r2x:f,className:v?"hidden":"shown",tgsUrl:a.w.MonkeyClose,playSegment:h,noLoop:!0,onLoad:b}),(0,d.Y)(c.A,{size:t?s.r2x:f,className:v?"shown":"hidden",tgsUrl:a.w.MonkeyPeek,playSegment:e?u:m,noLoop:!0})]})})},31140:(e,t,i)=>{i.r(t),i.d(t,{AboutAdsModal:()=>Ul,AboutMonetizationModal:()=>Kl,AgeVerificationModal:()=>wl,ArchivedChats:()=>Vm,AttachBotInstallModal:()=>Ca,AttachBotRecipientPicker:()=>ss,AttachmentModal:()=>zp,BoostModal:()=>gl,BotCommandMenu:()=>kv,BotTrustModal:()=>ba,CalendarModal:()=>ys,ChatCommandTooltip:()=>Sv,ChatFolderModal:()=>_m,ChatInviteModal:()=>Rl,ChatLanguageModal:()=>Bc,ChatlistModal:()=>Ml,CollectibleInfoModal:()=>Ec,ContactList:()=>dm,ContextMenuContainer:()=>Km.A,CountryPickerModal:()=>$o,CreateTopic:()=>Xg,CustomEmojiSetsModal:()=>zm,CustomEmojiTooltip:()=>Iv,CustomSendMenu:()=>Yv,DeleteAccountModal:()=>Sl,DeleteFolderDialog:()=>ya,DeleteMessageModal:()=>bc,Dialogs:()=>rs,DraftRecipientPicker:()=>ns,DropArea:()=>Fv.A,EditTopic:()=>tA,EmojiInteractionAnimation:()=>Tc,EmojiStatusAccessModal:()=>Hl,EmojiTooltip:()=>Lv,ForwardRecipientPicker:()=>is,FrozenAccountModal:()=>Nf,GifSearch:()=>Hv,GiftCodeModal:()=>Cl,GiveawayModal:()=>yr,HeaderMenuContainer:()=>Wm,HistoryCalendar:()=>Ss,InlineBotTooltip:()=>Kv,InviteViaLinkModal:()=>yf,LeftSearch:()=>xd,LocationAccessModal:()=>$l,Management:()=>EA,MapModal:()=>ms,MediaViewer:()=>Rt,MentionTooltip:()=>Up,MessageSelectToolbar:()=>kc,MessageStatistics:()=>Tg,MiddleSearch:()=>lp,MinimizedWebAppModal:()=>Es,MuteChatModal:()=>Om,NewChat:()=>pm,NewContactModal:()=>ws,Notifications:()=>cs,OneTimeMediaModal:()=>kf,PaymentModal:()=>vf,PinMessageModal:()=>Cc,PollModal:()=>Hp,PollResults:()=>Og,PremiumLimitReachedModal:()=>Pr,PremiumMainModal:()=>Ko,PreparedMessageModal:()=>ic,PrivacySettingsNoticeModal:()=>Dc,ProfileRatingModal:()=>Pf,ReactionPicker:()=>gp,ReactorListModal:()=>Mc,ReceiptModal:()=>ff,ReportAdModal:()=>Wl,ReportModal:()=>Xl,SafeLinkModal:()=>hs,SeenByModal:()=>wc,SendAsMenu:()=>Jv,Settings:()=>cm,SharePreparedMessageModal:()=>ac,SponsoredContextMenuContainer:()=>xl.A,Statistics:()=>kg,StatusPickerMenu:()=>ll,StickerSearch:()=>zv,StickerSetModal:()=>Gm,StickerTooltip:()=>wv,StoryStatistics:()=>Vg,StoryViewer:()=>Kn,SuggestMessageModal:()=>lc,SuggestedPostApprovalModal:()=>dc,SuggestedStatusModal:()=>hl,SymbolMenu:()=>bv,TextFormatter:()=>Bv,ToDoListModal:()=>qp,UnpinAllMessagesModal:()=>yc,UrlAuthModal:()=>vs,VerificationMonetizationModal:()=>jl,WebAppModal:()=>fa,WebAppsCloseConfirmationModal:()=>wf});var n=i(84051),s=i(13439),a=i(89925),o=i(31481),r=i(66644),l=i(90709),c=i(57639),d=i(53827),h=i(63495),u=i(96454),m=i(11778),p=i(14680),v=i(9716),g=i(76023),A=i(49086);function f({message:e,avatarOwner:t,profilePhotos:i,standaloneMedia:n,mediaIndex:s,sponsoredMessage:a}){return t&&i?{type:"avatar",avatarOwner:t,profilePhotos:i,mediaIndex:s}:n?{type:"standalone",media:n,mediaIndex:s}:e?{type:"message",message:e,mediaIndex:s}:a?{type:"sponsoredMessage",message:a,mediaIndex:s}:void 0}function b(e,t){if(!t)return;if("standalone"===t.type)return{media:t.media[t.mediaIndex],isSingle:1===t.media.length};if("avatar"===t.type){const e=t.profilePhotos?.photos[t.mediaIndex];return e?{media:e}:void 0}const{action:i,document:n,photo:s,video:a,paidMedia:o}=(0,l.r_)(t.message);if("chatEditPhoto"===i?.type||"suggestProfilePhoto"===i?.type)return{media:i.photo,isSingle:!0};if(n&&((0,l.Ml)(n)||(0,l.hr)(n)))return{media:n};const r=(0,c.Pn$)(e,t.message);if("full"===r?.webpageType){const{photo:e,video:t,document:i}=r,n=i&&((0,l.Ml)(i)||(0,l.hr)(i)),s=t||(n?i:void 0)||e;if(s)return{media:s,isSingle:!0}}if(o){const e=o.extendedMedia[t.mediaIndex||0];if(!("mediaType"in e)){const{photo:t,video:i}=e;return{media:t||i}}}const d=a||s;return d?{media:d,isSingle:a?.isGif}:void 0}var C=i(19822),y=i(83868),S=i(16460),k=i(41512),w=i(43503);function N(e,t){const i=document.createElement("div");i.classList.add("ghost");const n=new Image;if(n.draggable=!1,n.oncontextmenu=y.A,"string"==typeof e?n.src=e:e instanceof HTMLVideoElement?n.src=e.poster:n.src=e.src,i.appendChild(n),t===a.TQ.ProfileAvatar||t===a.TQ.SettingsAvatar){i.classList.add("ProfileInfo"),t===a.TQ.SettingsAvatar&&i.classList.add("self");const e=document.querySelector(t===a.TQ.ProfileAvatar?"#RightColumn .ProfileInfo .info":"#Settings .ProfileInfo .info");e&&i.appendChild(e.cloneNode(!0))}return i}function I(e,t,i){let n,s;switch(e){case a.TQ.Album:case a.TQ.ScheduledAlbum:n=`.Transition_slide-active > .MessageList #album-media-${(0,l.GZ)(t.id,i)}`,s=".full-media";break;case a.TQ.PreviewMedia:n=`#preview-media${i}`,s="img";break;case a.TQ.SharedMedia:n=`#shared-media${(0,l.GZ)(t.id,i)}`,s="img";break;case a.TQ.SearchResult:n=`#search-media${(0,l.GZ)(t.id,i)}`,s="img";break;case a.TQ.MiddleHeaderAvatar:n=".MiddleHeader .Transition_slide-active .ChatInfo .Avatar",s=".avatar-media";break;case a.TQ.SettingsAvatar:n="#Settings .ProfileInfo .Transition_slide-active .ProfilePhoto",s=".avatar-media";break;case a.TQ.ProfileAvatar:n="#RightColumn .ProfileInfo .Transition_slide-active .ProfilePhoto",s=".avatar-media";break;case a.TQ.ChannelAvatar:case a.TQ.SuggestedAvatar:n=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,i)}`,s=".Avatar img";break;case a.TQ.StarsTransaction:n=".transaction-media-preview",s=0===i?`.stars-transaction-media-${i} :is(img, video)`:void 0;break;case a.TQ.SponsoredMessage:n=".Transition_slide-active > .MessageList .sponsored-media-preview",s=`${o.KFG} .full-media,${o.KFG} .thumbnail:not(.blurred-bg)`;break;case a.TQ.ScheduledInline:case a.TQ.Inline:default:n=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,i)}`,s=`${o.KFG} .full-media,${o.KFG} .thumbnail:not(.blurred-bg)`}const r=document.querySelector(n),c=s?r?.querySelectorAll(s):void 0;return{container:r,mediaEl:c?.[0]}}function P(e,t){switch(t){case a.TQ.Album:case a.TQ.ScheduledAlbum:case a.TQ.Inline:case a.TQ.ScheduledInline:case a.TQ.StarsTransaction:case a.TQ.PreviewMedia:e.classList.add("rounded-corners");break;case a.TQ.SharedMedia:case a.TQ.SettingsAvatar:case a.TQ.ProfileAvatar:case a.TQ.SearchResult:e.firstChild.style.objectFit="cover";break;case a.TQ.MiddleHeaderAvatar:case a.TQ.SuggestedAvatar:case a.TQ.ChannelAvatar:e.classList.add("circle")}}var Y=i(43874),F=i(37661),D=i(30857),M=i(17712),T=i(59030),B=i(41733),R=i(22237);const L=(0,R.n5)(!1),x=L[1];function E(e){if(e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode)return e.webkitSetPresentationMode.bind(e)}function V(){if(document.pictureInPictureElement)try{document.exitPictureInPicture()}catch(e){o.Oig&&console.log("[MV] PictureInPicture Error",e)}}var _=i(73767),U=i(34780),O=i(23174),K=i(32587),J=i(87679);const G=new Map;var j=i(35297);var z=i(62587),H=i(69419);const $=g.cf,q=({media:e,isAvatar:t,origin:i,delay:s})=>{const o=t&&"photo"===e?.mediaType&&!e.isVideo,r=t&&"photo"===e?.mediaType&&e.isVideo,c="document"===e?.mediaType,d="video"===e?.mediaType&&!e.isRound||c&&(0,l.hr)(e),h="photo"===e?.mediaType||c&&(0,l.Ml)(e),u="video"===e?.mediaType&&e.isGif,m=i===a.TQ.SharedMedia,p=i===a.TQ.SearchResult,v=(0,n.Kr)(()=>t=>{if(e)return!o&&!r||t?r&&t?(0,l.Pg)(e):(0,l.VO)(e,t?"full":"preview"):(0,l.mU)(e)},[r,o,e]),A=(0,z.A)(e&&(m||p||c)&&(0,l.VO)(e,"pictogram"),void 0,O.qZ.BlobUrl,s),f=v(),b=(0,z.A)(f,void 0,O.qZ.BlobUrl,s),{mediaData:C,loadProgress:y}=(0,H.A)(v(!0),void 0,e&&(0,l.Cz)(e,"full"),s),S=e&&"blobUrl"in e?e.blobUrl:void 0;let k=!d&&(S||C)||b||A;const w=function(e){const t=(0,n.li)();let i=!1;(0,j.A)(()=>{if(i=!0,t.current=void 0,!e)return;const n=new Image;if(n.src=e,!n.width)return;const s=(0,J.PR)(n);(0,K.A)(s.getContext("2d"),0,0,s.width,s.height,2,2),t.current=s.toDataURL()},[e]);const s=function(e,t=!1,i){const s=(0,n.li)(e?G.get(e):void 0),a=(0,n.li)(),o=(0,D.A)();return a.current&&t&&(clearTimeout(a.current),a.current=void 0),(0,n.vJ)(()=>{if(!e||s.current||t)return;const n=new Image;n.onload=()=>{const t=(0,J.PR)(n);(0,K.A)(t.getContext("2d"),0,0,t.width,t.height,2,2);const i=t.toDataURL();s.current=i,o(),G.size>=1e3&&G.clear(),G.set(e,i)},i?a.current=window.setTimeout(()=>{n.src=e},i):n.src=e},[e,i,o,t]),s.current}(e||void 0,Boolean(t.current));return t.current||!i&&s||e||void 0}(!k&&e&&(0,l.VD)(e));k||i===a.TQ.SearchResult||(k=w),r&&b&&(k=b);const N=S||C||(r||d?void 0:b||A||k),I=e&&(0,l.si)(e),P=Boolean(S),Y=(0,n.Kr)(()=>t?r?g._e:g.cf:c?e.mediaSize||$:h?(0,l.Xn)(e):d?(0,l.NZ)(e):$,[t,c,h,d,r,e]);return{getMediaHash:v,media:e,isVideo:d,isPhoto:h,isGif:u,isDocument:c,bestImageData:k,bestData:N,dimensions:Y,isFromSharedMedia:m,isVideoAvatar:r,isLocal:P,loadProgress:y,mediaSize:I}};var W=i(18276),Q=i(64493),Z=i(40664),X=i(22337),ee=i(1087),te=i(20021);const ie=(0,n.ph)(({isOpen:e,peerId:t,photo:i,onClose:a,onCloseAnimationEnd:o})=>{const{reportProfilePhoto:r}=(0,s.ko)(),[l,c]=(0,n.J0)("spam"),[d,h]=(0,n.J0)(""),u=(0,M.A)(()=>{r({chatId:t,photo:i,reason:l,description:d}),a()}),m=(0,M.A)(e=>{c(e)}),p=(0,M.A)(e=>{h(e.target.value)}),v=(0,T.A)(),g=(0,n.Kr)(()=>[{value:"spam",label:v("lng_report_reason_spam")},{value:"violence",label:v("lng_report_reason_violence")},{value:"pornography",label:v("lng_report_reason_pornography")},{value:"childAbuse",label:v("lng_report_reason_child_abuse")},{value:"copyright",label:v("ReportPeer.ReasonCopyright")},{value:"illegalDrugs",label:"Illegal Drugs"},{value:"personalDetails",label:"Personal Details"},{value:"other",label:v("lng_report_reason_other")}],[v]);if(!t||!i)return;const A=v("ReportPeer.Report");return(0,te.FD)(X.A,{isOpen:e,onClose:a,onEnter:e?u:void 0,onCloseAnimationEnd:o,className:"narrow",title:A,children:[(0,te.Y)(ee.A,{className:"dialog-checkbox-group",name:"report-message",options:g,onChange:m,selected:l}),(0,te.Y)(Z.A,{label:v("lng_report_reason_description"),value:d,onChange:p}),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:u,children:v("lng_report_button")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:a,children:v("Cancel")})]})]})});var ne=i(26607),se=i(41036);const[ae,oe]=(0,R.n5)(1);function re(){return(0,n._W)(()=>{oe(1)}),[ae,oe]}const le=(0,n.ph)(({isOpen:e,photo:t,profileId:i,onClose:a,onConfirm:o})=>{const{deleteProfilePhoto:r,deleteChatPhoto:l}=(0,s.ko)(),c=(0,n.hb)(()=>{o?.(),(0,v.L8)(i)?r({photo:t}):l({photo:t,chatId:i}),a()},[o,i,a,r,t,l]),d=(0,T.A)();return(0,te.Y)(X.A,{isOpen:e,onClose:a,onEnter:c,className:"delete dialog-buttons-column",title:d("AreYouSure"),children:(0,te.FD)("div",{className:"dialog-buttons mt-2",children:[(0,te.Y)(Q.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:c,children:d("Preview.DeletePhoto")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:a,children:d("Cancel")})]})})});var ce=i(22699),de=i(24433),he=i(35913);const ue=(0,n.ph)((0,s.EK)((e,{item:t,canUpdateMedia:i})=>{const n=(0,c.nTw)(e),{origin:s}=n.mediaViewer,a="message"===t?.type?t.message:void 0,o="avatar"===t?.type?t.avatarOwner:void 0,r="avatar"===t?.type&&t.profilePhotos.photos[t.mediaIndex],l=(0,c.meB)(e),d=(0,c.Xf0)(e),{threadId:h}=(0,c.Xf0)(e)||{},u=(0,c.ynf)(e,a),m=(0,c.yuw)(e),p=a&&(0,c.ryq)(e,a?.chatId),{canDelete:v}=h&&a&&(0,c.WAX)(e,a,h)||{},g=r&&r.id===o?.avatarPhotoId,A=i&&Boolean(r),f=v||A,C=i&&Boolean(r)&&!g,y=d?.type;return{activeDownloads:m,isProtected:u,chat:l,isChatProtected:p,canDelete:f,canUpdate:C,messageListType:y,origin:s,viewableMedia:b(e,t)}})(({item:e,mediaData:t,isVideo:i,chat:a,isChatProtected:o,isProtected:r,canReportAvatar:c,canDelete:d,canUpdate:h,messageListType:u,activeDownloads:m,origin:p,viewableMedia:g,onReportAvatar:A,onCloseMediaViewer:f,onBeforeDelete:b,onForward:C})=>{const[y,S,k]=(0,F.A)(!1),[w,N]=re(),{isMobile:I}=(0,Y.Ay)(),{downloadMedia:P,cancelMediaDownload:D,updateProfilePhoto:B,updateChatPhoto:R,openMediaViewer:L,openDeleteMessageModal:x}=(0,s.ko)(),E="message"===e?.type,{media:V}=g||{},_=V&&(0,l.sd)(V),U=V&&(0,l.$r)(m,V),{loadProgress:O}=(0,H.A)(V&&(0,l.VO)(V,"download"),!U,V&&(0,l.Cz)(V,"download")),K=(0,M.A)(()=>{if(V)if(U)D({media:V});else{const t="message"===e?.type?e.message:void 0;P({media:V,originMessage:t})}}),J=(0,M.A)(()=>{const e=w();N((e<0?e:0)-1)}),G=(0,M.A)(()=>{const e=w();N((e>0?e:0)+1)}),j=(0,M.A)(()=>{if("avatar"!==e?.type)return;const{avatarOwner:t,profilePhotos:i,mediaIndex:n}=e,s=i?.photos[n];(0,v.L8)(t.id)?B({photo:s}):R({chatId:t.id,photo:s}),L({origin:p,chatId:t.id,mediaIndex:0,isAvatarView:!0},{forceOnHeavyAnimation:!0})}),z=(0,T.A)(),$=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",className:t?"active":void 0,onClick:e,ariaLabel:"More actions",children:(0,te.Y)(W.A,{name:"more"})}),[]);function q(){return"avatar"===e?.type?(0,te.Y)(le,{isOpen:y,onClose:k,onConfirm:b,profileId:e.avatarOwner.id,photo:e.profilePhotos.photos[e.mediaIndex]}):void 0}const Z=(0,M.A)(()=>{"message"===e?.type&&a?x({chatId:a?.id,messageIds:[e.message.id],isSchedule:"scheduled"===u,onConfirm:b}):S()});if(I){const n=[];if(E&&e.message.isForwardingAllowed&&!e.message.content.action&&!o&&n.push({icon:"forward",onClick:C,children:z("Forward")}),r||(i?n.push({icon:U?"close":"download",onClick:K,children:U?`${Math.round(100*O)}% Downloading...`:"Download"}):n.push({icon:"download",href:t,download:_,children:z("AccActionDownload")})),c&&n.push({icon:"flag",onClick:A,children:z("ReportPeer.Report")}),h&&n.push({icon:"copy-media",onClick:j,children:z("ProfilePhoto.SetMainPhoto")}),d&&n.push({icon:"delete",onClick:Z,children:z("Delete"),destructive:!0}),0===n.length)return;return(0,te.FD)("div",{className:"MediaViewerActions-mobile",children:[(0,te.Y)(ce.A,{trigger:$,positionX:"right",children:n.map(({icon:e,onClick:t,href:i,download:n,children:s,destructive:a})=>(0,te.Y)(de.A,{icon:e,href:i,download:n,onClick:t,destructive:a,children:s},e))}),U&&(0,te.Y)(he.A,{progress:O,size:"s",noCross:!0}),d&&q()]})}return(0,te.FD)("div",{className:"MediaViewerActions",children:[E&&e.message.isForwardingAllowed&&!o&&(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("Forward"),onClick:C,children:(0,te.Y)(W.A,{name:"forward"})}),function(){if(!r&&"standalone"!==e?.type)return"sponsoredMessage"!==e?.type&&(i?(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("AccActionDownload"),onClick:K,children:U?(0,te.Y)(he.A,{progress:O,size:"s",onClick:K}):(0,te.Y)(W.A,{name:"download"})}):(0,te.Y)(Q.A,{href:t,download:_,round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("AccActionDownload"),children:(0,te.Y)(W.A,{name:"download"})}))}(),(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("MediaZoomOut"),onClick:J,children:(0,te.Y)(W.A,{name:"zoom-out"})}),(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("MediaZoomIn"),onClick:G,children:(0,te.Y)(W.A,{name:"zoom-in"})}),c&&(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z(i?"PeerInfo.ReportProfileVideo":"PeerInfo.ReportProfilePhoto"),onClick:A,children:(0,te.Y)(W.A,{name:"flag"})}),h&&(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("ProfilePhoto.SetMainPhoto"),onClick:j,children:(0,te.Y)(W.A,{name:"copy-media"})}),d&&(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("Delete"),onClick:Z,children:(0,te.Y)(W.A,{name:"delete"})}),(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:z("Close"),onClick:f,children:(0,te.Y)(W.A,{name:"close"})}),d&&q()]})}));var me=i(87357),pe=i(50442),ve=i(43336),ge=i(37836),Ae=i(14737),fe=i(16581),be=i(19129),Ce=i(26072),ye=i(15283);function Se(e){const t=(0,n.li)(e());return(0,ye.A)(()=>e.subscribe(()=>{t.current=e()})),t}var ke=i(90423),we=i(39751),Ne=i(83414);const[Ie,Pe]=(0,R.n5)(!1),[Ye,Fe]=(0,R.n5)(!1);function De(){return[(0,Ne.A)(()=>Ie()&&!Ye(),[Ie,Ye]),Pe,Fe]}var Me=i(56494);const[Te,Be]=(0,R.n5)(0);function Re(){return(0,n._W)(()=>{Be(0)}),[Te,Be]}var Le=i(5718),xe=i(672),Ee=i(57474);const Ve=({text:e="",buttonText:t,isForVideo:i,onClick:s,handleSponsoredClick:a,isProtected:o,isForceMobileVersion:r})=>{const[l,c]=(0,n.J0)(!1),{isMobile:d}=(0,Y.Ay)(),[h]=De(),m=(0,be.A)(()=>!!u.TF&&!h(),[h]);(0,n.vJ)(()=>{const e=document.querySelector(".MediaViewerFooter .media-text"),t=()=>{const t=e?e.clientHeight:0;c(t>2*g.$)};t();const i=(0,ge.nF)(t,500,!0);return window.addEventListener("resize",i,!1),()=>{window.removeEventListener("resize",i,!1)}},[]);const p=(0,M.A)(()=>{a()}),v=(0,me.A)("MediaViewerFooter",i&&"is-for-video",m&&"is-hidden",o&&"is-protected",r&&"mobile");return(0,te.FD)("div",{className:v,onClick:function(t){e&&t.stopPropagation()},children:[Boolean(e)&&(0,te.Y)("div",{className:"media-viewer-footer-content",onClick:d?void 0:s,children:(0,te.Y)("p",{className:"media-text custom-scroll allow-selection "+(l?"multiline":""),dir:"auto",children:e})}),Boolean(t)&&(0,te.Y)(Q.A,{className:(0,me.A)("media-viewer-footer-content","media-viewer-button"),size:"default",color:"primary",isRectangular:!0,onClick:p,children:t})]})};var _e=i(15640),Ue=i(84313),Oe=i(71533),Ke=i(50680),Je=i(73622);const[Ge,je]=(0,R.n5)(!1);function ze(){return(0,n._W)(()=>{je(!1)}),[Ge,je]}var He=i(17663),$e=i(14242),qe=i(71429),We=i(82497),Qe=i(41074),Ze=i(4875);const Xe=u.Ni||u.pz,et=u.Ni||u.pz?.3:.25,tt=Xe?40:80,it=200,nt=(0,Qe.Ay)();let st;class at{frames=new Map;currentTime=0;constructor(e,t){this.canvas=t,nt.forEach(({connector:t},i)=>{t.request({name:"video-preview:init",args:[e,tt,i,Qe.bP,this.onFrame.bind(this)]})})}onFrame(e,t){this.frames.set(e,t),e===this.currentTime&&this.render(e)}clearCache(){this.frames.forEach(e=>{e.close()}),this.frames.clear()}render(e){this.currentTime=e;const t=this.frames.get(e);return!!t&&((0,r.RK)(()=>{this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,this.canvas.width,this.canvas.height)}),!0)}destroy(){this.clearCache(),nt.forEach(({connector:e})=>{e.request({name:"video-preview:destroy",args:[]})})}}nt.forEach(({worker:e})=>{e.addEventListener("message",async t=>{const{type:i,messageId:n,params:s}=t.data;if("requestPart"!==i)return;const a=await(0,Ze.px)("downloadMedia",{mediaFormat:O.qZ.Progressive,...s});if(!a)return;const{arrayBuffer:o}=a;e.postMessage({type:"partResponse",messageId:n,result:o},[o])})});var ot=i(63988);const rt="Od9ZSc1U";let lt;const ct=(0,n.ph)(({duration:e,bufferedRanges:t,isReady:i,posterSize:s,playbackRate:a,url:o,isActive:r,isPlaying:l,isPreviewDisabled:c,onSeek:d,onSeekStart:h})=>{const m=(0,n.li)(),[p]=Re(),[v]=ze(),g=(0,ot.aG)(p,250),[A,f]=(0,n.Ul)(g()),[b,y]=(0,n.Ul)(0),[S,k]=(0,n.Ul)(0),w=(0,n.li)(!1),[N,I]=(0,n.J0)(!1),[P,Y]=(0,n.J0)(!1),F=(0,n.li)(),D=(0,n.li)(),T=(0,n.li)(),B=(0,n.li)(),R=(0,n.Kr)(()=>function(e,t){const i=(e=Math.round(e*et))/(t=Math.round(t*et));return e>it&&(e=it,t=Math.round(e/i)),t>it&&(t=it,e=Math.round(t*i)),{width:e,height:t}}(s?.width||0,s?.height||0),[s]),L=(0,M.A)(e=>{e=Math.floor(e),k(e),function(e){st&&st.render(e)}(e)});return(0,n.vJ)(()=>{if(!c&&o&&i)return function(e,t){return st&&st.destroy(),st=new at(e,t),()=>{st?.destroy(),st=void 0}}(o,F.current)},[o,i,c]),(0,n.vJ)(()=>{I(!1)},[r]),(0,n.vJ)(()=>{if(lt&&lt(),lt=void 0,!w.current&&!P){const t=g(),i=e-t;lt=(0,C.Hd)({from:t,to:e,duration:1e3*i/a,onUpdate:f})}},[g,P,f,a,e]),(0,n.vJ)(()=>{l&&!v()||(lt&&lt(),lt=void 0)},[l,A,v]),(0,n.vJ)(()=>{if(l){lt&&lt(),lt=void 0;const t=g(),i=e-t;lt=(0,C.Hd)({from:t,to:e,duration:1e3*i/a,onUpdate:f})}},[l,a,e]),(0,n.Nf)(()=>{if(!T.current)return;const t=(0,ve.LI)(A()/e*100,2);T.current.style.width=`${t}%`},[A,e]),(0,n.Nf)(()=>{D.current&&(D.current.style.left=`${b()}px`)},[b]),(0,n.Nf)(()=>{B.current&&(B.current.innerText=(0,He.QO)(S()))},[S]),(0,n.vJ)(()=>{if(!m.current||!r)return;const t=m.current;let i=t.getBoundingClientRect(),n=0,s=0;const a=n=>{const s=(0,_e.A)(n).x,a=(0,ve.qE)(e*((s-i.left)/i.width),0,e);if(c)return[a,0];i.width||(i=t.getBoundingClientRect());const o=D.current;return[a,(0,ve.qE)(s-i.left-o.clientWidth/2,-4,i.width-o.clientWidth+4)]},o=()=>{lt&&lt(),lt=void 0},l=()=>{o(),w.current=!0,I(!1),Y(!1),f(n),d(n),setTimeout(()=>{w.current=!1},250)},p=(0,pe.wJ)(t,{onCapture:()=>{o(),I(!0),Y(!0),h()},onRelease:l,onClick:l,onDrag:e=>{o(),I(!0),[n,s]=a(e),L(n),y(s),f(n)}});if(u.TF||c)return p;const v=e=>{I(!0),[n,s]=a(e),y(s),L(n)},g=()=>{I(!1)};return t.addEventListener("mousemove",v),t.addEventListener("mouseenter",v),t.addEventListener("mouseleave",g),()=>{p(),t.removeEventListener("mousemove",v),t.removeEventListener("mouseenter",v),t.removeEventListener("mouseleave",g)}},[e,L,r,d,h,y,f,Y,c,a]),(0,te.FD)("div",{className:"ingarEvU",ref:m,children:[!c&&(0,te.FD)(ne.A,{isOpen:!0,isHidden:!N,className:"TqpEWfl3",style:`width: ${R.width}px; height: ${R.height}px`,ref:D,children:[(0,te.Y)("canvas",{className:"fKVz2lln",ref:F}),(0,te.Y)("div",{className:"bGiNvx5D",children:(0,te.Y)("span",{className:"mnkqvOMR",ref:B})})]}),(0,te.Y)("div",{className:rt,children:t.map(({start:e,end:t})=>(0,te.Y)("div",{className:"ANe2DKfp",style:`left: ${100*e}%; right: ${100-100*t}%`},`${e}-${t}`))}),(0,te.Y)("div",{className:rt,children:(0,te.Y)("div",{ref:T,className:(0,me.A)("igaGLblf",P&&"beUP6SqY")})})]})}),dt=e=>{e.stopPropagation()},ht=[.5,1,1.5,2];function ut(e,t){return(0,te.Y)("div",{className:"player-time",children:`${(0,He.QO)(e)} / ${(0,He.QO)(t)}`})}const mt=(0,n.ph)(({url:e,bufferedRanges:t,bufferedProgress:i,duration:s,isReady:a,fileSize:o,isForceMobileVersion:r,isPlaying:l,isFullscreenSupported:c,isFullscreen:d,isBuffered:h,isPreviewDisabled:m,volume:p,isMuted:v,playbackRate:g,posterSize:A,onChangeFullscreen:f,onVolumeClick:b,onVolumeChange:C,onPlaybackRateChange:y,isPictureInPictureSupported:S,onPictureInPictureChange:k,onPlayPause:w,onSeek:N,onSeekingChange:I})=>{const[P,D,B]=(0,F.A)(),[R]=Re(),L=(0,be.A)(()=>Math.trunc(R()),[R]),[x,E]=(0,n.Ul)(!1),V=(0,n.li)(),{isMobile:_}=(0,Y.Ay)(),[U,O]=De(),K=(0,be.A)(U);(0,n.vJ)(()=>{if(u.TF||r){if(K&&l&&!P&&!x())return V.current=window.setTimeout(()=>{O(!1)},3e3),()=>{V.current&&window.clearTimeout(V.current)};V.current&&window.clearTimeout(V.current)}},[l,K,O,P,x,r]),(0,n.Nf)(()=>(K?document.body.classList.add("video-controls-visible"):document.body.classList.remove("video-controls-visible"),()=>{document.body.classList.remove("video-controls-visible")}),[K]),(0,n.vJ)(()=>{K||B()},[B,K]);const J=(0,T.A)(),G=(0,M.A)(e=>{E(!1),N(e),I(!1)}),j=(0,M.A)(()=>{E(!0),I(!0)}),z=(0,n.Kr)(()=>0===p||v?"muted":p<.3?"volume-1":p<.6?"volume-2":"volume-3",[p,v]);return(0,te.FD)("div",{className:(0,me.A)("VideoPlayerControls",r&&"mobile",K&&"active"),onClick:dt,children:[(0,te.Y)(ct,{url:e,duration:s,isReady:a,isPlaying:l,isPreviewDisabled:m,posterSize:A,bufferedRanges:t,playbackRate:g,onSeek:G,onSeekStart:j,isActive:K}),(0,te.FD)("div",{className:"buttons",children:[(0,te.Y)(Q.A,{ariaLabel:J("AccActionPlay"),size:"tiny",ripple:!_,color:"translucent-white",className:"play",round:!0,onClick:w,children:(0,te.Y)(W.A,{name:l?"pause":"play"})}),(0,te.Y)(Q.A,{ariaLabel:"Volume",size:"tiny",color:"translucent-white",className:"volume",round:!0,onClick:b,children:(0,te.Y)(W.A,{name:z})}),!u.pz&&(0,te.Y)(We.A,{bold:!0,className:"volume-slider",value:v?0:100*p,onChange:C}),ut(L,s),!h&&(0,te.Y)("div",{className:"player-file-size",children:`${(0,$e.v7)(J,o*i)} / ${(0,$e.v7)(J,o)}`}),(0,te.Y)("div",{className:"spacer"}),(0,te.Y)(Q.A,{ariaLabel:"Playback rate",size:"tiny",color:"translucent-white",className:"playback-rate",round:!0,onClick:D,children:`${g}x`}),S&&(0,te.Y)(Q.A,{ariaLabel:"Picture in picture",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:k,children:(0,te.Y)(W.A,{name:"pip"})}),c&&(0,te.Y)(Q.A,{ariaLabel:"Fullscreen",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:f,children:(0,te.Y)(W.A,{name:d?"smallscreen":"fullscreen"})})]}),(0,te.Y)(qe.A,{isOpen:P,className:(0,me.A)("playback-rate-menu",!c&&"no-fullscreen",!S&&"no-pip"),positionX:"right",positionY:"bottom",autoClose:!0,onClose:B,children:ht.map(e=>(0,te.Y)(de.A,{disabled:g===e,onClick:()=>y(e),children:`${e}x`}))})]})}),pt=(0,n.ph)(({url:e,isGif:t,posterData:i,posterSize:a,loadProgress:r,fileSize:l,isMediaViewerOpen:c,noPlay:d,volume:h,isMuted:m,playbackRate:p,isForceMobileVersion:v,shouldCloseOnClick:g,isProtected:A,isClickDisabled:f,isPreviewDisabled:b,isSponsoredMessage:C,timestamp:S,handleSponsoredClick:k,onClose:w})=>{const{setMediaViewerVolume:N,setMediaViewerMuted:I,setMediaViewerPlaybackRate:P,setMediaViewerHidden:F}=(0,s.ko)(),D=(0,n.li)(),[T,R]=(0,n.J0)(!u.TF||!u.pz),[L,_,U]=(0,ke.Ay)(D,R),{isMobile:O}=(0,Y.Ay)(),K=D.current?.duration||0,J=t||K<=30,G=(0,M.A)(()=>{u.Nd||F({isHidden:!0})}),j=(0,M.A)(()=>{u.Nd||F({isHidden:!1})}),[z,H,$]=function(e,t,i){const[s,a]=(0,n.J0)(!1),[r,l]=(0,n.J0)(!1);(0,n.Nf)(()=>{if(u.pz&&u._7||!e.current)return;const n=e.current,s=E(n);if((!document.pictureInPictureEnabled||e.current?.disablePictureInPicture)&&void 0===s)return;n.autoPictureInPicture=!0,a(!0);const o=()=>{t(),l(!0),x(!0)},r=()=>{x(!1),l(!1),i()};return n.addEventListener("enterpictureinpicture",o),n.addEventListener("leavepictureinpicture",r),()=>{n.removeEventListener("enterpictureinpicture",o),n.removeEventListener("leavepictureinpicture",r)}},[e,t,i]);const c=(0,n.hb)(()=>{if(!e.current)return;const t=E(e.current);t?t("inline"):V()},[e]),d=(0,n.hb)(()=>{if(!e.current)return;c();const t=e.current,i=(0,B.e)(t),n=E(t);n?n("picture-in-picture"):function(e){if(e.requestPictureInPicture)try{e.requestPictureInPicture()}catch(e){o.Oig&&console.log("[MV] PictureInPicture Error",e)}}(t),i&&(0,B.A)(t)},[e,c]);return s?[s,d,r]:[!1]}(D,G,j),[,q,Z]=De(),[X,ee]=(0,n.Ul)(!1),ie=(0,n.li)({x:0,y:0});(0,n.vJ)(()=>{const e=e=>{ie.current=(0,_e.A)(e)};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}},[]);const ne=(0,M.A)((e,t)=>{const i=D.current?.getBoundingClientRect();i&&(e<=i.left||e>=i.right||t<=i.top||t>=i.bottom)&&(X()||q(!1))}),se=(0,M.A)(()=>{q(!0)}),ae=(0,M.A)(e=>{ne(e.clientX,e.clientY)}),oe=(0,M.A)(e=>{if(ee(e),!e){const{x:e,y:t}=ie.current;ne(e,t)}}),{isReady:re,isBuffered:le,bufferedRanges:ce,bufferingHandlers:de,bufferedProgress:ue}=(0,Oe.A)(),me=(0,Ue.A)(D,void 0,!e),{shouldRender:pe,transitionClassNames:ge}=(0,Ke.A)(!le&&!me,void 0,void 0,"slow"),{shouldRender:Ae,transitionClassNames:fe}=(0,Ke.A)(u.pz&&!T&&!pe&&!me,void 0,void 0,"slow"),[,be]=Re(),[,Ce]=ze();(0,n.vJ)(()=>{Z(pe)},[Z,pe]),(0,n.vJ)(()=>{d||!c||me?D.current.pause():e&&!u.TF&&(0,B.A)(D.current)},[d,c,e,I,me]),(0,n.vJ)(()=>{D.current.volume=h},[h]),(0,n.vJ)(()=>{D.current.playbackRate=p},[p]),(0,n.vJ)(()=>{S&&(D.current.currentTime=S,be(S))},[be,S]);const ye=(0,M.A)(e=>{e.stopPropagation(),T?(D.current.pause(),R(!1)):((0,B.A)(D.current),R(!0))}),Se=(0,M.A)(e=>{C&&(k?.(!0),w(e)),f||(g?w(e):ye(e))});(0,Je.A)(D,de);const we=(0,M.A)(e=>{const t=e.currentTarget;t.readyState>=4&&(Ce(!1),be(t.currentTime)),J||t.currentTime!==t.duration||(be(0),R(!1))}),Ne=(0,M.A)(()=>{J||(be(0),R(!1),q(!0))}),Ie=(0,M.A)(()=>{L&&U?U():!L&&_&&_()}),Pe=(0,M.A)(e=>{D.current.currentTime=e}),Ye=(0,M.A)(e=>{N({volume:e/100})}),Fe=(0,M.A)(()=>{D.current.muted=!D.current.muted,I({isMuted:!m})}),Me=(0,M.A)(e=>{P({playbackRate:e})});(0,n.vJ)(()=>{if(!c)return;const e=e=>{if(!L)return;const t=D.current,i=(0,ve.qE)(t.currentTime+5*e,0,t.duration);Number.isFinite(i)&&(t.currentTime=i)},t=t=>{if(!$)switch(t.key){case" ":case"Enter":t.preventDefault(),ye(t);break;case"Left":case"ArrowLeft":t.preventDefault(),e(-1);break;case"Right":case"ArrowRight":t.preventDefault(),e(1)}};return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}},[ye,c,L,$]);const Te=a&&`width: ${a.width}px; height: ${a.height}px`,Be=`background-image: url(${i})`,Le=!u.TF&&!v;return(0,te.FD)("div",{className:"VideoPlayer",onMouseMove:Le?se:void 0,onMouseLeave:Le?ae:void 0,children:[(0,te.FD)("div",{style:Te,children:[A&&(0,te.Y)("div",{onContextMenu:y.A,onDoubleClick:u.TF?void 0:Ie,onClick:O?void 0:ye,className:"protector"}),(0,te.Y)("video",{ref:D,autoPlay:u.TF,controlsList:"nodownload",playsInline:!0,loop:J,muted:t||m,id:"media-viewer-video",style:Be,onWaiting:()=>Ce(!0),onPlay:()=>R(!0),onEnded:Ne,onClick:O||L?void 0:Se,onDoubleClick:u.TF?void 0:Ie,...de,onPause:e=>{R(!1),de.onPause(e)},onTimeUpdate:we,src:e})]}),Ae&&(0,te.Y)(Q.A,{round:!0,className:`play-button ${fe}`,onClick:ye,children:(0,te.Y)(W.A,{name:"play"})}),pe&&(0,te.FD)("div",{className:["spinner-container",ge].join(" "),children:[!le&&(0,te.Y)("div",{className:"buffering",children:"Buffering..."}),(0,te.Y)(he.A,{size:"xl",progress:le?1:r,onClick:w})]}),!t&&!C&&!me&&(0,te.Y)(mt,{url:e,isPlaying:T,bufferedRanges:ce,bufferedProgress:ue,isBuffered:le,isFullscreenSupported:Boolean(_),isPictureInPictureSupported:z,isFullscreen:L,isPreviewDisabled:b,fileSize:l,duration:K,isReady:re,posterSize:a,isForceMobileVersion:v,onSeek:Pe,onChangeFullscreen:Ie,onPictureInPictureChange:H,onPlayPause:ye,volume:h,playbackRate:p,isMuted:m,onVolumeClick:Fe,onVolumeChange:Ye,onPlaybackRateChange:Me,onSeekingChange:oe})]})}),vt=(0,n.ph)((0,s.EK)((e,{item:t})=>{const{volume:i,isMuted:n,playbackRate:s,isHidden:a,origin:o,timestamp:r,threadId:l}=(0,c.nTw)(e).mediaViewer,d="message"===t.type?t.message:void 0,h="sponsoredMessage"===t.type?t.message:void 0,u=d||h,m=b(e,t),p=d&&(0,Me.me)(e,d,!0);return{origin:o,textMessage:u,isProtected:d&&(0,c.ynf)(e,d),volume:i,isMuted:n,isHidden:a,playbackRate:s,threadId:l,timestamp:r,maxTimestamp:p,viewableMedia:m}})(({item:e,viewableMedia:t,isActive:i,textMessage:n,origin:a,withAnimation:r,isProtected:l,volume:c,playbackRate:d,isMuted:m,isHidden:p,isMoving:v,threadId:f,timestamp:b,maxTimestamp:C,onClose:y,onFooterClick:S,handleSponsoredClick:k})=>{const{updateLastPlaybackTimestamp:w}=(0,s.ko)(),N=(0,T.A)(),I="avatar"===e.type,P="sponsoredMessage"===e.type,{media:F}=t||{},{isVideo:D,isPhoto:B,bestImageData:R,bestData:L,dimensions:x,isGif:E,isLocal:V,isVideoAvatar:_,mediaSize:U,loadProgress:O}=q({media:F,isAvatar:I,origin:a,delay:!!r&&350}),[,K]=De(),[J]=Re(),G=Boolean(F),{isMobile:j}=(0,Y.Ay)(),z=(0,M.A)(()=>{K(!0)}),H=(0,xe.A)(()=>{if(!i||!n||"video"!==F?.mediaType)return;if(F.duration<o.u4b)return;const e="id"in n?n:void 0,t=J();if(!t||!e||e.isInAlbum)return;const s=F.duration-t>1?t:void 0;w({chatId:e.chatId,messageId:e.id,timestamp:s})},[J,i,F,n],1e3);if((0,Le.R)(H,[J]),!F)return;if("avatar"===e.type)return _?(0,te.Y)("div",{className:"MediaViewerContent",children:(0,te.Y)(pt,{url:L,isGif:!0,posterData:R,posterSize:(0,g.sk)(x,!1,!0),loadProgress:O,fileSize:U,isMediaViewerOpen:G&&i,isProtected:l,isPreviewDisabled:!h.G9||V,noPlay:!i,onClose:y,isMuted:!0,shouldCloseOnClick:!0,volume:0,isClickDisabled:v,playbackRate:1,isSponsoredMessage:P,handleSponsoredClick:k},F.id)},F.id):(0,te.Y)("div",{className:"MediaViewerContent",children:gt(L,(0,g.sk)(x,!1),!j&&!l,l)},F.id);const $=n&&(n.content.action?"suggestProfilePhoto"===n.content.action.type?N("Conversation.SuggestedPhotoTitle"):void 0:(0,A.V)({message:n,maxTimestamp:C,threadId:f,forcePlayback:!0,isForMediaViewer:!0})),W=n&&"buttonText"in n?n.buttonText:void 0,Q=Boolean($),Z=(0,g.sk)(x,Q,D),X=j||function(e){return!!e&&e.width<350}(Z);return(0,te.FD)("div",{className:(0,me.A)("MediaViewerContent",Q&&"has-footer"),onMouseMove:X&&!u.TF?z:void 0,children:[B&&gt(L,Z,!j&&!l,l),D&&(i?(0,te.Y)(pt,{url:L,isGif:E,posterData:R,posterSize:Z,loadProgress:O,fileSize:U,isMediaViewerOpen:G&&i,noPlay:!i,isPreviewDisabled:!h.G9||V,onClose:y,isMuted:m,isHidden:p,isForceMobileVersion:X,isProtected:l,volume:c,isClickDisabled:v,playbackRate:d,isSponsoredMessage:P,handleSponsoredClick:k,timestamp:b},F.id):At(R,Z,!j&&!l,l)),$&&(0,te.Y)(Ve,{text:$,buttonText:W,onClick:S,isProtected:l,isForceMobileVersion:X,isForVideo:D&&!E,handleSponsoredClick:k})]})}));function gt(e,t,i,n){return e?(0,te.FD)("div",{style:"position: relative;",children:[n&&(0,te.Y)("div",{onContextMenu:y.A,className:"protector"}),(0,te.Y)("img",{src:e,alt:"",className:(0,me.A)(n&&"is-protected"),style:t?`width: ${t.width}px`:"",draggable:Boolean(i)})]}):(0,te.Y)("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:"",children:(0,te.Y)(Ee.A,{color:"white"})})}function At(e,t,i,n){const s=t&&`width: ${t.width}px; height: ${t.height}px`,a=`background-image: url(${e})`;return e?(0,te.FD)("div",{className:"VideoPlayer",children:[n&&(0,te.Y)("div",{onContextMenu:y.A,className:"protector"}),(0,te.Y)("div",{style:s,children:(0,te.Y)("video",{style:a,className:(0,me.A)(n&&"is-protected"),draggable:Boolean(i)})})]}):(0,te.Y)("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:"",children:(0,te.Y)(Ee.A,{color:"white"})})}const{easeOutCubic:ft,easeOutQuart:bt}=C.qM,Ct=u.TF?40:0,yt=350;let St,kt;var wt=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(wt||{});const Nt=(0,n.ph)(({item:e,isVideo:t,isGif:i,isOpen:s,withAnimation:a,isHidden:o,isLoadingMoreMedia:r,isSynced:l,loadMoreItemsIfNeeded:c,getNextItem:d,selectItem:h,onClose:m,onFooterClick:p,handleSponsoredClick:v})=>{const g=(0,n.li)(),A=(0,n.li)(),f=(0,n.li)(),b=(0,n.li)(),y=(0,n.li)({x:0,y:0,scale:1}),S=(0,n.li)(void 0),k=(0,n.li)(void 0),w=(0,n.li)(!1),[N,I]=(0,n.J0)(!0),[P]=re(),Y=(0,n.li)(P()),F=(0,ke.zk)(),[D,B]=(0,n.J0)(!1),[R,L]=(0,n.Ul)({x:0,y:0,scale:1}),x=Se(R),[E,V]=(0,n.Ul)(e),_=Se(E),U=(0,be.A)(()=>1!==R().scale,[R]),O=(0,be.A)(E),{height:K,width:J,isResizing:G}=(0,we.A)(),[j,z,H]=De(),$=(0,T.A)();(0,Ce.A)({isActive:s,onBack:m,shouldBeReplaced:!0});const q=(0,fe.A)(h,[h],350,!0),W=(0,fe.A)(()=>{S.current=void 0},[],500,!0),Q=(0,fe.A)(e=>I(e),[],800,!0),Z=Boolean(i&&!u.pz),X=u.TF?40:J/10,ee=(0,M.A)(e=>{if(!u.TF)return;const t=K-e.pageY<80;!t&&e.pageX<X||!t&&e.pageX>J-X||z(!j())});(0,Ae.A)(()=>z(!0),yt),(0,n.vJ)(()=>{const{scale:t,x:i,y:n}=x.current;0===i&&0===n&&1===t&&V(e)},[e,V,x]),(0,n.vJ)(()=>{l&&O&&!r&&c(O)},[O,c,l,r]),(0,n.Nf)(()=>{const{x:e,y:t,scale:i}=R();H(1!==i),f.current&&(f.current.style.transform=It(-J+e-Ct)),A.current&&(A.current.style.transform=It(e,t,i)),b.current&&(b.current.style.transform=It(J+e+Ct))},[R,H,J]),(0,n.vJ)(()=>{if(!g.current||void 0===_.current||o||F)return;let e=y.current;const t={x:0,y:0},i={x:0,y:0},n={x:0,y:0};let s,r=Date.now();const l=(0,ge.sg)(()=>{r=Date.now()},500,!1,!0),c=t=>{const i=_.current;if(void 0===i)return!1;const n=d(i,t);if(void 0!==n){const i=(J+Ct)*t,s=x.current.x+i;return I(!1),V(n),q(n),Q(!0),e={x:0,y:0,scale:1},a?(St=(0,C.Hd)({from:s,to:0,duration:yt,timing:ft,onUpdate:e=>L({y:0,x:e,scale:1})}),!0):(L(e),!0)}return!1},h=e=>{const{scale:t}=x.current;if(1!==t)return[!1,!1];if(e.target.closest("div.VideoPlayerControls"))return[!1,!1];let i=0;return K-e.pageY<80?[!1,!1]:(e.pageX<X?i=-1:e.pageX>J-X&&(i=1),[0!==i,c(i)])},p=e=>{const{scale:t}=x.current;if(1===t)switch(e.key){case"Left":case"ArrowLeft":c(-1);break;case"Right":case"ArrowRight":c(1)}},v=({x:e,y:t,scale:i},n=0)=>{const s=k.current;if(!s)return[{x:e,y:t,scale:i},!0,!0];let a=!0,o=!0;const r=(J-J*i)/2,l=(K-K*i)/2,c=Math.max(-s.left*i,r),d=J-s.right*i;a=(0,ve.Bt)(e,d,c),e=(0,ve.qE)(e,d,c);const h=Math.max(-s.top*i+n,l),u=K-s.bottom*i;return o=(0,ve.Bt)(t,u,h),[{x:e,y:t=(0,ve.qE)(t,u,h),scale:i},a,o]},f=s=>{if(w.current)return void(w.current=!1);"mouseup"===s.type&&B(!1);const a=x.current,{y:o,scale:l}=a;let c=a.x;const h=Math.abs(c),u=Math.abs(o);if(W(),Q(!0),l<1)return e={x:0,y:0,scale:1},void(St=(0,C.Hd)({from:[c,o,l],to:[0,0,1],duration:yt,timing:ft,onUpdate:e=>L({x:e[0],y:e[1],scale:e[2]})}));if(l>1){const a=Math.min(l,4),d=a/l;let h=c*d+(i.x-d*i.x),u=o*d+(i.y-d*i.y);const m=.15;if("wheel"!==s.type&&e.scale===l){const e=Math.abs(t.x)/(Date.now()-r),i=Math.abs(t.y)/(Date.now()-r);h-=Math.abs(t.x)*e*m*n.x,u-=Math.abs(t.y)*i*m*n.y}return[e]=v({x:h,y:u,scale:a},60),void(St=(0,C.Hd)({from:[c,o,l],to:[e.x,e.y,e.scale],duration:yt,timing:ft,onUpdate:e=>L({x:e[0],y:e[1],scale:e[2]})}))}if(e={x:c,y:o,scale:l},u>=50)return void m();if(u>0)return void(St=(0,C.Hd)({from:o,to:0,duration:yt,timing:ft,onUpdate:e=>L({x:0,y:e,scale:l})}));const p=c<0?1:-1,g=_.current,A=g&&d(g,c<0?1:-1),f=n.x<0?-1:1;void 0!==A&&h>=50&&p===f&&(c+=(J+Ct)*p,V(A),q(A)),St=(0,C.Hd)({from:c,to:0,duration:yt,timing:ft,onUpdate:e=>L({y:0,x:e,scale:l??1})})},b=(0,pe.wJ)(g.current,{isNotPassive:!0,withNativeDrag:!0,excludedClosestSelector:".MediaViewerFooter, .ZoomControls, .VideoPlayerControls",minZoom:1,maxZoom:4,doubleTapZoom:3,withWheelDrag:!0,onCapture:e=>{if(Yt(e))return;const{x:t,y:i,scale:n}=x.current;if("mousedown"!==e.type||(B(!0),1===n)){if(r=Date.now(),0===t&&0===i&&1===n){if(!A.current)return;if(s=A.current.querySelector("img, video"),!s)return;k.current=s.getBoundingClientRect()}}else e.preventDefault()},onDrag:(i,s,{dragOffsetX:a,dragOffsetY:o},r)=>{if(w.current||Yt(i))return;if(u.pz&&"touchstart"===s.type){const{pageX:e}=s.touches[0];if(e<=pe.h6||e>=J-pe.h6)return}St&&(St(),St=void 0),n.x=t.x-a,n.y=t.y-o,t.x=a,t.y=o;const c=Math.abs(a),d=Math.abs(o),{x:h,y:m,scale:p}=x.current;if(l(),1===p){if("mousemove"!==i.type){if(S.current!==wt.Vertical&&(S.current===wt.Horizontal||Math.abs(h)>pe.no||c/d>pe.fG)){S.current=wt.Horizontal,I(!1);const e=J+Ct,t=(0,ve.qE)(a,-e,e);return L({x:t,y:0,scale:p}),void("wheel"===i.type&&Math.abs(t)>100&&(f(i),w.current=!0))}if(S.current===wt.Vertical||Math.abs(m)>pe.no||d/c>pe.fG){S.current=wt.Vertical;const e=K,t=(0,ve.qE)(o,-e,e);L({x:0,y:t,scale:p}),"wheel"===i.type&&Math.abs(t)>100&&(f(i),w.current=!0)}}}else{const t=e.x+a,n=e.y+o;if(["wheel","mousemove"].includes(i.type)){const[e,i,s]=v({x:t,y:n,scale:p},60);return r&&r(!i,!s),void L(e)}"touches"in i&&1===i.touches.length&&L({x:t,y:n,scale:p})}},onZoom:(t,{zoom:n,zoomFactor:s,initialCenterX:a,initialCenterY:o,dragOffsetX:r,dragOffsetY:l,currentCenterX:c,currentCenterY:d})=>{St&&St(),a=a||J/2,o=o||K/2,c=c||J/2,d=d||K/2;const h=n??(0,ve.qE)(e.scale*s,.5,12),u=h/e.scale,m=Math.abs(Math.min(e.x,0)),p=Math.abs(Math.min(e.y,0));i.x=c,i.y=d;const g=m+a,A=p+o,f=g-u*g,b=A-u*A,[C]=v({x:e.x+f+r,y:e.y+b+l,scale:h});L(C)},onClick(t){B(!1);const[i,n]=h(t);if(i){if(t.preventDefault(),t.stopPropagation(),u.TF)return;n||m()}else 1!==e.scale||u.TF||!Z&&Pt(t.target,".VideoPlayer")||m()},onDoubleClick(t,{centerX:i,centerY:n}){const[s]=h(t);if(s)return t.preventDefault(),void t.stopPropagation();if(!u.TF&&"wheel"!==t.type)return;const{x:a,y:o,scale:r}=x.current;if(1===r){if(0!==a||0!==o)return;e=v({x:i-3*i,y:n-3*n,scale:3})[0]}else e={x:0,y:0,scale:1};St=(0,C.Hd)({from:[a,o,r],to:[e.x,e.y,e.scale],duration:yt,timing:ft,onUpdate:e=>{const t={x:e[0],y:e[1],scale:e[2]};L(t)}})},onRelease:f});return document.addEventListener("keydown",p,!1),()=>{b(),document.removeEventListener("keydown",p,!1)}},[_,W,X,d,F,o,m,q,V,Q,L,Z,x,K,J,a]),(0,n.vJ)(()=>{const e=P(),t=void 0!==Y.current&&Y.current!==e;if(!g.current||!t||o||F)return;Y.current=e;const{scale:i}=x.current,n=e>0?-1:1;let s=100,a=0;i<=.6&&n>0||i>=12&&n<0||(1===i&&n>0&&(s=20),kt&&kt(),kt=(0,C.Hd)({from:n,to:n*s,duration:yt,timing:bt,onUpdate:e=>{if(!g.current)return;const t=(0,ve.LI)(e-a,2);a=e;const i=new WheelEvent("wheel",{deltaY:t,ctrlKey:!0});g.current.dispatchEvent(i)}}))},[P,o,F,x]);const[ie,ne]=(0,n.Kr)(()=>void 0===O?[void 0,void 0]:[d(O,-1),d(O,1)],[O,d]);if(void 0===O)return;const se=void 0!==ie,ae=void 0!==ne,oe=D&&U;return(0,te.FD)("div",{className:"MediaViewerSlides",ref:g,children:[(0,te.Y)("div",{className:"MediaViewerSlide",ref:f,children:se&&!U&&!G&&(0,te.Y)(vt,{withAnimation:a,isMoving:oe,item:ie,onClose:m,onFooterClick:p,handleSponsoredClick:v})}),(0,te.Y)("div",{className:(0,me.A)("MediaViewerSlide","MediaViewerSlide--active",oe&&"MediaViewerSlide--moving"),onClick:ee,ref:A,children:(0,te.Y)(vt,{item:O,withAnimation:a,isActive:N,isMoving:oe,onClose:m,onFooterClick:p,handleSponsoredClick:v})}),(0,te.Y)("div",{className:"MediaViewerSlide",ref:b,children:ae&&!U&&!G&&(0,te.Y)(vt,{withAnimation:a,isMoving:oe,item:ne,onClose:m,onFooterClick:p,handleSponsoredClick:v})}),se&&!U&&!u.TF&&(0,te.Y)("button",{type:"button",className:`navigation prev ${t&&!i&&"inline"}`,"aria-label":$("AccDescrPrevious"),dir:$.isRtl?"rtl":void 0}),ae&&!U&&!u.TF&&(0,te.Y)("button",{type:"button",className:`navigation next ${t&&!i&&"inline"}`,"aria-label":$("Next"),dir:$.isRtl?"rtl":void 0})]})});function It(e=0,t=0,i=1){return`translate3d(${e.toFixed(3)}px, ${t.toFixed(3)}px, 0px) scale(${i.toFixed(3)})`}function Pt(e,t){return!!e&&(!!e.matches(t)||Boolean(e.closest(t)))}function Yt(e){const t=e.target;return!!Pt(t,".VideoPlayerControls")&&(Pt(t,".play, .fullscreen, .volume, .volume-slider, .playback-rate, .playback-rate-menu, .SeekLine")||e.preventDefault(),!0)}var Ft=i(70636),Dt=i(4961),Mt=i(21849);const Tt=(0,s.EK)((e,{item:t})=>{const i="message"===t?.type?t.message:void 0,n=i&&(0,c.Y7C)(e,i);return{owner:"avatar"===t?.type?t.avatarOwner:n}})(({owner:e,item:t})=>{const{closeMediaViewer:i,focusMessage:a,toggleChatInfo:o}=(0,s.ko)(),{isMobile:r}=(0,Y.Ay)(),c=(0,M.A)(()=>{if(i(),"message"!==t?.type)return;const e=t.message;r?setTimeout(()=>{o({force:!1},{forceSyncOnIOs:!0}),a({chatId:e.chatId,messageId:e.id})},350):a({chatId:e.chatId,messageId:e.id})}),d=(0,T.A)(),h=(0,n.Kr)(()=>{if(!t||"standalone"===t.type)return;const e="avatar"===t.type?t.avatarOwner:void 0,i="avatar"===t.type?t.profilePhotos:void 0,n=i?.photos[t.mediaIndex],s=n?.id===i?.fallbackPhoto?.id,a=n?.id===i?.personalPhoto?.id,o="message"===t.type?t.message.date:n?.date;if(!o)return;const r=(0,He.fS)(d,1e3*o,!0),c=i?.count&&i.count+(i?.fallbackPhoto?1:0),h=t.mediaIndex+1+(i?.personalPhoto?-1:0),u=c&&d("Of",[h,c]),m=[];if(n){const t=(0,v.L8)(e.id)?void 0:e,i=t&&(0,l.WX)(t),n=t&&(0,l.YE)(t);m.push(d(a?"lng_mediaview_profile_photo_by_you":s?"lng_mediaview_profile_public_photo":i?"lng_mediaview_channel_photo":n?"lng_mediaview_group_photo":"lng_mediaview_profile_photo"))}return!u||a||s||m.push(u),m.push(r),m.join(" • ")},[t,d]);if(!e)return;const u=(0,Ft.F9)(d,e);return(0,te.FD)("div",{className:"SenderInfo",onClick:c,children:[(0,te.Y)(Mt.A,{size:"medium",peer:e},e.id),(0,te.FD)("div",{className:"meta",children:[(0,te.Y)("div",{className:"title",dir:"auto",children:u&&(0,Dt.A)(u)}),(0,te.Y)("div",{className:"date",dir:"auto",children:h})]})]})}),Bt=250,Rt=(0,n.ph)((0,s.EK)(e=>{const{mediaViewer:t,shouldSkipHistoryAnimations:i}=(0,c.nTw)(e),{chatId:n,threadId:s,messageId:o,origin:r,isHidden:d,withDynamicLoading:h,standaloneMedia:u,mediaIndex:m,isAvatarView:p,isSponsoredMessage:g}=t,A=(0,c.xYJ)(e,"mediaViewerAnimations"),{currentUserId:C,isSynced:y}=e,S=Boolean(n)&&(0,c.nZ4)(e,n);if(p){const t=(0,c.PVB)(e,n);let a=!1;t&&(a=(0,v.L8)(t.id)?t.id===C:(0,l.SJ)(t));const p=(0,c.IVq)(e,n),g=f({avatarOwner:t,standaloneMedia:u,profilePhotos:p,mediaIndex:m}),k=b(e,g);return{profilePhotos:p,avatar:p?.photos[m],avatarOwner:t,isLoadingMoreMedia:p?.isLoading,isChatWithSelf:S,canUpdateMedia:a,withAnimation:A,origin:r,shouldSkipHistoryAnimations:i,isHidden:d,standaloneMedia:u,mediaIndex:m,isSynced:y,currentItem:g,viewableMedia:k,chatId:n,threadId:s,messageId:o,message:void 0,collectedMessageIds:void 0,chatMessages:void 0,sponsoredMessage:void 0,withDynamicLoading:h}}let k,w,N;n&&o&&(k=r&&[a.TQ.ScheduledAlbum,a.TQ.ScheduledInline].includes(r)?(0,c.Jl6)(e,n,o):(0,c.O5q)(e,n,o)),g&&n&&r===a.TQ.SponsoredMessage&&(w=(0,c.v8U)(e,n)),n&&(N=r&&[a.TQ.ScheduledAlbum,a.TQ.ScheduledInline].includes(r)?(0,c.yFI)(e,n):(0,c.zeq)(e,n));let I=!1;const P=r===a.TQ.Inline,Y=r===a.TQ.Album;let F;if(n&&s&&o)if(h&&(P||Y)){const t=(0,c.CuV)(e);I=Boolean(t?.isLoading);const{foundIds:i}=t?.currentSegment||{};F=i}else if(r===a.TQ.SharedMedia){const t=(0,c.BU_)(e),{foundIds:i}=t&&t.resultsByType&&t.resultsByType.media||{};F=i}else(P||Y)&&(F=(0,c.Lzh)(e,n,s,o)||(0,c.gCU)(e,n,s));const D=f({message:k,standaloneMedia:u,mediaIndex:m,sponsoredMessage:w});return{chatId:n,threadId:s,messageId:o,isChatWithSelf:S,origin:r,message:k,chatMessages:N,sponsoredMessage:w,collectedMessageIds:F,withAnimation:A,isHidden:d,shouldSkipHistoryAnimations:i,withDynamicLoading:h,standaloneMedia:u,mediaIndex:m,isLoadingMoreMedia:I,isSynced:y,currentItem:D,viewableMedia:b(e,D),canUpdateMedia:void 0,avatar:void 0,avatarOwner:void 0,profilePhotos:void 0}})(({chatId:e,threadId:t,messageId:i,message:c,collectedMessageIds:f,isChatWithSelf:b,canUpdateMedia:y,origin:B,avatar:R,avatarOwner:x,profilePhotos:E,chatMessages:O,sponsoredMessage:K,standaloneMedia:J,mediaIndex:G,withAnimation:j,isHidden:z,shouldSkipHistoryAnimations:H,withDynamicLoading:$,isLoadingMoreMedia:Z,isSynced:X,currentItem:ee,viewableMedia:ae})=>{const{openMediaViewer:oe,closeMediaViewer:re,openForwardMenu:le,focusMessage:ce,toggleChatInfo:de,searchChatMediaMessages:he,loadMoreProfilePhotos:me,clickSponsored:pe,openUrl:ve}=(0,s.ko)(),ge=Boolean(x||c||J||K),{isMobile:Ae}=(0,Y.Ay)(),{media:fe,isSingle:be}=ae||{},Ce=(0,n.li)(),ye=c?.senderId||x?.id||c?.chatId,Se=(0,_.A)(ye),ke=j?"slideFade":"none",we=Boolean(j&&!H),[Ne,Ie,Pe]=(0,F.A)(),{isVideo:Ye,isPhoto:Fe,bestImageData:De,bestData:Me,dimensions:Te,isGif:Be,isFromSharedMedia:Re}=q({media:fe,isAvatar:Boolean(x),origin:B,delay:we&&Bt}),Le=(()=>{if(b)return!1;if("avatar"!==ee?.type||!x)return!1;const e=ee.profilePhotos;return fe!==e.personalPhoto})(),xe=!z&&ge,Ee=(0,n.Kr)(()=>$?f:(0,l.Wm)(O||{},f||[],Re),[O,f,Re,$]);!ge||Se&&Se===ye&&void 0!==Ce.current||(Ce.current=be?0:i||G);const[Ve]=L;(0,n.vJ)(()=>{if(!ge||Ve())return;(0,p.FD)();const e=(0,U.w4)();return()=>{e(),(0,p.wb)()}},[ge,Ve]),(0,n.vJ)(()=>{xe&&V()},[xe]),(0,n.vJ)(()=>{Ae&&(0,r.RK)(()=>{document.body.classList.toggle("is-media-viewer-open",ge)})},[Ae,ge]);const _e=(0,D.A)();(0,n.vJ)(()=>{const e=window.matchMedia(g.wy);return e.addEventListener("change",_e),()=>{e.removeEventListener("change",_e)}},[_e]);const Ue=(0,_.A)(c),Oe=(0,_.A)(z),Ke=(0,_.A)(B),Je=(0,_.A)(ee),Ge=(0,_.A)(De),je=c?(0,A.V)({message:c,forcePlayback:!0,isForMediaViewer:!0}):void 0,ze=Boolean(je),He=Oe&&Je!==ee;(0,n.vJ)(()=>{we&&ge&&(He||!Je)&&((0,n.VK)(Bt+o.xB5),function(e,t,i,n,s,l,c){const{mediaEl:d}=I(t,l,c);if(!d)return;const{width:h}=w.A.get(),{width:m,height:p}=(0,g.$w)(e,s),{width:v,height:A}=(0,g.ky)(m,p,n.width,n.height),f=(h-v)/2,b=function(e){const t=window.matchMedia(g.wy);let i=4.125;return e&&!u.TF&&(i+=t.matches?.875:2.125),i*g.$}(e)+(p-A)/2;let{top:y,left:S,width:k,height:Y}=d.getBoundingClientRect();if([a.TQ.SharedMedia,a.TQ.Album,a.TQ.ScheduledAlbum,a.TQ.SearchResult].includes(t)){const e=function(e,t,i,n,s,a){if(e===t){const o=Math.max(s,a)*(e/t);n-=(o-s)/2,i-=(o-a)/2,s=o,a=o}else if(e>t){const i=s;n-=((s=a*(e/t))-i)/2}else if(t>e){const n=a;i-=((a=s*(t/e))-n)/2}return{top:i,left:n,width:s,height:a}}(v,A,y,S,k,Y);y=e.top,S=e.left,k=e.width,Y=e.height}const F=S+k/2-(f+v/2),D=y+Y/2-(b+A/2),M=k/v,T=Y/A;(0,r.RK)(()=>{const e=N(i||d);(0,C.ZM)(e,{top:`${b}px`,left:`${f}px`,width:`${v}px`,height:`${A}px`,transform:`translate3d(${F}px, ${D}px, 0) scale(${M}, ${T})`}),P(e,t),document.body.appendChild(e),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{e.style.transform="",function(e){e.firstChild.style.objectFit="default",e.classList.remove("rounded-corners","circle")}(e),setTimeout(()=>{(0,r.RK)(()=>{document.body.contains(e)&&document.body.removeChild(e),document.body.classList.remove("ghost-animating")})},200+o.xB5)})})}(ze,B,De,Te,Ye,c,G)),we&&!ge&&Je&&((0,n.VK)(Bt+o.xB5),function(e,t,i,n){const{container:s,mediaEl:l}=I(e,i,n);if(!l)return;const c=document.getElementById("MediaViewer").querySelector(".MediaViewerSlide--active img, .MediaViewerSlide--active video");if(!c)return;const{top:d,left:h,width:u,height:m}=c.getBoundingClientRect(),{top:p,left:v,width:g,height:A}=l.getBoundingClientRect();let f=p;if(!(0,k.Y)(s)){const{height:e}=w.A.get();f=p<d?-A:e}const b=h+u/2-(v+g/2),y=d+m/2-(f+A/2);let Y=u/g,F=m/A;const D=[a.TQ.Inline,a.TQ.ScheduledInline,a.TQ.Album,a.TQ.ScheduledAlbum].includes(e)&&!function(e){const t=document.querySelector(".Transition_slide-active > .MessageList"),{top:i}=(0,S.A)(e,t);return i>t.scrollTop&&i+e.offsetHeight<t.scrollTop+t.offsetHeight}(l);[a.TQ.SharedMedia,a.TQ.Album,a.TQ.ScheduledAlbum,a.TQ.SearchResult].includes(e)&&(Y>F?Y=F:F>Y&&(F=Y));const M=document.getElementsByClassName("ghost")[0],T=M||N(t||l,e);let B;if(M){const{top:e,left:t,width:i,height:n}=M.getBoundingClientRect();B={transition:"none",top:`${f}px`,left:`${v}px`,transformOrigin:"top left",transform:`translate3d(${t-v}px, ${e-f}px, 0) scale(${i/g}, ${n/A})`,width:`${g}px`,height:`${A}px`}}else B={top:`${f}px`,left:`${v}px`,width:`${g}px`,height:`${A}px`,transform:`translate3d(${b}px, ${y}px, 0) scale(${Y}, ${F})`};(0,r.RK)(()=>{(0,C.ZM)(T,B),M||document.body.appendChild(T),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{M&&(M.style.transition=""),T.style.transform="",D&&(T.style.opacity="0"),P(T,e),setTimeout(()=>{(0,r.RK)(()=>{document.body.contains(T)&&document.body.removeChild(T),document.body.classList.remove("ghost-animating")})},200+o.xB5)})})}(Ke,Ge,Ue,Je?.mediaIndex))},[De,Te,ze,we,ge,Ye,c,B,Ge,Je,Ue,Ke,He,G]);const $e=(0,M.A)(()=>re()),qe=(0,M.A)(n=>{n.target instanceof HTMLElement&&n.target.closest("a")||($e(),e&&i&&(Ae?setTimeout(()=>{de({force:!1},{forceSyncOnIOs:!0}),ce({chatId:e,threadId:t,messageId:i})},Bt):ce({chatId:e,threadId:t,messageId:i})))}),We=(0,M.A)(t=>{K&&e&&(pe({isMedia:t,isFullscreen:!0,randomId:K.randomId}),ve({url:K.url}),re())}),Qe=(0,M.A)(()=>{le({fromChatId:e,messageIds:[i]})});(0,n.vJ)(()=>ge?(0,m.A)(()=>{$e()}):void 0,[$e,ge]),(0,n.vJ)(()=>{Ye&&!Be&&(0,d._K)()},[Be,Ye]);const Ze=(0,M.A)(i=>{if(i&&!Z){if("avatar"===i.type){if(!(i.mediaIndex>=i.profilePhotos.photos.length-4))return;me({peerId:i.avatarOwner.id})}"message"===i.type&&$&&he({chatId:e,threadId:t,currentMediaMessageId:i.message.id})}}),Xe=(0,M.A)((e,t)=>{if(0===t||be)return;if("standalone"===e.type){const{media:i,mediaIndex:n}=e,s=n+t;return s>=0&&s<i.length?{type:"standalone",media:i,mediaIndex:s}:void 0}if("avatar"===e.type){const{avatarOwner:i,profilePhotos:n,mediaIndex:s}=e,a=s+t;return a>=0&&n&&a<n.photos.length?{type:"avatar",avatarOwner:i,profilePhotos:n,mediaIndex:a}:void 0}if("sponsoredMessage"===e.type){const{message:i,mediaIndex:n}=e,s=n+t;return s>=0&&i?{type:"sponsoredMessage",message:i,mediaIndex:s}:void 0}const{message:i,mediaIndex:n}=e,s=(0,l.qG)(i);if(s){const e=n+t;if(e>=0&&e<s.extendedMedia.length)return{type:"message",message:i,mediaIndex:e}}const a=Ee?.indexOf(i.id);if(void 0===a)return;const o=Ee[a+t],r=O?.[o];return r?{type:"message",message:r}:void 0}),et=(0,M.A)(e=>{if(!e)return void $e();const t="avatar"===e.type?e.avatarOwner.id:"message"===e.type?e.message.chatId:void 0,i="message"===e.type?e.message.id:void 0,n="standalone"===e.type?e.media:void 0;oe({origin:B,chatId:t,messageId:i,standaloneMedia:n,mediaIndex:e.mediaIndex,isAvatarView:"avatar"===e.type,withDynamicLoading:$},{forceOnHeavyAnimation:!0})}),tt=(0,M.A)(()=>{if((E?.photos.length||J?.length||Ee?.length||0)<=1||!ee)return void $e();const e=Xe(ee,-1);e?et(e):"avatar"===ee.type&&(0,v.L8)(ee.avatarOwner.id)||"standalone"===ee.type||$e()}),it=(0,T.A)();return(0,te.FD)(ne.A,{id:"MediaViewer",isOpen:ge,isHidden:z,shouldAnimateFirstRender:!0,noCloseTransition:H,children:[(0,te.FD)("div",{className:"media-viewer-head",dir:it.isRtl?"rtl":void 0,"data-tauri-drag-region":!(!h.Vq||!u.MP)||void 0,children:[Ae&&(0,te.Y)(Q.A,{className:"media-viewer-close",round:!0,size:"smaller",color:"translucent-white",ariaLabel:it("Close"),onClick:$e,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)(se.Ay,{activeKey:Ce.current,name:ke,children:(0,te.Y)(Tt,{item:ee},fe?.id)}),(0,te.Y)(ue,{mediaData:Me,isVideo:Ye,item:ee,canUpdateMedia:y,canReportAvatar:Le,onBeforeDelete:tt,onReportAvatar:Ie,onCloseMediaViewer:$e,onForward:Qe}),(0,te.Y)(ie,{isOpen:Ne,onClose:Pe,photo:R,peerId:x?.id})]}),(0,te.Y)(Nt,{item:ee,loadMoreItemsIfNeeded:Ze,isLoadingMoreMedia:Z,isSynced:X,getNextItem:Xe,chatId:e,isPhoto:Fe,isGif:Be,threadId:t,avatarOwnerId:x?.id,origin:B,isOpen:ge,hasFooter:ze,isVideo:Ye,withAnimation:j,onClose:$e,selectItem:et,isHidden:z,onFooterClick:qe,handleSponsoredClick:We})]})})),Lt="CdTfL4f7",xt="kW0xpExG",Et="W9A8SEMl",Vt="gLHHo5k8",_t="GJVwqV9e",Ut="_Yn4SWUB",Ot="hGCH03qc",Kt="ZecqXqKy",Jt="PVZ8TOWS",Gt="Wi0DXPH2",jt="Ka1CGfzq",zt="urTtSsk9",Ht="AjXOHOgE",$t="uAlXNXJN",qt="g8ypsnnC",Wt="hGTnZuar",Qt="TkphaPyQ",Zt="CvnxnCxN",Xt="nZ30pf4g",ei="MnNC7VHS",ti="G8OgmMDJ",ii=3.5*g.$,ni=.5*g.$;function si(e,t=!1,i=!1){const n=document.createElement("div");n.classList.add(i?"TYicp2_K":"fME2l_yv");const s=new Image;if(s.draggable=!1,s.oncontextmenu=y.A,s.classList.add("HjoURJRK"),t){const t=document.createElement("canvas");t.classList.add(ei),s.onload=()=>{const e=t.getContext("2d",{alpha:!1}),{width:i,height:n}=s;(0,r.RK)(()=>{t.width=i,t.height=n,u.QH&&(e.filter="blur(2px)"),e.drawImage(s,-4,-4,i+8,n+8),u.QH||(0,K.A)(e,0,0,i,n,2,2)})},s.src=e,n.appendChild(t)}else s.src=e,n.appendChild(s);return n}function ai(e,t){let i;const n=`#${(0,l.kR)(t)}`;switch(e){case a.G9.StoryRibbon:i=`#LeftColumn .${Lt}`;break;case a.G9.MiddleHeaderAvatar:i=".MiddleHeader .Transition_slide-active .ChatInfo";break;case a.G9.ChatList:i="#LeftColumn .chat-list";break;case a.G9.SearchResult:i="#LeftColumn .LeftSearch--container"}const s=document.querySelector(i),o=s&&s.querySelectorAll(`${n} img`);return{container:s,mediaEl:o?.[0]}}function oi({scale:e,slideAmount:t,isActiveSlideSize:i,isMoveThroughActiveSlide:n,isBackward:s}){const a=40+(i?405:135),o=(Math.abs(t)-1)*(40+(n?405:135)),r=(0,ve.Ki)((a+o)*e);return s?-r:r}function ri(){const{width:e,height:t}=(0,we.A)();return(0,n.Kr)(()=>function(e,t){const i=function(e,t,i,n){const s=i/1200,a=n/800;return Math.min(s,a)}(0,0,e,t),n=(0,ve.Ki)(405*i),s=(0,ve.Ki)(135*i);return{activeSlide:{width:n,height:(0,ve.Ki)(720*i)},slide:{width:s,height:(0,ve.Ki)(240*i)},scale:i,toActiveScale:n/s,fromActiveScale:s/n}}(e,t),[e,t])}function li(e,t=!1,i=!1){const n=e&&"content"in e,s=e&&"isDeleted"in e,a=!!n&&(0,l.XR)(e),o=n&&Boolean(e.forwardInfo);let r;n&&(e.content.photo?.thumbnail&&(r=e.content.photo.thumbnail.dataUri),e.content.video?.thumbnail?.dataUri&&(r=e.content.video.thumbnail.dataUri));const c=n?(0,l.EN)(e):void 0,d=(0,z.A)(c),h=Boolean(n&&e.content.video),u=n&&e.content.video?.noSound,m=n?(0,l.EN)(e,"full"):void 0,p=(0,z.A)(m,!e,h?O.qZ.Progressive:O.qZ.BlobUrl),v=h&&n?(0,l.EN)(e,"full",!0):void 0,g=(0,z.A)(v,!e,O.qZ.Progressive),A=Boolean(p||g),f=h?d:p||d,b=!d&&!A,C=t&&n&&!e.noForwards,y=n?(0,l.EN)(e,"download"):void 0;return{isLoadedStory:n,isDeletedStory:s,hasText:a,hasForwardInfo:o,thumbnail:r,previewHash:c,previewBlobUrl:d,isVideo:h,noSound:u,fullMediaHash:m,fullMediaData:p,altMediaHash:v,altMediaData:g,hasFullData:A,bestImageData:f,hasThumb:b,canDownload:C,downloadMediaData:(0,z.A)(y,!C&&!i)}}var ci=i(80140),di=i(22720),hi=i(61361);const ui="RGD70uBt",mi="HCYfPccW",pi="L8oRQyKb",vi=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e);return{isOpen:t.storyViewer?.isStealthModalOpen,stealthMode:e.stories.stealthMode,isCurrentUserPremium:(0,c.g29)(e)}})(({isOpen:e,stealthMode:t,isCurrentUserPremium:i})=>{const{toggleStealthModal:a,activateStealthMode:o,showNotification:r,openPremiumModal:l}=(0,s.ko)(),[c,d]=(0,n.J0)(!1);(0,n.vJ)(()=>{if(!t)return;const e=(0,ci.Fm)();t.cooldownUntil&&t.cooldownUntil>e&&d(!0)},[t,e]);const h=(0,T.A)(),u=(0,M.A)(()=>{d(!1)}),m=(0,M.A)(()=>{a({isOpen:!1})}),p=(0,M.A)(()=>{i?(o(),r({title:h("StealthModeOn"),message:h("StealthModeOnHint")}),a({isOpen:!1})):l({initialSection:"stories"})});return(0,te.FD)(X.A,{className:"component-theme-dark",contentClassName:"GrE47IXS",isOpen:e,isSlim:!0,onClose:m,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",className:"NlWSF1pA",ariaLabel:h("Close"),onClick:m,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"qKi5jsGM",children:(0,te.Y)(W.A,{name:"eye-crossed-outline"})}),(0,te.Y)("div",{className:"BFctFGoT",children:h("StealthMode")}),(0,te.Y)("div",{className:"fZIJH4IG",children:h(i?"StealthModeHint":"StealthModePremiumHint")}),(0,te.FD)(di.A,{className:(0,me.A)(ui,"smaller-icon"),multiline:!0,inactive:!0,leftElement:(0,te.Y)(W.A,{name:"stealth-past",className:mi}),children:[(0,te.Y)("span",{className:"title",children:h("HideRecentViews")}),(0,te.Y)("span",{className:(0,me.A)("subtitle",pi),children:h("HideRecentViewsDescription")})]}),(0,te.FD)(di.A,{className:(0,me.A)(ui,"smaller-icon"),multiline:!0,inactive:!0,leftElement:(0,te.Y)(W.A,{name:"stealth-future",className:mi,"aria-hidden":!0}),children:[(0,te.Y)("span",{className:"title",children:h("HideNextViews")}),(0,te.Y)("span",{className:(0,me.A)("subtitle",pi),children:h("HideNextViewsDescription")})]}),(0,te.Y)(Q.A,{className:"AM_sxoXP",disabled:c,isShiny:!i,withPremiumGradient:!i,onClick:p,children:i?c?(0,te.Y)(hi.A,{langKey:"AvailableIn",endsAt:t.cooldownUntil,onEnd:u}):h("EnableStealthMode"):h("UnlockStealthMode")})]})}));var gi=i(94189);const Ai=(0,n.ph)(function({isOpen:e,story:t,onClose:i}){const{deleteStory:a,openNextStory:o}=(0,s.ko)(),r=(0,T.A)(),l=(0,n.hb)(()=>{t&&(o(),a({peerId:t.peerId,storyId:t.id}),i())},[i,t]);return(0,te.Y)(gi.A,{isOpen:e,onClose:i,title:r("DeleteStoryTitle"),text:r("DeleteStorySubtitle"),confirmLabel:r("Delete"),confirmHandler:l,confirmIsDestructive:!0,className:"component-theme-dark"})});var fi=i(21309),bi=i(63152),Ci=i(87894),yi=i(79824),Si=i(54960);const ki=(0,n.ph)(function({id:e,contactListIds:t,currentUserId:i,selectedIds:s,lockedIds:a,onSelect:o}){const r=(0,T.A)(),[l,c]=(0,n.J0)(""),d=(0,n.Kr)(()=>{const e=(t||[]).filter(e=>e!==i);return(0,Ci.Am)((0,Ft.PU)({ids:[...s||[],...e],query:l,type:"user"}))},[t,i,l,s]);return(0,te.Y)(Si.A,{itemIds:d,selectedIds:s??yi.p,lockedSelectedIds:a,filterValue:l,filterPlaceholder:r("Search"),searchInputId:`${e}-picker-search`,isSearchable:!0,withDefaultPadding:!0,forceShowSelf:!0,onSelectedIdsChange:o,onFilterChange:c,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"},e)});var wi=i(82117),Ni=i(12933);const Ii=(0,n.ph)(function({isActive:e,contactListIds:t,usersById:i,currentUserId:a,onClose:o}){const{saveCloseFriends:r}=(0,s.ko)(),l=(0,T.A)(),[c,d]=(0,n.J0)(""),[h,u]=(0,n.J0)(!1),[m,p]=(0,n.J0)([]),v=(0,n.Kr)(()=>(t||[]).filter(e=>i[e]?.isCloseFriend),[t,i]),g=(0,n.Kr)(()=>{const e=(t||[]).filter(e=>e!==a);return(0,Ci.Am)((0,Ft.PU)({ids:[...v,...e],query:c,type:"user"}))},[v,t,a,c]);(0,wi.A)(([t])=>{!t&&e&&(u(!1),p(v))},[e,v]);const A=(0,n.hb)(e=>{p(e),u(!0)},[]),f=(0,M.A)(()=>{r({userIds:m}),o()});return(0,te.FD)(te.FK,{children:[(0,te.Y)(Si.A,{itemIds:g||[],selectedIds:m,filterValue:c,filterPlaceholder:l("Search"),searchInputId:"close-friends-picker-search",isSearchable:!0,withDefaultPadding:!0,onSelectedIdsChange:A,onFilterChange:d,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,te.Y)("div",{className:(0,me.A)("BDK_pgpt",h&&"N8ujSwlC"),children:(0,te.Y)(Ni.A,{isShown:h,onClick:f,ariaLabel:l("Save"),children:(0,te.Y)(W.A,{name:"check"})})})]})}),Pi={modal:"hz7SomkK",header:"NV6Rt2g9",closeButton:"SN1GFS6L",headerTitle:"gi0Y6Ns6",content:"sTaVDkiD",section:"eUiuPoEC",title:"iPPiw9DI",list:"OUP1Ss0W",option:"JL33Sa3b",checked:"qVPo_cVL",input:"zsDaUk0i",icon:"AfYCVlys",action:"njMeBBwY",optionContent:"TUAAnG2w",footer:"r24Qz2bf",info:"ljeRVBOm",submit:"RwNLN_rH"},Yi=[{name:"StoryPrivacyOptionEveryone",value:"everybody",color:["#50ABFF","#007AFF"],icon:"channel-filled",actions:"blockUserIds"},{name:"StoryPrivacyOptionContacts",value:"contacts",color:["#C36EFF","#8B60FA"],icon:"user-filled",actions:"blockContactUserIds"},{name:"StoryPrivacyOptionCloseFriends",value:"closeFriends",color:["#88D93A","#30B73B"],icon:"favorite-filled",actions:"closeFriends"},{name:"StoryPrivacyOptionSelectedContacts",value:"nobody",color:["#FFB743","#F69A36"],icon:"group-filled",actions:"allowUserIds"}];var Fi=function(e){return e[e.privacy=0]="privacy",e[e.allowList=1]="allowList",e[e.closeFriends=2]="closeFriends",e[e.denyList=3]="denyList",e}(Fi||{});const Di=(0,n.ph)((0,s.EK)(e=>{const{storyViewer:{storyId:t,peerId:i}}=(0,c.nTw)(e),n=i&&t?(0,c.Msb)(e,i,t):void 0;return{story:n&&"content"in n?n:void 0,visibility:n&&"visibility"in n?n.visibility:void 0,contactListIds:e.contactList?.userIds,usersById:e.users.byId,currentUserId:e.currentUserId}})(function({isOpen:e,story:t,visibility:i,contactListIds:a,usersById:o,currentUserId:r,onClose:c}){const{editStoryPrivacy:d,toggleStoryInProfile:h}=(0,s.ko)(),u=(0,T.A)(),[m,p,v]=(0,F.A)(!1),[g,A]=(0,n.J0)(i),[f,b]=(0,n.J0)(t?.isInProfile),[C,S]=(0,n.J0)(Fi.privacy),[k,w]=(0,n.J0)("everybody"),N=C!==Fi.privacy,I=(0,n.Kr)(()=>(a||[]).filter(e=>o[e]?.isCloseFriend),[a,o]),P=(0,n.Kr)(()=>{if(C===Fi.allowList&&(!g?.allowUserIds?.length||g.allowUserIds[0]===r))return[r]},[C,r,g?.allowUserIds]),Y=(0,n.Kr)(()=>k!==g?.visibility?[]:g?.blockUserIds||[],[k,g?.blockUserIds,g?.visibility]),D=(0,M.A)(e=>{A({...g,allowUserIds:e?.length?e?.filter(e=>e!==r):[r]})}),B=(0,M.A)(e=>{A({...g,blockUserIds:e,visibility:k})});(0,n.vJ)(()=>{e&&(S(Fi.privacy),p())},[e]),(0,n.vJ)(()=>{A(i)},[i]);const R=(0,M.A)(()=>{C!==Fi.privacy?S(Fi.privacy):v()}),L=(0,M.A)(()=>{b(!f)}),x=(0,M.A)(()=>{d({peerId:t.peerId,storyId:t.id,privacy:g}),t.isInProfile!==f&&h({peerId:t.peerId,storyId:t.id,isInProfile:f}),v()});return(0,te.FD)(X.A,{isOpen:m,className:(0,me.A)(Pi.modal,"component-theme-dark"),onClose:v,noBackdrop:!0,onCloseAnimationEnd:c,children:[(0,te.FD)("div",{className:Pi.header,children:[(0,te.Y)(Q.A,{className:(0,me.A)(Pi.closeButton,"close-button"),round:!0,color:"translucent",size:"smaller",onClick:R,ariaLabel:u(N?"Common.Back":"Common.Close"),children:(0,te.Y)("div",{className:(0,me.A)("animated-close-icon",N&&"state-back")})}),(0,te.Y)(se.Ay,{name:"slideFade",activeKey:C,children:function(){switch(C){case Fi.privacy:return(0,te.Y)("h3",{className:Pi.headerTitle,children:u("StoryPrivacyAlertEditTitle")});case Fi.allowList:return(0,te.Y)("h3",{className:Pi.headerTitle,children:u("StoryPrivacyAlertSelectContactsTitle")});case Fi.closeFriends:return(0,te.Y)("h3",{className:Pi.headerTitle,children:u("CloseFriends")});case Fi.denyList:return(0,te.Y)("h3",{className:Pi.headerTitle,children:u("StoryPrivacyAlertExcludedContactsTitle")})}}()})]}),(0,te.Y)(se.Ay,{activeKey:C,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",className:Pi.content,children:function(e){switch(C){case Fi.privacy:return function(){const e=t?(0,fi.qZ)(t.expireDate-t.date):0;return(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:Pi.section,children:[(0,te.Y)("h3",{className:Pi.title,children:u("StoryPrivacyAlertSubtitleProfile")}),(0,te.Y)("div",{className:Pi.list,children:Yi.map(e=>{return(0,te.FD)("label",{className:(0,me.A)(Pi.option,e.value===g?.visibility&&Pi.checked),children:[(0,te.Y)("input",{type:"radio",name:"story_privacy",className:Pi.input,value:e.value,checked:e.value===g?.visibility,onChange:()=>{return t=e.value,void A({...g,visibility:t});var t},teactExperimentControlled:!0}),(0,te.Y)("span",{className:Pi.icon,style:`--color-from: ${e.color[0]}; --color-to: ${e.color[1]}`,children:(0,te.Y)(W.A,{name:e.icon})}),(0,te.FD)("div",{className:Pi.optionContent,children:[(0,te.Y)("span",{className:(0,me.A)(Pi.option_name),children:u(e.name)}),e.actions&&(0,te.FD)("div",{tabIndex:0,role:"button",className:Pi.action,"aria-label":u("Edit"),onClick:t=>{!function(e,t){switch((0,y.A)(e),t){case"closeFriends":S(Fi.closeFriends);break;case"allowUserIds":S(Fi.allowList);break;case"blockUserIds":S(Fi.denyList),w("everybody");break;case"blockContactUserIds":S(Fi.denyList),w("contacts")}}(t,e.actions)},children:[(0,te.Y)("span",{className:Pi.actionInner,children:(t=e.actions,"closeFriends"===t?0===I.length?u("StoryPrivacyOptionCloseFriendsDetail"):1===I.length?(0,Ft.F9)(u,o[I[0]]):u("StoryPrivacyOptionPeople",I.length,"i"):"blockUserIds"===t&&"everybody"===g?.visibility||"blockContactUserIds"===t&&"contacts"===g?.visibility?g?.blockUserIds?.length?1===g.blockUserIds.length?u("StoryPrivacyOptionExcludePerson",(0,l.Yg)(o[g.blockUserIds[0]])):u("StoryPrivacyOptionExcludePeople",g.blockUserIds.length,"i"):u("StoryPrivacyOptionContactsDetail"):g?.allowUserIds&&0!==g.allowUserIds.length?1===g.allowUserIds.length?(0,l.Yg)(o[g.allowUserIds[0]]):u("StoryPrivacyOptionPeople",g.allowUserIds.length,"i"):u("StoryPrivacyOptionSelectedContactsDetail"))}),(0,te.Y)(W.A,{name:"next"})]})]})]},e.value);var t})})]}),(0,te.Y)("div",{className:Pi.section,children:(0,te.FD)(di.A,{ripple:!0,onClick:L,children:[(0,te.Y)("span",{children:u("StoryKeep")}),(0,te.Y)(bi.A,{id:"group-notifications",label:u("StoryKeep"),checked:f,inactive:!0})]})}),(0,te.FD)("div",{className:Pi.footer,children:[(0,te.Y)("div",{className:Pi.info,children:u("StoryKeepInfo",e)}),(0,te.Y)("div",{className:Pi.submit,children:(0,te.Y)(Q.A,{onClick:x,children:u("StoryPrivacyButtonSave")})})]})]})}();case Fi.closeFriends:return(0,te.Y)(Ii,{isActive:e,contactListIds:a,currentUserId:r,usersById:o,onClose:R},"close-friends");case Fi.denyList:return(0,te.Y)(ki,{id:"deny-list",contactListIds:a,currentUserId:r,selectedIds:Y,onSelect:B},"deny-list");case Fi.allowList:return(0,te.Y)(ki,{id:"allow-list",contactListIds:a,lockedIds:P,currentUserId:r,selectedIds:g?.allowUserIds,onSelect:D},"allow-list")}}})]})}));var Mi=i(95807),Ti=i(36353),Bi=i(73104),Ri=i(14),Li=i(52674),xi=i(95362),Ei=i(48775);const Vi="video/mp4; codecs=hvc1.1.6.L63.00";var _i=i(45470),Ui=i(39351),Oi=i(38218),Ki=i(83057),Ji=i(39761);const Gi=new Map,ji=new Map,zi=new Map;async function*Hi(e,t=0,i=262144){const n=e.match(/fileSize=(\d+)/);let s;for(s=n?n&&Number(n[1]):ji.get(e);;){if(s&&t>=s)return;let n=t+i-1;s&&n>s&&(n=s-1);const a=`${e}:${t}-${n}`;let o=Gi.get(a);if(!o){let i=zi.get(a);i||(i=(0,Ze.px)("downloadMedia",{mediaFormat:O.qZ.Progressive,url:e,start:t,end:n}),zi.set(a,i));const r=await i.finally(()=>{zi.delete(a)});if(!r?.arrayBuffer)return;r.fullSize&&!s&&(s=r.fullSize,ji.set(e,r.fullSize)),o=r.arrayBuffer,n<=5242879&&Gi.set(a,r.arrayBuffer)}yield o,t=n+1}}function $i(e){return!(!u.Yw||!e)&&Boolean(Qi()?.isTypeSupported(e))}function qi(e,t){try{e.appendBuffer(t)}catch(e){o.Oig&&console.warn("[Stream] failed to append buffer",e)}}function Wi(e){try{e.endOfStream()}catch(e){o.Oig&&console.warn("[Stream] failed to end stream",e)}}function Qi(){return"ManagedMediaSource"in window?ManagedMediaSource:"MediaSource"in window?MediaSource:void 0}var Zi=i(61157),Xi=i(58554);const en={},tn=(0,ge.v7)(1e3),nn=function(e,t){(0,n.vJ)(()=>{if(void 0===e)return;(Array.isArray(e)?e:[e]).forEach(e=>{const i=t||(0,s.mS)().stories.byPeerId[e]?.orderedIds?.[0];i&&(async e=>{await tn,e.forEach(({hash:e,format:t,isStream:i})=>{i?async function(e){const t=Hi((0,Xi.RB)(e));let i=0;for await(const e of t)if(i+=e.byteLength,i>=2097152)break}(e):Xi.hd(e,t).then(e=>{e&&(t===O.qZ.Progressive&&function(e){const t=document.head,i=document.createElement("video");i.preload="auto",i.src=e,i.muted=!0,i.autoplay=!0,i.disableRemotePlayback=!0,i.style.display="none",t.appendChild(i),i.load(),setTimeout(()=>{(0,Ji.A)(i),t.removeChild(i)},1e3)}(e),t===O.qZ.BlobUrl&&(0,J.NN)(e))})})})(function(e,t){const i=(0,c._bp)((0,s.mS)(),e);if(!i||!i.orderedIds?.length)return[];const n=function(e,t){const i=e.indexOf(t),n=Math.max(i-5,0),s=Math.min(i+5,e.length);return e.slice(n,s)}(i.orderedIds,t),a=[];return n.forEach(t=>{if(en[e]?.has(t))return;const n=i.byId[t];if(!n||!("content"in n))return;const s=Boolean(n.content.video);a.push({hash:(0,l.EN)(n,"full"),format:s?O.qZ.Progressive:O.qZ.BlobUrl,isStream:s&&$i(Vi)}),a.push({hash:(0,l.EN)(n),format:O.qZ.BlobUrl}),n.content.altVideos&&a.push({hash:(0,l.EN)(n,"full",!0),format:O.qZ.Progressive}),en[e]=(en[e]||new Set).add(t)}),a}(e,i))})},[t,e])};var sn=i(22081),an=i(65843),on=i(55158),rn=i(59816),ln=i(61433),cn=i(91800),dn=i(23565),hn=i(35049),un=i(18501),mn=i(11217),pn=i(86070),vn=i(39877);const gn=(0,n.ph)((0,s.EK)((e,{forwardInfo:t})=>({sender:t.fromPeerId?(0,c.PVB)(e,t.fromPeerId):void 0,story:t.storyId&&t.fromPeerId?(0,c.Msb)(e,t.fromPeerId,t.storyId):void 0}))(({className:e,forwardInfo:t,sender:i,story:a})=>{const{openStoryViewer:o,loadPeerStoriesByIds:r,openChat:l}=(0,s.ko)(),c=(0,n.li)(),d=(0,T.A)();(0,n.vJ)(()=>{!a&&t.fromPeerId&&t.storyId&&r({peerId:t.fromPeerId,storyIds:[t.storyId]})},[t,a]);const h=i?(0,Ft.F9)(d,i):t.fromName,u=(0,M.A)(()=>{const{fromPeerId:e,storyId:i}=t;e&&(!a||"isDeleted"in a&&a.isDeleted?l({id:e}):o({peerId:e,storyId:i,isSingleStory:!0}))}),{handleClick:m,handleMouseDown:p}=(0,mn.Q)(u);return(0,te.FD)(pn.A,{ref:c,className:(0,me.A)("EmbeddedMessage",e,(0,hn.y)(i,!0,!0)),dir:d.isRtl?"rtl":void 0,onClick:m,onMouseDown:p,children:[i?.color?.backgroundEmojiId&&(0,te.Y)(vn.A,{emojiDocumentId:i.color.backgroundEmojiId,className:"EmbeddedMessage--background-icons"}),(0,te.FD)("div",{className:"message-text",children:[function(){if(a&&"content"in a&&a.content.text)return(0,te.Y)("p",{className:"embedded-text-wrapper",children:(0,un.fd)(a.content.text)})}(),(0,te.Y)("div",{className:"message-title",children:function(){if(!i||!h)return;const e=(0,v.L8)(i.id)?"user-filled":"channel-filled";return(0,te.FD)(te.FK,{children:[e&&(0,te.Y)(W.A,{name:e,className:"embedded-chat-icon"}),h&&(0,Dt.A)(h)]})}()})]})]})}));var An=i(74936);const fn=(0,n.ph)(function({story:e,isExpanded:t,className:i,onExpand:s,onFold:a}){const o=(0,T.A)(),l=(0,n.li)(),c=(0,n.li)(),d=(0,n.li)(),h=(0,n.li)(),u=(0,Ri.A)(e,!0),m=u?.content.text,[p,v]=(0,n.J0)(!1),g=(0,dn.A)(t||void 0,400),A=t||g;(0,n.vJ)(()=>{(0,r.RK)(()=>{c.current&&(t?(0,ln.YM)(c.current,Zt):(0,ln.HW)(c.current,Zt))})},[t]);const f=p&&!A,{shouldRender:b,transitionClassNames:C}=(0,Ke.A)(f,void 0,!0,"slow",!0);(0,n.Nf)(()=>{(0,r.YS)(()=>{const e=c.current,t=h.current;if(!e||!t)return;const{offsetWidth:i}=t;(0,r.RK)(()=>{e.style.setProperty("--expand-button-width",`${i}px`)})})},[b,o]),(0,n.Nf)(()=>{(0,r.gm)(()=>{if(!c.current||!d.current)return;const e=c.current,t=d.current,i=t.offsetTop,{lineHeight:n,totalLines:s}=(0,cn.A)(t),a=s>3,o=i+3*n;return()=>{a&&((0,ln.YM)(e,"e1gyTmKe"),v(!0)),e.style.setProperty("--_overflow-shift",`${o}px`)}})},[m]),(0,n.vJ)(()=>{t||l.current?.scrollTo({top:0})},[t]);const y=(0,me.A)("ilyTRZtw",A&&"HIMnUViv",b&&"Vq8pl_kQ");return(0,te.FD)("div",{className:(0,me.A)("RKedwa0I",i),children:[(0,te.Y)("div",{ref:c,className:y,role:f?"button":void 0,onClick:f?s:a,children:(0,te.FD)("div",{ref:l,className:(0,me.A)("D_5mWNmi","allow-selection","custom-scroll"),children:[u?.forwardInfo&&(0,te.Y)(gn,{forwardInfo:u.forwardInfo,className:"_M8CgT7s"}),u&&m&&(0,te.Y)("div",{ref:d,className:"hmFA5qb1",children:(0,te.Y)(An.A,{messageOrStory:u,withTranslucentThumbs:!0,forcePlayback:!0})})]})}),b&&(0,te.Y)("div",{ref:h,className:(0,me.A)("bM5rlQtM",C),onClick:s,children:o("Story.CaptionShowMore")})]})});var bn=i(26875),Cn=i(11241);const yn="YVD19vOP",Sn="vJRk_UUk",kn="nIv3YAnZ",wn=(0,n.ph)(({story:e,className:t})=>{const{openStoryViewModal:i,openForwardMenu:a,sendStoryReaction:r}=(0,s.ko)(),c=(0,T.A)(),{views:d,isOut:h,peerId:u,id:m,sentReaction:p}=e,{viewsCount:g,forwardsCount:A,reactionsCount:f}=d||{},b=!(0,v.L8)(u),C=p&&(0,l.a0)(p,o.tNZ),y=Boolean((h||b)&&e.isPublic&&!e.noForwards),S=(0,l.$_)(u,m),k=(0,n.Kr)(()=>{const{users:{byId:e}}=(0,s.mS)(),t=d&&"recentViewerIds"in d?d.recentViewerIds:void 0;if(t)return t.map(t=>e[t]).filter(Boolean)},[d]),w=(0,M.A)(()=>{i({storyId:m})}),N=(0,M.A)(()=>{a({fromChatId:u,storyId:m})}),I=(0,M.A)(()=>{const e=p?void 0:o.tNZ;r({peerId:u,storyId:m,containerId:S,reaction:e})});return g?(0,te.FD)("div",{className:(0,me.A)(yn,t),children:[(0,te.FD)("div",{className:(0,me.A)("cknL5COh",!b&&"pJAyeGkG"),onClick:b?void 0:w,children:[Boolean(k?.length)&&(0,te.Y)(bn.A,{size:"small",peers:k,className:"Vz_VtJ16"}),b?(0,te.FD)("span",{className:kn,children:[(0,te.Y)(W.A,{name:"channelviews",className:"WyBiNM6e"}),g]}):(0,te.Y)("span",{className:kn,children:c("Views",g,"i")}),Boolean(f)&&!b&&(0,te.FD)("span",{className:"sf3u_6Vh",children:[(0,te.Y)(W.A,{name:"heart",className:"Er2XKRqi"}),f]})]}),(0,te.Y)("div",{className:"kKoeDk3Z"}),y&&(0,te.Y)(Q.A,{color:"translucent",size:"smaller",round:!0,onClick:N,ariaLabel:c("Forward"),className:Sn,children:(0,te.Y)(W.A,{name:"forward"})}),b&&(0,te.FD)(te.FK,{children:[Boolean(A)&&(0,te.FD)("div",{className:Sn,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",nonInteractive:!0,ariaLabel:c("PublicShares"),children:(0,te.Y)(W.A,{name:"loop"})}),(0,te.Y)("span",{children:A})]}),(0,te.FD)("div",{className:Sn,children:[(0,te.FD)(Q.A,{round:!0,className:"lpDXVIuf",color:"translucent",size:"smaller",onClick:I,ariaLabel:c("AccDescrLike"),children:[p&&(0,te.Y)(Cn.A,{containerId:S,reaction:p,withEffectOnly:C},(0,l.Jj)(p)),(!p||C)&&(0,te.Y)(W.A,{name:C?"heart":"heart-outline",className:(0,me.A)(C&&"twgMDT1y")})]}),Boolean(f)&&(0,te.Y)("span",{children:f})]})]})]}):(0,te.Y)("div",{className:(0,me.A)(yn,t),children:c("NobodyViewed")})}),Nn=(0,n.ph)(function({isActive:e,isViewed:t,isVideo:i,duration:n=6,isPaused:s,onImageComplete:a}){const o=(0,M.A)(e=>{i||"XY98E7VM"!==e.animationName||a()}),r=(0,me.A)("c1fbGgcx",t&&"xwOKghO2",e&&"ZuByYcIx",s&&"n9V6B7hP");return(0,te.Y)("span",{className:r,"aria-hidden":!0,children:e&&(0,te.Y)("i",{style:`--progress-duration: ${n}s`,className:"qyBCpJct",onAnimationEnd:o})})}),In=u.Yw?4:3,Pn=(0,n.ph)((0,s.EK)((e,{peerId:t,storyId:i,isDeleteModalOpen:n})=>{const{appConfig:s}=e,a=(0,c.mBe)(e,t),o=(0,c.hds)(e,t),r=(0,c.vGo)(e,t),l=(0,c.nTw)(e),{storyViewer:{isMuted:d,viewModal:h,isPrivacyModalOpen:u,isStealthModalOpen:m,storyList:p},forwardMessages:{storyId:v},premiumModal:g,safeLinkModalUrl:A,mapModal:f,reportModal:b,giftInfoModal:C,isPaymentMessageConfirmDialogOpen:y}=l,{isOpen:S}=g||{},k=(0,c.Msb)(e,t,i),w=k&&"content"in k,N=Boolean(y||h||v||l.reactionPicker?.storyId||b||u||S||n||A||m||f||C),I=w?k.forwardInfo:void 0,P=w?k.mediaAreas:void 0,Y=I?.fromPeerId||P?.find(e=>"channelPost"===e.type)?.channelId,F=Y?(0,c.PVB)(e,Y):void 0,D=(0,c.xYJ)(e,"mediaViewerAnimations"),M=w&&k.fromId?(0,c.PVB)(e,k.fromId):void 0,T=(0,c.WA9)(e,t),B=(0,c.trm)(e);return{peer:a||o,forwardSender:F,fromPeer:M,story:k,orderedIds:p?.storyIdsByPeerId[t],isMuted:d,isCurrentUserPremium:(0,c.g29)(e),shouldForcePause:N,storyChangelogUserId:s.storyChangelogUserId,viewersExpirePeriod:s.storyViewersExpirePeriod,isChatExist:Boolean(o),arePeerSettingsLoaded:Boolean(r?.settings),stealthMode:e.stories.stealthMode,withHeaderAnimation:D,paidMessagesStars:T,isAccountFrozen:B}})(function({peerId:e,storyId:t,peer:i,forwardSender:a,fromPeer:c,isMuted:d,isArchivedStories:h,isPrivateStories:m,story:p,orderedIds:g,isSingleStory:A,dimensions:f,shouldForcePause:b,storyChangelogUserId:y,viewersExpirePeriod:S,isChatExist:k,arePeerSettingsLoaded:w,getIsAnimating:N,isCurrentUserPremium:I,stealthMode:P,withHeaderAnimation:D,onDelete:B,onClose:R,onReport:L,paidMessagesStars:x,isAccountFrozen:E}){const{viewStory:V,setStoryViewerMuted:_,openPreviousStory:U,openNextStory:K,loadPeerSkippedStories:J,openForwardMenu:G,copyStoryLink:j,toggleStoryInProfile:z,openChat:H,showNotification:$,openStoryPrivacyEditor:q,loadPeerSettings:Z,fetchChat:X,loadStoryViews:ee,toggleStealthModal:ie}=(0,s.ko)(),ne=(0,ci.Fm)(),ae=(0,T.A)(),oe=(0,Ui.A)(),{isMobile:re}=(0,Y.Ay)(),[le,he,ue]=(0,F.A)(!1),[pe,ge,Ae]=(0,F.A)(!1),[fe,be,Ce]=(0,F.A)(!1),[ye,Se,ke]=(0,F.A)(!0),[we,Ne,Ie]=(0,F.A)(!1),[Pe,Ye]=(0,n.J0)(!1),[Fe,De,Me]=(0,F.A)(!1),[Te,Be,Re]=(0,F.A)(!1),Le=(0,n.li)(),{isDeletedStory:xe,hasText:Ee,hasForwardInfo:Ve,thumbnail:_e,previewBlobUrl:Oe,isVideo:Je,noSound:Ge,fullMediaData:je,altMediaHash:ze,altMediaData:$e,hasFullData:qe,hasThumb:We,canDownload:Qe,downloadMediaData:Ze}=li(p,I,Te),Xe=p&&"content"in p,et=e===y,tt=(0,v.L8)(e),it=!tt,nt=it&&(0,l.WX)(i),st=Xe&&p.isOut,at=(0,Ri.A)(st?!p.isInProfile:void 0,!0),ot=(0,Ri.A)(st?p.isInProfile:void 0,!0),rt=Boolean(st&&p.date+S<(0,ci.Fm)()),lt=a?(0,Ft.F9)(ae,a):Xe&&p.forwardInfo?.fromName,ct=Boolean(Xe&&p.isPublic&&!et&&i?.hasUsername),dt=Boolean(Xe&&p.isPublic&&!p.noForwards&&!et&&!we),ht=Boolean(qe&&!b&&ye&&!le&&!we&&!Pe&&!Fe),ut=Xe&&p.content.video?.duration?p.content.video.duration:void 0,mt=!(st&&tt||et||nt||E),pt=Xe&&!mt&&(st||nt),vt=re&&D?"slideFade":"none",{shouldRender:gt,transitionClassNames:At}=(0,Ke.A)(!qe),{transitionClassNames:ft}=(0,Ke.A)(Boolean(je)),bt=(0,_i.A)(_e,!We),Ct=(0,Ki.A)(Oe),{shouldRender:yt,transitionClassNames:St}=(0,Ke.A)(mt),{shouldRender:kt,transitionClassNames:wt}=(0,Ke.A)(Ee&&we),{transitionClassNames:Nt}=(0,Ke.A)(!0),{shouldRender:It,transitionClassNames:Pt}=(0,Ke.A)(Ee||Ve),Yt=function(e,t,i){return(0,n.vJ)(()=>{if(!t||!e.current)return;const n=Qi(),s=e.current;if(!u.Yw||!i||!n?.isTypeSupported(i))return;const a=new n;function o(){if(!t||!i)return;const e=a.addSourceBuffer(i),n=Hi(t);e.addEventListener("updateend",function(){n.next().then(({value:t,done:i})=>{"open"===a.readyState&&(i?Wi(a):qi(e,t))})}),n.next().then(({value:t,done:i})=>{i||"open"!==a.readyState||((0,r.RK)(()=>{s.style.display="block",setTimeout(()=>{(0,r.RK)(()=>{(0,C.ZM)(s,{opacity:"1"})})},100)}),qi(e,t))})}return a.addEventListener("sourceopen",o,{once:!0}),(0,r.RK)(()=>{(0,C.ZM)(s,{display:"none",opacity:"0"}),s.src=URL.createObjectURL(a)}),()=>{(0,r.RK)(()=>{const e=s.src;(0,Ji.A)(s),a.removeEventListener("sourceopen",o),"open"===a.readyState&&Wi(a),URL.revokeObjectURL(e)})}},[i,t,e]),$i(i)}(Le,je,Vi);nn(e,t),(0,n.vJ)(()=>{t&&V({peerId:e,storyId:t})},[t,e]),(0,n.vJ)(()=>{J({peerId:e})},[e]),(0,n.vJ)(()=>{const t=(0,v.L8)(e);!k&&t&&X({chatId:e})},[k,e]),(0,n.vJ)(()=>{k&&!w&&Z({peerId:e})},[w,k,e]);const Tt=(0,M.A)(()=>{Je&&Le.current?.pause(),Ce(),Ae()}),Bt=(0,M.A)(()=>{ht&&(ge(),Je||be())}),Rt=(0,M.A)(()=>{De()}),Lt=(0,M.A)(()=>{Me()}),xt=(0,M.A)(()=>{Be(),Tt()}),Vt=(0,M.A)(()=>{Re(),Bt()}),{onMouseDown:_t,onMouseUp:Ut,onMouseLeave:Kt,onTouchStart:zt,onTouchEnd:Ht}=(0,Oi.A)({onStart:Rt,onEnd:Lt}),$t=(0,Ue.A)(Le,void 0,!Je||!je||Yt),Zt=je&&(!ze||$e);(0,n.vJ)(()=>{Zt&&!$t&&Bt()},[Zt,$t]),(0,Zi.Ay)(ke,Se),(0,n.vJ)(()=>{Zt&&Le.current?.load()},[Zt]),(0,n.vJ)(()=>{!Xe||xe||rt||(st||nt)&&ee({peerId:e,storyId:t})},[xe,rt,Xe,e,t,st,nt]),(0,n.vJ)(()=>{b||!ye||le||we||Pe||Fe?Tt():Bt()},[Bt,ye,we,le,b,Pe,Fe]),(0,n.vJ)(()=>{if(!(le||b||we))return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){32===e.keyCode&&(e.preventDefault(),Ye(!Pe))}},[we,le,Pe,b]),(0,wi.A)(([e,t,i,n,s])=>{!Pe||we||le||b||!ye||Fe||t===we&&e===le&&i===b&&n===ye&&s===Fe||Ye(!1)},[le,we,b,ye,Fe,Pe]);const ii=(0,M.A)(()=>{R(),H({id:e})}),ni=(0,M.A)(()=>{R(),H({id:a.id})}),si=(0,M.A)(()=>{R(),H({id:c.id})}),ai=(0,M.A)(()=>{U()}),oi=(0,M.A)(()=>{K()}),ri=(0,M.A)(e=>{const t=e.currentTarget;t.readyState>=In?be():Ce(),ut&&(0,ve.LI)(t.currentTime,2)>=(0,ve.LI)(ut,2)&&oi()});(0,n.vJ)(()=>N()||le?void 0:(0,Li.A)({onRight:oi,onLeft:ai}),[N,le]);const di=(0,M.A)(()=>{j({peerId:e,storyId:t})}),hi=(0,M.A)(()=>{z({peerId:e,storyId:t,isInProfile:!0})}),ui=(0,M.A)(()=>{z({peerId:e,storyId:t,isInProfile:!1})}),mi=(0,M.A)(()=>{B(p)}),pi=(0,M.A)(()=>{L()}),vi=(0,M.A)(()=>{G({fromChatId:e,storyId:t})}),gi=(0,M.A)(()=>{q()}),Ai=(0,M.A)(()=>{const e=!Xe||p.isPublic?void 0:p.isForContacts?"contacts":p.isForCloseFriends?"closeFriends":"nobody";let t;const n=(0,Ft.F9)(ae,i);switch(e){case"nobody":t=ae("StorySelectedContactsHint",n);break;case"contacts":t=ae("StoryContactsHint",n);break;case"closeFriends":t=ae("StoryCloseFriendsHint",n);break;default:return}$({message:t})}),fi=(0,M.A)(()=>{Ge?$({message:ae("Story.TooltipVideoHasNoSound")}):(Le.current.muted=!Le.current.muted,_({isMuted:!d}))}),bi=(0,M.A)(()=>{if(P.activeUntil&&(0,ci.Fm)()<P.activeUntil){const e=P.activeUntil-(0,ci.Fm)();$({title:ae("StealthModeOn"),message:ae("Story.ToastStealthModeActiveText",(0,He.QO)(e)),duration:4e3})}else ie({isOpen:!0})}),Ci=(0,M.A)(()=>{Ze&&(0,xi.A)(Ze,`story-${e}-${t}.${Je?"mp4":"jpg"}`)});(0,n.vJ)(()=>{xe&&$({message:ae("StoryNotFound")})},[ae,xe]);const yi=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.Y)(Q.A,{round:!0,ripple:!re,size:"tiny",color:"translucent-white",onClick:e,className:(0,me.A)(Qt,t&&"active"),ariaLabel:ae("AccDescrOpenMenu2"),children:(0,te.Y)(W.A,{name:"more"})}),[re,ae]);const Si=x?oe("ComposerPlaceholderPaidReply",{amount:(0,Ei.U2)(oe,x,{asFont:!0,className:"placeholder-star-icon"})},{withNodes:!0}):ae(it?"ReplyToGroupStory":"ReplyPrivately");return(0,te.FD)("div",{className:(0,me.A)(qt,"component-theme-dark"),onMouseDown:_t,onMouseUp:Ut,onMouseLeave:Kt,onTouchStart:zt,onTouchEnd:Ht,children:[(0,te.FD)("div",{className:(0,me.A)("e7HHuS1g",Nt),children:[(0,te.Y)("div",{className:"jGDd2sza",children:(A?[t]:g??[]).map(e=>(0,te.Y)(Nn,{isActive:e===p?.id,isVideo:Je,isViewed:Boolean(p?.id&&(m||h?e>p?.id:e<p?.id)),isPaused:!fe,duration:ut,onImageComplete:oi},`progress-${e}`))}),(0,te.FD)("div",{className:"eMYhXF_X",children:[(0,te.Y)(se.Ay,{activeKey:Number(e),name:vt,className:"PXnfXZur",children:(0,te.FD)("div",{className:"WpyVfrsc",children:[(0,te.Y)(Mt.A,{peer:i,size:"tiny",onClick:ii}),(0,te.FD)("div",{className:"jmKI_lhC",children:[(0,te.Y)("span",{onClick:ii,className:"H1uod43o",children:(0,Dt.A)((0,Ft.F9)(ae,i)||"")}),(0,te.FD)("div",{className:"zimpR8Hz",children:[lt&&(0,te.FD)("span",{className:(0,me.A)(Wt,"JJFtefb9",a&&"BsqMBS2I"),onClick:a?ni:void 0,children:[(0,te.Y)(W.A,{name:"loop"}),(0,te.Y)("span",{className:ti,children:(0,Dt.A)(lt)})]}),c&&(0,te.FD)("span",{className:(0,me.A)(Wt,"nJr8QgYX"),onClick:si,children:[(0,te.Y)(Mt.A,{peer:c,size:"micro"}),(0,te.Y)("span",{className:ti,children:(0,Dt.A)((0,Ft.F9)(ae,c)||"")})]}),p&&"date"in p&&(0,te.Y)("span",{className:Wt,children:(0,He.jy)(ae,ne,p.date)}),Xe&&p.isEdited&&(0,te.Y)("span",{className:Wt,children:ae("Story.HeaderEdited")})]})]})]})}),(0,te.FD)("div",{className:"GrsJNw3y",children:[function(){if(!tt)return;let e="channel-filled";const t={"channel-filled":["#50ABFF","#007AFF"],"user-filled":["#C36EFF","#8B60FA"],"favorite-filled":["#88D93A","#30B73B"],"group-filled":["#FFB743","#F69A36"]};if(st){const{visibility:t}=p&&"visibility"in p&&p.visibility||{};switch(t){case"everybody":e="channel-filled";break;case"contacts":e="user-filled";break;case"closeFriends":e="favorite-filled";break;case"nobody":e="group-filled"}}else{if(!p||!("content"in p)||p.isPublic)return;e=p.isForCloseFriends?"favorite-filled":p.isForContacts?"user-filled":"group-filled"}return(0,te.FD)("div",{className:(0,me.A)("prxptFFf",st&&"_MVsZpgB"),onClick:st?gi:Ai,style:`--color-from: ${t[e][0]}; --color-to: ${t[e][1]}`,children:[(0,te.Y)(W.A,{name:e}),st&&(0,te.Y)(W.A,{name:"next"})]})}(),Je&&(0,te.Y)(Q.A,{className:Qt,round:!0,ripple:!re,size:"tiny",color:"translucent-white",disabled:!qe,onClick:fi,ariaLabel:ae("Volume"),children:(0,te.Y)(W.A,{name:d||Ge?"speaker-muted-story":"speaker-story"})}),(0,te.FD)(ce.A,{className:"K0_xAdzf",trigger:yi,positionX:"right",onOpen:xt,onClose:Vt,children:[ct&&(0,te.Y)(de.A,{icon:"copy",onClick:di,children:ae("CopyLink")}),at&&(0,te.Y)(de.A,{icon:"save-story",onClick:hi,children:ae(tt?"StorySave":"SaveToPosts")}),ot&&(0,te.Y)(de.A,{icon:"delete",onClick:ui,children:ae(tt?"ArchiveStory":"RemoveFromPosts")}),Qe&&(0,te.Y)(de.A,{icon:"download",disabled:!Ze,onClick:Ci,children:ae("lng_media_download")}),!st&&tt&&(0,te.Y)(de.A,{icon:"eye-crossed-outline",onClick:bi,children:ae("StealthMode")}),!st&&(0,te.Y)(de.A,{icon:"flag",onClick:pi,children:ae("lng_report_story")}),st&&(0,te.Y)(de.A,{icon:"delete",destructive:!0,onClick:mi,children:ae("Delete")})]}),(0,te.Y)(Q.A,{className:(0,me.A)(Qt,"WlLsjJ2Z"),round:!0,size:"tiny",color:"translucent-white",ariaLabel:ae("Close"),onClick:R,children:(0,te.Y)(W.A,{name:"close"})})]})]})]}),(0,te.FD)("div",{className:"YiuvOPgT",style:`width: ${f.width}px; height: ${f.height}px`,children:[(0,te.Y)("canvas",{ref:bt,className:ei}),Oe&&(0,te.Y)("img",{src:Oe,draggable:!1,alt:"",className:(0,me.A)(Jt,"lQfkulvp",Ct)},`preview-${t}`),gt&&(0,te.Y)(on.A,{className:(0,me.A)(At,Et)}),!Je&&je&&(0,te.Y)("img",{src:je,alt:"",className:(0,me.A)(Jt,ft),draggable:!1}),Je&&je&&(0,te.FD)(an.A,{ref:Le,className:(0,me.A)(Jt,ft),canPlay:pe,muted:d,width:720,height:1280,draggable:!1,playsInline:!0,disablePictureInPicture:!0,isPriority:!0,onPause:Ce,onWaiting:Ce,disableRemotePlayback:!0,onTimeUpdate:ri,children:[(0,te.Y)("source",{src:je,type:Vi,width:"720"}),$e&&(0,te.Y)("source",{src:$e,type:"video/mp4; codecs=avc1.64001E",width:"480"})]},`video-${t}`),!Fe&&!le&&(0,te.FD)(te.FK,{children:[(0,te.Y)("button",{type:"button",className:(0,me.A)(Xt,"SXpRZiax"),onClick:ai,"aria-label":ae("Previous")}),(0,te.Y)("button",{type:"button",className:(0,me.A)(Xt,"twOBFwUE"),onClick:oi,"aria-label":ae("Next")})]}),Xe&&je&&(0,te.Y)(rn.A,{story:p,isActive:!0,isStoryPlaying:Te},`area-overlay-${t}-${e}`),!re&&(0,te.Y)("div",{className:Ot,children:(0,te.FD)("div",{className:Gt,children:[(0,te.Y)(Mt.A,{peer:i}),(0,te.Y)("div",{className:jt,children:(0,Dt.A)((0,Ft.F9)(ae,i)||"")})]})})]}),pt&&(0,te.Y)(wn,{story:p,className:Nt}),kt&&(0,te.Y)("div",{tabIndex:0,role:"button",className:(0,me.A)("Jd1DYS6Y",wt),onClick:()=>Ie(),"aria-label":ae("Close")}),Ee&&(0,te.Y)("div",{className:(0,me.A)("sHNAfxzf",Pt)}),It&&(0,te.Y)(fn,{story:p,isExpanded:we,onExpand:Ne,onFold:Ie,className:Pt},`caption-${t}-${e}`),yt&&(0,te.Y)(sn.A,{type:"story",chatId:e,threadId:O.l3,storyId:t,isReady:!st,messageListType:"thread",isMobile:(0,Y.Ny)(),editableInputCssSelector:o.iKt,editableInputId:o.YVZ,inputId:"story-input-text",className:(0,me.A)("FXineBYO",St),inputPlaceholder:Si,onForward:dt?vi:void 0,onFocus:he,onBlur:ue})]})})),Yn=(0,n.ph)((0,s.EK)((e,{peer:t})=>{const{storyViewer:{lastViewedByPeerId:i,origin:n,storyList:s}}=(0,c.nTw)(e);return{lastViewedId:t?.id?i?.[t.id]:void 0,origin:n,storyIdsForViewer:t?.id?s?.storyIdsByPeerId[t.id]:void 0}})(function({peer:e,peerStories:t,lastViewedId:i,storyIdsForViewer:a,origin:o}){const{openStoryViewer:r,loadPeerSkippedStories:c}=(0,s.ko)(),d=(0,T.A)(),h=(0,n.Kr)(()=>{if(!t)return;const{orderedIds:e,lastReadId:n,byId:s}=t,o=e[e.length-1]!==n,r=i&&a?.includes(i)?i??(o?n??-1:-1):-1;return s[s[r]?.id||a?.[0]||e[0]]},[i,t,a]),u=h&&"content"in h;(0,n.vJ)(()=>{h&&!u&&c({peerId:h.peerId})},[h,u]);const m=u?h.content.video:void 0,p=u?(0,l.EN)(h):void 0,v=(0,z.A)(p)||m?.thumbnail?.dataUri;if(e&&h&&!("isDeleted"in h))return(0,te.FD)("div",{className:qt,onClick:()=>{r({peerId:h.peerId,storyId:h.id,origin:o})},children:[v&&(0,te.Y)("img",{src:v,alt:"",className:Jt,draggable:!1}),u&&(0,te.Y)(rn.A,{story:h}),(0,te.Y)("div",{className:Ot,children:(0,te.FD)("div",{className:Gt,children:[(0,te.Y)(Mt.A,{peer:e}),(0,te.Y)("div",{className:jt,children:(0,Dt.A)((0,Ft.F9)(d,e)||"")})]})})]})}));var Fn=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(Fn||{});const Dn=(0,n.ph)((0,s.EK)(e=>{const{storyViewer:{peerId:t,storyId:i,isSinglePeer:n,isSingleStory:s,isPrivate:a,isArchive:o,storyList:r}}=(0,c.nTw)(e),{byPeerId:l,orderedPeerIds:{active:d}}=e.stories;return{byPeerId:l,peerIds:r?.peerIds??d,currentPeerId:t,currentStoryId:i,isSinglePeer:n,isSingleStory:s,isPrivate:a,isArchive:o}},e=>(0,c.gd2)(e))(function({peerIds:e,currentPeerId:t,currentStoryId:i,isOpen:a,isSinglePeer:d,isSingleStory:h,isPrivate:m,isArchive:p,byPeerId:v,isDeleteModalOpen:g,onDelete:A,onClose:f,onReport:b}){const{stopActiveReaction:C}=(0,s.ko)(),y=(0,n.li)(),[S,k]=(0,n.J0)(t),[w,N]=(0,n.J0)(i),I=(0,_.A)(t),P=(0,Ri.A)(p,!0),F=(0,Ri.A)(m,!0),D=(0,Ri.A)(d,!0),T=(0,Ri.A)(h,!0),B=ri(),{height:R,width:L}=(0,we.A)(),x=(0,n.li)(void 0),E=(0,n.li)(!1),{isMobile:V}=(0,Y.Ay)(),U=(0,n.li)({}),[O,K]=(0,n.Ul)(!1);function J(e,t){e&&(U.current[t]?U.current[t].current=e:U.current[t]={current:e})}(0,Ce.A)({isActive:a,onBack:f,shouldBeReplaced:!0});const G=(0,n.Kr)(()=>{if(S&&(D||T))return[S];const t=S?e.indexOf(S):-1;if(!S||-1===t)return[];const i=Math.max(t-4,0),n=Math.min(t+5,e.length);return e.slice(i,n)},[T,D,S,e]),j=(0,n.Kr)(()=>G.length&&S?G.indexOf(S):-1,[S,G]),z=(0,n.Kr)(()=>G.length&&t?G.indexOf(t):-1,[t,G]);(0,n.vJ)(()=>{V&&k(t)},[t,V]),(0,n.vJ)(()=>{S===t&&i!==w&&N(i)},[t,i,S,w]),(0,n.vJ)(()=>{if(!V)return I&&I!==t&&K(!0),()=>{K(!1)}},[I,t,K,V]),(0,n.vJ)(()=>()=>{i&&t&&C({containerId:(0,l.$_)(t,i)})},[i,t]);const H=z-j,$=j>z,q=(0,M.A)(()=>e.reduce((i,n,s)=>{if(n===S)i[n]=oi({scale:B.scale,slideAmount:H,isBackward:$,isActiveSlideSize:$});else{let a=!1;!$&&s>0&&e[s-1]===S&&(a=!0),$&&s<e.length-1&&e[s+1]===S&&(a=!0),i[n]=oi({scale:B.scale,slideAmount:H,isBackward:$,isActiveSlideSize:t===n&&!$,isMoveThroughActiveSlide:a})}return i},{}));(0,n.vJ)(()=>{if(!y.current||!a)return;let e=0;const t=()=>S?U.current[S]?.current:void 0,i=i=>{if(E.current)return void(E.current=!1);const n=t();if(n)if(e<-50){const e=document.getElementById(o.YVZ);e&&(0,r.RK)(()=>{(0,Ti.A)(e)})}else e>50?(f(),"wheel"===i.type&&((0,Bi.M6)(),setTimeout(Bi.v5,1500))):(0,r.RK)(()=>{n.style.setProperty("--slide-translate-y","0px")})};return(0,pe.wJ)(y.current,{isNotPassive:!0,withNativeDrag:!0,withWheelDrag:!0,excludedClosestSelector:".Composer",onDrag:(n,s,{dragOffsetX:a,dragOffsetY:o})=>{if(E.current)return;if(u.pz&&"touchstart"===s.type){const{pageX:e}=s.touches[0];if(e<=pe.h6||e>=L-pe.h6)return}if("mousemove"===n.type)return;const l=Math.abs(a),c=Math.abs(o),d=t();if(d&&(x.current===Fn.Vertical||Math.abs(c)>pe.no||c/l>pe.fG)){x.current=Fn.Vertical;const t=R;e=(0,ve.qE)(o,-t,t),e>0&&(0,r.RK)(()=>{d.style.setProperty("--slide-translate-y",e*(V?1:-1)+"px")}),"wheel"===n.type&&Math.abs(e)>100&&(i(n),E.current=!0)}},onRelease:i})},[a,f,L,R,V,S]),(0,n.Nf)(()=>{if(V)return;const e=q();Object.entries(U.current).forEach(([i,{current:n}])=>{if(!n)return;if(!O())return n.classList.remove(_t,Ut,Kt),n.style.setProperty("--slide-translate-x","0px"),n.style.setProperty("--slide-translate-y","0px"),n.style.setProperty("--slide-translate-scale","1"),void n.style.setProperty("--slide-content-scale",String(B.toActiveScale));let s=0;i===S&&(s=-1.75*B.fromActiveScale,n.classList.add(Kt)),i===t&&(s=1.75,n.classList.add(Ut)),n.classList.add(_t),n.style.setProperty("--slide-translate-x",`${e[i]||0}px`),n.style.setProperty("--slide-translate-y",`${s}rem`),n.style.setProperty("--slide-translate-scale",t===i?String(B.toActiveScale):i===S?String(B.fromActiveScale):"1")})},[t,O,S,B,V]);const W=(0,M.A)(e=>{const n=e.target;n&&n.classList.contains($t)&&(S!==t?(k(t),N(i)):i!==w&&N(i),K(!1))});return V?(0,te.Y)("div",{className:Vt,ref:y,children:(0,te.Y)("div",{className:Ht,ref:e=>J(e,S),children:(0,te.Y)(Pn,{peerId:S,storyId:w,onDelete:A,dimensions:B.activeSlide,isPrivateStories:F,isArchivedStories:P,isDeleteModalOpen:g,isSingleStory:h,getIsAnimating:O,onClose:f,onReport:b})})}):(0,te.FD)("div",{className:Vt,ref:y,style:`--story-viewer-scale: ${B.scale}`,onTransitionEnd:W,children:[(0,te.Y)("div",{className:Et,onClick:f}),G.length>1&&(0,te.Y)("div",{className:"xe67dhtF",style:`height: ${B.slide.height}px`}),G.map((e,t)=>e===S?function(e){const t=V?void 0:(0,Mi.A)(`width: ${B.activeSlide.width}px`,`--slide-media-height: ${B.activeSlide.height}px`);return(0,te.Y)("div",{ref:t=>J(t,e),className:(0,me.A)(zt,$t),style:t,children:(0,te.Y)(Pn,{peerId:e,storyId:w,onDelete:A,dimensions:B.activeSlide,isPrivateStories:F,isArchivedStories:P,isDeleteModalOpen:g,isSingleStory:h,getIsAnimating:O,onClose:f,onReport:b})},e)}(S):function(e,t,i){const n=(0,Mi.A)(`width: ${B.slide.width}px`,`height: ${B.slide.height}px`),a=(0,me.A)(zt,"Sef28wEh",`slide-${i}`);return(0,te.Y)("div",{ref:t=>J(t,e),className:a,style:n,children:(0,te.Y)(Yn,{peer:(0,c.PVB)((0,s.mS)(),e),peerStories:v?.[e]})},e)}(e,0,t-j))]})}));function Mn(e=5){const[t,i]=(0,n.J0)(!0),[s,a]=(0,n.J0)(!0);return{isAtBeginning:t,isAtEnd:s,handleScroll:(0,M.A)(t=>{const{scrollHeight:n,scrollTop:s,clientHeight:o}=t.target;i(s<e),a(n-s-o<e)})}}var Tn=i(46222),Bn=i(283),Rn=i(36393),Ln=i(51083),xn=i(17751),En=i(17794);const Vn={"views-list":"gpDY8bos",viewsList:"gpDY8bos","views-list-loading":"vuRAfQ5v",viewsListLoading:"vuRAfQ5v",info:"AOSUIChK",centeredInfo:"oGLhkkS7","view-reaction":"MLaabS6n",viewReaction:"MLaabS6n",header:"d3N2bktu",content:"QmRA3HZK","top-button":"Dkv8GAxf",topButton:"Dkv8GAxf","contact-filter":"YpB_9VxE",contactFilter:"YpB_9VxE",selected:"DoUlpdZJ",sort:"axDpgq9G","sort-button":"Bm5VA66f",sortButton:"Bm5VA66f","icon-sort":"YVQiH93R",iconSort:"YVQiH93R","icon-down":"NXP9aMD0",iconDown:"NXP9aMD0",search:"QQQqBLK6","bottom-info":"_CSv6suH",bottomInfo:"_CSv6suH",scrolled:"RYQ0liYe",footer:"dUK7rP37",closeButton:"abPzLiCH","opacity-fade-in":"cX8oY3zb",opacityFadeIn:"cX8oY3zb",fadeIn:"Sx_aeh1o",blocked:"L82sciL8",check:"UqGBKwjg",menuBubble:"dRqemuTA","with-colored-status":"GQ96fta9",withColoredStatus:"GQ96fta9"},_n=1.5*g.$,Un=(0,n.ph)((0,s.EK)((e,{storyView:t})=>({peer:(0,c.PVB)(e,t.peerId),availableReactions:e.reactions.availableReactions}))(({storyView:e,peer:t,availableReactions:i})=>{const{openChat:a,closeStoryViewer:o,unblockUser:r,blockUser:c,deleteContact:d,updateStoryView:h,focusMessage:u,openStoryViewer:m,closeStoryViewModal:p}=(0,s.ko)(),g=(0,T.A)(),A=(0,M.A)(()=>{const{type:t}=e;if("repost"===t)return p(),void m({peerId:e.peerId,storyId:e.storyId});o(),setTimeout(()=>{"user"===t?a({id:e.peerId}):"forward"===t&&u({chatId:e.peerId,messageId:e.messageId})},100)}),f=(0,n.Kr)(()=>{if(!(0,v.L8)(e.peerId))return;const{peerId:i,areStoriesBlocked:n,isUserBlocked:s}=e,a=t,{isContact:o}=a||{},u=(0,l.Yg)(a),m=[];return s||(n?m.push({handler:()=>{r({userId:i,isOnlyStories:!0}),h({userId:i,areStoriesBlocked:!1})},title:g("StoryShowBackTo",u),icon:"play-story"}):m.push({handler:()=>{c({userId:i,isOnlyStories:!0}),h({userId:i,areStoriesBlocked:!0})},title:g("StoryHideFrom",u),icon:"hand-stop"})),o?m.push({handler:()=>{d({userId:i})},title:g("DeleteContact"),icon:"delete-user",destructive:!0}):m.push({handler:()=>{s?(r({userId:i}),h({userId:i,isUserBlocked:!1})):(c({userId:i}),h({userId:i,isUserBlocked:!0}))},title:g(s?"Unblock":"BlockUser"),icon:s?"user":"delete-user",destructive:!s}),m},[g,e,t]),b="user"===e.type?"message-read":"forward"===e.type?"forward":"loop",C="forward"===e.type||"repost"===e.type,y=(0,n.Kr)(()=>{const t="repost"===e.type&&e.story.forwardInfo?.isModified,i=[(0,He.U)(g,1e3*e.date)];return t&&i.push(g("lng_edited")),i.join(" • ")},[g,e]);return(0,te.Y)(di.A,{className:(0,me.A)("chat-item-clickable small-icon",Vn.opacityFadeIn,(e.isUserBlocked||e.areStoriesBlocked)&&Vn.blocked),onClick:A,rightElement:"user"===e.type&&e.reaction?(0,te.Y)(En.A,{reaction:e.reaction,className:Vn.viewReaction,size:_n,availableReactions:i,withIconHeart:!0}):void 0,contextActions:f,withPortalForMenu:!0,menuBubbleClassName:Vn.menuBubble,children:(0,v.L8)(e.peerId)?(0,te.Y)(xn.A,{className:(0,me.A)(C&&Vn.withColoredStatus),userId:e.peerId,noStatusOrTyping:!0,status:y,statusIcon:b,forceShowSelf:!0}):(0,te.Y)(Ln.A,{className:(0,me.A)(C&&Vn.withColoredStatus),chatId:e.peerId,status:y,statusIcon:b})},e.peerId)})),On=(0,n.ph)((0,s.EK)(e=>{const{appConfig:t}=e,{storyViewer:{viewModal:i}}=(0,c.nTw)(e),{storyId:n,views:s,nextOffset:a,isLoading:o}=i||{},r=n?(0,c.Msb)(e,e.currentUserId,n):void 0,l="story"===r?.["@type"]?r.expireDate:void 0;return{views:s,viewersExpireDate:l?l+t.storyViewersExpirePeriod:void 0,story:r&&"content"in r?r:void 0,nextOffset:a,isLoading:o,isCurrentUserPremium:(0,c.g29)(e)}})(function({story:e,viewersExpireDate:t,views:i,nextOffset:a,isLoading:r,isCurrentUserPremium:l}){const{loadStoryViewList:c,closeStoryViewModal:d,clearStoryViews:h}=(0,s.ko)(),[u,m,p]=(0,F.A)(!1),[v,g,A]=(0,F.A)(!0),[f,b]=(0,n.J0)(""),C=(0,T.A)(),y=Boolean(e),S=Boolean(t)&&t<(0,ci.Fm)(),{viewsCount:k=0,reactionsCount:w=0}=e?.views||{},N=e?.isPublic&&k>o.XQO,I=w>o.$4F,P=k>o.frj,Y=N||I||P;(0,n.vJ)(()=>{y||(b(""),p(),g())},[y]);const D=(0,fe.A)(()=>{h({isLoading:!0})},[],250,!0);(0,n.vJ)(()=>{D()},[u,v,f,D]);const B=(0,n.Kr)(()=>i?.sort(function(e){return(t,i)=>{if(e){const e="user"===t.type&&t.reaction,n="user"===i.type&&i.reaction;if(e&&!n)return-1;if(!e&&n)return 1}return i.date-t.date}}(v)),[v,i]),R=B?.length?1:Math.min(k,8),L=Boolean(B?.length)&&B.length<k&&S,x=(0,M.A)(()=>{e?.id&&void 0!==a&&c({peerId:e.peerId,storyId:e.id,offset:a,areReactionsFirst:v||void 0,areJustContacts:u||void 0,query:f})}),{handleScroll:E,isAtBeginning:V}=Mn(),_=(0,M.A)(()=>{d()}),U=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.FD)(Q.A,{fluid:!0,size:"tiny",color:"translucent",className:(0,me.A)(!t&&"active",Vn.sortButton,Vn.topButton),faded:t,onClick:e,ariaLabel:C("SortBy"),children:[(0,te.Y)(W.A,{name:v?"heart-outline":"recent",className:Vn.iconSort}),(0,te.Y)(W.A,{name:"down",className:Vn.iconDown})]}),[v,C]);return(0,te.FD)(X.A,{isOpen:y,onClose:_,className:"component-theme-dark",contentClassName:Vn.viewsList,isSlim:!0,children:[Y&&(0,te.FD)("div",{className:Vn.header,children:[N&&(0,te.FD)("div",{className:Vn.contactFilter,children:[(0,te.Y)(Q.A,{className:(0,me.A)(!u&&Vn.selected,Vn.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:p,children:C("AllViewers")}),(0,te.Y)(Q.A,{className:(0,me.A)(u&&Vn.selected,Vn.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:m,children:C("Contacts")})]}),I&&(0,te.FD)(ce.A,{className:Vn.sort,trigger:U,positionX:"right",children:[(0,te.FD)(de.A,{icon:"heart-outline",onClick:g,children:[C("SortByReactions"),v&&(0,te.Y)(W.A,{name:"check",className:Vn.check})]}),(0,te.FD)(de.A,{icon:"recent",onClick:A,children:[C("SortByTime"),!v&&(0,te.Y)(W.A,{name:"check",className:Vn.check})]})]}),P&&(0,te.Y)(Rn.A,{className:Vn.search,value:f,onChange:b})]}),(0,te.FD)("div",{className:(0,me.A)(Vn.content,!V&&Vn.topScrolled,"custom-scroll"),onScroll:E,children:[S&&!r&&!f&&Boolean(!B?.length)&&(0,te.Y)("div",{className:(0,me.A)(Vn.info,Vn.centeredInfo),children:(0,Dt.A)(C(l?"ServerErrorViewers":"ExpiredViewsStub"),["simple_markdown","emoji"])}),!r&&Boolean(f.length)&&!B?.length&&(0,te.Y)("div",{className:Vn.info,children:C("Story.ViewList.EmptyTextSearch")}),(0,te.FD)(Tn.A,{items:B,onLoadMore:x,children:[B?.map(e=>{const t="forward"===e.type?e.messageId:"repost"===e.type?e.storyId:"user";return(0,te.Y)(Un,{storyView:e},`${e.peerId}-${e.date}-${t}`)}),r&&Array.from({length:R}).map((e,t)=>(0,te.Y)(di.A,{className:"chat-item-clickable contact-list-item scroll-item small-icon",disabled:!0,children:(0,te.Y)(Bn.A,{})},`placeholder-${t}`)),L&&(0,te.Y)("div",{className:(0,me.A)(Vn.info,Vn.bottomInfo),children:C("Story.ViewList.NotFullyRecorded")},"not-all-available")]})]}),(0,te.Y)("div",{className:(0,me.A)(Vn.footer,"dialog-buttons"),children:(0,te.Y)(Q.A,{className:(0,me.A)("confirm-dialog-button",Vn.close),isText:!0,onClick:_,children:C("Close")})})]})})),Kn=(0,n.ph)((0,s.EK)(e=>{const{shouldSkipHistoryAnimations:t,storyViewer:{storyId:i,peerId:n,isPrivacyModalOpen:s,origin:a}}=(0,c.nTw)(e),o=n&&i?(0,c.Msb)(e,n,i):void 0,r=(0,c.xYJ)(e,"mediaViewerAnimations");return{isOpen:(0,c.gd2)(e),shouldSkipHistoryAnimations:t,peerId:n,storyId:i,story:o,origin:a,withAnimation:r,isPrivacyModalOpen:s}})(function({isOpen:e,peerId:t,storyId:i,story:a,origin:l,shouldSkipHistoryAnimations:c,withAnimation:d,isPrivacyModalOpen:h}){const{closeStoryViewer:u,closeStoryPrivacyEditor:v,reportStory:g}=(0,s.ko)(),A=(0,T.A)(),[f,b]=(0,n.J0)(void 0),[y,S,k]=(0,F.A)(!1),{bestImageData:N,thumbnail:I}=li(a),P=ri(),Y=(0,_.A)(e),D=(0,_.A)(N),B=(0,_.A)(t),R=(0,_.A)(l),L=Boolean(d&&!c);(0,n.vJ)(()=>{e||(b(void 0),k())},[e]),(0,n.vJ)(()=>{if(!e)return;(0,p.FD)();const t=(0,U.w4)();return()=>{(0,p.wb)(),t()}},[e]);const x=(0,n.hb)(()=>{u()},[u]),E=(0,M.A)(e=>{b(e),S()}),V=(0,M.A)(()=>{k(),b(void 0)}),O=(0,M.A)(()=>{i&&g({storyId:i,peerId:t})});return(0,n.vJ)(()=>e?(0,m.A)(()=>{x()}):void 0,[x,e]),(0,n.vJ)(()=>{L&&!Y&&e&&t&&I&&void 0!==l&&((0,n.VK)(250+o.xB5),function(e,t,i,n,s){const{mediaEl:a}=ai(t,e);if(!a)return;const{width:l,height:c}=w.A.get();let{width:d,height:h}=s;const u=l<=600;if(u){d=l-2*ni,h=c-ii-2*ni;const e=getComputedStyle(document.documentElement).getPropertyValue("--safe-area-bottom");e&&(h-=parseFloat(e))}const m=u?ni:(l-d)/2,p=u?ni:(c-(h+ii))/2,{top:v,left:g,width:A,height:f}=a.getBoundingClientRect(),b=g+A/2-(m+d/2),y=v+f/2-(p+h/2),S=A/d,k=f/h;(0,r.RK)(()=>{const e=si(n||i,!n);(0,C.ZM)(e,{top:`${p}px`,left:`${m}px`,width:`${d}px`,height:`${h}px`,transform:`translate3d(${b}px, ${y}px, 0) scale(${S}, ${k})`});const t=document.getElementById("StoryViewer");t.appendChild(e),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{(0,C.ZM)(e,{transform:""}),setTimeout(()=>{(0,r.RK)(()=>{t.contains(e)&&t.removeChild(e),document.body.classList.remove("ghost-animating")})},200+o.xB5)})})}(t,l,I,N,P.activeSlide)),L&&Y&&!e&&B&&D&&void 0!==R&&((0,n.VK)(250+o.xB5),function(e,t,i){const{mediaEl:n}=ai(t,e),s=document.getElementById("StoryViewer").querySelector(`.${Ht} .${Jt}, .${$t} .${Jt}`);if(!s||!n)return;const{top:a,left:l,width:c,height:d}=s.getBoundingClientRect(),{top:h,left:u,width:m,height:p}=n.getBoundingClientRect(),v=u+m/2-(l+c/2),g=h+p/2-(a+d/2),A=m/c,f=p/d;(0,r.RK)(()=>{const e=si(i);(0,C.ZM)(e,{top:`${a}px`,left:`${l}px`,width:`${c}px`,height:`${d}px`});const t=si(n.src,void 0,!0),s=a+d/2-c/2;(0,C.ZM)(t,{top:`${s}px`,left:`${l}px`,width:`${c}px`,height:`${c}px`});const h=document.getElementById("StoryViewer");h.appendChild(e),document.body.appendChild(t),document.body.classList.add("ghost-animating"),(0,r.RK)(()=>{(0,C.ZM)(e,{transform:`translate3d(${v}px, ${g}px, 0) scale(${A}, ${f})`}),(0,C.ZM)(t,{transform:`translate3d(${v}px, ${g}px, 0) scale(${A})`,opacity:"1"}),setTimeout(()=>{(0,r.RK)(()=>{h.contains(e)&&h.removeChild(e),document.body.contains(t)&&document.body.removeChild(t),document.body.classList.remove("ghost-animating")})},200+o.xB5)})})}(B,R,D))},[L,N,D,e,Y,P.activeSlide,I,t,B,l,R]),(0,te.FD)(ne.A,{id:"StoryViewer",className:"bu_hGbaa",isOpen:e,shouldAnimateFirstRender:!0,noCloseTransition:c,children:[(0,te.Y)("div",{className:"OFh6u50Q",onClick:x}),(0,te.Y)(Q.A,{className:"Mye8Dwxa",round:!0,size:"smaller",color:"translucent-white",ariaLabel:A("Close"),onClick:x,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)(Dn,{isOpen:e,isDeleteModalOpen:y,onReport:O,onClose:x,onDelete:E}),(0,te.Y)(Ai,{isOpen:y,story:f,onClose:V}),(0,te.Y)(On,{}),(0,te.Y)(vi,{}),(0,te.Y)(Di,{isOpen:h,onClose:v})]})}));var Jn=i(79582),Gn=i(63527),jn=i(96374),zn=i(79174),Hn=i(10328),$n=i(52745),qn=i(34431),Wn=i(38102),Qn=i(45780);const Zn=2.75*g.$,Xn="ChatOrUserPicker-item",es=(0,n.ph)(({isOpen:e,currentUserId:t,chatOrUserIds:i,search:a,searchPlaceholder:r,className:d,loadMore:h,onSearchChange:u,onSelectChatOrUser:m,onClose:p,onCloseAnimationEnd:v,isLowStackPriority:g})=>{const{loadTopics:A}=(0,s.ko)(),f=(0,T.A)(),b=(0,n.li)(),C=(0,n.li)(),y=(0,n.li)(),S=(0,n.li)(),[k,w]=(0,jn.A)(h,i,Boolean(a)),[N,I]=(0,n.J0)(void 0),[P,Y]=(0,n.J0)(""),F=N?1:0,D=i.indexOf(k[0]),B=(0,M.A)(()=>{u("")});(0,zn.A)(y,e&&0===F,B),(0,zn.A)(S,e&&1===F);const R=(0,M.A)(e=>{if(N)return(0,c.pSx)(e,N)}),L=(0,Gn.A)(R),[x,E]=(0,n.Kr)(()=>{const e=(0,s.mS)(),t=e.chats.byId,i=e.chats.fullInfoById,n=t[N];if(!n||!L)return[void 0,void 0];const a=P.toLowerCase(),o=L?Object.values(L).reduce((e,t)=>(!(0,l.__)(n,t,void 0,i[N])||a&&!t.title.toLowerCase().includes(a)||(e[t.id]=t),e),{}):L;return[Object.keys(o).map(Number),o]},[N,P,L]),V=(0,M.A)(()=>{I(void 0),Y("")}),_=(0,M.A)(e=>{u(e.currentTarget.value)}),U=(0,M.A)(e=>{Y(e.currentTarget.value)}),O=(0,Hn.A)(b,e,e=>{if(k&&k.length>0){const t=(0,s.mS)().chats.byId,i=k[-1===e?0:e],n=t[i];n?.isForum?(L||A({chatId:i}),I(i)):m(i)}},`.${Xn}`,!0),K=(0,Hn.A)(C,e,e=>{x?.length&&m(N,x[-1===e?0:e])},`.${Xn}`,!0),J=(0,M.A)(e=>{const t=(0,s.mS)().chats.byId,i=t?.[e];i?.isForum?(L||A({chatId:e}),I(e),B()):m(e)}),G=(0,n.hb)((e,i)=>{const n=(0,s.mS)();let a=(0,c.PVB)(n,e);if(!a)return;const r=(0,c.k2W)(n,e);r&&(a=r);const d=a&&!(0,Ft.vj)(a)?a.isSelf:void 0,[h,u]=function(){if(!a)return;if(a.id===t)return[f("SavedMessagesInfo")];if((0,Ft.vj)(a))return[(0,l.sT)(f,a)];const e=(0,c.K0y)(n,a.id);return[(0,l.CD)(f,a,e),(0,me.A)((0,l.PF)(a,e,!0)&&"online")]}()||[];return(0,te.Y)(Qn.A,{className:Xn,title:(0,te.Y)("div",{className:"title-wrapper",children:(0,te.Y)(qn.A,{className:"item-title",peer:a,isMonoforum:Boolean(r),isSavedMessages:d})}),avatarElement:(0,te.Y)(Mt.A,{peer:a,asMessageBubble:Boolean(r),isSavedMessages:d,size:"medium"}),subtitle:h,subtitleClassName:u,ripple:!0,style:`top: ${(D+i)*o.xw7}px;`,onClick:()=>J(e)},e)},[t,f,D]);return(0,te.Y)(X.A,{isOpen:e,className:(0,me.A)("ChatOrUserPicker",d),onClose:p,onCloseAnimationEnd:v,isLowStackPriority:g,children:(0,te.Y)(se.Ay,{activeKey:F,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",children:()=>1===F?(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"modal-header",dir:f.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:f("Back"),onClick:V,children:(0,te.Y)(W.A,{name:"arrow-left"})}),(0,te.Y)(Z.A,{ref:S,value:P,onChange:U,onKeyDown:K,placeholder:r})]}),(0,te.FD)(Tn.A,{ref:C,className:"picker-list custom-scroll",items:x,withAbsolutePositioning:!0,maxHeight:56*(x?.length||0),onKeyDown:K,children:[!x&&(0,te.Y)($n.A,{}),x?.map((e,t)=>(0,te.Y)(Qn.A,{className:Xn,onClick:()=>m(N,e),style:`top: ${56*(D+t)}px;`,avatarElement:(0,te.Y)(Wn.A,{size:Zn,topic:E[e],className:"topic-icon",letterClassName:"topic-icon-letter"}),title:(0,Dt.A)(E[e].title)},`${N}_${e}`))]})]}):(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"modal-header",dir:f.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:f("Close"),onClick:p,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)(Z.A,{ref:y,value:a,onChange:_,onKeyDown:O,placeholder:r})]}),k?.length?(0,te.Y)(Tn.A,{ref:b,className:"picker-list custom-scroll",items:k,itemSelector:`.${Xn}`,onLoadMore:w,withAbsolutePositioning:!0,maxHeight:i.length*o.xw7,onKeyDown:O,children:k.map(G)}):k&&!k.length?(0,te.Y)("p",{className:"no-results",children:f("lng_blocked_list_not_found")}):(0,te.Y)($n.A,{})]})})})}),ts=(0,n.ph)((0,s.EK)(e=>{const{chats:{listIds:t,orderedPinnedIds:i},currentUserId:n}=e;return{activeListIds:t.active,archivedListIds:t.archived,pinnedIds:i.active,contactIds:e.contactList?.userIds,currentUserId:n}})(({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:a,pinnedIds:r,contactIds:d,filter:h=o.K_A,className:u,searchPlaceholder:m,loadMore:p,onSelectRecipient:v,onClose:g,onCloseAnimationEnd:A,isLowStackPriority:f,isForwarding:b})=>{const[C,y]=(0,n.J0)(""),S=(0,n.Kr)(()=>{if(!e)return;let n=r||[];t&&(n=(0,Ci.Am)([t,...n]));const o=(0,s.mS)(),u=[...i||[],...C&&a||[]].filter(e=>{const t=(0,c.hds)(o,e),i=(0,c.mBe)(o,e),n=t&&(0,l.ub)(t,"postMessages"),s=t&&(0,l.WX)(t);if(b&&s&&!n)return!1;if(i&&!(0,l.PL)(i))return!0;if(!t)return!1;if(t.isMonoforum&&(0,c.ODG)(o,e))return!1;const a=(0,c.AWZ)(o,e);return!a||(0,l.__)(t,void 0,void 0,a)}),m=(0,Jn.A)((0,Ft.PU)({ids:(0,Ci.Am)([...t?[t]:[],...u,...d||[]]),query:C}),void 0,n,t);return(0,c.yMZ)(o,m,h)},[e,r,t,i,C,a,d,h,b]),k=(0,Ri.A)(S,!0);return(0,te.Y)(es,{isOpen:e,className:u,chatOrUserIds:k,currentUserId:t,searchPlaceholder:m,search:C,onSearchChange:y,loadMore:p,onSelectChatOrUser:v,onClose:g,onCloseAnimationEnd:A,isLowStackPriority:f})})),is=(0,n.ph)((0,s.EK)(e=>{const{messageIds:t,storyId:i}=(0,c.nTw)(e).forwardMessages,n=t&&t.length>0;return{currentUserId:e.currentUserId,isManyMessages:(t?.length||0)>1,isStory:Boolean(i),isForwarding:n}})(({isOpen:e,currentUserId:t,isManyMessages:i,isStory:a,isForwarding:o})=>{const{openChatOrTopicWithReplyInDraft:r,setForwardChatOrTopic:d,exitForwardMode:h,forwardToSavedMessages:u,forwardStory:m,showNotification:p}=(0,s.ko)(),g=(0,T.A)(),A=(0,_.A)(a,!0),[f,b,C]=(0,F.A)();(0,n.vJ)(()=>{e&&b()},[e,b]);const y=(0,n.hb)((e,n)=>{const h=e===t;if(a){m({toChatId:e});const t=(0,s.mS)();if((0,v.L8)(e))p({message:h?g("Conversation.StoryForwardTooltip.SavedMessages.One"):g("StorySharedTo",(0,l.u0)((0,c.mBe)(t,e)))});else{const i=(0,c.hds)(t,e);if(!i)return;p({message:g("StorySharedTo",(0,l.Js)(g,i))})}}else if(h){const e=g(i?"Conversation.ForwardTooltip.SavedMessages.Many":"Conversation.ForwardTooltip.SavedMessages.One");u(),p({message:e})}else{const t=e,i=n?Number(n):void 0;o?d({chatId:t,topicId:i}):r({chatId:t,topicId:i})}},[t,i,a,g,o]),S=(0,n.hb)(()=>{h()},[h]);if(e||f)return(0,te.Y)(ts,{isOpen:e,className:A?"component-theme-dark":void 0,searchPlaceholder:g(o?"ForwardTo":"ReplyToDialog"),onSelectRecipient:y,onClose:S,onCloseAnimationEnd:C,isForwarding:o})})),ns=(0,n.ph)(({requestedDraft:e})=>{const t=Boolean(e&&!e.chatId),{openChatWithDraft:i,resetOpenChatWithDraft:a}=(0,s.ko)(),o=(0,T.A)(),[r,l,c]=(0,F.A)();(0,n.vJ)(()=>{t&&l()},[t,l]);const d=(0,n.hb)((t,n)=>{i({chatId:t,threadId:n,text:e.text,files:e.files})},[i,e]),h=(0,n.hb)(()=>{a()},[a]);if(t||r)return(0,te.Y)(ts,{isOpen:t,searchPlaceholder:o("ForwardTo"),filter:e?.filter,onSelectRecipient:d,onClose:h,onCloseAnimationEnd:c})}),ss=(0,n.ph)(({requestedAttachBotInChat:e})=>{const{cancelAttachBotInChat:t,callAttachBot:i}=(0,s.ko)(),a=(0,T.A)(),o=Boolean(e),[r,l,c]=(0,F.A)();(0,n.vJ)(()=>{o&&l()},[o,l]);const{bot:d,filter:h,startParam:u}=e||{},m=(0,n.hb)(e=>{i({bot:d,chatId:e,startParam:u}),t()},[d,i,t,u]);if(o||r)return(0,te.Y)(ts,{isOpen:o,searchPlaceholder:a("Search"),filter:h,onSelectRecipient:m,onClose:t,onCloseAnimationEnd:c})});var as=i(99375);function os(e){return e.isSlowMode?"Slowmode enabled":e.hasErrorKey?"Something went wrong":"Telegram"}const rs=(0,n.ph)((0,s.EK)(e=>({dialogs:(0,c.nTw)(e).dialogs,currentMessageList:(0,c.Xf0)(e)}))(({dialogs:e,currentMessageList:t})=>{const{dismissDialog:i,sendMessage:a}=(0,s.ko)(),[o,r,l]=(0,F.A)(),c=(0,T.A)();var d,h,u;if((0,n.vJ)(()=>{e.length>0&&r()},[e,r]),e.length)return Boolean(e.length)&&("phoneNumber"in(d=e[e.length-1])?(h=d,(0,te.FD)(X.A,{isOpen:o,onClose:l,className:"confirm",title:c("ShareYouPhoneNumberTitle"),onCloseAnimationEnd:i,children:[c("AreYouSureShareMyContactInfoBot"),(0,te.FD)("div",{className:"dialog-buttons mt-2",children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:()=>{t&&(a({contact:h,messageList:t}),l())},children:c("OK")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:l,children:c("Cancel")})]})]})):(u=d,(0,te.FD)(X.A,{isOpen:o,onClose:l,onCloseAnimationEnd:i,className:"error",title:os(u),children:[u.hasErrorKey?(0,as.Ay)(u):(0,Dt.A)(u.message,["simple_markdown","emoji","br"]),(0,te.Y)("div",{className:"dialog-buttons mt-2",children:(0,te.Y)(Q.A,{isText:!0,onClick:l,children:c("OK")})})]})))}));var ls=i(17208);const cs=(0,n.ph)((0,s.EK)(e=>(0,Ci.Up)((0,c.nTw)(e),["notifications"]))(({notifications:e})=>{if(e.length)return(0,te.Y)("div",{id:"Notifications",children:e.map(e=>(0,te.Y)(ls.A,{notification:e},e.localId))})}));var ds=i(24585);const hs=(0,n.ph)(({url:e})=>{const{toggleSafeLinkModal:t}=(0,s.ko)(),i=(0,Ui.A)(),a=(0,n.hb)(()=>{e&&(window.open((0,ds.Tc)(e),"_blank","noopener noreferrer"),t({url:void 0}))},[t,e]),o=(0,n.hb)(()=>{t({url:void 0})},[t]),r=(0,Ri.A)(e);return(0,te.Y)(gi.A,{isOpen:Boolean(e),onClose:o,title:i("OpenUrlTitle"),textParts:(0,Dt.A)(i("OpenUrlText",{url:r},{withNodes:!0,withMarkdown:!0})),confirmLabel:i("OpenUrlConfirm"),confirmHandler:a})});var us=i(47526);const ms=(0,n.ph)(({modal:e})=>{const{closeMapModal:t}=(0,s.ko)(),{point:i,zoom:a}=e||{},o=(0,T.A)(),r=Boolean(i),l=(0,M.A)(()=>{t()}),[c,d,h,m]=(0,n.Kr)(()=>{if(!i)return[];const e=(0,us.zS)("google",i,a),t=(0,us.zS)("bing",i,a),n=(0,us.zS)("osm",i,a);return[e,t,(0,us.zS)("apple",i,a),n]},[i,a]),p=(0,M.A)(e=>{t(),window.open(e,"_blank","noopener")}),v=(0,M.A)(()=>{p(c)}),g=(0,M.A)(()=>{p(d)}),A=(0,M.A)(()=>{p(h)}),f=(0,M.A)(()=>{p(m)});return(0,te.FD)(X.A,{contentClassName:"VJDwJpsF",title:o("OpenMapWith"),isOpen:r,onClose:l,isSlim:!0,children:[(0,te.FD)("div",{className:"aYO2C2Hx",children:[(u.pz||u.MP)&&(0,te.Y)(Q.A,{fluid:!0,size:"smaller",onClick:A,children:"Apple Maps"}),(0,te.Y)(Q.A,{fluid:!0,size:"smaller",onClick:v,children:"Google Maps"}),(0,te.Y)(Q.A,{fluid:!0,size:"smaller",onClick:g,children:"Bing Maps"}),(0,te.Y)(Q.A,{fluid:!0,size:"smaller",onClick:f,children:"OpenStreetMap"})]}),(0,te.Y)("div",{className:"dialog-buttons mt-2",children:(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:l,children:o("Cancel")})})]})});var ps=i(19806);const vs=(0,n.ph)((0,s.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({modal:e,currentUser:t})=>{const{closeUrlAuthModal:i,acceptBotUrlAuth:a,acceptLinkUrlAuth:o}=(0,s.ko)(),[r,c]=(0,n.J0)(!0),[d,h]=(0,n.J0)(!0),u=(0,Ri.A)(e,!1),{domain:m,botId:p,shouldRequestWriteAccess:v}=u?.request||{},g=p?(0,s.mS)().users.byId[p]:void 0,A=(0,T.A)(),f=(0,n.hb)(()=>{e?.url&&r?(e.button?a:o)({isWriteAllowed:d}):u?.url&&window.open((0,ds.Tc)(u.url),"_blank","noopener"),i()},[e,r,i,a,o,d,u]),b=(0,n.hb)(()=>{i()},[i]),C=(0,n.hb)(e=>{c(e),h(e)},[c]);return(0,n.vJ)(()=>{m&&(c(!0),h(Boolean(v)))},[v,m]),(0,te.FD)(gi.A,{isOpen:Boolean(e?.url),onClose:b,title:A("OpenUrlTitle"),confirmLabel:A("OpenUrlTitle"),confirmHandler:f,children:[(0,Dt.A)(A("OpenUrlAlert2",u?.url),["links"]),m&&(0,te.Y)(ps.A,{className:"dialog-checkbox",checked:r,label:(0,te.Y)(te.FK,{children:(0,Dt.A)(A("Conversation.OpenBotLinkLogin",[m,(0,l.Yg)(t)]),["simple_markdown"])}),onCheck:C}),v&&(0,te.Y)(ps.A,{className:"dialog-checkbox",checked:d,label:(0,te.Y)(te.FK,{children:(0,Dt.A)(A("Conversation.OpenBotLinkAllowMessages",(0,l.Yg)(g)),["simple_markdown"])}),onCheck:h,disabled:!r})]})})),gs=1e3*o.fRl,As=["lng_weekday1","lng_weekday2","lng_weekday3","lng_weekday4","lng_weekday5","lng_weekday6","lng_weekday7"];function fs(e,t,i,n,s){const a=new Date(e,t,i),o=n&&(0,He.pU)(n),r=s&&(0,He.pU)(s);return!!(r&&a>r)||!!(o&&a<o)}function bs(e){return String(e).padStart(2,"0")}function Cs(e,t,i){return`${e}-${t+1}-${i}`}const ys=(0,n.ph)(({selectedAt:e,minAt:t,maxAt:i,isFutureMode:s,isPastMode:a,isOpen:o,withTimePicker:r,submitButtonLabel:l,secondButtonLabel:c,description:d,onClose:h,onSubmit:u,onDateChange:m,onSecondButtonClick:p})=>{const v=(0,T.A)(),g=new Date,A=(0,n.Kr)(()=>s&&!t?new Date:new Date(Math.max(t||0,0)),[s,t]),f=(0,n.Kr)(()=>a&&!i?new Date:new Date(Math.min(i||gs,gs)),[a,i]),b=(0,n.Kr)(()=>e?new Date(e):new Date,[e]),C=(0,_.A)(o),[y,S]=(0,F.A)(!1),[k,w]=(0,n.J0)(b),[N,I]=(0,n.J0)(new Date(k.getFullYear(),k.getMonth(),1)),[P,Y]=(0,n.J0)(bs(b.getHours())),[D,M]=(0,n.J0)(bs(b.getMinutes())),B=Cs(k.getFullYear(),k.getMonth(),k.getDate()),R=N.getFullYear(),L=N.getMonth(),x=s&&k.getTime()<A.getTime()||a&&k.getTime()>f.getTime();(0,n.vJ)(()=>{!C&&o&&(w(b),I(new Date(b.getFullYear(),b.getMonth(),1)),r&&(Y(bs(b.getHours())),M(bs(b.getMinutes()))))},[b,o,C,r]),(0,n.vJ)(()=>{s&&!y&&k.getTime()<A.getTime()&&(w(A),Y(bs(A.getHours())),M(bs(A.getMinutes())))},[s,y,A,k]),(0,n.vJ)(()=>{a&&!y&&k.getTime()>f.getTime()&&(w(f),Y(bs(f.getHours())),M(bs(f.getMinutes())))},[s,a,y,f,A,k]),(0,n.vJ)(()=>{if(e){const t=new Date(e);w(t),Y(bs(t.getHours())),M(bs(t.getMinutes()))}},[e]);const E=a&&R>=g.getFullYear()&&L>=g.getMonth()||f&&R>=f.getFullYear()&&L>=f.getMonth(),V=s&&R<=g.getFullYear()&&L<=g.getMonth(),{prevMonthGrid:U,currentMonthGrid:O,nextMonthGrid:K}=(0,n.Kr)(()=>function(e,t){const i=[],n=[],s=[],a=new Date;a.setDate(1),a.setMonth(t),a.setFullYear(e);const o=a.getDay()||7,r=new Date(e,t,0).getDate();for(let e=1;e<o;e++)i.push(r-o+e+1);for(;a.getMonth()===t;){const e=a.getDate();n.push(e),a.setDate(e+1)}const l=(n.length+i.length)%7;if(l>0)for(let e=1;e<=7-l;e++)s.push(e);return{prevMonthGrid:i,currentMonthGrid:n,nextMonthGrid:s}}(R,L),[L,R]),J=(0,n.Kr)(()=>l||function(e,t){const i=(0,He.A)(t,e.code);return i===(0,He.A)(new Date,e.code)?e("Conversation.ScheduleMessage.SendToday",(0,He.fU)(e,t)):e("Conversation.ScheduleMessage.SendOn",[i,(0,He.fU)(e,t)])}(v,k),[v,k,l]),G=(0,n.hb)(()=>{u(s&&k<A?A:a&&k>f?f:k)},[s,a,A,f,u,k]),j=(0,n.hb)(e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return Y(""),void(e.target.value="");const i=Math.max(0,Math.min(Number(t),23)),n=new Date(k.getTime());n.setHours(i),w(n),m?.(n);const s=bs(i);Y(s),e.target.value=s},[k,m]),z=(0,n.hb)(e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return M(""),void(e.target.value="");const i=Math.max(0,Math.min(Number(t),59)),n=new Date(k.getTime());n.setMinutes(i),w(n),m?.(n);const s=bs(i);M(s),e.target.value=s},[k,m]);return(0,te.FD)(X.A,{isOpen:o,onClose:h,className:"CalendarModal",onEnter:G,children:[(0,te.Y)("div",{className:"container",children:(0,te.FD)("div",{className:"month-selector",children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:h,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.FD)("h4",{children:[v(`lng_month${L+1}`)," ",R]}),(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",disabled:V,onClick:V?void 0:function(){I(e=>{const t=new Date(e);return t.setMonth(t.getMonth()-1),t})},children:(0,te.Y)(W.A,{name:"previous"})}),(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",disabled:E,onClick:E?void 0:function(){I(e=>{const t=new Date(e);return t.setMonth(t.getMonth()+1),t})},children:(0,te.Y)(W.A,{name:"next"})})]})}),(0,te.Y)("div",{className:"calendar-wrapper",children:(0,te.FD)("div",{className:"calendar-grid",children:[As.map(e=>(0,te.Y)("div",{className:"day-button faded weekday",children:(0,te.Y)("span",{children:v(e)})})),U.map(e=>(0,te.Y)("div",{className:"day-button disabled",children:(0,te.Y)("span",{children:e})})),O.map(e=>(0,te.Y)("div",{role:"button",tabIndex:0,onClick:()=>{return t=e,void w(e=>{const i=new Date(e);return i.setDate(t),i.setMonth(L),i.setFullYear(R),m?.(i),i});var t},className:(0,me.A)("day-button","div-button",fs(R,L,e,A,f)?"disabled":e?"clickable":"",B===Cs(R,L,e)&&"selected"),children:Boolean(e)&&(0,te.Y)("span",{children:e})})),K.map(e=>(0,te.Y)("div",{className:"day-button disabled",children:(0,te.Y)("span",{children:e})}))]})}),r&&(0,te.FD)("div",{className:"timepicker",children:[(0,te.Y)("input",{type:"text",className:"form-control",inputMode:"decimal",value:P,onChange:j,onFocus:S}),":",(0,te.Y)("input",{type:"text",className:"form-control",inputMode:"decimal",value:D,onChange:z,onFocus:S})]}),(0,te.FD)("div",{className:"footer",children:[d&&(0,te.Y)("div",{className:"description",children:d}),(0,te.FD)("div",{className:"footer",children:[(0,te.Y)(Q.A,{onClick:G,disabled:x,children:J}),c&&(0,te.Y)(Q.A,{onClick:p,isText:!0,children:c})]})]})]})}),Ss=(0,n.ph)((0,s.EK)(e=>({selectedAt:(0,c.nTw)(e).historyCalendarSelectedAt}))(({isOpen:e,selectedAt:t})=>{const{searchMessagesByDate:i,closeHistoryCalendar:a}=(0,s.ko)(),o=(0,n.hb)(e=>{i({timestamp:e.getTime()/1e3}),a()},[a,i]),r=(0,T.A)();return(0,te.Y)(ys,{isOpen:e,selectedAt:t,isPastMode:!0,submitButtonLabel:r("JumpToDate"),onClose:a,onSubmit:o})}));var ks=i(64713);const ws=(0,n.ph)((0,s.EK)((e,{userId:t})=>({user:t?(0,c.mBe)(e,t):void 0,userStatus:t?(0,c.K0y)(e,t):void 0,phoneCodeList:e.countryList.phoneCodes}))(({isOpen:e,userId:t,isByPhoneNumber:i,user:a,userStatus:o,phoneCodeList:r})=>{const{updateContact:c,importContact:d,closeNewContactDialog:h}=(0,s.ko)(),m=(0,T.A)(),p=(0,Ri.A)(a),v=(0,Ri.A)(i),g=(0,n.li)(),[A,f,b]=(0,F.A)(),[C,y]=(0,n.J0)(p?.firstName??""),[S,k]=(0,n.J0)(p?.lastName??""),[w,N]=(0,n.J0)(p?.phoneNumber??""),[I,P]=(0,n.J0)(!0),Y=Boolean(C&&(!i||w));(0,n.vJ)(()=>{e&&(f(),y(p?.firstName??""),k(p?.lastName??""),N(p?.phoneNumber??""),P(!0))},[e,f,p?.firstName,p?.lastName,p?.phoneNumber]),(0,n.vJ)(()=>{!u.TF&&A&&setTimeout(()=>{g.current?.focus()},200)},[A]);const D=(0,n.hb)(e=>{y(e.target.value)},[]),M=(0,n.hb)(e=>{N((0,ks.Ox)(r,e.target.value))},[r]),B=(0,n.hb)(e=>{k(e.target.value)},[]),R=(0,n.hb)(()=>{h(),y(""),k(""),N("")},[h]),L=(0,n.hb)(()=>{i||!t?d({firstName:C,lastName:S,phoneNumber:w}):c({userId:t,firstName:C,lastName:S,shouldSharePhoneNumber:I})},[C,d,i,S,w,I,c,t]);if(e||A)return(0,te.FD)(X.A,{className:"NewContactModal",title:m("NewContact"),isOpen:e,onClose:R,onCloseAnimationEnd:b,children:[p&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"NewContactModal__profile",dir:m.isRtl?"rtl":void 0,children:[(0,te.Y)(Mt.A,{size:"jumbo",peer:p,text:`${C} ${S}`}),(0,te.FD)("div",{className:"NewContactModal__profile-info",children:[(0,te.Y)("p",{className:"NewContactModal__phone-number",children:p?.phoneNumber?(0,ks.Ox)(r,p.phoneNumber):m("MobileHidden")}),(0,te.Y)("span",{className:"NewContactModal__user-status",dir:"auto",children:(0,l.CD)(m,p,o)})]})]}),(0,te.Y)(Z.A,{ref:g,value:C,label:m("FirstName"),tabIndex:0,onChange:D}),(0,te.Y)(Z.A,{value:S,label:m("LastName"),tabIndex:0,onChange:B}),(0,te.Y)("p",{className:"NewContactModal__help-text",children:(0,Dt.A)(m("NewContact.Phone.Hidden.Text",p?.firstName||""),["emoji","simple_markdown"])}),(0,te.Y)(ps.A,{className:"dialog-checkbox",checked:I,tabIndex:0,onCheck:P,label:m("lng_new_contact_share")}),(0,te.Y)("p",{className:"NewContactModal__help-text NewContactModal__help-text__negative",children:(0,Dt.A)(m("AddContact.SharedContactExceptionInfo",p?.firstName))})]}),v&&(0,te.FD)("div",{className:"NewContactModal__new-contact",dir:m.isRtl?"rtl":void 0,children:[(0,te.Y)(Mt.A,{size:"jumbo",text:`${C} ${S}`}),(0,te.FD)("div",{className:"NewContactModal__new-contact-fieldset",children:[(0,te.Y)(Z.A,{ref:g,value:w,inputMode:"tel",label:m("lng_contact_phone"),tabIndex:0,onChange:M}),(0,te.Y)(Z.A,{value:C,label:m("FirstName"),tabIndex:0,onChange:D}),(0,te.Y)(Z.A,{value:S,label:m("LastName"),tabIndex:0,onChange:B})]})]}),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",disabled:!Y,onClick:L,children:m("Done")}),(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:R,children:m("Cancel")})]})]})}));var Ns=i(20179),Is=i(30708),Ps=i(48894),Ys=i(71322),Fs=i(32625),Ds=i(10722);let Ms=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e}({});const Ts={top:Ms.Top,bottom:Ms.Bottom,left:Ms.Left,right:Ms.Right,topLeft:Ms.TopLeft,topRight:Ms.TopRight,bottomLeft:Ms.BottomLeft,bottomRight:Ms.BottomRight},Bs=Object.keys(Ts);let Rs;const Ls={x:0,y:0};var xs=i(36838);const Es=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).webApps,{botId:i}=(0,c.ES7)(e)||{},{modalState:n,openedWebApps:s}=t||{},a="minimized"===n;return{activeTabBot:i?(0,c.mBe)(e,i):void 0,isMinimizedState:a,openedWebApps:s}})(({activeTabBot:e,isMinimizedState:t,openedWebApps:i})=>{const{changeWebAppModalState:a,closeWebAppModal:o}=(0,s.ko)(),r=(0,T.A)(),l=(0,Ui.A)(),d=(0,n.li)(),h=(0,n.Kr)(()=>i&&Object.values(i),[i]),u=h?.length,m=(0,n.Kr)(()=>{if(!u)return[];const t=(0,s.mS)(),i=e?.id;return(0,Ci.Am)([i,...h.map(e=>e.botId)]).map(e=>e&&(0,c.mBe)(t,e)).filter(Boolean).slice(0,3)},[u,e,h]),p=(0,M.A)(()=>{o()}),v=(0,M.A)(()=>{a({state:"maximized"})});if(t)return(0,te.FD)("div",{ref:d,className:(0,me.A)("kUZmBlnN"),children:[(0,te.Y)(Q.A,{className:"SMRJmUuE",round:!0,color:"translucent",size:"tiny",ariaLabel:r("Close"),onClick:p,children:(0,te.Y)(W.A,{className:"P0P4gW6a",name:"close"})}),(0,te.Y)(bn.A,{className:"GP17QhNN",size:"mini",peers:m}),function(){const e=m.length>0&&m[0]?.firstName,t=u&&e&&u>1?l("MiniAppsMoreTabs",{botName:e,count:u-1},{pluralValue:u-1}):e;return(0,te.Y)("div",{className:"TZFjRaG4",children:t})}(),(0,te.Y)(Q.A,{className:(0,me.A)("Rax9j_TK","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:v,children:(0,te.Y)(W.A,{className:"sdbTXCxq",name:"expand-modal"})})]})}));var Vs=i(59852),_s=i(84991);const Us={container:"RFg0Ey2I","user-count-badge":"UZtJ6ZXb",userCountBadge:"UZtJ6ZXb","user-badge-icon":"pTiZFhsG",userBadgeIcon:"pTiZFhsG",name:"TzA5nqCC"},Os=(0,n.ph)((0,s.EK)((e,{chatId:t})=>({user:(0,c.mBe)(e,t)}))(function({user:e,isPopularApp:t}){const{requestMainWebView:i}=(0,s.ko)(),n=(0,Ui.A)(),a=(0,M.A)(()=>{if(!e)return;const t=e?.id;if(!t)return;const n=(0,Vs.A)();i({botId:t,peerId:t,theme:n})});if(!e)return;const o=e?.firstName,r=e?.botActiveUsers,l=r&&t?(0,$e.Vw)(n,r):void 0;return(0,te.Y)("div",{className:Us.container,onClick:a,children:(0,te.Y)(_s.A,{className:(0,me.A)(Us.avatarContainer,t&&"PopularAppGridItem"),textClassName:Us.name,badgeClassName:Us.userCountBadge,badgeIconClassName:Us.userBadgeIcon,peer:e,text:o,badgeText:l,badgeIcon:"user-filled"})})})),Ks={root:"BJV09FsC",search:"bdi8G7GR","section-title":"ex3kxgWX",sectionTitle:"ex3kxgWX","section-content":"uIZzLhEh",sectionContent:"uIZzLhEh",showMoreLink:"h_Zs9ypA"},Js=(0,ge.nF)(e=>e(),500,!0),Gs=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).globalSearch,i=t.popularBotApps?.peerIds;return{isLoading:!i&&t.fetchingStatus?.botApps,foundIds:i,recentBotIds:e.topBotApps.userIds}})(({foundIds:e,recentBotIds:t})=>{const i=(0,T.A)(),o=(0,Ui.A)(),[r,l]=(0,n.J0)(!1),{searchPopularBotApps:c}=(0,s.ko)(),d=(0,M.A)(()=>{l(e=>!e)}),[h,u]=(0,n.J0)(""),m=(0,n.Kr)(()=>e?(0,Ft.PU)({ids:e,query:h,type:"user"}):[],[e,h]),p=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&Js(()=>{c()})},[]),v=(0,n.hb)(()=>{u("")},[]);return(0,te.FD)(Tn.A,{className:(0,me.A)(Ks.root,"custom-scroll"),items:m,onLoadMore:p,itemSelector:".PopularAppGridItem",noFastList:!0,preloadBackwards:30,children:[(0,te.Y)(Rn.A,{className:Ks.search,value:h,onChange:u,onReset:v,placeholder:o("SearchApps")}),t&&!h&&(0,te.FD)("div",{className:Ks.section,children:[(0,te.FD)("div",{className:Ks.sectionTitle,children:[(0,te.Y)("span",{children:i("SearchAppsMine")}),(0,te.Y)("span",{className:Ks.showMoreLink,onClick:d,children:i(r?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")})]}),(0,te.Y)("div",{className:Ks.sectionContent,children:t.map((e,t)=>{if(r||!(t>=5))return(0,te.Y)(Os,{chatId:e})})})]}),(0,te.FD)("div",{className:Ks.section,children:[(0,te.Y)("div",{className:Ks.sectionTitle,children:o(h?"Apps":"PopularApps")}),(0,te.Y)("div",{className:Ks.sectionContent,children:m&&m.map(e=>(0,te.Y)(Os,{chatId:e,isPopularApp:!h}))})]})]})})),js=3.675*g.$,zs="jEAibDyh",Hs="ablUg8HU",$s="Wrl63uWL",qs="vOFiAq3l",Ws="KwI4XdkC",Qs="oq6HKJur",Zs="a0AI_he5",Xs="MvCwTbk_",ea=250,ta=["allow-scripts","allow-same-origin","allow-popups","allow-forms","allow-modals","allow-storage-access-by-user-activation"].join(" "),ia={ok:"OK",cancel:"Cancel",close:"Close"},na=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:n}=i||{},s=t?.modalState,a=n?e.attachMenu.bots[n]:void 0,o=n?(0,c.mBe)(e,n):void 0,r=n?(0,c.vGo)(e,n):void 0,l=r?.botInfo?.appSettings,d=e.currentUserId?(0,c.mBe)(e,e.currentUserId):void 0,h=(0,c.SJA)(e),{isPaymentModalOpen:u,status:m}=(0,c.nTw)(e).payment,{status:p,inputInvoice:v}=(0,c.nTw)(e).starsPayment,g=o?(0,c.XOs)(e,o.id):void 0,A=p||m;return{attachBot:a,bot:o,currentUser:d,theme:h,isPaymentModalOpen:u||Boolean(v),paymentStatus:A,modalState:s,botAppPermissions:g,botAppSettings:l}})(({modal:e,webApp:t,bot:i,theme:a,isPaymentModalOpen:r,paymentStatus:c,registerSendEventCallback:d,registerReloadFrameCallback:h,isTransforming:m,modalState:p,isMultiTabSupported:v,onContextMenuButtonClick:g,botAppPermissions:A,botAppSettings:f,modalHeight:b})=>{const{closeActiveWebApp:C,sendWebViewData:y,toggleAttachBot:S,openTelegramLink:k,setWebAppPaymentSlug:w,switchBotInline:N,sharePhoneWithBot:I,updateWebApp:P,resetPaymentStatus:D,openChatWithInfo:B,showNotification:R,openEmojiStatusAccessModal:L,openLocationAccessModal:x,changeWebAppModalState:E,closeWebAppModal:V,openPreparedInlineMessageModal:_}=(0,s.ko)(),[U,O]=(0,n.J0)(),[K,J]=(0,n.J0)(),[G,z,H]=(0,F.A)(!1),[$,q]=(0,n.J0)(),[Z,ee]=(0,n.J0)(!1),[ie,ne]=(0,n.J0)(!1),[ae,oe]=(0,n.J0)(),[re,le]=(0,n.J0)(),{unlockPopupsAt:ce,handlePopupOpened:de,handlePopupClosed:he}=function(){const[e,t]=(0,n.J0)(0),i=(0,n.li)(0),s=(0,n.li)(0),a=(0,M.A)(()=>{const e=Date.now();e-s.current>2e3&&(i.current=0),i.current+=1,i.current>=3&&t(e+2e3)}),o=(0,M.A)(()=>{e<Date.now()&&(s.current=Date.now())});return{unlockPopupsAt:e,handlePopupOpened:a,handlePopupClosed:o}}(),ue=(0,n.li)(),pe=(0,n.li)(),ve=(0,n.li)(),ge="fullScreen"===p,Ae="minimized"===p,fe=(0,M.A)(()=>{setTimeout(()=>{E({state:"maximized"})},350)}),be=(0,n.li)();(0,n.vJ)(()=>{be.current=document.querySelector("#portals")},[]);const[,Ce,ye]=(0,ke.Ay)(be,fe),Se=e?.activeWebAppKey?e.openedWebApps[e.activeWebAppKey]:void 0,{appName:Ne,backgroundColor:Ie}=Se||{},{url:Pe,buttonText:Ye,isBackButtonVisible:Fe}=t||{},{placeholderPath:De}=f||{},Me=Boolean(t?.isCloseModalOpen),Te=Boolean(t?.isRemoveModalOpen),Be=t&&(0,Ns.rp)(t),Re=Se&&(0,Ns.rp)(Se),Le=Se&&t&&Re===Be,xe=u.H$,Ve=void 0!==A?.geolocation,_e=Boolean(A?.geolocation),Ue=(0,M.A)(e=>{Be&&P({key:Be,update:e})}),Oe=(0,n.Kr)(()=>(0,Vs.A)(),[a]);(0,n.vJ)(()=>{le(Oe.secondary_bg_color)},[Oe]);const Ke=Oe.bg_color,[Je,Ge]=(0,n.J0)(),je="light"===a?f?.backgroundColor:f?.backgroundDarkColor;(0,n.vJ)(()=>{Ue({backgroundColor:Je||je||Ke})},[Ke,Je,je]);const ze=Oe.bg_color,[He,$e]=(0,n.J0)(),qe="light"===a?f?.headerColor:f?.headerDarkColor;(0,n.vJ)(()=>{Ue({headerColor:He||qe||ze})},[ze,He,qe]);const We=(0,n.li)(),Qe=(0,T.A)(),Xe=(0,Ui.A)(),et=e?.isModalOpen||!1,tt=Boolean(Ye),{reloadFrame:it,sendEvent:nt,sendFullScreenChanged:st,sendViewport:at,sendSafeArea:ot,sendTheme:rt}=((e,t,i,a,r,c,d)=>{const{showNotification:h,setWebAppPaymentSlug:u,openInvoice:m,closeWebApp:p,openSuggestedStatusModal:v,updateWebApp:g,updateContentSettings:A}=(0,s.ko)(),f=(0,n.li)(!1),b=(0,n.li)(),C=(0,n.li)(!1),y=(0,n.li)(),S=(0,we.A)();(0,n.vJ)(()=>{if(!e.current||!t)return;const i=()=>{d?.()},n=e.current;return n.addEventListener("load",i),()=>{n.removeEventListener("load",i)}},[d,e,t]);const k=(0,n.hb)(t=>{e.current?.contentWindow&&e.current.contentWindow.postMessage(JSON.stringify(t),"*")},[e]),w=(0,n.hb)(e=>{k({eventType:"fullscreen_changed",eventData:{is_fullscreen:e}})},[k]),N=(0,M.A)(t=>{if(!e.current)return;const i=e.current;i.src="about:blank",i.addEventListener("load",()=>{i.src=t},{once:!0})}),I=(0,n.hb)(e=>{if(f.current)return k({eventType:"reload_iframe"}),void(b.current=setTimeout(()=>{N(e)},500));N(e)},[k]),P=(0,n.hb)(t=>{if(!e.current)return;const{width:i,height:n}=e.current.getBoundingClientRect();k({eventType:"viewport_changed",eventData:{width:i,height:n,is_expanded:!0,is_state_stable:!t}})},[k,e]),Y=(0,n.hb)(()=>{e.current&&(k({eventType:"safe_area_changed",eventData:{left:0,right:0,top:0,bottom:0}}),k({eventType:"content_safe_area_changed",eventData:{left:0,right:0,top:i?js:0,bottom:0}}))},[k,i,e]),F=(0,n.hb)(()=>{k({eventType:"theme_changed",eventData:{theme_params:(0,Vs.A)()}})},[k]),D=(0,n.hb)(e=>{k({eventType:"set_custom_style",eventData:e})},[k]),T=(0,n.hb)(t=>{if(C.current)return;const i=e.current?.contentWindow;if(i===t.source)try{const e=JSON.parse(t.data),{eventType:i,eventData:n}=e;if("web_app_ready"===i&&d?.(),"web_app_close"===i&&c){const e=(0,l.rp)(c);p({key:e,skipClosingConfirmation:!0})}if("web_app_request_viewport"===i&&P(S.isResizing),"web_app_request_safe_area"===i&&Y(),"web_app_request_content_safe_area"===i&&Y(),"web_app_request_theme"===i&&F(),"iframe_ready"===i){const e=getComputedStyle(document.body).getPropertyValue("--color-scrollbar");D("* {\n  scrollbar-width: thin;\n  scrollbar-color: %SCROLLBAR_COLOR% transparent;\n}\n\n*::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n  background-color: transparent;\n}\n\n*::-webkit-scrollbar-thumb {\n  border-radius: 6px;\n  background-color: %SCROLLBAR_COLOR%;\n}\n\n*::-webkit-scrollbar-corner {\n  background-color: transparent;\n}".replace(/%SCROLLBAR_COLOR%/g,e)),f.current=Boolean(n.reload_supported)}if("iframe_will_reload"===i&&clearTimeout(b.current),"web_app_data_send"===i){if(!a)return;C.current=!0}if("web_app_read_text_from_clipboard"===i&&k({eventType:"clipboard_text_received",eventData:{req_id:n.req_id,data:null}}),"web_app_open_scan_qr_popup"===i&&h({message:"Scanning QR code is not supported in this client yet"}),"web_app_open_invoice"===i&&(u({slug:n.slug}),m({type:"slug",slug:n.slug})),"web_app_open_link"===i){const e=n.url;window.open(e,"_blank","noreferrer")}if("web_app_biometry_get_info"===i&&k({eventType:"biometry_info_received",eventData:{available:!1}}),"web_app_device_storage_clear"===i||"web_app_device_storage_get_key"===i||"web_app_device_storage_save_key"===i){const{req_id:e}=n;k({eventType:"device_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_secure_storage_clear"===i||"web_app_secure_storage_get_key"===i||"web_app_secure_storage_restore_key"===i||"web_app_secure_storage_save_key"===i){const{req_id:e}=n;k({eventType:"secure_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_start_accelerometer"===i&&k({eventType:"accelerometer_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_gyroscope"===i&&k({eventType:"gyroscope_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_device_orientation"===i&&k({eventType:"device_orientation_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_add_to_home_screen"===i&&k({eventType:"home_screen_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_check_home_screen"===i&&k({eventType:"home_screen_checked",eventData:{status:"unsupported"}}),"web_app_set_emoji_status"===i){const{custom_emoji_id:e,duration:t}=n;if(!e||"string"!=typeof e)return void k({eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}});if(t)try{BigInt(t)}catch(e){return void k({eventType:"emoji_status_failed",eventData:{error:"DURATION_INVALID"}})}if(!c)return void k({eventType:"emoji_status_failed",eventData:{error:"UNKNOWN_ERROR"}});v({webAppKey:(0,l.rp)(c),customEmojiId:e,duration:Number(t),botId:c.botId})}if("web_app_verify_age"===i){const{passed:e}=n,t=(0,s.mS)().appConfig.verifyAgeMin||o.lYi,i=n.age||0;e&&i>=t?(h({message:{key:"TitleAgeCheckSuccess"}}),A({isSensitiveEnabled:!0})):h({message:{key:"TitleAgeCheckFailed"}})}r(e)}catch(e){}},[a,k,r,D,c,F,P,Y,d,S.isResizing,e]);return(0,n.vJ)(()=>{const{width:e,height:t,isResizing:i}=S;y.current&&y.current.width===e&&y.current.height===t&&!y.current.isResizing||(y.current={width:e,height:t,isResizing:i},P(i))},[P,Y,S]),(0,n.vJ)(()=>{c?.plannedEvents?.length&&(c.plannedEvents.forEach(e=>{k(e)}),g({key:(0,l.rp)(c),update:{plannedEvents:[]}}))},[k,c]),(0,n.vJ)(()=>(window.addEventListener("message",T),()=>window.removeEventListener("message",T)),[T,e]),(0,n.vJ)(()=>{t&&e.current?.contentWindow?(P(),Y(),C.current=!1):y.current=void 0},[t,i,P,Y,e]),{sendEvent:k,sendFullScreenChanged:w,reloadFrame:I,sendViewport:P,sendSafeArea:Y,sendTheme:F}})(We,et,ge,tt,function(e){const{eventType:t,eventData:n}=e;if("web_app_request_fullscreen"===t&&((0,Y.cB)()?E({state:"fullScreen"}):nt({eventType:"fullscreen_failed",eventData:{error:"UNSUPPORTED"}})),"web_app_exit_fullscreen"===t&&bt(),"web_app_open_tg_link"===t){E({state:"minimized"});const e=o.jsp+n.path_full;k({url:e,shouldIgnoreCache:n.force_request})}if("web_app_setup_back_button"===t&&Ue({isBackButtonVisible:n.is_visible}),"web_app_setup_settings_button"===t&&Ue({isSettingsButtonVisible:n.is_visible}),"web_app_set_background_color"===t&&Ge((0,Vs.To)(n.color)?n.color:void 0),"web_app_set_header_color"===t){const e=n.color_key;$e(n.color||(e?Oe[e]:void 0))}if("web_app_set_bottom_bar_color"===t&&le(n.color),"web_app_data_send"===t&&(C(),y({bot:i,buttonText:Ye,data:n.data})),"web_app_setup_main_button"===t){const e=n.color,t=n.text_color;O({isVisible:n.is_visible&&Boolean(n.text?.trim().length),isActive:n.is_active,text:n.text,color:e,textColor:t,isProgressVisible:n.is_progress_visible})}if("web_app_setup_secondary_button"===t){const e=n.color,t=n.text_color;J({isVisible:n.is_visible&&Boolean(n.text?.trim().length),isActive:n.is_active,text:n.text,color:e,textColor:t,isProgressVisible:n.is_progress_visible,position:n.position})}if("web_app_setup_closing_behavior"===t&&Ue({shouldConfirmClosing:!0}),"web_app_open_popup"===t){if($||!n.message.trim().length||!n.buttons?.length||n.buttons.length>3||Z||ie||ce>Date.now())return void vt(void 0);q(n),de()}if("web_app_switch_inline_query"===t){const e=n.chat_types?.map(l.Xj).filter(Boolean),t=!e?.length;N({botId:i.id,query:n.query,filter:e,isSamePeer:t}),C()}if("web_app_request_phone"===t){if($||ie||ce>Date.now())return void kt();ee(!0),de()}if("web_app_request_write_access"===t){if($||Z||ce>Date.now())return void It();!async function(){if(!i)return;const e=await(0,Ze.px)("fetchBotCanSendMessage",{bot:i});e&&nt({eventType:"write_access_requested",eventData:{status:"allowed"}}),ne(!e)}(),de()}if("web_app_invoke_custom_method"===t){const{method:e,params:t,req_id:s}=n;!async function(e,t,n){const s=await(0,Ze.px)("invokeWebViewCustomMethod",{bot:i,customMethod:t,parameters:n});nt({eventType:"custom_method_invoked",eventData:{req_id:e,...s}})}(s,e,JSON.stringify(t))}if("web_app_request_file_download"===t){if(ae||ce>Date.now())return void Nt();!async function(e,t){await(0,Ze.px)("checkBotDownloadFileParams",{bot:i,url:e,fileName:t})?(oe({url:e,fileName:t}),de()):nt({eventType:"file_download_requested",eventData:{status:"cancelled"}})}(n.url,n.file_name)}if("web_app_send_prepared_message"===t){if(!i||!Be)return;const{id:e}=n;_({botId:i.id,messageId:e,webAppKey:Be})}if("web_app_request_emoji_status_access"===t){if(!i)return;L({bot:i,webAppKey:Be})}"web_app_check_location"===t&&nt({eventType:"location_checked",eventData:{available:xe,access_requested:Ve,access_granted:_e}}),"web_app_request_location"===t&&(async()=>{const e=await(0,u.Bu)(),{accessRequested:t,accessGranted:n,geolocation:s}=e;if(!n||!t)return nt({eventType:"location_requested",eventData:{available:!1}}),R({message:Qe("PermissionNoLocationPosition")}),void vt(void 0);xe?Ve?nt({eventType:"location_requested",eventData:{available:Boolean(A?.geolocation),latitude:s?.latitude,longitude:s?.longitude,altitude:s?.altitude,course:s?.heading,speed:s?.speed,horizontal_accuracy:s?.accuracy,vertical_accuracy:s?.altitudeAccuracy}}):x({bot:i,webAppKey:Be}):(R({message:Qe("PermissionNoLocationPosition")}),vt(void 0))})(),"web_app_open_location_settings"===t&&Ft()},t,z);(0,n.vJ)(()=>{Le&&d(nt)},[nt,d,Le]),(0,n.vJ)(()=>{Le&&h(it)},[it,h,Le]);const lt=G&&U?.isVisible&&U.text.trim().length>0,ct=G&&K?.isVisible&&K.text.trim().length>0,dt=(0,M.A)(()=>{Ue({isCloseModalOpen:!1})}),ht=(0,M.A)(()=>{Ue({shouldConfirmClosing:!1,isCloseModalOpen:!1}),setTimeout(()=>{C()},400)}),ut=(0,M.A)(()=>{Ue({isRemoveModalOpen:!1})}),mt=(0,M.A)(()=>{nt({eventType:"main_button_pressed"})}),pt=(0,M.A)(()=>{nt({eventType:"secondary_button_pressed"})}),vt=(0,M.A)(e=>{q(void 0),he(),nt({eventType:"popup_closed",eventData:{button_id:e}})}),gt=(0,M.A)(()=>{vt()}),At=(0,M.A)(()=>{rt()});(0,j.A)(()=>{setTimeout(()=>{At()},400)},[a]);const ft=(0,M.A)(()=>{!(0,ke.j9)()&&Le&&Ce?.()}),bt=(0,M.A)(()=>{(0,ke.j9)()&&Le&&ye?.()}),Ct=(0,M.A)(e=>{Le&&st(e)});(0,n.vJ)(()=>{ge?(ft(),Ct(!0)):(bt(),Ct(!1))},[ge]);const yt=(0,M.A)(e=>{nt({eventType:"visibility_changed",eventData:{is_visible:e}})});(0,n.vJ)(()=>{G&&yt(Boolean(Le))},[Le,G]),(0,wi.A)(([e])=>{"minimized"===p&&yt(!1),p&&"minimized"===e&&yt(!0)},[p]),(0,j.A)(([e])=>{r!==e&&t?.slug&&!r&&c&&(nt({eventType:"invoice_closed",eventData:{slug:t.slug,status:c}}),w({slug:void 0}),D())},[r,c,nt,t?.slug]);const St=(0,M.A)(()=>{S({botId:i.id,isEnabled:!1}),C()}),kt=(0,M.A)(()=>{ee(!1),he(),nt({eventType:"phone_requested",eventData:{status:"cancelled"}})}),wt=(0,M.A)(()=>{I({botId:i.id}),ee(!1),he(),nt({eventType:"phone_requested",eventData:{status:"sent"}})}),Nt=(0,M.A)(e=>{e&&(oe(void 0),he()),nt({eventType:"file_download_requested",eventData:{status:"cancelled"}})}),It=(0,M.A)(()=>{nt({eventType:"write_access_requested",eventData:{status:"cancelled"}}),ne(!1),he()}),Pt=(0,M.A)(async()=>{i&&(await(0,Ze.px)("allowBotSendMessages",{bot:i})?(nt({eventType:"write_access_requested",eventData:{status:"allowed"}}),ne(!1),he()):It())}),Yt=(0,M.A)(()=>{ae&&(oe(void 0),he(),(0,xi.A)(ae.url,ae.fileName),nt({eventType:"file_download_requested",eventData:{status:"downloading"}}))});(0,n.vJ)(()=>{et||(q(void 0),ee(!1),ne(!1),O(void 0),J(void 0),Ue({isSettingsButtonVisible:!1,shouldConfirmClosing:!1,isBackButtonVisible:!1,isCloseModalOpen:!1,isRemoveModalOpen:!1}),H())},[et]);const Ft=(0,M.A)(()=>{B({id:i.id})}),Mt=(0,Ri.A)(U?.color,!0),Tt=(0,Ri.A)(U?.textColor,!0),Bt=(0,Ri.A)(U&&Boolean(U.isActive),!0),Rt=(0,Ri.A)(U?.text,!0),Lt=(0,Ri.A)(K?.position,!0),xt=(0,Ri.A)(K?.color,!0),Et=(0,Ri.A)(K?.textColor,!0),Vt=(0,Ri.A)(K&&Boolean(K.isActive),!0),_t=(0,Ri.A)(K?.text,!0),[Ut,Ot]=(0,n.J0)(!1),[Kt,Jt]=(0,n.J0)(!0),[Gt,jt]=(0,n.J0)(!0),[zt,Ht]=(0,n.J0)(!1),[$t,qt]=(0,n.J0)(!1),[Wt,Qt]=(0,n.J0)(!1),[Zt,Xt]=(0,n.J0)(0);(0,j.A)(()=>{setTimeout(()=>{at(),ot()},m?0:400)},[$t,Gt,zt,zt,K?.position,at,m,b,ot]);const ei="top"===Lt||"bottom"===Lt,ti=ei&&zt&&$t?2:zt||$t?1:0,ii=ei||Kt||Gt?"vertical":"horizontal",ni=(0,n.li)(),si=(0,n.li)(),ai=(0,n.li)(),oi=(0,n.li)(),ri=(0,n.li)();(0,n.vJ)(()=>(ge&&et&&Boolean(Ne)?(Qt(!0),ri.current&&clearTimeout(ri.current),ri.current=setTimeout(()=>{Qt(!1),ri.current=void 0},3800)):(Qt(!1),ri.current&&(clearTimeout(ri.current),ri.current=void 0)),()=>{ri.current&&clearTimeout(ri.current)}),[ge,et,Ne]),(0,n.vJ)(()=>{ni.current&&clearTimeout(ni.current),si.current&&clearTimeout(si.current),lt&&(si.current=setTimeout(()=>{Ht(!0)},35),Jt(!1),ni.current=setTimeout(()=>{Ot(!0)},ea)),lt||(Ht(!1),ni.current=setTimeout(()=>{Jt(!0)},ea))},[lt]),(0,n.vJ)(()=>{ai.current&&clearTimeout(ai.current),oi.current&&clearTimeout(oi.current),ct&&(oi.current=setTimeout(()=>{qt(!0)},35),jt(!1),ai.current=setTimeout(()=>{Ot(!0)},ea)),ct||(qt(!1),ai.current=setTimeout(()=>{jt(!0)},ea))},[ct]),(0,n.vJ)(()=>{$t||zt||Ot(!1)},[Ot,$t,zt]);const li=(0,Mi.A)(`background-color: ${Ie||"var(--color-background)"}`,m&&"pointer-events: none;"),ci=(0,M.A)(()=>{Fe?nt({eventType:"back_button_pressed"}):(bt(),st(!1),E({state:"maximized"}),V())}),di=(0,M.A)(()=>{bt()}),hi=(0,M.A)(e=>{g(e)}),ui=(0,me.A)("BvNtfigU",Fe&&"rC2wkMIk"),mi=Wt?Ne:Qe(Fe?"Back":"Close"),pi=ve?.current;return(0,n.vJ)(()=>{Xt(ve?.current?.clientWidth||0)},[mi,pi]),(0,te.FD)("div",{ref:ue,className:(0,me.A)("LeeJZdwH",!Le&&qs,v&&"ESsGT5OD"),children:[ge&&(0,Y.cB)()&&(0,te.FD)("div",{className:"eYrhewMy",children:[(0,te.FD)("div",{ref:pe,className:Xs,onClick:ci,children:[(0,te.Y)("div",{className:"JXsuZ01s",children:(0,te.Y)("div",{className:ui})}),(0,te.Y)("span",{className:"dpZR3YT7",style:`width: ${Zt}px;`,children:(0,te.Y)(se.Ay,{activeKey:Wt?0:Fe?1:2,name:"slideFade",children:(0,te.Y)("div",{ref:ve,className:"dWDprnWa",children:mi})})})]}),(0,te.FD)("div",{className:"Tl4_05AQ",children:[(0,te.Y)("div",{className:(0,me.A)(Xs,"emOpAMBm"),tabIndex:0,role:"button","aria-label":Xe("WebAppCollapse"),onClick:di,children:(0,te.Y)(W.A,{name:"down",className:Zs})}),(0,te.Y)("div",{className:(0,me.A)(Xs,"z4C5VD5o"),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":Xe("AriaMoreButton"),onClick:hi,children:(0,te.Y)(W.A,{name:"more",className:(0,me.A)(Zs,"T58ozRyW")})})]})]}),!Ae&&(De?(0,te.Y)("svg",{className:(0,me.A)(zs,G&&$s),viewBox:"0 0 512 512",children:(0,te.Y)("path",{className:"Gx1BIECZ",d:De})}):function(){const e=(0,me.A)(zs,"Ig_t1R7i",G&&$s);return(0,te.FD)("div",{className:e,children:[(0,te.Y)("div",{className:Hs}),(0,te.Y)("div",{className:Hs}),(0,te.Y)("div",{className:Hs}),(0,te.Y)("div",{className:Hs})]})}()),(0,te.Y)("iframe",{className:(0,me.A)("OmY14FFl",Ut&&"liDRl1xT",!G&&$s),style:li,src:Pe,title:Xe("AriaMiniApp",{bot:i?.firstName}),sandbox:ta,allow:"camera; microphone; geolocation; clipboard-write;",allowFullScreen:!0,ref:We}),!Ae&&(0,te.FD)("div",{style:`background-color: ${re};`,className:(0,me.A)("mR_hsBdT","left"===Lt&&"ntESqwQ_","right"===Lt&&"q6IUFEL0","top"===Lt&&"gb4iHJ9H","bottom"===Lt&&"R_bh3GF8","horizontal"===ii&&"oYaRA7u4",1===ti&&"YfQO314y",2===ti&&"gUldkEoy"),children:[(0,te.FD)(Q.A,{className:(0,me.A)("ypxiUCFQ",$t&&!Gt&&Ws,Gt&&qs),fluid:!0,style:`background-color: ${xt}; color: ${Et}`,disabled:!Vt&&!K?.isProgressVisible,nonInteractive:K?.isProgressVisible,onClick:pt,children:[!K?.isProgressVisible&&_t,K?.isProgressVisible&&(0,te.Y)(Ee.A,{className:Qs,color:"blue"})]}),(0,te.FD)(Q.A,{className:(0,me.A)("U_ggDKn1",zt&&!Kt&&Ws,Kt&&qs),fluid:!0,style:`background-color: ${Mt}; color: ${Tt}`,disabled:!Bt&&!U?.isProgressVisible,nonInteractive:U?.isProgressVisible,onClick:mt,children:[!U?.isProgressVisible&&Rt,U?.isProgressVisible&&(0,te.Y)(Ee.A,{className:Qs,color:"white"})]})]}),$&&(0,te.FD)(X.A,{isOpen:Boolean($),title:$.title||" ",onClose:gt,hasCloseButton:!0,className:(0,me.A)("YEOURXza",!$.title?.trim().length&&"gvljUzY9"),children:[$.message,(0,te.Y)("div",{className:"dialog-buttons mt-2",children:$.buttons.map(e=>(0,te.Y)(Q.A,{className:"confirm-dialog-button",color:"destructive"===e.type?"danger":"primary",isText:!0,onClick:()=>vt(e.id),children:e.text||Qe(ia[e.type])},e.id||e.type))})]}),(0,te.Y)(gi.A,{isOpen:Z,onClose:kt,title:Qe("ShareYouPhoneNumberTitle"),text:Qe("AreYouSureShareMyContactInfoBot"),confirmHandler:wt,confirmLabel:Qe("ContactShare")}),(0,te.Y)(gi.A,{isOpen:ie,onClose:It,title:Qe("lng_bot_allow_write_title"),text:Qe("lng_bot_allow_write"),confirmHandler:Pt,confirmLabel:Qe("lng_bot_allow_write_confirm")}),(0,te.Y)(gi.A,{isOpen:Boolean(ae),title:Qe("BotDownloadFileTitle"),textParts:Xe("BotDownloadFileDescription",{bot:i?.firstName,filename:ae?.fileName},{withNodes:!0,withMarkdown:!0}),confirmLabel:Qe("BotDownloadFileButton"),onClose:Nt,confirmHandler:Yt}),(0,te.Y)(gi.A,{isOpen:Me,onClose:dt,title:Qe("lng_bot_close_warning_title"),text:Qe("lng_bot_close_warning"),confirmHandler:ht,confirmIsDestructive:!0,confirmLabel:Qe("lng_bot_close_warning_sure")}),(0,te.Y)(gi.A,{isOpen:Te,onClose:ut,title:Qe("BotRemoveFromMenuTitle"),textParts:(0,Dt.A)(Qe("BotRemoveFromMenu",i?.firstName),["simple_markdown"]),confirmHandler:St,confirmIsDestructive:!0})]})})),sa="oHX2d8Or",aa="O4NxErFX",oa="dgdyQDsZ",ra="xGefqS93",la="f7EicoVH",ca="s6pBIYMI",da="txS0KiU0",ha="XpHR_yo0",ua="DoeOewUR",ma="YRMGpqUS",pa="b13oE9uA",va={width:300,height:40},ga={width:420,height:730},Aa={width:300,height:300},fa=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:n}=i||{},s=n?e.attachMenu.bots[n]:void 0,a=n?(0,c.mBe)(e,n):void 0,o=(0,c.meB)(e),r=(0,c.SJA)(e),{miniAppsCachedPosition:l,miniAppsCachedSize:d}=(0,Is.l)(e);return{attachBot:s,bot:a,chat:o,theme:r,cachedPosition:l,cachedSize:d}})(({modal:e,chat:t,bot:i,attachBot:a,theme:r,cachedSize:l,cachedPosition:c})=>{const{closeActiveWebApp:d,closeWebAppModal:h,prolongWebView:u,toggleAttachBot:m,openChat:p,changeWebAppModalState:v,openWebAppTab:g,updateWebApp:A,openMoreAppsTab:f,closeMoreAppsTab:b,updateMiniAppCachedPosition:C,updateMiniAppCachedSize:y}=(0,s.ko)(),[S,k]=(0,n.Ul)(l||ga);function N(){return"fullScreen"===e?.modalState?w.A.get():"maximized"===e?.modalState?S():va}const{openedWebApps:I,activeWebAppKey:P,openedOrderedKeys:D,sessionKeys:B,isMoreAppsTabActive:R}=e||{},L=P?I?.[P]:void 0,{isBackButtonVisible:x,headerColor:E,backgroundColor:V,isSettingsButtonVisible:_}=L||{},U=(0,n.Kr)(()=>D?.map(e=>{const t=I[e];return{bot:(0,s.mS)().users.byId[t.botId],webApp:t,isOpen:Boolean(L&&e===(0,Ns.rp)(L))}}),[D,I,L]),{isMobile:O}=(0,Y.Ay)(),K=e?.isModalOpen||!1,J="maximized"===e?.modalState,G="minimized"===e?.modalState,j="fullScreen"===e?.modalState,z=!O,H=(0,n.li)(),$=(0,n.li)(),q=(0,n.li)(),Z=(0,M.A)(()=>H.current),ee=(0,M.A)(()=>H.current),ie=(0,M.A)(()=>q.current),{isContextMenuOpen:ne,contextMenuAnchor:se,handleContextMenu:ae,handleContextMenuClose:oe,handleContextMenuHide:re}=(0,Ds.A)(H),[le,he]=(0,n.J0)(!1),ue=$.current,ve=H.current;(0,n.vJ)(()=>{he(Boolean(z&&ue&&ve&&!j))},[z,ue,ve,j]),(0,n.vJ)(()=>{v({state:"maximized"})},[z]);const{isDragging:ge,isResizing:Ae,style:fe,size:be,position:Ce}=function(e,t,i=!0,s,a=!1,r={width:0,height:0},l){const[c,d]=(0,n.J0)(l),[h,u]=(0,n.J0)(void 0),[m,p]=(0,n.Ul)({x:0,y:0}),[v,g]=(0,n.Ul)({width:0,height:0}),[A,f]=(0,n.Ul)({x:0,y:0}),b=m(),C=A(),y=e.current,S=t.current,[k,w]=(0,F.A)(!1),[N,I]=(0,F.A)(!1),[P,Y,D]=(0,F.A)(!1),[T,B,R]=(0,F.A)(!1),[L,x,E]=(0,F.A)(!1),[V,_]=(0,n.J0)(void 0);function U(){return{width:window.innerWidth,height:window.innerHeight}}const O=(0,M.A)(e=>{a||d({x:e.x,y:e.y})}),K=(0,M.A)(()=>a?Ls:c),J=(0,M.A)(()=>{if(!h)return;const{width:e,height:t}=h,i=U();return{x:(i.width-e)/2,y:(i.height-t)/2}});(0,n.vJ)(()=>{y&&I()},[y]),(0,n.vJ)(()=>{if(!k&&h){const e=J();if(!e)return;O(e),w()}},[h,k,y]);const G=(0,M.A)(e=>{if(e instanceof MouseEvent&&0!==e.button)return;if(e.target.closest(".no-drag")||!y)return;const{x:t,y:i}=(0,_e.A)(e),{left:n,top:s}=y.getBoundingClientRect();p({x:n,y:s}),f({x:t,y:i}),Y()}),j=(0,M.A)(e=>{if(e instanceof MouseEvent&&0!==e.button)return;const t=e.target;if(!y||!t)return;const i=function(e){const t=t=>e.closest(t);if(t(o.cnh))for(const e of Bs)if(t(`.${e}`))return Ts[e]}(t);if(void 0===i)return;_(i);const{x:n,y:s}=(0,_e.A)(e),{left:a,right:r,top:l,bottom:c}=y.getBoundingClientRect();p({x:a,y:l}),g({width:r-a,height:c-l}),f({x:n,y:s}),B()}),z=(0,M.A)(()=>{D()}),H=(0,M.A)(()=>{R()});(0,n.vJ)(()=>{i||D()},[i]);const $=(e,t)=>{const i=U(),n=i.width,s=i.height,a=h.width,o=h.height;let r=e,l=t;return r<0&&(r=0),l<0&&(l=0),r+a>n&&(r=n-a),l+o>s&&(l=s-o),{x:r,y:l}},q=(0,M.A)(()=>{if(a)return;const e=N||l?c:J();if(!h||!e)return;const t=$(e.x,e.y);O(t)}),W=(0,M.A)(e=>{const t=e,i=U(),n=s.width,a=s.height;return t.width=Math.min(i.width,Math.max(n,t.width)),t.height=Math.min(i.height,Math.max(a,t.height)),t});(0,n.vJ)(()=>{if(T)return;const e=W({width:s.width,height:s.height});e&&u(e)},[s,T]);const Q=(0,M.A)(()=>{if(!h||T)return;const e=W(h);e&&u(e)});(0,n.vJ)(()=>{T||q()},[h,T]),(0,n.vJ)(()=>{const e=()=>{x(),Q(),q(),Rs&&(clearTimeout(Rs),Rs=void 0),Rs=window.setTimeout(()=>{Rs=void 0,E()},250)};return window.addEventListener("resize",e),()=>{clearTimeout(Rs),Rs=void 0,window.removeEventListener("resize",e)}},[q]);const Z=(0,M.A)(e=>{if(!P||!y)return;const{x:t,y:i}=(0,_e.A)(e),n=t-C.x,s=i-C.y,a=b.x+n,o=b.y+s;h&&d($(a,o))}),X=(0,M.A)(e=>{if(!T||!y||void 0===V)return;const{x:t,y:i}=(0,_e.A)(e),n=v(),s=Math.min(Math.max(0,t),U().width),a=Math.min(Math.max(0,i),U().height),o=s-C.x,l=a-C.y,c=b.x+n.width-r.width,h=b.y+n.height-r.height,m={x:b.x,y:b.y,width:n.width,height:n.height};V!==Ms.Left&&V!==Ms.TopLeft&&V!==Ms.BottomLeft||(m.width=Math.max(n.width-o,r.width),m.x=Math.min(m.x+o,c)),V!==Ms.Right&&V!==Ms.TopRight&&V!==Ms.BottomRight||(m.width=Math.max(n.width+o,r.width)),V!==Ms.Top&&V!==Ms.TopLeft&&V!==Ms.TopRight||(m.height=Math.max(n.height-l,r.height),m.y=Math.min(m.y+l,h)),V!==Ms.Bottom&&V!==Ms.BottomLeft&&V!==Ms.BottomRight||(m.height=Math.max(n.height+l,r.height)),u({width:m.width,height:m.height}),d({x:m.x,y:m.y})});(0,n.vJ)(()=>{let e;return S&&i&&(e=(0,pe.wJ)(S,{onCapture:G,onDrag:Z,onRelease:z,onClick:z,onDoubleClick:z})),e},[i,S]),(0,n.vJ)(()=>{const e=[];if(y&&i)for(const t of Bs){const i=y.querySelector(`.resizeHandle.${t}`);if(i){const t=(0,pe.wJ)(i,{onCapture:j,onDrag:X,onRelease:H,onClick:H,onDoubleClick:H});t&&e.push(t)}}return()=>{e.forEach(e=>e())}},[i,y]);const ee=P?"cursor: grabbing !important; ":"",te=K();if(!k||!h||!te)return{isDragging:!1,style:ee};const ie=(0,Mi.A)(`left: ${te.x}px;`,`top: ${te.y}px;`,!a&&`max-width: ${h.width}px;`,!a&&`max-height: ${h.height}px;`,"position: fixed;",(P||T||L)&&"transition: none !important;",ee);return{position:c,size:h,isDragging:P,isResizing:T,style:ie}}(H,$,le,N(),j,function(){if("maximized"===e?.modalState)return Aa}(),c),ye=Ce?.x,Se=Ce?.y;(0,n.vJ)(()=>{ge||void 0===ye||void 0===Se||C({position:{x:ye,y:Se}})},[ge,ye,Se]),(0,n.vJ)(()=>{!ge&&be&&J&&y({size:be})},[ge,J,be]);const ke=be||N(),we=ke.width,Ne=ke.height;(0,n.vJ)(()=>{Ae&&k({width:we,height:Ne})},[Ne,we,Ae,k]);const Ie=(0,T.A)(),Pe=(0,Ui.A)(),{queryId:Ye}=L||{},Fe=I?Object.values(I).length:0;(0,Fs.A)(()=>{I&&Object.keys(I).forEach(e=>{const i=I[e];i.queryId&&u({botId:i.botId,queryId:i.queryId,peerId:i.peerId||t.id,replyInfo:i.replyInfo})})},Ye?45e3:void 0,!0);const De=(0,n.li)(null),Me=(0,n.li)(null),Te=(0,M.A)(e=>{De.current=e}),Be=(0,M.A)(e=>{De.current&&De.current(e)}),Re=(0,M.A)(e=>{Me.current=e}),Le=(0,M.A)(e=>{Me.current&&Me.current(e)}),xe=(0,M.A)(()=>{Be({eventType:"settings_button_pressed"})}),Ee=(0,M.A)(()=>{Le(L.url)}),Ve=(0,M.A)(()=>{h()}),Ue=(0,M.A)(()=>{b()}),Oe=(0,M.A)(()=>{Fe>1?d():h()}),Ke=(0,M.A)(()=>{if(a){const e=(0,Ns.rp)(L);A({key:e,update:{isRemoveModalOpen:!0}})}else m({botId:i.id,isEnabled:!0})}),Je=(0,M.A)(()=>{x?Be({eventType:"back_button_pressed"}):Ve()}),Ge=(0,M.A)(()=>{v({state:"minimized"})}),je=(0,M.A)(()=>{v({state:"fullScreen"})}),ze=(0,M.A)(()=>{f()}),He=(0,M.A)(e=>{g({webApp:e.webApp})}),$e=(0,M.A)(()=>{p({id:i.id})}),We=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.Y)(Q.A,{className:(0,me.A)(z?"gkji2_RB":"kKPD09tc",t&&"active"),round:!0,ripple:!O,size:z?"tiny":"smaller",color:"translucent",onClick:e,ariaLabel:"More actions",children:(0,te.Y)(W.A,{name:"more"})}),[O,z]);function Qe(){return(0,te.FD)(te.FK,{children:[t&&i&&t.id!==i.id&&(0,te.Y)(de.A,{icon:"bots",onClick:$e,children:Ie("BotWebViewOpenBot")}),(0,te.Y)(de.A,{icon:"reload",onClick:Ee,children:Ie("WebApp.ReloadPage")}),_&&(0,te.Y)(de.A,{icon:"settings",onClick:xe,children:Ie("Settings")}),i?.isAttachBot&&(0,te.Y)(de.A,{icon:a?"stop":"install",onClick:Ke,destructive:Boolean(a),children:Ie(a?"WebApp.RemoveBot":"WebApp.AddToAttachmentAdd")})]})}function Ze(){return(0,te.Y)(qe.A,{isOpen:ne,anchor:se,ref:q,className:(0,me.A)(z?da:"web-app-more-menu","with-menu-transitions"),getTriggerElement:Z,getMenuElement:ie,getRootElement:ee,autoClose:!0,onClose:oe,onCloseAnimationEnd:re,children:Qe()})}const Xe=(0,me.A)("RuJ3d9N6",x&&"IWA50OWU"),et=(0,n.Kr)(()=>{if(R)return"color-text";if(!E)return;const{r:e,g:t,b:i}=(0,Ys.E2)(E),n=(0,Ps.LS)([e,t,i]);return("dark"===r?255-n:n)>128?"color-text":"color-background"},[E,r,R]);function tt(e){return(0,te.Y)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,te.Y)("path",{className:"bOuMHiVw","fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 16V0C16 12 12 16 0 16H16Z"})})}const it=(0,n.li)();function nt(e){return(0,me.A)(o.jQ1,e)}return(0,xs.A)(it,!K||G||!it.current),(0,te.FD)(X.A,{dialogRef:H,className:(0,me.A)("XWfkIDLY",z&&"gBVR7Hec",G&&"dJ1Ld_PX",j&&"ciSTWz16"),dialogStyle:z?fe:void 0,dialogContent:le&&!G?(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{className:nt("top")}),(0,te.Y)("div",{className:nt("bottom")}),(0,te.Y)("div",{className:nt("left")}),(0,te.Y)("div",{className:nt("right")}),(0,te.Y)("div",{className:nt("topLeft")}),(0,te.Y)("div",{className:nt("topRight")}),(0,te.Y)("div",{className:nt("bottomLeft")}),(0,te.Y)("div",{className:nt("bottomRight")})]}):void 0,isOpen:K,isLowStackPriority:!0,onClose:Ve,header:(0,te.Y)("div",{ref:$,children:z?J?(0,te.FD)("div",{className:(0,me.A)("modal-header","multiTab"),style:(0,Mi.A)(et&&`--color-header-text: var(--${et})`),children:[(0,te.Y)(Q.A,{className:"GE5AkJOU",round:!0,color:"translucent",size:"tiny",ariaLabel:Ie(x?"Back":"Close"),onClick:Je,children:(0,te.Y)("div",{className:Xe})}),(0,te.FD)("div",{className:"X18WbDa5",ref:it,children:[U?.map(e=>e.isOpen?function(){const e=(0,Mi.A)(et&&`--color-header-text: var(--${et})`,E&&`--active-tab-background: ${E}`);return(0,te.FD)("div",{className:sa,style:e,children:[tt(la),(0,te.FD)("div",{className:aa,children:[(0,te.FD)("div",{className:"z39ojrWc",children:[(0,te.Y)(Mt.A,{size:"mini",peer:i}),(0,te.Y)(We,{onTrigger:ae,isOpen:ne})]}),a?.shortName??i?.firstName,(0,te.Y)("div",{className:oa}),(0,te.Y)(Q.A,{className:ra,round:!0,color:"translucent",size:"tiny",ariaLabel:Ie("Close"),onClick:Oe,children:(0,te.Y)(W.A,{className:ua,name:"close"})})]}),tt(ca)]})}():(0,te.Y)(Mt.A,{className:"tI6TE6HP",size:"mini",peer:e.bot,onClick:()=>He(e)})),R&&(0,te.FD)("div",{className:sa,children:[tt(la),(0,te.FD)("div",{className:aa,children:[(0,te.Y)("div",{className:"Obu3ui67",children:(0,te.Y)(W.A,{className:pa,name:"add"})}),Pe("OpenApp"),(0,te.Y)("div",{className:oa}),(0,te.Y)(Q.A,{className:ra,round:!0,color:"translucent",size:"tiny",ariaLabel:Ie("Close"),onClick:Ue,children:(0,te.Y)(W.A,{className:ua,name:"close"})})]}),tt(ca)]})]}),Ze(),(0,te.FD)("div",{className:"qK4q0Sat",children:[!R&&(0,te.Y)(Q.A,{className:(0,me.A)("cEuW1_hJ","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:ze,children:(0,te.Y)(W.A,{className:pa,name:"add"})}),!R&&(0,te.Y)(Q.A,{className:(0,me.A)(ha,"otlJULGy","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:je,children:(0,te.Y)(W.A,{className:ma,name:"expand-modal"})}),(0,te.Y)(Q.A,{className:(0,me.A)(ha,"no-drag"),round:!0,color:"translucent",size:"tiny",onClick:Ge,children:(0,te.Y)(W.A,{className:ma,name:"collapse-modal"})})]})]}):(0,te.Y)(Es,{}):(0,te.FD)("div",{className:"modal-header",style:(0,Mi.A)(E&&`background-color: ${E}`,et&&`--color-header-text: var(--${et})`),children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ie(x?"Back":"Close"),onClick:Je,children:(0,te.Y)("div",{className:Xe})}),(0,te.Y)("div",{className:"modal-title",children:a?.shortName??i?.firstName}),!R&&(0,te.Y)(ce.A,{className:(0,me.A)(z?da:"web-app-more-menu","with-menu-transitions"),trigger:We,positionX:z?"left":"right",children:Qe()})]})}),style:`background-color: ${V||"var(--color-background)"}`,noBackdrop:!0,noBackdropClose:!0,children:[j&&Ze(),I&&B?.map(t=>(0,te.Y)(na,{modal:e,registerSendEventCallback:Te,registerReloadFrameCallback:Re,webApp:I[t],isTransforming:ge||Ae,onContextMenuButtonClick:ae,isMultiTabSupported:z,modalHeight:Ne},t)),R&&(0,te.Y)(Gs,{})]})})),ba=(0,n.ph)(({bot:e,type:t,shouldRequestWriteAccess:i})=>{const{cancelBotTrustRequest:a,markBotTrusted:o}=(0,s.ko)(),[r,c]=(0,n.J0)(i||!1),d=(0,T.A)(),h=(0,n.hb)(()=>{o({botId:e.id,isWriteAllowed:r})},[o,r,e]),u=(0,n.hb)(()=>{a()},[]),m=d("game"===t?"AppName":"BotOpenPageTitle"),p=(0,n.Kr)(()=>{switch(t){case"game":return d("BotPermissionGameAlert",(0,l.Yg)(e));case"webApp":return d("BotOpenPageMessage",(0,l.Yg)(e));default:return d("BotWebViewStartPermission")}},[e,t,d]);return(0,te.FD)(gi.A,{isOpen:Boolean(e),onClose:u,title:m,confirmHandler:h,children:[(0,Dt.A)(p,["simple_markdown"]),i&&(0,te.Y)(ps.A,{className:"dialog-checkbox",checked:r,label:(0,Dt.A)(d("WebApp.AddToAttachmentAllowMessages",e?.firstName),["simple_markdown"]),onCheck:c})]})}),Ca=(0,n.ph)(({modal:e})=>{const{confirmAttachBotInstall:t,cancelAttachBotInstall:i}=(0,s.ko)(),a=e?.bot,[r,l]=(0,n.J0)(!1),c=(0,T.A)(),d=(0,n.hb)(()=>{t({isWriteAllowed:Boolean(a?.shouldRequestWriteAccess)})},[t,a]);(0,n.vJ)(()=>{a&&l(!1)},[a]);const h=(0,n.Kr)(()=>{const e=c("lng_mini_apps_disclaimer_button").split("{link}"),t=c("lng_mini_apps_disclaimer_link");return[e[0],(0,te.Y)("a",{href:o.Pje,target:"_blank",rel:"noopener noreferrer",children:t}),e[1]]},[c]);return(0,te.FD)(gi.A,{isOpen:Boolean(a),onClose:i,title:c("lng_mini_apps_disclaimer_title"),confirmHandler:d,isConfirmDisabled:!r,children:[(0,Dt.A)(c("lng_mini_apps_disclaimer_text",a?.shortName),["simple_markdown"]),(0,te.Y)(ps.A,{className:"dialog-checkbox",checked:r,label:h,onCheck:l}),(0,Dt.A)(c("WebBot.Account.Desclaimer.Desc",a?.shortName),["simple_markdown"])]})}),ya=(0,n.ph)(({folder:e})=>{const{closeDeleteChatFolderModal:t,deleteChatFolder:i,openDeleteChatFolderModal:a}=(0,s.ko)(),o=(0,T.A)(),r=Boolean(e),l=(0,_.A)(e)||e,c=l?.hasMyInvites,d=(0,n.hb)(()=>{t(),c?a({folderId:l.id,isConfirmedForChatlist:!0}):i({id:l.id})},[c,l]);return(0,te.Y)(gi.A,{isOpen:r,onClose:t,text:o(c?"FilterDeleteAlertLinks":"FilterDeleteAlert"),confirmLabel:o("Delete"),confirmHandler:d,confirmIsDestructive:!0})});var Sa=i(64520),ka=i(17142),wa=i(66833),Na=i(87412),Ia=i(38777);const Pa={root:"Wn7D2H1e",text:"IQ1U2TrZ",header:"F6qqXRvD",description:"ILLaH6qQ",icon:"DzGwbpu5","font-icon":"Pa9h5mh3",fontIcon:"Pa9h5mh3"},Ya=["#F2862D","#EB7B4D","#E46D72","#DD6091","#CC5FBA","#B464E7","#9873FF","#768DFF","#55A5FC","#52B0C9","#4FBC93","#4CC663"].map(Ys.E2),Fa=(0,n.ph)(({icon:e,isFontIcon:t,title:i,text:n,index:s,count:a,section:o,onClick:r})=>{const l=s/a*Ya.length,c=Ya[Math.floor(l)],d=Ya[Math.ceil(l)]??c,{r:h,g:u,b:m}=(0,Ys.dD)(c,d,.5),p=(0,M.A)(()=>{r?.(o)});return(0,te.FD)(di.A,{buttonClassName:Pa.root,onClick:p,inactive:!r,children:[t?(0,te.Y)(W.A,{name:e,className:Pa.fontIcon,style:`--item-color: rgb(${h},${u},${m})`}):(0,te.Y)("img",{src:e,className:Pa.icon,alt:"",style:`--item-color: rgb(${h},${u},${m})`,draggable:!1}),(0,te.FD)("div",{className:Pa.text,children:[(0,te.Y)("div",{className:Pa.title,children:(0,Dt.A)(i,["br"])}),(0,te.Y)("div",{className:Pa.description,children:n})]})]})});var Da=i(57446);const Ma="cqNhvdib",Ta="wDzTWXzO",Ba=(0,n.ph)(({length:e,active:t,onSelectSlide:i})=>{const s=Math.max(0,Math.min(e-8,t-4)),a=s===e-8-1,o=s===e-8,r=0===s,l=1===s,c=Math.min(e,8),d=(0,n.hb)(()=>{i(t+1)},[t,i]),h=(0,n.hb)(()=>{i(t-1)},[t,i]),m=Math.min(8,e);return(0,te.FD)("div",{children:[!u.TF&&(0,te.Y)(Q.A,{className:(0,me.A)(Ma,0===t&&Ta),color:"translucent",disabled:0===t,round:!0,onClick:h,children:(0,te.Y)(W.A,{name:"previous"})}),(0,te.Y)("div",{className:"HmY1pYD9",style:`--start-from: ${s}; --length: ${e}; --count: ${m};`,children:Array(e).fill(void 0).map((e,n)=>{const d=n,h=n===s+c-1&&!o&&!a,u=n===s+c-2&&!a&&!o||n===s+c-1&&a,m=n===s&&!r&&!l,p=n===s+1&&!r&&!l||n===s&&l,v=n<s||n>=s+c;return(0,te.Y)("div",{onClick:()=>i(n),className:(0,me.A)("Ac0pMX9w",d===t&&"NYDxCNdz",(u||p)&&"yDo_8Y7X",(h||m||v)&&"bhODNwmU",v&&"O9pyrgj0")})})}),!u.TF&&(0,te.Y)(Q.A,{className:(0,me.A)(Ma,t===e-1&&Ta,"hIgQCprt"),color:"translucent",round:!0,disabled:t===e-1,onClick:d,children:(0,te.Y)(W.A,{name:"next"})})]})}),Ra="Hy5kWx0p",La=(0,n.ph)(({leftValue:e,rightValue:t,className:i,floatingBadgeIcon:n,rightStyle:s})=>{const a=(0,T.A)();return(0,te.FD)("div",{className:(0,me.A)("u84X0r2z",i),children:[n&&(0,te.FD)("div",{className:"hPi4fICJ",children:[(0,te.Y)(W.A,{name:n,className:"XkiOXdMP"}),(0,te.Y)("div",{className:"iC3LJrvy",dir:a.isRtl?"rtl":void 0,children:e}),(0,te.Y)("div",{className:"jufjjcX9",children:(0,te.Y)("svg",{width:"26",height:"9",viewBox:"0 0 26 9",fill:"none",children:(0,te.Y)("path",{d:"M0 0H26H24.4853C22.894 0 21.3679 0.632141 20.2426 1.75736L14.4142 7.58579C13.6332 8.36684 12.3668 8.36683 11.5858 7.58579L5.75736 1.75736C4.63214 0.632139 3.10602 0 1.51472 0H0Z",fill:"#7E85FF"})})})]}),(0,te.FD)("div",{className:(0,me.A)(Ra,"scGr4JS9"),children:[(0,te.Y)("div",{className:"OejVAPj6 YaiSoFKE YaiSoFKE",dir:a.isRtl?"rtl":void 0,children:a("LimitFree")}),!n&&(0,te.Y)("div",{className:"RJosx238 YaiSoFKE",children:e})]}),(0,te.FD)("div",{className:(0,me.A)(Ra,"nPaUalQf"),style:s,children:[(0,te.Y)("div",{className:"COQdFBQk YaiSoFKE YaiSoFKE",dir:a.isRtl?"rtl":void 0,children:a("LimitPremium")}),(0,te.Y)("div",{className:"BEq3jFlz YaiSoFKE YaiSoFKE",children:t})]})]})}),xa=[91,160,255],Ea=[197,100,243],Va=(0,n.ph)(({title:e,description:t,leftValue:i,rightValue:s,colorStepProgress:a})=>{const o=(0,n.Kr)(()=>xa.map((e,t)=>(0,ve.Cc)(e,Ea[t],a)),[a]);return(0,te.FD)("div",{className:"ZXp65Wgy",children:[(0,te.Y)("div",{className:"W1xG3pjS",children:e}),(0,te.Y)("div",{className:"b_CBXIkT",children:t}),(0,te.Y)(La,{leftValue:i,rightValue:s,rightStyle:`background: rgb(${o.join(",")})`})]})});var _a=i(67054),Ua=i(18104);const Oa=({size:e,realIndex:t,canPlay:i,sticker:s,index:a,maxLength:o,onClick:r,onEnded:l})=>{const c=(0,z.A)(`sticker${s.id}`),d=(0,z.A)(`sticker${s.id}?size=f`),h=0===a,[u,m,p]=(0,F.A)(h),v=e-.6*e,g=3*v,A=3.2*v,f=a/o*(2*Math.PI),b=h?1:.66,C=Math.cos(f)*g-2.8*v,y=Math.sin(f)*A,S=(0,M.A)(()=>{r(t)}),k=(0,M.A)(()=>{p(),l(t)});return(0,n.vJ)(()=>{h&&m()},[h,m]),(0,te.FD)(te.FK,{children:[h&&(0,te.Y)(Ua.A,{className:"Stdz4UIW ogaoEAcn",tgsUrl:d,play:i,isLowPriority:!0,noLoop:!0,size:.8*e,style:`--x: calc(${C}px - 10%); --y: ${y}px;`}),(0,te.Y)(Ua.A,{className:"ogaoEAcn",tgsUrl:c,play:i&&u,noLoop:!0,size:.6*e,style:`--x: ${C}px; --y: ${y}px; --opacity: ${b}`,onClick:S,onEnded:k})]})},Ka=(0,n.ph)((0,s.EK)(e=>({stickers:e.stickers.premium.stickers}))(({stickers:e,isActive:t})=>{const i=(0,n.li)(),[s,a]=(0,n.J0)(0),[o,r]=(0,n.J0)(0),l=e?.slice(0,15),c=(0,M.A)(e=>{a(-e)}),d=(0,M.A)(e=>{0===(0,_a.A)(l.length,e+s)&&setTimeout(()=>{a(e=>(0,_a.A)(l.length,e+1))},150)});return(0,n.vJ)(()=>{const e=i.current;e&&r(e.closest(".modal-dialog").clientWidth)},[]),(0,te.Y)("div",{className:"O1fqNCy0",ref:i,children:Boolean(o)&&l?.map((e,i)=>(0,te.Y)(Oa,{size:o,sticker:e,realIndex:i,index:(i+s+l.length)%l.length,maxLength:l.length,onClick:c,onEnded:d,canPlay:t}))})}));var Ja=i(38691);const Ga=["#34C578","#3CA3F3"],ja=["#C9EB38","#09C167"],za=.125*g.$,Ha=.25*g.$,$a=4*g.$,qa=Math.PI/4,Wa=2*Math.PI*.1,Qa=qa-Wa/2,Za=qa+Wa/2;function Xa({canvas:e,size:t,strokeWidth:i=za,colorStops:n,segmentsCount:s,readSegmentsCount:a=0,withExtraGap:o=!1,readSegmentColor:r,dpr:l}){s>45&&(a=Math.round(a*(45/s)),s=45);const c=l,d=l,h=e.getContext("2d");if(!h)return;const u=t*c,m=i*d;e.width=u,e.height=u;const p=u/2,v=(u-m)/2,g=2*Math.PI/s,A=2*Math.PI*.02,f=h.createLinearGradient(0,0,Math.ceil(u*Math.cos(Math.PI/2)),Math.ceil(u*Math.sin(Math.PI/2)));1===n.length?(f.addColorStop(0,n[0]),f.addColorStop(1,n[0])):n.forEach((e,t)=>{f.addColorStop(t/(n.length-1),e)}),h.lineCap="round",h.clearRect(0,0,u,u),Array.from({length:s}).forEach((e,t)=>{const i=t<a;let n=t*g-Math.PI/2+A/2,l=n+g-(s>1?A:0);if(h.strokeStyle=i?r:f,h.lineWidth=m*(i?.5:1),o){if(n>=Qa&&l<=Za)return;n<Qa&&l>Za?(h.beginPath(),h.arc(p,p,v,Za,l),h.stroke(),l=Qa):n<Qa&&l>Qa?l=Qa:n<Za&&l>Za&&(n=Za)}h.beginPath(),h.arc(p,p,v,n,l),h.stroke()})}(0,n.ph)((0,s.EK)((e,{peerId:t})=>{const i=(0,c._bp)(e,t),n=(0,c.SJA)(e);return{peerStories:i?.byId,storyIds:i?.orderedIds,lastReadId:i?.lastReadId,appTheme:n}})(function({size:e,className:t,peerStories:i,storyIds:s,lastReadId:a,withExtraGap:o,appTheme:r,colors:l}){const c=(0,n.li)(),d=(0,Ja.A)(),h=e>$a,u=h?Ha:za,m=e+u+(h?.25*g.$:0),p=(0,n.Kr)(()=>(s||[]).reduce((e,t)=>(e.total+=1,a&&t<=a&&(e.read+=1),e),{total:0,read:0}),[a,s]),v=(0,n.Kr)(()=>!(!i||!s?.length)&&s.some(e=>{const t=i[e];if(!t||!("isForCloseFriends"in t))return!1;const n=a&&t.id<=a;return t.isForCloseFriends&&!n}),[a,i,s]);if((0,n.Nf)(()=>{c.current&&Xa({canvas:c.current,size:m,strokeWidth:u,segmentsCount:p.total,colorStops:l||(v?ja:Ga),readSegmentsCount:p.read,withExtraGap:o,readSegmentColor:"dark"===r?"#737373":"#C4C9CC",dpr:d})},[r,v,m,p.read,p.total,o,d,l,e,u]),p.total)return(0,te.Y)("canvas",{ref:c,className:(0,me.A)("story-circle",t),style:`max-width: ${m}px; max-height: ${m}px;`})}));const eo=["#A667FF","#55A5FF"],to={stories_order:"PremiumStoriesPriority",stories_stealth:"PremiumStoriesStealth",stories_views:"PremiumStoriesViews",stories_timer:"lng_premium_stories_subtitle_expiration",stories_save:"PremiumStoriesSaveToGallery",stories_caption:"lng_premium_stories_subtitle_caption",stories_link:"lng_premium_stories_subtitle_links"},io={stories_order:"PremiumStoriesPriorityDescription",stories_stealth:"PremiumStoriesStealthDescription",stories_views:"PremiumStoriesViewsDescription",stories_timer:"PremiumStoriesExpirationDescription",stories_save:"PremiumStoriesSaveToGalleryDescription",stories_caption:"PremiumStoriesCaptionDescription",stories_link:"PremiumStoriesFormattingDescription"},no={stories_order:"story-priority",stories_stealth:"eye-crossed-outline",stories_views:"eye-outline",stories_timer:"timer",stories_save:"arrow-down-circle",stories_caption:"story-caption",stories_link:"link-badge"},so=Object.keys(to),ao=.25*g.$,oo=Mt.R.giant+ao,ro=(0,n.ph)((0,s.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({currentUser:e})=>{const t=(0,n.li)(),i=(0,T.A)(),s=(0,Ja.A)();(0,n.Nf)(()=>{t.current&&Xa({canvas:t.current,size:oo,strokeWidth:ao,segmentsCount:8,colorStops:eo,readSegmentsCount:0,readSegmentColor:"transparent",dpr:s})},[s]);const{handleScroll:a,isAtBeginning:o}=Mn(),r=oo;return(0,te.FD)("div",{className:"mFElmm7a",children:[(0,te.FD)("div",{className:"Jjbochk6",children:[(0,te.Y)(Mt.A,{forPremiumPromo:!0,peer:e,size:"giant"}),(0,te.Y)("canvas",{className:"ChteQ9C3",ref:t,style:`max-width: ${r}px; max-height: ${r}px`})]}),(0,te.Y)("div",{className:"d2ayix6L",children:i("UpgradedStories")}),(0,te.FD)("div",{className:(0,me.A)("ensyCeMe",!o&&"iN1T0a2Y","custom-scroll"),onScroll:a,children:[so.map((e,t)=>(0,te.Y)(Fa,{title:i(to[e]),text:i(io[e]),icon:no[e],isFontIcon:!0,index:t,count:so.length,section:e},e)),(0,te.Y)("div",{className:"DFbZJafh",children:i("lng_premium_stories_about_mobile")})]})]})})),lo={root:"Ot0dA1yZ",wrapper:"yxSAGAc1",down:"Jcy6cDoc",frame:"Vn81yTTJ",video:"rrVJClLL"},co=i.p+"DeviceFrame.79271ee0fa60a7b6a1aa.svg",ho=(0,n.ph)(({videoId:e,isReverseAnimation:t,isDown:i,videoThumbnail:n,index:s,isActive:a})=>{const o=(0,z.A)(`document${e}`),r=(0,_i.A)(n.dataUri),l=(0,Ki.A)(o);return(0,te.Y)("div",{className:lo.root,children:(0,te.FD)("div",{className:(0,me.A)(lo.wrapper,t&&lo.reverse,i&&lo.down),id:`premium_feature_preview_video_${s}`,children:[(0,te.Y)("img",{src:co,alt:"",className:lo.frame,draggable:!1}),(0,te.Y)("canvas",{ref:r,className:lo.video}),(0,te.Y)(an.A,{canPlay:a,className:(0,me.A)(lo.video,l),src:o,disablePictureInPicture:!0,playsInline:!0,muted:!0,loop:!0})]})})}),uo="a7IoUtQG",mo="gubS9KP1",po="iZLwcL8v",vo="A7YHY8qF",go={double_limits:"PremiumPreviewLimits",infinite_reactions:"PremiumPreviewReactions2",premium_stickers:"PremiumPreviewStickers",animated_emoji:"PremiumPreviewEmoji",no_ads:"PremiumPreviewNoAds",voice_to_text:"PremiumPreviewVoiceToText",profile_badge:"PremiumPreviewProfileBadge",faster_download:"PremiumPreviewDownloadSpeed",more_upload:"PremiumPreviewUploads",advanced_chat_management:"PremiumPreviewAdvancedChatManagement",animated_userpics:"PremiumPreviewAnimatedProfiles",emoji_status:"PremiumPreviewEmojiStatus",translations:"PremiumPreviewTranslations",stories:"PremiumPreviewStories",saved_tags:"PremiumPreviewTags2",last_seen:"PremiumPreviewLastSeen",message_privacy:"PremiumPreviewMessagePrivacy",effects:"Premium.MessageEffects",todo:"PremiumPreviewTodo"},Ao={double_limits:"PremiumPreviewLimitsDescription",infinite_reactions:"PremiumPreviewReactions2Description",premium_stickers:"PremiumPreviewStickersDescription",no_ads:"PremiumPreviewNoAdsDescription",animated_emoji:"PremiumPreviewEmojiDescription",voice_to_text:"PremiumPreviewVoiceToTextDescription",profile_badge:"PremiumPreviewProfileBadgeDescription",faster_download:"PremiumPreviewDownloadSpeedDescription",more_upload:"PremiumPreviewUploadsDescription",advanced_chat_management:"PremiumPreviewAdvancedChatManagementDescription",animated_userpics:"PremiumPreviewAnimatedProfilesDescription",emoji_status:"PremiumPreviewEmojiStatusDescription",translations:"PremiumPreviewTranslationsDescription",stories:"PremiumPreviewStoriesDescription",saved_tags:"PremiumPreviewTagsDescription2",last_seen:"PremiumPreviewLastSeenDescription",message_privacy:"PremiumPreviewMessagePrivacyDescription",effects:"Premium.MessageEffectsInfo",todo:"PremiumPreviewTodoDescription"},fo={channels:"GroupsAndChannelsLimitTitle",dialogFolderPinned:"PinChatsLimitTitle",channelsPublic:"PublicLinksLimitTitle",savedGifs:"SavedGifsLimitTitle",stickersFaved:"FavoriteStickersLimitTitle",aboutLength:"BioLimitTitle",captionLength:"CaptionsLimitTitle",dialogFilters:"FoldersLimitTitle",dialogFiltersChats:"ChatPerFolderLimitTitle",recommendedChannels:"SimilarChannelsLimitTitle",moreAccounts:"ConnectedAccountsLimitTitle"},bo={channels:"GroupsAndChannelsLimitSubtitle",dialogFolderPinned:"PinChatsLimitSubtitle",channelsPublic:"PublicLinksLimitSubtitle",savedGifs:"SavedGifsLimitSubtitle",stickersFaved:"FavoriteStickersLimitSubtitle",aboutLength:"BioLimitSubtitle",captionLength:"CaptionsLimitSubtitle",dialogFilters:"FoldersLimitSubtitle",dialogFiltersChats:"ChatPerFolderLimitSubtitle",recommendedChannels:"SimilarChannelsLimitSubtitle",moreAccounts:"ConnectedAccountsLimitSubtitle"},Co=(0,n.ph)(({promo:e,initialSection:t,isPremium:i,limits:s,premiumPromoOrder:a,subscriptionOption:l,onBack:c,onClickSubscribe:d})=>{const h=(0,T.A)(),u=(0,Ui.A)(),m=(0,n.li)(),[p,v]=(0,n.J0)(o.O2i.indexOf(t)),[g,A]=(0,n.J0)(0),[f,b,C]=(0,F.A)(),[y,S]=(0,n.J0)(!0),[k,w]=(0,n.J0)(!1),N=(0,_.A)(t),I=(0,n.Kr)(()=>a?a.filter(e=>o.O2i.includes(e)):o.O2i,[a]),P=(0,n.Kr)(()=>{if(!l)return;const{amount:e,months:t,currency:n}=l,s=Math.floor(e/t);return i?u("OK"):u("SubscribeToPremium",{price:(0,ka.vv)(u,s,n)},{withNodes:!0})},[i,u,l]),Y=(0,M.A)(()=>{d(t)});function D(e){const{scrollTop:t,clientHeight:i,scrollHeight:n}=e.currentTarget;S(t<=20),w(t>=n-i-20)}(0,n.vJ)(()=>{const e=m.current;if(!e||N===t)return;const i=I.indexOf(t);v(i),b(),(0,Da.A)(e,e.clientWidth*i,0).then(C)},[p,I,t,N]);const B=(0,M.A)(async e=>{const t=m.current;t&&(v(e),b(),await(0,Da.A)(t,t.clientWidth*e,800),C())}),R=I[p],L="double_limits"!==R&&"stories"!==R;return(0,te.FD)("div",{className:"oyUTEj8I",children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",className:(0,me.A)("njYoMrKM",L&&"SB4pczOo"),color:L?"translucent-white":"translucent",onClick:c,ariaLabel:h("Back"),children:(0,te.Y)(W.A,{name:"arrow-left"})}),(0,te.Y)("div",{className:"dIVBSdWi"}),(0,te.Y)("div",{className:(0,me.A)("sJubG84j","no-scrollbar"),onScroll:function(e){const t=e.currentTarget,{clientWidth:i,scrollLeft:n}=t,s=Math.round(n),a=s%i/i,o=Math.ceil((s+1)/i);A(o);const l=t.querySelector("#premium_feature_preview_video_"+(o-1)),c=t.querySelector(`#premium_feature_preview_video_${o}`);if((0,r.RK)(()=>{t.style.setProperty("--scroll-progress",a.toString()),t.style.setProperty("--abs-scroll-progress",Math.abs(a).toString()),l&&(0,ln.dH)(l,"reverse",!1),c&&(0,ln.dH)(c,"reverse",!0)}),f)return;const d=Math.round(s/i);v(d)},ref:m,children:I.map((t,i)=>{if("double_limits"===t)return(0,te.FD)("div",{className:(0,me.A)(mo,"U7ePgVBR"),children:[(0,te.Y)("h2",{className:(0,me.A)("mz2Hmd83",y&&"AgmNOqi7"),children:h(go.double_limits)}),(0,te.Y)("div",{className:(0,me.A)("n_rowVPI","custom-scroll"),onScroll:D,children:o.M$8.map((e,t)=>{const i=s?.[e][0].toString(),n=s?.[e][1].toString();return(0,te.Y)(Va,{title:h(fo[e]),description:h(bo[e],n),leftValue:i,rightValue:n,colorStepProgress:t/(o.M$8.length-1)})})})]});if("premium_stickers"===t)return(0,te.FD)("div",{className:mo,children:[(0,te.Y)("div",{className:uo,children:(0,te.Y)(Ka,{isActive:p===i})}),(0,te.Y)("h1",{className:po,children:h(go.premium_stickers)}),(0,te.Y)("div",{className:vo,children:(0,Dt.A)(h(Ao.premium_stickers),["br"])})]});if("stories"===t)return(0,te.Y)("div",{className:(0,me.A)(mo,"J1M6fEdo"),children:(0,te.Y)(ro,{})});const n=e.videoSections.indexOf(t);if(-1===n)return;const a="todo"===e.videoSections[n];return(0,te.FD)("div",{className:mo,children:[(0,te.Y)("div",{className:uo,children:(0,te.Y)(ho,{isActive:p===i,videoId:e.videos[n].id,videoThumbnail:e.videos[n].thumbnail,isDown:o.jhT.includes(t),index:i,isReverseAnimation:i===g})}),(0,te.Y)("h1",{className:po,children:a?u(go[e.videoSections[n]],void 0,{withNodes:!0,renderTextFilters:["br"]}):h(go[e.videoSections[n]])}),(0,te.Y)("div",{className:vo,children:(0,Dt.A)(a?u(Ao[e.videoSections[n]],void 0,{withNodes:!0,renderTextFilters:["br"]}):h(Ao[e.videoSections[n]]),["br"])})]})})}),(0,te.FD)("div",{className:(0,me.A)("yN2611rA",(k||0!==p)&&"rCHMABcD"),children:[(0,te.Y)(Ba,{length:o.O2i.length,active:p,onSelectSlide:B}),Boolean(P)&&(0,te.Y)(Q.A,{className:(0,me.A)("EPfM7AgT"),isShiny:!i,withPremiumGradient:!i,onClick:i?c:Y,children:P})]})]})}),yo=(0,n.ph)(({option:e,checked:t,fullMonthlyAmount:i,onChange:s,className:a,isGiveaway:o})=>{const r=(0,T.A)(),{months:l,amount:c,currency:d}=e,h="users"in e?e.users:void 0,u=Math.floor(c/l),m=h?h>1:void 0,p=(0,n.Kr)(()=>i&&i>u?Math.ceil(100-u/(i/100)):void 0,[i,u]),v=(0,n.hb)(e=>{e.target.checked&&s(l)},[l,s]);return(0,te.FD)("label",{className:(0,me.A)(o?"PkseWxFK":"qZA6S2kc",t&&!o&&"EJOQwnRj",a),dir:r.isRtl?"rtl":void 0,children:[(0,te.Y)("input",{className:"WOEkhx6R",type:"radio",name:"subscription_option",value:l,checked:t,onChange:v}),(0,te.FD)("div",{className:"BHUCScsU",children:[(0,te.FD)("div",{className:"DfYCMUkL",children:[Boolean(p)&&(0,te.FD)("span",{className:(0,me.A)("ublijP0j","uqDlP3Zt"),title:r("GiftDiscount"),children:[" ","−",p,"%"]}),r("Months",l)]}),(0,te.Y)("div",{className:"poxOXJ2o",children:o||m?`${(0,ka.Ad)(c,d,r.code)} x ${h}`:r("PricePerMonth",(0,ka.Ad)(u,d,r.code))}),(0,te.Y)("div",{className:"IGMrERf_",children:(0,ka.Ad)(c,d,r.code)})]})]})}),So="yKm9hKQP",ko=i.p+"PremiumAds.a758f19ece91fe91318e.svg",wo=i.p+"PremiumBadge.1c630afcfd1112ad16d0.svg",No=i.p+"PremiumChats.89d9d315638e283ca895.svg",Io=i.p+"PremiumEffects.4eab9caad8e9c276842d.svg",Po=i.p+"PremiumEmoji.26515017c8f6dc4f3f67.svg",Yo=i.p+"PremiumFile.884dd3865acfe594fc61.svg",Fo=i.p+"PremiumLastSeen.9575a548770d23785846.svg",Do=i.p+"PremiumLimits.08701cb6df3cf756c5f7.svg",Mo=i.p+"PremiumMessagePrivacy.950cab3e87c60c5733a6.svg",To=i.p+"PremiumReactions.7fee56ab6b58c82fd15e.svg",Bo=i.p+"PremiumSpeed.d0a43b6780c411c2f84a.svg",Ro=i.p+"PremiumStatus.c42f9c4b68f9c2c4537a.svg",Lo=i.p+"PremiumStickers.7b5a8531a41b43d0da12.svg",xo=i.p+"PremiumTags.3b187054cc90f8e16cb7.svg",Eo=i.p+"PremiumTranslate.cb2dcbb898d96cb35469.svg",Vo=i.p+"PremiumVideo.288cb61931e33d913f0a.svg",_o=i.p+"PremiumVoice.b3a2893dbe481108ab94.svg",Uo=8*g.$,Oo={stories:Ro,double_limits:Do,infinite_reactions:To,premium_stickers:Lo,animated_emoji:Po,no_ads:ko,voice_to_text:_o,profile_badge:wo,faster_download:Bo,more_upload:Yo,advanced_chat_management:No,animated_userpics:Vo,emoji_status:Ro,translations:Eo,saved_tags:xo,last_seen:Fo,message_privacy:Mo,effects:Io,todo:wo},Ko=(0,n.ph)((0,s.EK)(e=>{const{premiumModal:t}=(0,c.nTw)(e),i=t?.fromUserId?(0,c.mBe)(e,t.fromUserId):void 0,n=i?.emojiStatus?(0,c.O8F)(e,i.emojiStatus.documentId):void 0,s=n?(0,c.ycM)(e,n.stickerSetInfo):void 0;return{currentUserId:e.currentUserId,promo:t?.promo,isSuccess:t?.isSuccess,isGift:t?.isGift,monthsAmount:t?.monthsAmount,gift:t?.gift,fromUser:i,fromUserStatusEmoji:n,fromUserStatusSet:s,toUser:t?.toUserId?(0,c.mBe)(e,t.toUserId):void 0,initialSection:t?.initialSection,isPremium:(0,c.g29)(e),limitChannels:(0,Sa.B)(e,"channels"),limitFolders:(0,Sa.B)(e,"dialogFilters"),limitPins:(0,Sa.B)(e,"dialogFolderPinned"),limitLinks:(0,Sa.B)(e,"channelsPublic"),limits:e.appConfig.limits,premiumSlug:e.appConfig.premiumInvoiceSlug,premiumBotUsername:e.appConfig.premiumBotUsername,premiumPromoOrder:e.appConfig.premiumPromoOrder}})(({isOpen:e,currentUserId:t,fromUser:i,fromUserStatusEmoji:a,fromUserStatusSet:r,promo:c,initialSection:d,isPremium:h,limitChannels:u,limitLinks:m,limitFolders:p,limitPins:v,limits:g,premiumSlug:A,premiumBotUsername:f,isSuccess:b,isGift:C,toUser:y,monthsAmount:S,premiumPromoOrder:k,gift:w})=>{const N=(0,n.li)(),{closePremiumModal:I,openInvoice:P,requestConfetti:Y,openTelegramLink:F,loadStickers:D,openStickerSet:B}=(0,s.ko)(),R=(0,T.A)(),L=(0,Ui.A)(),[x,E]=(0,n.J0)(!0),[V,_]=(0,n.J0)(d),[U,O]=(0,n.J0)();(0,n.vJ)(()=>{e?d&&_(d):(E(!0),_(void 0))},[e,d]);const K=(0,M.A)(e=>{_(e)}),J=(0,M.A)(()=>{_(void 0)}),G=(0,M.A)(e=>{N.current&&(A?P({type:"slug",slug:A}):f&&(F({url:`${o.jsp}${f}?start=${e||"promo"}`}),I()))}),z=(0,M.A)(()=>{U?G(String(U.months)):G()}),H=(0,M.A)(e=>{const t=c?.options.find(t=>t.months===e);O(t)}),$=(0,M.A)(()=>{const t=N.current;if(t&&e){const{top:e,left:i,width:n,height:s}=t.querySelector(".modal-content").getBoundingClientRect();Y({top:e,left:i,width:n,height:s,withStars:!0})}});(0,n.vJ)(()=>{b&&$()},[b,$]),(0,j.A)(([e])=>{e!==h&&$()},[h,$]);const q=(0,n.Kr)(()=>k?k.filter(e=>o.O2i.includes(e)):o.O2i,[k]);(0,n.vJ)(()=>{a&&!r&&D({stickerSetInfo:a.stickerSetInfo})},[D,a,r]),(0,n.vJ)(()=>{const[e]=c?.options??[];O(e)},[c]);const Z=(0,M.A)(()=>{r&&B({stickerSetInfo:r})}),ee=(0,n.Kr)(()=>{const e=c?.options.find(e=>1===e.months);if(e)return Number(e.amount)},[c]),ie=(0,n.Kr)(()=>{if(!U)return;const{amount:e,months:t,currency:i}=U,n=Math.floor(e/t);return(0,ka.vv)(L,n,i)},[U,L]);if(c&&(!a||r))return(0,te.Y)(X.A,{className:"sfbpMFHM",onClose:I,isOpen:e,dialogRef:N,children:(0,te.Y)(se.Ay,{name:"slide",activeKey:V?1:0,className:"ELNkgPve",children:V?(0,te.Y)(Co,{initialSection:V,onBack:J,promo:c,onClickSubscribe:G,isPremium:h,limits:g,premiumPromoOrder:k,subscriptionOption:U}):(0,te.FD)("div",{className:(0,me.A)("ZpOIPrhp","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;E(t<=150)},children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",className:"XyN3eWog",color:"translucent",onClick:()=>I(),ariaLabel:R("Close"),children:(0,te.Y)(W.A,{name:"close"})}),function(){if(w){const e=(0,wa.yQ)(w);return(0,te.Y)(Ia.A,{model:"sticker",sticker:e,color:"purple",title:ne(),description:(0,Dt.A)(ae(),["simple_markdown","emoji"]),className:"lzalivui"})}return a?(0,te.FD)(te.FK,{children:[(0,te.Y)(Na.A,{className:"mQwvY9LA",onClick:Z,documentId:a.id,isBig:!0,size:Uo}),(0,te.Y)("h2",{className:(0,me.A)("y71v6ECL",r&&"xw_GbDj7"),children:ne()}),(0,te.Y)("div",{className:"cUcKXV3j",children:(0,Dt.A)(ae(),["simple_markdown","emoji"])})]}):(0,te.Y)(Ia.A,{model:"swaying-star",color:"purple",title:ne(),description:(0,Dt.A)(ae(),["simple_markdown","emoji"]),className:"z0zfJObh"})}(),!h&&!C&&(0,te.Y)("div",{className:"xZC_Oajr",children:c?.options.map(e=>(0,te.Y)(yo,{className:"gygsbDbE",option:e,onChange:H,fullMonthlyAmount:ee,checked:U?.months===e.months},e.amount))}),(0,te.Y)("div",{className:(0,me.A)("Bc_F0RKb",x&&"ltXo0Xi7"),children:(0,te.Y)("h2",{className:"xysPdANX",children:R("TelegramPremium")})}),(0,te.FD)("div",{className:(0,me.A)("c3Ee2oSo",h&&"yWEHoJOL"),children:[q.map((e,t)=>{const i="todo"===e;return(0,te.Y)(Fa,{title:i?L(go[e]):R(go[e]),text:"double_limits"===e?R(Ao[e],[u,p,v,m,4]):i?L(Ao[e]):R(Ao[e]),icon:Oo[e],index:t,count:q.length,section:e,onClick:K},e)}),(0,te.FD)("div",{className:(0,me.A)(So,"l1WlNpmu"),dir:R.isRtl?"rtl":void 0,children:[(0,te.Y)("p",{children:(0,Dt.A)(R("AboutPremiumDescription"),["simple_markdown"])}),(0,te.Y)("p",{children:(0,Dt.A)(R("AboutPremiumDescription2"),["simple_markdown"])})]}),function(){if(c&&(!C||i?.id!==t))return(0,te.Y)("div",{className:So,dir:R.isRtl?"rtl":void 0,children:(0,un.fd)({text:c.statusText,entities:c.statusEntities})})}()]}),!h&&U&&(0,te.Y)("div",{className:"nCnlO9UZ",children:(0,te.Y)(Q.A,{className:"c1tMxuFH",isShiny:!0,withPremiumGradient:!0,onClick:z,children:R("SubscribeToPremium",ie)})})]})})});function ne(){if(w)return L("PremiumGiftHeader");if(C)return(0,Dt.A)(i?.id===t?R("TelegramPremiumUserGiftedPremiumOutboundDialogTitle",[(0,l.Yg)(y),S]):R("TelegramPremiumUserGiftedPremiumDialogTitle",[(0,l.Yg)(i),S]),["simple_markdown","emoji"]);if(r&&i){const e=R("lng_premium_emoji_status_title").replace("{user}",(0,l.Yg)(i)),[t,n]=e.split("{link}"),s=r.thumbCustomEmojiId?(0,te.Y)(Na.A,{className:"Y0jTcadE",documentId:r.thumbCustomEmojiId}):void 0,a=(0,te.FD)("span",{className:"FLzl2ng5",onClick:Z,children:[s,(0,Dt.A)(r.title)]});return[(0,Dt.A)(t),a,(0,Dt.A)(n)]}return(0,Dt.A)(i?R("TelegramPremiumUserDialogTitle",(0,l.Yg)(i)):R(h?"TelegramPremiumSubscribedTitle":"TelegramPremium"),["simple_markdown","emoji"])}function ae(){return w&&"starGiftUnique"!==w.type&&w.perUserTotal?L("DescriptionGiftPremiumRequired2",{count:w.perUserTotal},{pluralValue:w.perUserTotal}):C?i?.id===t?R("TelegramPremiumUserGiftedPremiumOutboundDialogSubtitle",(0,l.Yg)(y)):R("TelegramPremiumUserGiftedPremiumDialogSubtitle"):R(r?"TelegramPremiumUserStatusDialogSubtitle":i?"TelegramPremiumUserDialogSubtitle":h?"TelegramPremiumSubscribedSubtitle":"TelegramPremiumSubtitle")}}));var Jo=i(24956),Go=i(31722);const jo="ItemPickerItem",zo=(0,n.ph)(({className:e,isSearchable:t,searchInputId:i,items:s,filterValue:a,notFoundText:o,isLoading:l,noScrollRestore:c,filterPlaceholder:d,isViewOnly:h,itemInputType:u,itemClassName:m,withDefaultPadding:p,forceRenderAllItems:v,onFilterChange:g,onDisabledClick:A,onLoadMore:f,...b})=>{const C=(0,T.A)(),y=(0,n.li)(),S=b.allowMultiple,k=S?b.lockedSelectedValues:void 0,w=S?b.lockedUnselectedValues:void 0;(0,n.vJ)(()=>{if(!t)return;const e=window.setTimeout(()=>{(0,r.YS)(()=>{y.current?.focus()})},500);return()=>{window.clearTimeout(e)}},[t]);const N=(0,n.Kr)(()=>S?b.selectedValues:b.selectedValue?[b.selectedValue]:yi.p,[S,b.selectedValue,b.selectedValues]),I=(0,n.Kr)(()=>new Set(k),[k]),P=(0,n.Kr)(()=>new Set(w),[w]),Y=(0,n.Kr)(()=>{if(a)return s.map(e=>e.value);const e=[],t=[],i=[];return s.forEach(n=>{I.has(n.value)?e.push(n):P.has(n.value)?i.push(n):t.push(n)}),e.concat(t,i).map(e=>e.value)},[a,s,I,P]),F=(0,M.A)(e=>{if(S){const t=N.slice(),i=t.indexOf(e);return i>=0?t.splice(i,1):t.push(e),void b.onSelectedValuesChange?.(t)}b.onSelectedValueChange?.(e)}),[D,B]=(0,jn.A)(f,Y,Boolean(v||a)),R=(0,M.A)(e=>{const{value:t}=e.currentTarget;g?.(t)}),L=(0,n.hb)(e=>{const t=s.find(t=>t.value===e);if(!t)return;const{label:i,subLabel:n,isLoading:a}=t,o=P.has(e),r=I.has(e),l=o||r,c=N.includes(e);return(0,te.Y)(Qn.A,{className:(0,me.A)(jo,m),title:i,subtitle:n,disabled:l,inactive:h,ripple:!0,inputElement:l?(0,te.Y)(W.A,{name:"lock-badge"}):"radio"===u?(0,te.Y)(Jo.A,{checked:c,disabled:l,isLoading:a,onlyInput:!0}):"checkbox"===u?(0,te.Y)(ps.A,{checked:c,disabled:l,isLoading:a,onlyInput:!0}):void 0,onClick:()=>F(e),onDisabledClick:A&&(()=>A(e,r))},e)},[s,P,I,N,h,A,u,m]);return(0,te.FD)("div",{className:(0,me.A)(Go.A.container,e),children:[t&&(0,te.Y)("div",{className:(0,me.A)(Go.A.header,"custom-scroll"),dir:C.isRtl?"rtl":void 0,children:(0,te.Y)(Z.A,{id:i,ref:y,value:a,onChange:R,placeholder:d||C("Search")})}),D?.length?(0,te.Y)(Tn.A,{className:(0,me.A)(Go.A.pickerList,p&&Go.A.padded,"custom-scroll"),items:D,itemSelector:`.${jo}`,onLoadMore:B,noScrollRestore:c,children:D.map(e=>L(e))}):l||!D||D.length?(0,te.Y)($n.A,{}):(0,te.Y)("p",{className:Go.A.noResults,children:o||C("SearchEmptyViewTitle")})]})}),Ho={root:"wzzA3MFh",pickerSelector:"xhujrq9i",pickerTitle:"YuRK4e7S",picker:"YF9nLkCK",footer:"ATCZ2Q5G"},$o=(0,n.ph)(({isOpen:e,onClose:t,onSubmit:i,countryList:a,selectionLimit:o})=>{const{showNotification:r}=(0,s.ko)(),l=(0,T.A)(),[c,d]=(0,n.J0)([]),h=(0,_.A)(c)===c,u=(0,n.Kr)(()=>a?a.filter(e=>!e.isHidden&&"FT"!==e.iso2).map(({iso2:e,defaultName:t})=>({value:e,label:t})):[],[a]),m=(0,M.A)(e=>{o&&e.length>o?r({message:l("BoostingSelectUpToWarningCountries",o)}):d(e)}),p=(0,M.A)(()=>{i(c),t()});return(0,te.FD)(X.A,{className:Ho.root,isOpen:e,onClose:t,onEnter:p,children:[(0,te.Y)("div",{className:Ho.container,children:(0,te.FD)("div",{className:Ho.pickerSelector,children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:t,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("h4",{className:Ho.pickerTitle,children:l("BoostingSelectCountry")})]})}),(0,te.Y)("div",{className:(0,me.A)(Ho.main,"custom-scroll"),children:(0,te.Y)(zo,{className:Ho.picker,items:u,selectedValues:c,onSelectedValuesChange:m,noScrollRestore:h,allowMultiple:!0,itemInputType:"checkbox"})}),(0,te.Y)("div",{className:Ho.footer,children:(0,te.Y)(Q.A,{onClick:p,children:l("SelectCountries.OK")})})]})});var qo=i(1526),Wo=i(96530),Qo=i(11124),Zo=i(34642);const Xo=(0,n.ph)(({isOpen:e,giveawayChatId:t,selectionLimit:i,initialSelectedIds:a,onSelectedIdsConfirmed:o,onClose:r})=>{const{showNotification:c}=(0,s.ko)(),d=(0,T.A)(),[h,u]=(0,n.J0)(void 0),[m,p]=(0,n.J0)(""),[v,g,A]=(0,F.A)(),[f,b]=(0,n.J0)(a);(0,n.vJ)(()=>{b(a)},[a]);const C=(0,n.Kr)(()=>{const e=(0,s.mS)(),i=e.chats.byId,{active:n,archived:a}=e.chats.listIds,o=(n||[]).concat(a||[]);return(0,Ci.Am)(o).map(e=>i[e]).filter(e=>e&&((0,l.WX)(e)||(0,l.Vs)(e))&&e.id!==t).map(e=>e.id)},[t]),y=(0,n.Kr)(()=>{const e=C?(0,Ft.PU)({ids:C,query:m,type:"chat"}):[];return(0,Jn.A)(e,!1,f)},[C,m,f]),S=(0,M.A)(e=>{const t=(0,s.mS)().chats.byId,n=e.filter(e=>!f.includes(e)).find(e=>{const i=t[e];return i&&!(0,l.gA)(i)});f?.length>=i?c({message:d("BoostingSelectUpToWarningChannelsPlural",i)}):n?(u(n),g()):b(e)}),k=(0,M.A)(()=>{h&&b((0,Ci.Am)([...f,h])),A()}),w=(0,M.A)(()=>{o(f),r()});return(0,te.FD)(Zo.A,{isOpen:e,onClose:r,title:d("RequestPeer.ChooseChannelTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Save"),onConfirm:w,onEnter:w,children:[(0,te.Y)(Si.A,{itemIds:y,selectedIds:f,filterValue:m,filterPlaceholder:d("Search"),onSelectedIdsChange:S,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}),(0,te.Y)(gi.A,{title:d("BoostingGiveawayPrivateChannel"),text:d("BoostingGiveawayPrivateChannelWarning"),confirmLabel:d("Add"),isOpen:v,onClose:A,confirmHandler:k})]})}),er=(0,n.ph)(({option:e,checked:t,name:i,text:n,img:s,isLink:a,onChange:o,onClickAction:r,className:l,userNames:c,selectedMemberIds:d})=>{const h=(0,T.A)();let u=h(n);a&&d?.length&&(u=d.length>2?d.length.toString():c);const m=(0,M.A)(t=>{t.target.checked&&o(e)}),p=(0,M.A)(()=>{r?.()});return(0,te.FD)("label",{className:(0,me.A)("w3OGYFKn",l),dir:h.isRtl?"rtl":void 0,role:"button",tabIndex:0,children:[(0,te.Y)("input",{className:"xy4AclZa",type:"radio",name:"giveaway_option",value:e,checked:t,onChange:m,onClick:e=>e.stopPropagation()}),(0,te.FD)("div",{className:"TTgSI7Xh",children:[(0,te.Y)("img",{className:"lGhZJbMF",src:s,alt:"",draggable:!1}),(0,te.FD)("div",{className:"sEt7TF59",children:[(0,te.Y)("h3",{className:"u4NzVBBi",children:h(i)}),a?(0,te.FD)("div",{className:"y7XfPOoG",onClick:p,children:[(0,te.Y)("span",{children:u}),(0,te.Y)(W.A,{name:"next"})]}):(0,te.Y)("span",{className:"kt2ZKZ6j",children:u})]})]})]})}),tr=(0,n.ph)((0,s.EK)((e,{giveawayChatId:t})=>{const i=t?(0,c.AWZ)(e,t):void 0;return i?{members:i.members,adminMembersById:i.adminMembersById}:{members:void 0,adminMembersById:void 0}})(({isOpen:e,selectionLimit:t,members:i,adminMembersById:a,initialSelectedIds:o,onSelectedIdsConfirmed:r,onClose:c})=>{const{showNotification:d}=(0,s.ko)(),h=(0,T.A)(),[u,m]=(0,n.J0)(""),[p,v]=(0,n.J0)(o);(0,n.vJ)(()=>{v(o)},[o]);const g=(0,n.Kr)(()=>{const e=(0,s.mS)(),{byId:t,statusesById:n}=e.users;if(!i?.length)return[];const o=a&&new Set(Object.keys(a)),r=(0,l.UB)(i.map(({userId:e})=>e),t,n);return o?r.filter(e=>!o.has(e)):r},[a,i]),A=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId,t=g?(0,Ft.PU)({ids:g,query:u,type:"user"}):[];return(0,Jn.A)((0,Ci.Am)(t).filter(t=>{const i=e[t];return!i||!(0,l.tv)(i)}))},[g,u]),f=(0,M.A)(e=>{e.length>t?d({message:h("BoostingSelectUpToWarningUsers",t)}):v(e)}),b=(0,M.A)(()=>{r(p),c()});return(0,te.Y)(Zo.A,{isOpen:e,onClose:c,title:h("BoostingAwardSpecificUsers"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:h("Save"),onConfirm:b,onEnter:b,children:(0,te.Y)(Si.A,{itemIds:A,selectedIds:p,filterValue:u,filterPlaceholder:h("Search"),onSelectedIdsChange:f,onFilterChange:m,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"})})})),ir="rZRDMqUL",nr="JjDLNrKG",sr="p5Hn4Q6E",ar="rniPcuiP",or="G9H3tm6D",rr="xKl2UeV8",lr="HLx3wTBD",cr="Ftr7zf2v",dr="Ce0Ob2tg",hr="rDFQAfTt",ur="LZ3vPzak",mr="Z9QJQ6IS",pr="ldn4mh2T";var vr=i(72078),gr=i(68153),Ar=i(65741),fr=i(45318);const br=i.p+"PremiumStar.39c1ff364d35554f4b80.svg",Cr={3:gr,6:vr,12:Ar},yr=(0,n.ph)((0,s.EK)(e=>{const{giveawayModal:t}=(0,c.nTw)(e),i=t?.chatId,n=i?(0,c.hds)(e,i):void 0,s=n&&(0,l.WX)(n);return{chatId:i,gifts:t?.gifts,selectedMemberList:t?.selectedMemberIds,selectedChannelList:t?.selectedChannelIds,giveawayBoostPerPremiumLimit:e.appConfig.giveawayBoostsPerPremium,isStarsGiftEnabled:e.appConfig.isStarsGiftEnabled,userSelectionLimit:e.appConfig.giveawayAddPeersMax,countrySelectionLimit:e.appConfig.giveawayCountriesMax,countryList:e.countryList.general,prepaidGiveaway:t?.prepaidGiveaway,isChannel:s,starsGiftOptions:t?.starOptions}})(({chatId:e,gifts:t,isOpen:i,isChannel:a,selectedMemberList:r,selectedChannelList:c,giveawayBoostPerPremiumLimit:d=o.CQG,countryList:h,prepaidGiveaway:u,countrySelectionLimit:m=o.y67,userSelectionLimit:p=o.qbC,isStarsGiftEnabled:v,starsGiftOptions:g})=>{const A=(0,n.li)(),{closeGiveawayModal:f,openInvoice:b,openPremiumModal:C,launchPrepaidGiveaway:y,launchPrepaidStarsGiveaway:S}=(0,s.ko)(),k=(0,T.A)(),[w,N,I]=(0,F.A)(),[P,Y,D]=(0,F.A)(),[B,R,L]=(0,F.A)(),[x,E,V]=(0,F.A)(),[_,U,O]=(0,F.A)(),K=[{name:"Premium.Title",text:"BoostingWinnersRandomly",value:"premium_giveaway",img:vr,actions:"createPremiumGiveaway",isLink:!0,onClickAction:()=>{E()}}];v&&K.push({name:"TelegramStars",text:"BoostingWinnersRandomly",value:"stars_giveaway",img:fr,actions:"createStarsGiveaway",isLink:!1});const[J,G]=(0,n.J0)(Date.now()+2592e5),[j,z]=(0,n.J0)(!0),[H,$]=(0,n.J0)(5),[q,ie]=(0,n.J0)(K[0].value),[ne,se]=(0,n.J0)(),[ae,oe]=(0,n.J0)("all"),[re,le]=(0,n.J0)(),[ce,de]=(0,n.J0)([]),[he,ue]=(0,n.J0)([]),[pe,ve]=(0,n.J0)([]),[ge,Ae]=(0,n.J0)(!1),[fe,be]=(0,n.J0)(!1),[Ce,ye]=(0,n.J0)(void 0),[Se,ke]=(0,n.J0)(void 0),[we,Ne]=(0,n.J0)(void 0),Ie="premium_giveaway"===q,Pe="stars_giveaway"===q,Ye=Ie&&!ce.length?H:ce.length,Fe=Ye*d,De=ne?.yearlyBoosts,Me=(0,n.Kr)(()=>[{value:"all",label:k(a?"BoostingAllSubscribers":"BoostingAllMembers"),subLabel:pe&&pe.length>0?k("Giveaway.ReceiverType.Countries",pe.length):k("BoostingFromAllCountries")},{value:"new",label:k(a?"BoostingNewSubscribers":"BoostingNewMembers"),subLabel:pe&&pe.length>0?k("Giveaway.ReceiverType.Countries",pe.length):k("BoostingFromAllCountries")}],[a,k,pe]),Te=k("Months",re),Be="starsGiveaway"===u?.type,Re="giveaway"===u?.type,Le=(0,n.Kr)(()=>t?.find(e=>e.months===re&&e.users===Ye),[t,re,Ye]),xe=(0,n.Kr)(()=>g?.find(e=>Be&&e.stars===we?.stars),[we,g,Be]),Ee=(0,n.Kr)(()=>t?.filter(e=>e.users===Ye&&e.currency!==o.OUy),[t,Ye]),Ve=(0,n.Kr)(()=>{const e=Ee?.reduce((e,t)=>t.amount<e.amount?t:e,Ee[0]);return e&&Math.floor(e.amount/e.months)},[Ee]),_e=(0,n.Kr)(()=>(0,Ci.Am)(t?.filter(e=>e.currency!==o.OUy)?.map(e=>e.users)||[]).sort((e,t)=>e-t),[t]),Ue=(0,n.Kr)(()=>(0,Ci.Am)(ne?.winners?.map(e=>e.users)||[]).sort((e,t)=>e-t),[ne]);(0,n.vJ)(()=>{i&&t?.length&&!Be&&le(t?.[0].months)},[i,t,Be]),(0,n.vJ)(()=>{i&&g?.length&&!Re&&se(g?.[0])},[i,g,Re]),(0,n.vJ)(()=>{i&&Be&&($(u.quantity),Ne(u))},[i,Be,u]),(0,n.vJ)(()=>{i&&Re&&($(u.quantity),ke(u),le(u.months))},[i,Re,u]),(0,n.vJ)(()=>{r&&de(r)},[r]),(0,n.vJ)(()=>{c&&ue(c)},[c]);const Oe=(0,M.A)(()=>{C()}),Ke=(0,M.A)(()=>{Ne(void 0),ke(void 0),se(void 0),le(void 0),$(5),f()}),Je=(0,M.A)(()=>{b(Ie?ce?.length?{type:"giftcode",boostChannelId:e,userIds:ce,currency:Le.currency,amount:Le.amount,option:Le}:{type:"giveaway",chatId:e,additionalChannelIds:he,isOnlyForNewSubscribers:"new"===ae,countries:pe,areWinnersVisible:ge,prizeDescription:Ce,untilDate:J/1e3,currency:Le.currency,amount:Le.amount,option:Le}:{type:"starsgiveaway",chatId:e,additionalChannelIds:he,isOnlyForNewSubscribers:"new"===ae,countries:pe,areWinnersVisible:ge,prizeDescription:Ce,untilDate:J/1e3,currency:ne.currency,amount:ne.amount,stars:ne.stars,users:H}),Ke()}),Ge=(0,M.A)(()=>{Be?S({chatId:e,giveawayId:we.id,paymentPurpose:{additionalChannelIds:he,countries:pe,prizeDescription:Ce,areWinnersVisible:ge,untilDate:J/1e3,stars:we.stars,currency:xe.currency,amount:xe.amount,users:we.quantity}}):y({chatId:e,giveawayId:Se.id,paymentPurpose:{additionalChannelIds:he,countries:pe,prizeDescription:Ce,areWinnersVisible:ge,untilDate:J/1e3,currency:Le.currency,amount:Le.amount}}),L(),Ke()}),je=(0,M.A)(e=>{$(e)}),ze=(0,M.A)(e=>{$(e)}),$e=(0,M.A)(e=>{ye(e.target.value)}),qe=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId;return ce?.map(t=>(0,l.Yg)(e[t])).join(", ")},[ce]),We=(0,M.A)(e=>{oe(e)}),Qe=(0,M.A)(e=>{ie(e),de([]),$(5)}),Ze=(0,M.A)(e=>{G(e.getTime()),I()}),Xe=(0,M.A)(e=>{ve(e)}),et=(0,M.A)(e=>{de(e),e.length||ie("premium_giveaway")}),tt=(0,M.A)(e=>{ue(e)}),it=(0,M.A)(e=>{Ae(e.target.checked)}),nt=(0,M.A)(e=>{be(e.target.checked)}),st=(0,M.A)(()=>{Y()}),at=(0,M.A)(e=>{se(e)});function ot(){return(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:ir,children:[(0,te.Y)("h2",{className:sr,children:k("BoostingChannelsGroupsIncludedGiveaway")}),(0,te.Y)(di.A,{inactive:!0,className:"chat-item-clickable contact-list-item",children:(0,te.Y)(Ln.A,{chatId:e,status:k(a?"BoostingChannelWillReceiveBoost":"BoostingGroupWillReceiveBoost",Fe||De,"i")})}),he?.map(e=>(0,te.Y)(di.A,{ripple:!0,className:"chat-item-clickable contact-list-item",onClick:()=>function(e){const t=he.filter(t=>t!==e);ue(t)}(e),rightElement:(0,te.Y)(W.A,{name:"close",className:"UZdErfVI"}),children:(0,te.Y)(Ln.A,{chatId:e.toString()})},e)),he.length<9&&(0,te.Y)(di.A,{icon:"add",ripple:!0,onClick:U,className:"sOXvh85b",iconClassName:"aGbyR60s",children:k("BoostingAddChannelOrGroup")})]}),(0,te.FD)("div",{className:ir,children:[(0,te.Y)("h2",{className:sr,children:k("BoostingEligibleUsers")}),(0,te.Y)("div",{className:nr,children:(0,te.Y)(ee.A,{name:"subscribers",options:Me,selected:ae,onChange:We,onClickAction:st,subLabelClassName:"txXJxVFu",isLink:!0})})]}),(0,te.Y)("div",{className:ar,children:(0,Dt.A)(k(a?"BoostGift.LimitSubscribersInfo":"lng_giveaway_users_about_group"))}),(0,te.FD)("div",{className:ir,children:[(0,te.FD)("div",{className:mr,children:[(0,te.Y)("h2",{className:ur,children:k("BoostingGiveawayAdditionalPrizes")}),(0,te.Y)(bi.A,{label:k("BoostingGiveawayAdditionalPrizes"),checked:fe,onChange:nt})]}),fe&&(0,te.FD)("div",{className:"eQVP0Nx8",children:[(0,te.Y)("h2",{className:ur,children:H}),(0,te.Y)(Z.A,{className:"qMYNwiUZ",value:Ce,onChange:$e,label:k("BoostingGiveawayEnterYourPrize")})]})]}),fe?Pe||Be?void 0:(0,te.Y)("div",{className:ar,children:Ce?.length?(0,Dt.A)(k("BoostingGiveawayAdditionPrizeCountNameHint",Se?[Se.quantity,Ce,Te]:[Ye,Ce,Te],void 0,re),["simple_markdown"]):(0,Dt.A)(k("BoostingGiveawayAdditionPrizeCountHint",Se?[Se.quantity,Te]:[Ye,Te],void 0,re),["simple_markdown"])}):(0,te.Y)("div",{className:ar,children:(0,Dt.A)(k("BoostingGiveawayAdditionPrizeHint"))}),(0,te.Y)("div",{className:ir,children:(0,te.FD)("div",{className:mr,children:[(0,te.Y)("h2",{className:ur,children:k("BoostingGiveawayShowWinners")}),(0,te.Y)(bi.A,{label:k("BoostingGiveawayAdditionalPrizes"),checked:ge,onChange:it})]})}),(0,te.Y)("div",{className:ar,children:(0,Dt.A)(k("BoostingGiveawayShowWinnersHint"))}),(0,te.FD)("div",{className:(0,me.A)(ir,(Se||we||Pe)&&hr),children:[(0,te.Y)("h2",{className:sr,children:k("BoostingDateWhenGiveawayEnds")}),(0,te.FD)(Q.A,{ariaLabel:k("BoostGift.DateEnds"),className:(0,me.A)("GeKqKRgP","expire-limit"),isText:!0,onClick:N,children:[(0,te.Y)("h3",{className:ur,children:k("BoostGift.DateEnds")}),(0,He.L2)(J,k.code)]})]})]})}return(0,te.FD)(X.A,{className:"P0kLOw15",onClose:Ke,isOpen:i,dialogRef:A,onEnter:Se||we?R:Je,children:[(0,te.FD)("div",{className:(0,me.A)("SqiN63Ef","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;z(t<=150)},children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",className:"OX6_HqAd",color:"translucent",onClick:Ke,ariaLabel:k("Close"),children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("img",{className:"Me2hCsMs",src:br,alt:"",draggable:!1}),(0,te.Y)("h2",{className:"UVDnB0Wq",children:(0,Dt.A)(k("BoostingBoostsViaGifts"))}),(0,te.Y)("div",{className:"v5yGzV6v",children:(0,Dt.A)(k(a?"BoostingGetMoreBoost":"BoostingGetMoreBoostsGroup"))}),(0,te.Y)("div",{className:(0,me.A)("U6XNIToQ",j&&"tDZc21ZC"),children:(0,te.Y)("h2",{className:"v6hiGpEn",children:k("BoostingBoostsViaGifts")})}),Se||we?(0,te.FD)("div",{className:"q1y2qUTn",children:[(0,te.Y)("div",{children:we?(0,te.Y)("img",{className:pr,src:fr,alt:""}):(0,te.Y)("img",{className:pr,src:Cr[Se.months]||Cr[3],alt:""})}),(0,te.FD)("div",{className:"IsT38nlq",children:[(0,te.Y)("h3",{className:ur,children:we?k("Giveaway.Stars.Prepaid.Title",we?.stars):k("BoostingTelegramPremiumCountPlural",Se.quantity)}),(0,te.Y)("p",{className:"TsGuei3B",children:we?k("Giveaway.Stars.Prepaid.Desc",we?.quantity):k("PrepaidGiveawayMonths",Se?.months)})]}),(0,te.Y)("div",{className:or,children:(0,te.FD)("div",{className:(0,me.A)(rr,lr),children:[(0,te.Y)(W.A,{name:"boost",className:cr}),(0,te.Y)("div",{className:dr,dir:k.isRtl?"rtl":void 0,children:we?we?.boosts:Se.quantity*(d??o.CQG)})]})})]}):(0,te.Y)("div",{className:(0,me.A)(ir,"sQ5PkKEs"),children:(0,te.Y)("div",{className:nr,children:K.map(e=>(0,te.Y)(er,{name:e.name,text:e.text,option:e.value,img:e.img,onChange:Qe,checked:q===e.value,isLink:e.isLink,userNames:qe,selectedMemberIds:ce,onClickAction:e.onClickAction},e.name))})}),Ie&&!ce?.length&&(0,te.FD)(te.FK,{children:[!Se&&!we&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:ir,children:[(0,te.FD)("div",{className:or,children:[(0,te.Y)("h2",{className:sr,children:k("BoostingQuantityPrizes")}),(0,te.FD)("div",{className:(0,me.A)(rr,lr),children:[(0,te.Y)(W.A,{name:"boost",className:cr}),(0,te.Y)("div",{className:dr,dir:k.isRtl?"rtl":void 0,children:Fe})]})]}),(0,te.Y)(Qo.A,{rangeCount:Ye,marks:_e,onChange:je})]}),(0,te.Y)("div",{className:ar,children:(0,Dt.A)(k("BoostingChooseHowMany"))})]}),ot()]}),Pe&&(0,te.FD)(te.FK,{children:[!we&&!Se&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:ir,children:[(0,te.FD)("div",{className:or,children:[(0,te.Y)("h2",{className:sr,children:k("BoostingStarsOptions")}),(0,te.FD)("div",{className:(0,me.A)(rr,lr),children:[(0,te.Y)(W.A,{name:"boost",className:cr}),(0,te.Y)("div",{className:dr,dir:k.isRtl?"rtl":void 0,children:De})]})]}),(0,te.Y)(qo.A,{className:"cLhNkYPB",options:g,selectedStarCount:H,selectedStarOption:ne,onClick:at})]}),(0,te.Y)("div",{className:(0,me.A)(ar,"bzRAETfR"),children:(0,Dt.A)(k("BoostGift.Stars.Info"))}),(0,te.FD)("div",{className:ir,children:[(0,te.Y)("h2",{className:sr,children:k("BoostingStarsQuantityPrizes")}),(0,te.Y)(Qo.A,{rangeCount:H,marks:Ue,onChange:ze}),(0,te.Y)("div",{className:ar,children:(0,Dt.A)(k("BoostingStarsQuantityPrizesInfo"))})]})]}),ot()]}),!Se&&!we&&Ie&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:ir,children:[(0,te.Y)("h2",{className:sr,children:k("BoostingDurationOfPremium")}),(0,te.Y)("div",{className:nr,children:Ee?.map(e=>(0,te.Y)(yo,{isGiveaway:!0,option:e,fullMonthlyAmount:Ve,checked:e.months===re,onChange:le},e.months))})]}),(0,te.Y)("div",{className:(0,me.A)(ar,hr),children:function(){const e=k("GiftPremiumListFeaturesAndTerms").match(/([^*]*)\*([^*]+)\*(.*)/);if(e&&!(e.length<4))return(0,te.FD)("p",{className:"eNQ_nrKr",children:[e[1],(0,te.Y)(Wo.A,{isPrimary:!0,onClick:Oe,children:e[2]}),e[3]]})}()})]}),q&&(0,te.Y)("div",{className:"hD_AEzjd",children:(0,te.Y)(Q.A,{className:"ILuhBsJG",onClick:Se||we?R:Je,children:k("BoostingStartGiveaway")})})]}),(0,te.Y)(ys,{isOpen:w,isFutureMode:!0,withTimePicker:!0,onClose:I,onSubmit:Ze,selectedAt:J,submitButtonLabel:k("Save")}),(0,te.Y)($o,{isOpen:P,onClose:D,countryList:h,onSubmit:Xe,selectionLimit:m}),(0,te.Y)(tr,{isOpen:x,onClose:V,onSelectedIdsConfirmed:et,initialSelectedIds:ce,selectionLimit:p,giveawayChatId:e}),(0,te.Y)(Xo,{isOpen:_,onClose:O,initialSelectedIds:he,onSelectedIdsConfirmed:tt,selectionLimit:o.cgU,giveawayChatId:e}),(0,te.Y)(gi.A,{title:k("BoostingStartGiveawayConfirmTitle"),text:k("BoostingStartGiveawayConfirmText"),confirmLabel:k("Start"),isOpen:B,onClose:L,confirmHandler:Ge})]})})),Sr={dialogFiltersChats:"LimitReachedChatInFolders",uploadMaxFileparts:"LimitReachedFileSize",dialogFilters:"LimitReachedFolders",dialogFolderPinned:"LimitReachedPinDialogs",channelsPublic:"LimitReachedPublicLinks",channels:"LimitReachedCommunities",chatlistInvites:"LimitReachedFolderLinks",chatlistJoined:"LimitReachedSharedFolders",savedDialogsPinned:"LimitReachedPinSavedDialogs"},kr={dialogFiltersChats:"LimitReachedChatInFoldersLocked",uploadMaxFileparts:"LimitReachedFileSizeLocked",dialogFilters:"LimitReachedFoldersLocked",dialogFolderPinned:"LimitReachedPinDialogsLocked",channelsPublic:"LimitReachedPublicLinksLocked",channels:"LimitReachedCommunitiesLocked",chatlistInvites:"LimitReachedFolderLinksLocked",chatlistJoined:"LimitReachedSharedFoldersLocked",savedDialogsPinned:"LimitReachedPinSavedDialogsLocked"},wr={dialogFiltersChats:"LimitReachedChatInFoldersPremium",uploadMaxFileparts:"LimitReachedFileSizePremium",dialogFilters:"LimitReachedFoldersPremium",dialogFolderPinned:"LimitReachedPinDialogsPremium",channelsPublic:"LimitReachedPublicLinksPremium",channels:"LimitReachedCommunitiesPremium",chatlistInvites:"LimitReachedFolderLinksPremium",chatlistJoined:"LimitReachedSharedFoldersPremium",savedDialogsPinned:"LimitReachedPinSavedDialogsPremium"},Nr={dialogFiltersChats:"chat-badge",uploadMaxFileparts:"file-badge",dialogFilters:"folder-badge",dialogFolderPinned:"pin-badge",channelsPublic:"link-badge",channels:"chats-badge",chatlistInvites:"link-badge",chatlistJoined:"folder-badge",savedDialogsPinned:"pin-badge"},Ir={uploadMaxFileparts:(e,t)=>8e3===t?e("FileSize.GB","4"):4e3===t?e("FileSize.GB","2"):(0,$e.v7)(e,t*o.dK5)},Pr=(0,n.ph)((0,s.EK)((e,{limit:t})=>{const{limits:i}=e.appConfig,n=(0,c.g29)(e);return{defaultValue:t?i?.[t][0]:void 0,premiumValue:t?i?.[t][1]:void 0,canBuyPremium:!(0,c.n_C)(e),isPremium:n}})(({defaultValue:e,premiumValue:t,limit:i,isPremium:a,canBuyPremium:o})=>{const{closeLimitReachedModal:r,openPremiumModal:l}=(0,s.ko)(),c=(0,T.A)(),[d,h,u]=(0,F.A)(),m=(0,n.hb)(()=>{l(),h()},[l,h]);(0,n.vJ)(()=>{!i&&d&&u()},[d,i,u]);const p=c("LimitReached"),v=i&&Ir[i],g=function({lang:e,limitType:t,isPremium:i,canBuyPremium:n,defaultValue:s,premiumValue:a,valueFormatter:o}){if(!t)return;const r=o?o(e,s):s,l=o?o(e,a):a;return i?e(wr[t],l):n?e(Sr[t],"channelsPublic"===t?l:[r,l]):e(kr[t],r)}({lang:c,limitType:i,isPremium:a,canBuyPremium:o,defaultValue:e,premiumValue:t,valueFormatter:v}),A=i&&Nr[i],f=o&&!a;return(0,te.FD)(X.A,{onClose:h,onCloseAnimationEnd:r,isOpen:Boolean(i)&&!d,title:p,className:"QAs_iFxO",children:[!f&&(0,te.FD)("div",{className:"Q5d_7bB4",children:[(0,te.Y)("i",{className:(0,me.A)("rbnU7JVX",A,"icon")}),(0,te.Y)("div",{className:"ArEy3hhB",children:v?.(c,a?t:e)||(a?t:e)})]}),f&&(0,te.Y)(La,{className:"k0O6Rnjh",leftValue:v?.(c,e)||e?.toString(),rightValue:v?.(c,t)||t?.toString(),floatingBadgeIcon:A}),(0,te.Y)("div",{children:(0,Dt.A)(g||"",["simple_markdown","br"])}),(0,te.FD)("div",{className:"RVM_RSap",children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:h,color:"primary",children:c(f?"Cancel":"OK")}),f&&(0,te.FD)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"primary",children:[c("IncreaseLimit"),(0,te.Y)(W.A,{name:"double-badge",className:"esB1OhAF"})]})]})]})}));var Yr=i(93809),Fr=i(81954),Dr=i(5912);const Mr=350+o.xB5,Tr=.5*g.$;function Br(e,t,i,s){const a=(0,n.li)([]),[o,r]=(0,n.J0)(0),{observe:l,freeze:c,unfreeze:d}=(0,Dr.BL)({rootRef:e},e=>{const t=a.current;e.forEach(e=>{const n=Number(e.target.id.replace(`${i}-`,""));t[n]=e.isIntersecting});const n=t.reduce((e,t,i)=>t&&i<e?i:e,1/0);n!==1/0&&r(n)}),{observe:h,freeze:u,unfreeze:m}=(0,Dr.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:p}=(0,Dr.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:v}=(0,Dr.BL)({rootRef:t});return(0,j.A)(()=>{s?(c(),u()):setTimeout(()=>{m(),d()},Mr)},[c,u,s,d,m]),{activeSetIndex:o,observeIntersectionForSet:l,observeIntersectionForShowingItems:h,observeIntersectionForPlayingItems:p,observeIntersectionForCovers:v,selectStickerSet:(0,M.A)(t=>{r(n=>{const s=document.getElementById(`${i}-${t}`),a=1===Math.abs(n-t);return(0,Fr.Ay)({container:e.current,element:s,position:"start",margin:Tr,maxDistance:a?200:80}),t})})}}var Rr=i(37479),Lr=i(87094),xr=i(94519),Er=i(47483);const Vr=(0,n.ph)(({stickerSet:e,size:t=o.TBj,noPlay:i,forcePlayback:a,observeIntersection:r,sharedCanvasRef:d})=>{const{loadStickers:h}=(0,s.ko)(),m=(0,n.li)(),{hasThumbnail:p,hasVideoThumb:v,hasAnimatedThumb:g,hasStaticThumb:A,thumbCustomEmojiId:f}=e,{customEmoji:b}=(0,Er.A)(f),C=b?.shouldUseTextColor,y=(0,Lr.A)(m,void 0,!C),S=(0,Rr.A)(y),k=(0,Dr.Vz)(m,r),w=k&&!i,N=!p||v&&!u.OF&&!g&&!A,I=N&&e.stickers?.[0]&&(0,l.Mw)(e.stickers[0],"preview"),P=(0,z.A)(I,!k),Y=(p&&!I||g)&&`stickerSet${e.id}`,F=(0,z.A)(Y,!k),D=f||F||P,M=(0,Ki.A)(D),T=(0,xr.A)(m,d);return(0,n.vJ)(()=>{k&&!e.stickers?.length&&h({stickerSetInfo:e})},[k,h,e]),(0,te.Y)("div",{ref:m,className:(0,me.A)("m6XpTzQX","sticker-set-cover"),style:`--_size: ${t}px`,children:D?f?(0,te.Y)(Na.A,{documentId:f,size:t,observeIntersectionForPlaying:r,noPlay:i}):g?(0,te.Y)(Ua.A,{className:M,tgsUrl:F,size:t,play:w,isLowPriority:!(0,c.CzR)((0,s.mS)(),e),sharedCanvas:d?.current||void 0,sharedCanvasCoords:T,forceAlways:a}):v&&!N?(0,te.Y)(an.A,{className:(0,me.A)("OZHqKbDL",M),src:F,canPlay:w,style:S,isPriority:a,loop:!0,disablePictureInPicture:!0}):(0,te.Y)("img",{src:F||P,style:S,className:(0,me.A)("enA6c8gc",M),alt:"",draggable:!1}):(0,$e.Qh)(e.title,2)})});var _r=i(54464),Ur=i(82855);const Or=[{title:"SetTimeoutFor.Hours",value:1,arg:3600},{title:"SetTimeoutFor.Hours",value:2,arg:7200},{title:"SetTimeoutFor.Hours",value:8,arg:28800},{title:"SetTimeoutFor.Days",value:1,arg:86400},{title:"SetTimeoutFor.Days",value:2,arg:172800}],Kr=(0,n.ph)(({sticker:e,size:t,noPlay:i,title:a,className:o,noContextMenu:r,isSavedMessages:l,isStatusPicker:c,canViewSet:d,observeIntersection:h,observeIntersectionForShowing:m,isSelected:p,isCurrentUserPremium:v,shouldIgnorePremium:g,noShowPremium:A,sharedCanvasRef:f,withTranslucentThumb:b,forcePlayback:C,onClick:y,clickArg:S,onFaveClick:k,onUnfaveClick:w,onRemoveRecentClick:N,onContextMenuOpen:I,onContextMenuClose:P,onContextMenuClick:Y,isEffectEmoji:F})=>{const{openStickerSet:D,openPremiumModal:B,setEmojiStatus:R}=(0,s.ko)(),L=(0,n.li)(),x=(0,n.li)(),E=(0,T.A)(),V=e.shouldUseTextColor,_=(0,Lr.A)(L,void 0,!V),{id:U,stickerSetInfo:O}=e,K=!e.isFree&&F||e.hasEffect,J=e.isCustomEmoji||F,G=!v&&K&&!g,j=(0,Dr.Vz)(L,h),z=j,H=j&&!i,$=(0,Dr.Vz)(L,m),{isContextMenuOpen:q,contextMenuAnchor:Z,handleBeforeContextMenu:X,handleContextMenu:ee,handleContextMenuClose:ie,handleContextMenuHide:ne}=(0,Ds.A)(L),se=Boolean(!r&&Z),ae=(0,M.A)(()=>L.current),oe=(0,M.A)(()=>L.current.closest(".custom-scroll, .no-scrollbar")),re=(0,M.A)(()=>c?x.current:L.current.querySelector(".sticker-context-menu .bubble")),le=(0,M.A)(()=>({withPortal:c,shouldAvoidNegativePosition:!0}));(0,n.vJ)(()=>{q?I?.():P?.()},[q,P,I]),(0,n.vJ)(()=>{j||ie()},[ie,j]);const ce=(0,M.A)(t=>{t.stopPropagation(),t.preventDefault(),N(e)}),he=(0,M.A)(()=>{N(e)}),ue=(0,M.A)(()=>{w(e)}),pe=(0,M.A)(()=>{k(e)}),ve=(0,M.A)(()=>{y?.(S,!0)}),ge=(0,M.A)(()=>{y?.(S,void 0,!0)}),Ae=(0,M.A)(()=>{D({stickerSetInfo:O})}),fe=(0,M.A)((t,i=0)=>{t.preventDefault(),t.stopPropagation(),ie(),Y?.(),R({emojiStatus:{type:"regular",documentId:e.id,until:(0,ci.Fm)()+i}})}),be=!u.TF&&N,Ce=(0,me.A)("StickerButton",y&&"interactive",p&&"selected",J&&"custom-emoji",F&&"effect-emoji",o),ye=(0,n.Kr)(()=>{if(!se||r||J&&!c)return[];const e=[];return J?(Or.forEach(t=>{e.push((0,te.Y)(de.A,{onClick:fe,clickArg:t.arg,children:E(t.title,t.value,"i")}))}),e):(w&&e.push((0,te.Y)(de.A,{icon:"favorite",onClick:ue,children:E("Stickers.RemoveFromFavorites")})),k&&e.push((0,te.Y)(de.A,{icon:"favorite",onClick:pe,children:E("Stickers.AddToFavorites")})),!G&&y&&(l||e.push((0,te.Y)(de.A,{onClick:ve,icon:"muted",children:E("SendWithoutSound")})),e.push((0,te.Y)(de.A,{onClick:ge,icon:"calendar",children:E(l?"SetReminder":"ScheduleMessage")}))),d&&e.push((0,te.Y)(de.A,{onClick:Ae,icon:"stickers",children:E("ViewPackPreview")})),N&&e.push((0,te.Y)(de.A,{icon:"delete",onClick:he,children:E("DeleteFromRecent")})),e)},[se,r,J,c,w,k,G,y,d,N,fe,E,ue,pe,l,ge,ve,Ae,he]);return(0,te.FD)("div",{ref:L,className:Ce,title:a||e?.emoji,"data-sticker-id":U,onMouseDown:e=>{(0,_r.u)(e),X(e)},onClick:()=>{q||(G?B(F?{initialSection:"effects"}:{initialSection:"premium_stickers"}):y?.(S))},onContextMenu:ee,children:[$&&(0,te.Y)(Ur.A,{containerRef:L,sticker:e,isSmall:!0,size:t,shouldLoop:!0,shouldPreloadPreview:!0,noLoad:!z,noPlay:!H,noVideoOnMobile:!0,withSharedAnimation:!0,sharedCanvasRef:f,withTranslucentThumb:b,customColor:_,forceAlways:C}),!A&&G&&(0,te.Y)("div",{className:"sticker-locked",children:(0,te.Y)(W.A,{name:"lock-badge"})}),!A&&K&&!G&&(0,te.Y)("div",{className:"sticker-premium",children:(0,te.Y)(W.A,{name:"star"})}),be&&(0,te.Y)(Q.A,{className:"sticker-remove-button",color:"dark",round:!0,noFastClick:!0,onClick:ce,children:(0,te.Y)(W.A,{name:"close"})}),Boolean(ye.length)&&(0,te.Y)(qe.A,{ref:x,isOpen:q,anchor:Z,getTriggerElement:ae,getRootElement:oe,getMenuElement:re,getLayout:le,className:"sticker-context-menu",autoClose:!0,withPortal:c,onClose:ie,onCloseAnimationEnd:ne,children:ye})]})});var Jr=i(93545),Gr=i(95773),jr=i(58443),zr=i(64489);const Hr=(0,n.ph)(({reaction:e,availableReactions:t,isSelected:i,loadAndPlay:s,observeIntersection:a,sharedCanvasRef:r,sharedCanvasHqRef:c,forcePlayback:d,onClick:h,onContextMenu:u})=>{const m=(0,n.li)(),p="custom"===e.type,v=(0,n.Kr)(()=>t?.find(t=>(0,l.a0)(t.reaction,e)),[t,e]),g=v?.staticIcon?.thumbnail?.dataUri,A=v?.selectAnimation?.id,f=(0,xr.A)(m,r),b=(0,z.A)(v?.selectAnimation?(0,l.mr)(v.selectAnimation,"full"):void 0,!A),{isContextMenuOpen:C,handleBeforeContextMenu:y,handleContextMenu:S,handleContextMenuClose:k,handleContextMenuHide:w}=(0,Ds.A)(m,"paid"!==e.type,void 0,void 0,void 0,!0);(0,n.vJ)(()=>{C&&(u?.(e),k(),w())},[k,u,w,C,e]);const N="paid"===e.type?jr.w.StarReaction:b,I=(0,M.A)(()=>{h(e)}),P=(0,Ki.A)(b),Y=(0,me.A)("AVrrYEbM",i&&"QkdO_lz1",!p&&"sticker-reaction");return(0,te.Y)("div",{ref:m,className:Y,onClick:I,title:v?.title,"data-sticker-id":p?e.documentId:void 0,onMouseDown:y,onContextMenu:S,children:p?(0,te.Y)(Na.A,{ref:m,documentId:e.documentId,size:o.g0Q,noPlay:!s,observeIntersectionForPlaying:a,sharedCanvasRef:r,sharedCanvasHqRef:c,withTranslucentThumb:!0,forceAlways:d}):(0,te.Y)(zr.A,{tgsUrl:N,thumbDataUri:g,play:s,noLoop:!1,size:o.g0Q,isLowPriority:!0,className:P,sharedCanvas:r.current||void 0,sharedCanvasCoords:f,forceAlways:d})})});var $r=i(38027);const qr=(0,n.ph)((0,s.EK)(e=>{const t=e.collectibleEmojiStatuses?.statuses;return{collectibleStatuses:t}})(({stickerSet:e,loadAndPlay:t,index:i,idPrefix:a,isNearActive:r,favoriteStickers:d,availableReactions:h,isSavedMessages:u,isStatusPicker:m,isReactionPicker:p,isCurrentUserPremium:v,shouldHideHeader:g,withDefaultTopicIcon:A,selectedReactionIds:f,withDefaultStatusIcon:b,isChatEmojiSet:C,isChatStickerSet:y,isTranslucent:S,noContextMenus:k,forcePlayback:w,observeIntersection:N,observeIntersectionForPlayingItems:I,observeIntersectionForShowingItems:P,onReactionSelect:D,onReactionContext:B,onStickerSelect:R,onStickerUnfave:L,onStickerFave:x,onStickerRemoveRecent:E,onContextMenuOpen:V,onContextMenuClose:_,onContextMenuClick:U,collectibleStatuses:O})=>{const{clearRecentStickers:K,clearRecentCustomEmoji:J,clearRecentReactions:G,openPremiumModal:j,toggleStickerSet:z,loadStickers:H}=(0,s.ko)(),$=(0,n.li)(),q=(0,n.li)(),Z=(0,n.li)(),X=(0,T.A)(),{width:ee}=(0,we.A)(),[ie,ne,se]=(0,F.A)(),{isMobile:ae}=(0,Y.Ay)(),[oe,re]=(0,n.J0)(Wr(ee)),le=(0,Dr.Vz)($,N??P),ce=(0,Ki.A)(le),de=r||le,he=ae?8:4,ue=ae?8:10,pe=ae?8:4,ve=e.id===o.sR2,ge=e.id===o.j1l,Ae=e.id===o.tRH,fe=e.id===o.EPW,be=e.isEmoji,Ce=!ve&&(0,c.Q31)(e),ye=(0,M.A)(()=>{p?G():be?J():K(),se()}),Se=(0,M.A)(()=>{Ce&&!v?j({initialSection:"animated_emoji"}):z({stickerSetId:e.id})}),ke=(0,M.A)(()=>{R?.({mediaType:"sticker",id:o.MyF,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})}),Ne=(0,M.A)(()=>{R?.({mediaType:"sticker",id:o.zNY,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})}),Ie=be?o.g0Q:o.bkT,Pe=be?ue:he,Ye=be?pe:he,Fe=(0,M.A)(e=>e?Math.floor((e+Pe)/(Ie+Pe)):Wr(ee)),De=(0,M.A)(e=>{re(Fe(e.contentRect.width))});(0,Jr.A)($,De),(0,n.vJ)(()=>{$.current&&re(Fe($.current.clientWidth))},[Fe]),(0,n.vJ)(()=>{de&&!e.stickers?.length&&!e.reactions?.length&&e.accessHash&&H({stickerSetInfo:{id:e.id,accessHash:e.accessHash}})},[de,H,e]);const Me=!u&&!v&&Ce&&!C,Te=e.installedDate&&!e.isArchived,Be=!Te&&e.id!==o.sR2&&e.id!==o.EPW&&e.id!==o.hfH&&e.id!==o.Kp3&&!C&&!y,[Re,,Le]=(0,F.A)(Be),xe=3*oe-1,Ee=A||b?e.count+1:e.count,Ve=Ie+Ye,_e=Math.ceil(Math.min(xe,Ee)/oe)*Ve-Ye,Ue=Re?_e:Math.ceil(Ee/oe)*Ve-Ye,Oe=(0,n.Kr)(()=>d?new Set(d.map(({id:e})=>e)):void 0,[d]),Ke=(0,n.Kr)(()=>O?new Set(O.map(({documentId:e})=>e)):void 0,[O]),Je=!g&&!ve&&!ge&&be&&!fe&&!C&&(!Te||!v&&!u),Ge=(0,n.Kr)(()=>X(Me?Te?"lng_emoji_premium_restore":"Unlock":"Add"),[Me,X,Te]);return(0,te.FD)("div",{ref:$,id:`${a}-${i}`,className:(0,me.A)("symbol-set",Me&&"symbol-set-locked"),children:[!g&&(0,te.FD)("div",{className:"symbol-set-header",children:[(0,te.FD)("p",{className:(0,me.A)("symbol-set-title",Je&&"symbol-set-title-external"),children:[Me&&(0,te.Y)(W.A,{name:"lock-badge",className:"symbol-set-locked-icon"}),(0,te.Y)("span",{className:"symbol-set-name",children:e.title}),(C||y)&&(0,te.Y)("span",{className:"symbol-set-chat",children:X(C?"GroupEmoji":"GroupStickers")}),Je&&Boolean(e.stickers)&&(0,te.Y)("span",{className:"symbol-set-amount",children:X(be?"EmojiCount":"Stickers",e.stickers.length,"i")})]}),ve&&(0,te.Y)(W.A,{className:"symbol-set-remove",name:"close",onClick:ne}),Je&&(0,te.Y)(Q.A,{className:"symbol-set-add-button",withPremiumGradient:Ce&&!v,onClick:Se,pill:!0,size:"tiny",fluid:!0,children:Ge})]}),(0,te.FD)("div",{className:(0,me.A)("symbol-set-container shared-canvas-container",ce,e.id===o.hfH&&"effect-emojis"),style:`height: ${Ue}px;`,children:[(0,te.Y)("canvas",{ref:q,className:"shared-canvas",style:Be?`height: ${_e}px;`:void 0}),(ve||Ae||Be)&&(0,te.Y)("canvas",{ref:Z,className:"shared-canvas"}),A&&(0,te.Y)(Q.A,{className:"StickerButton custom-emoji",color:"translucent",onClick:ke,children:(0,te.Y)("img",{src:$r,alt:"Reset",className:"sticker-media",draggable:!1})},"default-topic-icon"),b&&(0,te.Y)(Q.A,{className:"StickerButton custom-emoji status-default",color:"translucent",onClick:Ne,children:(0,te.Y)(W.A,{name:"star"})},"default-status-icon"),de&&e.reactions?.map(i=>{const n=(0,l.Jj)(i),s=n?f?.includes(n):void 0;return(0,te.Y)(Hr,{reaction:i,isSelected:s,loadAndPlay:t,availableReactions:h,observeIntersection:I,onClick:D,onContextMenu:B,sharedCanvasRef:q,sharedCanvasHqRef:Z,forcePlayback:w},`${e.id}_${n}`)}),de&&e.stickers?.slice(0,Re?xe:e.stickers.length).map((i,n)=>{const a=(ve||Ae)&&(0,c.CzR)((0,s.mS)(),i.stickerSetInfo),r=Be&&n>=xe||a?Z:q,l=i.isCustomEmoji?i.id:i.emoji,d=l?f?.includes(l):void 0,h=e.id===o.j1l||Ke?.has(i.id),p=(0,te.Y)(Kr,{sticker:i,size:Ie,observeIntersection:I,observeIntersectionForShowing:P,noPlay:!t,isSavedMessages:u,isStatusPicker:m,canViewSet:!0,noContextMenu:k,isCurrentUserPremium:v,shouldIgnorePremium:C,sharedCanvasRef:r,withTranslucentThumb:S,onClick:R,clickArg:i,isSelected:d,onUnfaveClick:Ae&&Oe?.has(i.id)?L:void 0,onFaveClick:Oe?.has(i.id)?void 0:x,onRemoveRecentClick:ve?E:void 0,onContextMenuOpen:V,onContextMenuClose:_,onContextMenuClick:U,forcePlayback:w,isEffectEmoji:e.id===o.hfH,noShowPremium:v&&(e.id===o.Kp3||e.id===o.hfH)},i.id);return h?(0,te.Y)(Gr.A,{className:"gift-effect-wrapper",withSparkles:!0,children:p}):p}),Re&&Ee>xe&&(0,te.FD)(Q.A,{className:"StickerButton custom-emoji set-expand",round:!0,color:"translucent",onClick:Le,children:["+",Ee-xe]},"more")]}),ve&&(0,te.Y)(gi.A,{text:X(p?"ClearRecentReactionsAlertMessage":"ClearRecentStickersAlertMessage"),isOpen:ie,onClose:se,confirmHandler:ye,confirmIsDestructive:!0})]},e.id)}));function Wr(e){return e>440?8:e<362?6:7}const Qr="p7c8y0LH",Zr="zTGriBHY",Xr="Qn3lBUNs",el="HMspKpNp",tl="YKO0Obwy",il="BZfaP1GD",nl=2.5*g.$,sl=new Set([o.sR2,o.tRH,o.EPW]),al=new Set([o.sR2,o.tRH,o.EPW]),ol=(0,n.ph)((0,s.EK)((e,{chatId:t,isStatusPicker:i,isReactionPicker:n})=>{const{stickers:{setsById:s},customEmojis:{byId:a,featuredIds:o,statusRecent:{emojis:r}},recentCustomEmojis:l,reactions:{availableReactions:d,recentReactions:h,topReactions:u,defaultTags:m}}=e,p=Boolean(t&&(0,c.nZ4)(e,t)),v=t?(0,c.AWZ)(e,t):void 0,g=e.collectibleEmojiStatuses?.statuses;return{customEmojisById:a,recentCustomEmojiIds:i?void 0:l,recentStatusEmojis:i?r:void 0,collectibleStatuses:i?g:void 0,stickerSetsById:s,addedCustomEmojiIds:e.customEmojis.added.setIds,canAnimate:(0,c.BWX)(e),isSavedMessages:p,isCurrentUserPremium:(0,c.g29)(e),customEmojiFeaturedIds:o,defaultTopicIconsId:e.defaultTopicIconsId,defaultStatusIconsId:e.defaultStatusIconsId,topReactions:n?u:void 0,recentReactions:n?h:void 0,chatEmojiSetId:v?.emojiSet?.id,isWithPaidReaction:n&&v?.isPaidReactionAvailable,availableReactions:n?d:void 0,defaultTagReactions:n?m:void 0}})(({className:e,pickerListClassName:t,isHidden:i,loadAndPlay:a,addedCustomEmojiIds:r,customEmojisById:d,recentCustomEmojiIds:h,selectedReactionIds:m,recentStatusEmojis:p,collectibleStatuses:v,stickerSetsById:g,chatEmojiSetId:A,topReactions:f,recentReactions:b,availableReactions:C,idPrefix:y="custom-emoji-set",customEmojiFeaturedIds:S,canAnimate:k,isReactionPicker:w,isStatusPicker:N,isTranslucent:I,isSavedMessages:P,isCurrentUserPremium:F,withDefaultTopicIcons:D,defaultTopicIconsId:B,defaultStatusIconsId:R,defaultTagReactions:L,isWithPaidReaction:x,onCustomEmojiSelect:E,onReactionSelect:V,onReactionContext:_,onContextMenuOpen:U,onContextMenuClose:O,onContextMenuClick:K})=>{const J=(0,n.li)(),G=(0,n.li)(),j=(0,n.li)(),z=(0,n.li)(),{isMobile:H}=(0,Y.Ay)(),{handleScroll:$,isAtBeginning:q}=Mn(),Z=(0,n.Kr)(()=>N?p:Object.values((0,Ci._E)(d,h)),[d,N,h,p]),X=(0,n.Kr)(()=>{const e=v?.map(e=>e.documentId);return d&&e?.map(e=>d[e]).filter(Boolean)},[d,v]),ee=`${y}-custom-emoji`,{activeSetIndex:ie,observeIntersectionForSet:ne,observeIntersectionForPlayingItems:ae,observeIntersectionForShowingItems:oe,observeIntersectionForCovers:re,selectStickerSet:le}=Br(J,G,ee,i),ce=(0,dn.A)(a||void 0,o.jhd),de=(0,T.A)(),he=(0,Ui.A)(),ue=Boolean(r),pe=(0,n.Kr)(()=>{const e=[];if(w&&P&&L?.length&&e.push({id:o.G3A,accessHash:"",title:de("PremiumPreviewTags"),reactions:L,count:L.length,isEmoji:!0}),w&&!P){const t=f?.slice(0,16)||[];x&&t.unshift({type:"paid"}),t?.length&&e.push({id:o.G3A,accessHash:"",title:de("Reactions"),reactions:t,count:t.length,isEmoji:!0});const i=(b||[]).filter(e=>!t.some(t=>(0,l.a0)(t,e))).slice(0,32),n=(C||[]).filter(({isInactive:e})=>!e).map(({reaction:e})=>e).filter(e=>!t.some(t=>(0,l.a0)(t,e))&&!i.some(t=>(0,l.a0)(t,e)));if(n?.length||i?.length){const t=!i?.length,s=i.concat(n);e.push({id:t?o.EPW:o.sR2,accessHash:"",title:de(t?"PopularReactions":"RecentStickers"),reactions:s,count:s.length,isEmoji:!0})}}else if(N){const t=g[R];if(t?.stickers?.length){const i=(0,Ci.Xd)(t.stickers.slice(0,7).concat(Z||[]),"id");e.push({...t,stickers:i,count:i.length,id:o.sR2,title:de("RecentStickers"),isEmoji:!0})}X?.length&&e.push({id:o.j1l,accessHash:"",count:X.length,stickers:X,title:he("CollectibleStatusesCategory"),isEmoji:!0})}else if(D){const t=g[B];t.stickers?.length&&e.push({...t,id:o.sR2,title:de("RecentStickers")})}else Z?.length&&e.push({id:o.sR2,accessHash:"0",title:de("RecentStickers"),stickers:Z,count:Z.length,isEmoji:!0});const t=[...r||[]];A&&t.unshift(A);const i=(0,Ci.Am)(t.concat(S||[])),n=Object.values((0,Ci._E)(g,i));return[...e,...n]},[r,w,N,D,Z,S,g,f,C,de,b,R,B,P,L,A,x,X,he]),ve=(0,n.Kr)(()=>ue&&0===pe.filter(e=>e.stickers?.length).length,[pe,ue]),ge=(0,Yr.A)([],o.jhd),Ae=ue&&ge&&!ve;(0,xs.A)(G,H||!Ae),(0,n.vJ)(()=>{if(!ue)return;const e=G.current;if(!e)return;const t=ie*nl-(e.offsetWidth/2-nl/2);(0,Da.A)(e,t)},[ue,ie]);const fe=(0,M.A)(e=>{E(e)}),be=(0,me.A)("StickerPicker","Qk9PEGRE",e),Ce=(0,me.A)(Xr,"no-scrollbar",!q&&el),ye=(0,me.A)(Qr,"U0BL1VvK",u.TF?"no-scrollbar":"custom-scroll",t,Zr),Se=!Ae&&!ve;return(0,te.Y)(se.Ay,{className:be,name:"fade",activeKey:Se?0:1,shouldCleanup:!0,children:Ae||ve?!Ae&&ve?(0,te.Y)("div",{className:il,children:de("NoStickers")}):(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{ref:G,className:Ce,children:(0,te.FD)("div",{className:"shared-canvas-container",children:[(0,te.Y)("canvas",{ref:j,className:"shared-canvas"}),(0,te.Y)("canvas",{ref:z,className:"shared-canvas"}),pe.map(function(e,t){const i=e.stickers?.[0],n=(0,me.A)(tl,t===ie&&"WYeuJNQx"),a=t<o.j41,r=(0,c.CzR)((0,s.mS)(),e);if(e.id!==o.G3A){if(al.has(e.id)||e.hasThumbnail||!i){const i=e.id===o.sR2||e.id===o.EPW,s=sl.has(e.id);return(0,te.Y)(Q.A,{className:n,ariaLabel:e.title,round:!0,faded:s,color:"translucent",onClick:()=>le(i?0:t),children:i?(0,te.Y)(W.A,{name:"recent"}):(0,te.Y)(Vr,{stickerSet:e,noPlay:!k||!ce,forcePlayback:!0,observeIntersection:re,sharedCanvasRef:a?r?z:j:void 0})},e.id)}return(0,te.Y)(Kr,{sticker:i,size:o.TBj,title:e.title,className:n,noPlay:!k||!ce,observeIntersection:re,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:a?r?z:j:void 0,withTranslucentThumb:I,onClick:le,clickArg:t,forcePlayback:!0},e.id)}})]})}),(0,te.Y)("div",{ref:J,onScroll:$,className:ye,children:pe.map((e,t)=>{const i=e.id===o.G3A||e.id===o.sR2&&(D||N),n=e.id===A;return(0,te.Y)(qr,{stickerSet:e,loadAndPlay:Boolean(k&&ce),index:t,idPrefix:ee,observeIntersection:ne,observeIntersectionForPlayingItems:ae,observeIntersectionForShowingItems:oe,isNearActive:ie>=t-1&&ie<=t+1,isSavedMessages:P,isStatusPicker:N,isReactionPicker:w,shouldHideHeader:i,withDefaultTopicIcon:D&&e.id===o.sR2,withDefaultStatusIcon:N&&e.id===o.sR2,isChatEmojiSet:n,isCurrentUserPremium:F,selectedReactionIds:m,availableReactions:C,isTranslucent:I,onReactionSelect:V,onReactionContext:_,onStickerSelect:fe,onContextMenuOpen:U,onContextMenuClose:O,onContextMenuClick:K,forcePlayback:!0},e.id)})})]}):(0,te.Y)($n.A,{})})}));var rl=i(3325);const ll=(0,n.ph)((0,s.EK)(e=>({areFeaturedStickersLoaded:Boolean(e.customEmojis.featuredIds?.length),isTranslucent:(0,c.cwE)(e)}))(({isOpen:e,statusButtonRef:t,areFeaturedStickersLoaded:i,isTranslucent:a,onEmojiStatusSelect:o,onClose:r})=>{const{loadFeaturedEmojiStickers:l}=(0,s.ko)(),c=(0,n.li)(),[d,h,u]=(0,F.A)();(0,n.vJ)(()=>{c.current=t.current.getBoundingClientRect().right},[e,t]),(0,n.vJ)(()=>{e&&!i&&l()},[i,e,l]);const m=(0,n.hb)(e=>{o(e),r()},[r,o]);return(0,te.Y)(rl.A,{children:(0,te.Y)(qe.A,{isOpen:e,noCompact:!0,positionX:"right",bubbleClassName:"hRzvfaRb",onClose:r,transformOriginX:c.current,noCloseOnBackdrop:d,children:(0,te.Y)(ol,{idPrefix:"status-emoji-set-",loadAndPlay:e,isHidden:!e,isStatusPicker:!0,isTranslucent:a,onContextMenuOpen:h,onContextMenuClose:u,onCustomEmojiSelect:m,onContextMenuClick:r})})})}));var cl=i(10187);const dl=6*g.$,hl=(0,n.ph)((0,s.EK)((e,{modal:t})=>({currentUser:(0,c.mBe)(e,e.currentUserId),bot:t?.botId?(0,c.mBe)(e,t.botId):void 0}))(({modal:e,currentUser:t,bot:i})=>{const{setEmojiStatus:a,closeSuggestedStatusModal:o,sendWebAppEvent:r}=(0,s.ko)(),c=(0,Ui.A)(),d=Boolean(e),h=(0,Ri.A)(e),u=(0,n.Kr)(()=>{if(t&&h)return{...t,emojiStatus:{type:"regular",documentId:h.customEmojiId}}},[t,h]),m=(0,n.Kr)(()=>{if(!h||!i)return;const e=(0,l.Yg)(i);return h.duration?c("BotSuggestedStatusFor",{bot:e,duration:(0,He.A$)(c,h.duration)},{withNodes:!0,withMarkdown:!0}):c("BotSuggestedStatus",{bot:e},{withNodes:!0,withMarkdown:!0})},[i,c,h]),p=(0,M.A)(()=>{const e=h?.webAppKey;e&&r({webAppKey:e,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}}}),o()}),v=(0,M.A)(()=>{if(!h)return;const e=h.duration?(0,ci.Fm)()+h.duration:void 0;a({referrerWebAppKey:h.webAppKey,emojiStatus:{type:"regular",documentId:h.customEmojiId,until:e}}),o()});return(0,te.FD)(X.A,{isOpen:d,contentClassName:"C9sWDINB",hasAbsoluteCloseButton:!0,isSlim:!0,onClose:p,children:[h&&(0,te.Y)(Na.A,{className:"gdG3oY21",documentId:h.customEmojiId,size:dl,loopLimit:1,forceAlways:!0}),(0,te.FD)("div",{children:[(0,te.Y)("h3",{className:"KVpsce1g",children:c("BotSuggestedStatusTitle")}),(0,te.Y)("p",{className:"p7S4AH8A",children:m})]}),u&&(0,te.Y)(cl.A,{mockPeer:u,withEmojiStatus:!0}),(0,te.Y)(Q.A,{onClick:v,children:c("GeneralConfirm")})]})}));var ul=i(55317),ml=i(20333);const pl="j6xEoljc";function vl(e,t){return e.find(e=>!e.chatId)||e.filter(e=>t&&e.chatId!==t).sort((e,t)=>e.date-t.date)[0]}const gl=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=t&&(0,c.hds)(e,t?.chatId),n=i&&(0,c.AWZ)(e,i.id),s=t?.myBoosts&&vl(t.myBoosts,t.chatId);return{chat:i,chatFullInfo:n,prevBoostedChat:s?.chatId?(0,c.hds)(e,s?.chatId):void 0,isCurrentUserPremium:(0,c.g29)(e)}})(({modal:e,chat:t,chatFullInfo:i,prevBoostedChat:a,isCurrentUserPremium:o})=>{const{applyBoost:r,closeBoostModal:c,requestConfetti:d,openPremiumModal:h,loadFullChat:u}=(0,s.ko)(),[m,p,v]=(0,F.A)(),[g,A,f]=(0,F.A)(),[b,C,y]=(0,F.A)(),S=t&&(0,l.WX)(t),k=Boolean(e),w=(0,T.A)(),N=(0,Ui.A)();(0,n.vJ)(()=>{t&&!i&&u({chatId:t.id})},[t,i]);const I=(0,n.Kr)(()=>{if(t)return(0,l.Js)(w,t)},[t,w]),P=(0,n.Kr)(()=>{if(a)return(0,l.Js)(w,a)},[a,w]),{isStatusLoaded:Y,isBoosted:D,boost:B,title:R,leftText:L,rightText:x,value:E,progress:V,descriptionText:_,canBoostMore:U}=(0,n.Kr)(()=>{if(!e?.boostStatus||!t)return{isStatusLoaded:!1,title:w("Loading")};const{hasMyBoost:n}=e.boostStatus,s=e?.myBoosts&&vl(e.myBoosts,t.id),a=e?.myBoosts&&(o=e.myBoosts,r=t.id,!o.every(e=>e.chatId===r));var o,r;const{boosts:c,currentLevel:d,hasNextLevel:h,levelProgress:u,remainingBoosts:m,isMaxLevel:p}=(0,ul.z)(e.boostStatus,!0),v=n,g=w("BoostsLevel",d),A=h?w("BoostsLevel",d+1):void 0,f=w("ChannelBoost.MoreBoosts",m),b=w(S?"BoostChannel":"BoostGroup"),C=(i?.boostsToUnrestrict||0)-(i?.boostsApplied||0);let y;if(p)y=w("BoostsMaxLevelReached");else if(C>0&&!(0,l.SJ)(t)){const e=w("GroupBoost.BoostToUnrestrict.Times",C);y=w("GroupBoost.BoostToUnrestrict",[e,I])}else y=w("ChannelBoost.MoreBoostsNeeded.Text",[I,f]);return{isStatusLoaded:!0,title:b,leftText:g,rightText:A,value:c.toString(),progress:u,remainingBoosts:m,descriptionText:y,boost:s,isBoosted:v,canBoostMore:a&&!p}},[t,I,e,w,i,S]),O=!e?.myBoosts?.length&&o,K=B?.chatId&&B.chatId!==e?.chatId,J=(0,M.A)(()=>{v(),r({chatId:t.id,slots:[B.slot]}),d({})}),G=(0,M.A)(()=>{h(),y(),c()}),j=(0,M.A)(()=>{if(!B)return o?void c():void C();U?B.cooldownUntil?A():K?p():J():c()}),z=(0,M.A)(()=>{c()});return(0,te.FD)(X.A,{isOpen:k,title:R,className:"IK2mBqbm",contentClassName:"pUyNTysT",onClose:c,children:[Y?(0,te.FD)(te.FK,{children:[(0,te.Y)(ml.A,{leftText:L,rightText:x,progress:V,floatingBadgeText:E,floatingBadgeIcon:"boost"}),D&&(0,te.Y)("div",{className:(0,me.A)(pl,"hAA6B1lc"),children:w("ChannelBoost.YouBoostedChannelText",I)}),(0,te.Y)("div",{className:pl,children:(0,Dt.A)(_,["simple_markdown","emoji"])}),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",disabled:O,onClick:j,children:U?(0,te.FD)(te.FK,{children:[(0,te.Y)(W.A,{name:"boost"}),w(S?"ChannelBoost.BoostChannel":"GroupBoost.BoostGroup")]}):w("OK")}),(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:z,children:w("Cancel")})]})]}):(0,te.Y)($n.A,{className:"zjXCH3pT"}),K&&P&&(0,te.FD)(X.A,{isOpen:m,className:"GIFAjZPY",contentClassName:"Jxyz9TaL",onClose:v,children:[(0,te.FD)("div",{className:"OKp6HS1U",children:[(0,te.FD)("div",{className:"NU9itcIm",children:[(0,te.Y)(Mt.A,{peer:a,size:"large"}),(0,te.Y)(W.A,{name:"boostcircle",className:"upXvhNRY"})]}),(0,te.Y)(W.A,{name:"next",className:"WSJdWV7L"}),(0,te.Y)(Mt.A,{peer:t,size:"large"})]}),(0,te.Y)("div",{children:(0,Dt.A)(w("ChannelBoost.ReplaceBoost",[P,I]),["simple_markdown","emoji"])}),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:J,children:w("Replace")}),(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:v,children:w("Cancel")})]})]}),Boolean(B?.cooldownUntil)&&(0,te.Y)(gi.A,{isOpen:g,isOnlyConfirm:!0,confirmLabel:w("OK"),title:w("ChannelBoost.Error.BoostTooOftenTitle"),onClose:f,confirmHandler:f,children:(0,Dt.A)(w("ChannelBoost.Error.BoostTooOftenText",(0,He.A$)(N,B.cooldownUntil-(0,ci.Fm)())),["simple_markdown","emoji"])}),!o&&(0,te.Y)(gi.A,{isOpen:b,confirmLabel:w("Common.Yes"),title:w("PremiumNeeded"),onClose:y,confirmHandler:G,children:(0,Dt.A)(w("PremiumNeededForBoosting"),["simple_markdown","emoji"])})]})}));var Al=i(47058),fl=i(70046);const bl="xVLGjLub",Cl=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{message:i}=t||{},n=i&&(0,c.O5q)(e,i.chatId,i.messageId),s=n&&(0,c.Y7C)(e,n);return{currentUserId:e.currentUserId,messageSender:s}})(({currentUserId:e,modal:t,messageSender:i})=>{const{closeGiftCodeModal:a,applyGiftCode:r,focusMessage:l}=(0,s.ko)(),c=(0,T.A)(),d=Boolean(t),h=!(t?.info.toId&&t?.info.toId!==e||t?.info.usedAt),u=(0,M.A)(()=>{t&&t.info.giveawayMessageId&&(l({chatId:t.info.fromId,messageId:t.info.giveawayMessageId}),a())}),m=(0,M.A)(()=>{h?r({slug:t.slug}):a()}),p=(0,n.Kr)(()=>{if(!t)return;const{slug:e,info:n}=t,s=n.fromId||i?.id,a=(0,te.FD)(te.FK,{children:[(0,te.Y)("img",{src:br,alt:"",className:"Mtx4SWww"}),(0,te.Y)("p",{className:bl,children:(0,Dt.A)(c("lng_gift_link_about"),["simple_markdown"])}),(0,te.Y)(Al.A,{title:"BoostingGiftLink",link:`${o.jsp}/giftcode/${e}`})]}),r=[[c("BoostingFrom"),s?{chatId:s}:c("BoostingNoRecipient")],[c("BoostingTo"),n.toId?{chatId:n.toId}:c("BoostingNoRecipient")],[c("BoostingGift"),c("BoostingTelegramPremiumFor",c("Months",n.months,"i"))]];return n.isFromGiveaway&&r.push([c("BoostingReason"),(0,te.Y)("span",{className:(0,me.A)(n.giveawayMessageId&&"IzcASdzD"),onClick:u,children:n.isFromGiveaway&&!n.toId?c("BoostingIncompleteGiveaway"):c("BoostingGiveaway")})]),r.push([c("BoostingDate"),(0,He.L2)(1e3*n.date,c.code,!0)]),{header:a,tableData:r,footer:(0,te.Y)("span",{className:bl,children:(0,Dt.A)(n.usedAt?c("BoostingUsedLinkDate",(0,He.L2)(1e3*n.usedAt,c.code,!0)):c("BoostingSendLinkToAnyone"),["simple_markdown"])})}},[c,i?.id,t]);if(p)return(0,te.Y)(fl.A,{isOpen:d,title:c("lng_gift_link_title"),tableData:p.tableData,header:p.header,footer:p.footer,buttonText:c(h?"BoostingUseLink":"Close"),onButtonClick:m,onClose:a})}));function yl(e,t){return e.reduce((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)}const Sl=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{selfDestructAccountDays:i}=t||{};return{selfDestructAccountDays:i}})(({modal:e,selfDestructAccountDays:t})=>{const{closeGiftCodeModal:i,closeDeleteAccountModal:a,setAccountTTL:r}=(0,s.ko)(),l=(0,Ui.A)(),c=Boolean(e),[d,h]=(0,n.J0)(),u=(0,M.A)(e=>30*Number(e)),m=(0,n.Kr)(()=>{if(t)return yl(o.WF4,t/30).toString()},[t]);(0,n.vJ)(()=>{m&&h(m)},[m]);const p=(0,n.Kr)(()=>o.WF4.map(e=>({value:String(e),label:l("Months",{count:e},{pluralValue:1})})),[l]),v=(0,M.A)(e=>{h(e)}),g=(0,M.A)(()=>{d&&r({days:u(d)})}),A=(0,M.A)(()=>{a()});return(0,te.FD)(X.A,{isOpen:c,title:l("SelfDestructTitle"),onClose:i,className:"X6K5oA8U",children:[(0,te.Y)("p",{children:l("SelfDestructSessionsDescription")}),(0,te.Y)(ee.A,{className:"dialog-checkbox-group",name:"quick-reaction-settings",options:p,selected:d,onChange:v,withIcon:!0}),(0,te.FD)("div",{className:"dialog-buttons mt-2",children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:g,children:l("Save")}),(0,te.Y)(Q.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:A,children:l("Cancel")})]})]})})),kl={root:"OviJR58x",content:"BlpqzGYt",header:"b9RUzfpF",iconWrapper:"l1X5kBUM",icon:"qOoRnv_Y",mainText:"s2SOQSml",description:"wiKBjcl2"},wl=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig;return{verifyAgeBotUsername:t.verifyAgeBotUsername,verifyAgeMin:t.verifyAgeMin||o.lYi}})(({modal:e,verifyAgeBotUsername:t,verifyAgeMin:i})=>{const{closeAgeVerificationModal:n,openChatByUsername:a}=(0,s.ko)(),o=(0,Ui.A)(),r=Boolean(e),l=(0,M.A)(()=>{t&&a({shouldStartMainApp:!0,username:t}),n()}),c=(0,M.A)(()=>{n()});return(0,te.FD)(X.A,{isOpen:r,onClose:c,className:kl.root,children:[(0,te.FD)("div",{className:kl.content,children:[(0,te.Y)("div",{className:kl.header,children:(0,te.Y)("div",{className:kl.iconWrapper,children:(0,te.Y)(W.A,{name:"user",className:kl.icon})})}),(0,te.Y)("h2",{className:kl.title,children:o("TitleAgeVerificationModal")}),(0,te.Y)("p",{className:kl.mainText,children:o("TextAgeVerificationModal",{count:i},{withMarkdown:!0,withNodes:!0,pluralValue:i})}),(0,te.Y)("p",{className:kl.description,children:o("DescriptionAgeVerificationModal")})]}),(0,te.Y)("div",{className:"dialog-buttons mt-2",children:(0,te.Y)(Q.A,{onClick:l,children:o("ButtonAgeVerification")})})]})}));var Nl=i(34132),Il=i(24713);const Pl={description:"dl10exNi","picker-wrapper":"gxWY5c6x",pickerWrapper:"gxWY5c6x","picker-header":"h8N7eyob",pickerHeader:"h8N7eyob","picker-header-info":"Rth2Qu07",pickerHeaderInfo:"Rth2Qu07","selection-toggle":"B6eAugx8",selectionToggle:"B6eAugx8",foldersWrapper:"mwcvgD2S",folders:"LKavx8ww",folder:"qglLx5Dn","button-text":"bgaRuEMs",buttonText:"bgaRuEMs","button-badge":"rTe14Z22",buttonBadge:"rTe14Z22"},Yl=(0,n.ph)(({invite:e,folder:t})=>{const{closeChatlistModal:i,joinChatlistInvite:a}=(0,s.ko)(),o=(0,Ui.A)(),r=(0,T.A)(),[l,c]=(0,n.J0)(e.missingPeerIds),d=Boolean(e.missingPeerIds.length),h=0===e.alreadyPeerIds.length,u=d?e.missingPeerIds.length:0,m=l.length?l.length.toString():void 0,p=h?o("FolderLinkSubtitleNew"):u?o("FolderLinkSubtitleAdd",{chats:o("FolderLinkSubtitleAddCount",{count:u},{pluralValue:u}),title:(0,un.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})},{withNodes:!0,withMarkdown:!0}):o("FolderLinkSubtitleAlready"),v=(0,n.hb)(()=>{i(),l.length&&a({invite:e,peerIds:l})},[e,l]),g=(0,n.hb)(()=>{const t=l.length===e.missingPeerIds.length;c(t?[]:e.missingPeerIds)},[e.missingPeerIds,l.length]);return(0,te.FD)("div",{className:Pl.content,children:[(0,te.Y)("div",{className:Pl.description,children:(0,Dt.A)(p,["simple_markdown","emoji"])}),(0,te.FD)("div",{className:(0,me.A)(Pl.pickerWrapper,"custom-scroll"),children:[Boolean(e.missingPeerIds.length)&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:Pl.pickerHeader,children:[(0,te.Y)("div",{className:Pl.pickerHeaderInfo,children:r("FolderLinkHeaderChatsJoin",l.length,"i")}),(0,te.Y)("div",{className:Pl.selectionToggle,role:"button",tabIndex:0,onClick:g,children:l.length===e.missingPeerIds.length?r("DeselectAll"):r("SelectAll")})]}),(0,te.Y)(Si.A,{itemIds:e.missingPeerIds,onSelectedIdsChange:c,selectedIds:l,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,te.Y)("div",{className:Pl.pickerHeader,children:(0,te.Y)("div",{className:Pl.pickerHeaderInfo,children:r("FolderLinkHeaderAlready")})}),(0,te.Y)(Si.A,{itemIds:e.alreadyPeerIds,lockedSelectedIds:e.alreadyPeerIds,selectedIds:e.alreadyPeerIds,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,te.Y)(Q.A,{onClick:v,children:(0,te.FD)("div",{className:Pl.buttonText,children:[!l.length&&r("OK"),Boolean(l.length)&&(0,te.FD)(te.FK,{children:[r("FolderLinkButtonJoinPlural",l.length,"i"),(0,te.Y)(Il.A,{className:Pl.buttonBadge,text:m,isAlternateColor:!0})]})]})})]})}),Fl=(0,n.ph)(({folder:e,suggestedPeerIds:t=yi.p})=>{const{closeChatlistModal:i,leaveChatlist:a}=(0,s.ko)(),o=(0,T.A)(),[r,l]=(0,n.J0)([]),c=r.length?r.length.toString():void 0,d=(0,n.hb)(()=>{const e=r.length===t.length;l(e?[]:t)},[t,r.length]),h=(0,n.hb)(()=>{i(),a({folderId:e.id,peerIds:r})},[e.id,r]);return(0,te.FD)("div",{className:Pl.content,children:[Boolean(t?.length)&&(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{className:Pl.description,children:(0,Dt.A)(o("FolderLinkSubtitleRemove"),["simple_markdown","emoji"])}),(0,te.FD)("div",{className:(0,me.A)(Pl.pickerWrapper,"custom-scroll"),children:[(0,te.FD)("div",{className:Pl.pickerHeader,children:[(0,te.Y)("div",{className:Pl.pickerHeaderInfo,children:o("FolderLinkHeaderChatsQuit",r.length,"i")}),(0,te.Y)("div",{className:Pl.selectionToggle,role:"button",tabIndex:0,onClick:d,children:r.length===t.length?o("DeselectAll"):o("SelectAll")})]}),(0,te.Y)(Si.A,{itemIds:t,onSelectedIdsChange:l,selectedIds:r,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]})]}),(0,te.Y)(Q.A,{onClick:h,children:(0,te.FD)("div",{className:Pl.buttonText,children:[!r.length&&o("FolderLinkButtonRemove"),Boolean(r.length)&&(0,te.FD)(te.FK,{children:[o("FolderLinkButtonRemoveChats"),(0,te.Y)(Il.A,{className:Pl.buttonBadge,text:c,isAlternateColor:!0})]})]})})]})}),Dl=(0,n.ph)(({invite:e})=>{const{closeChatlistModal:t,joinChatlistInvite:i}=(0,s.ko)(),a=(0,Ui.A)(),o=(0,T.A)(),[r,l]=(0,n.J0)(e.peerIds),c=(0,n.Kr)(()=>{const t=(0,s.mS)().chats.byId;return e.peerIds.filter(e=>!t[e].isNotJoined)},[e.peerIds]),d=r.length-c.length,h=d?d.toString():void 0,u=(0,n.hb)(()=>{t(),i({invite:e,peerIds:r})},[e,r]),m=(0,n.hb)(()=>{const t=r.length===e.peerIds.length;l(t?c:e.peerIds)},[e.peerIds,c,r.length]);return(0,te.FD)("div",{className:Pl.content,children:[(0,te.Y)("div",{className:Pl.description,children:a("FolderLinkSubtitleNew")}),(0,te.FD)("div",{className:(0,me.A)(Pl.pickerWrapper,"custom-scroll"),children:[(0,te.FD)("div",{className:Pl.pickerHeader,children:[(0,te.Y)("div",{className:Pl.pickerHeaderInfo,children:o("FolderLinkHeaderChatsJoin",d,"i")}),(0,te.Y)("div",{className:Pl.selectionToggle,role:"button",tabIndex:0,onClick:m,children:r.length===e.peerIds.length?o("DeselectAll"):o("SelectAll")})]}),(0,te.Y)(Si.A,{itemIds:e.peerIds,lockedSelectedIds:c,onSelectedIdsChange:l,selectedIds:r,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,te.Y)(Q.A,{onClick:u,disabled:!r.length,children:(0,te.FD)("div",{className:Pl.buttonText,children:[a("FolderLinkAddFolder"),(0,te.Y)(Il.A,{className:Pl.buttonBadge,text:h,isAlternateColor:!0})]})})]})}),Ml=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{invite:i,removal:n}=t||{},s=n?.folderId||(i&&"folderId"in i?i.folderId:void 0);return{folder:s?(0,c.$aQ)(e,s):void 0}})(({modal:e,folder:t})=>{const{closeChatlistModal:i}=(0,s.ko)(),a=(0,T.A)(),o=Boolean(e),r=(0,_.A)(e)||e,l=(0,_.A)(t)||t,c=(0,n.Kr)(()=>{if(r){if(r.invite){const e=r.invite;return"alreadyPeerIds"in e?e.missingPeerIds.length?a("FolderLinkTitleAddChats"):a("FolderLinkTitleAlready"):a("FolderLinkTitleAdd")}return r.removal?a("FolderLinkTitleRemove"):void 0}},[a,r]),d=(0,n.Kr)(()=>l?(0,un.fd)({text:l.title.text,entities:l.title.entities,noCustomEmojiPlayback:l.noTitleAnimations}):r?.invite&&"title"in r.invite?(0,un.fd)({text:r.invite.title.text,entities:r.invite.title.entities,noCustomEmojiPlayback:r.invite.noTitleAnimations}):void 0,[l,r]),h=(0,n.Kr)(()=>{if(r?.invite)return"missingPeerIds"in r.invite?r.invite.missingPeerIds.length:void 0},[r]),u=(0,n.hb)(()=>{if(r){if(r.invite){const e=r.invite;return"alreadyPeerIds"in e?(0,te.Y)(Yl,{invite:e,folder:l}):(0,te.Y)(Dl,{invite:e})}return r.removal?(0,te.Y)(Fl,{folder:l,suggestedPeerIds:r.removal.suggestedPeerIds}):void 0}},[l,r]);return(0,te.FD)(X.A,{isOpen:o,title:c,onClose:i,isSlim:!0,hasCloseButton:!0,children:[d&&(m=d,(0,te.Y)("div",{className:Pl.foldersWrapper,children:(0,te.FD)("div",{className:Pl.folders,children:[(0,te.Y)(Nl.A,{className:Pl.folder,title:a("FolderLinkPreviewLeft")}),(0,te.Y)(Nl.A,{className:Pl.folder,isActive:!0,badgeCount:h,isBadgeActive:!0,title:m}),(0,te.Y)(Nl.A,{className:Pl.folder,title:a("FolderLinkPreviewRight")})]})})),u()]});var m}));var Tl=i(29886);const Bl={content:"MZ0RCecx",title:"ar8XeydN",participantCount:"un00TXYY",participants:"YvkZ6c2D",participant:"DHJSBDeE",buttons:"KFtrPtNr"},Rl=(0,n.ph)(({modal:e})=>{const{acceptChatInvite:t,closeChatInviteModal:i,showNotification:a}=(0,s.ko)(),o=(0,n.li)(),r=(0,T.A)(),d=(0,Tl.A)(e),{hash:h,inviteInfo:u}=e||d||{},{about:m,isBroadcast:p,participantIds:v,participantsCount:g,photo:A,isRequestNeeded:f}=u||{},b=(0,M.A)(()=>{i()}),C=(0,M.A)(()=>{t({hash:h}),f&&a({message:r(p?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")}),b()}),y=p?"ProfileJoinChannel":"JoinGroup",S=p?"MemberRequests.RequestToJoinChannel":"MemberRequests.RequestToJoinGroup",k=(0,n.Kr)(()=>{if(u)return(0,l.nr)(u)},[u]),w=(0,n.Kr)(()=>{if(!v)return;const e=(0,s.mS)();return v.map(t=>(0,c.mBe)(e,t)).filter(Boolean)},[v]);return(0,xs.A)(o,!e||!w),(0,te.FD)(X.A,{isOpen:Boolean(e),contentClassName:Bl.content,isSlim:!0,onClose:b,onEnter:C,children:[k&&(0,te.Y)(Mt.A,{size:"jumbo",photo:A,peer:k,withVideo:!0}),k&&(0,te.Y)(qn.A,{className:Bl.title,peer:k}),m&&(0,te.Y)("p",{className:Bl.about,children:m}),(0,te.Y)("p",{className:Bl.participantCount,children:r(p?"Subscribers":"Members",g,"i")}),w&&(0,te.Y)("div",{ref:o,className:(0,me.A)(Bl.participants,"no-scrollbar"),children:w.map(e=>(0,te.Y)(_s.A,{className:Bl.participant,peer:e,text:(0,l.Yg)(e)}))}),(0,te.FD)("div",{className:(0,me.A)("dialog-buttons",Bl.buttons),children:[(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:C,children:r(f?S:y)}),(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:b,children:r("Cancel")})]})]})});var Ll=i(84685),xl=i(89873),El=i(5463);const Vl="La4sUYaq",_l="Bn5kz5br",Ul=(0,n.ph)((0,s.EK)(e=>({minLevelToRestrictAds:e.appConfig.channelRestrictAdsLevelMin}))(({modal:e,minLevelToRestrictAds:t})=>{const{closeAboutAdsModal:i}=(0,s.ko)(),a=(0,n.li)(),o=Boolean(e),r=(0,Ri.A)(e),{canReport:l,randomId:c,additionalInfo:d,sponsorInfo:h}=r||{},u=l,m=(0,Ri.A)(u),p=(0,T.A)(),v=(0,n.Kr)(()=>(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{children:p("SponsoredMessageInfoScreen.Title")}),(0,te.Y)("p",{children:(0,Dt.A)(p("SponsoredMessageInfoDescription1"),["br"])}),(0,te.Y)("p",{children:(0,Dt.A)(p("SponsoredMessageInfoDescription2"),["br"])}),(0,te.Y)("p",{children:(0,Dt.A)(p("SponsoredMessageInfoDescription3"),["br"])}),(0,te.Y)("p",{children:(0,te.Y)(Ll.A,{url:p("SponsoredMessageAlertLearnMoreUrl"),text:p("SponsoredMessageAlertLearnMoreUrl")})}),(0,te.Y)("p",{children:(0,Dt.A)(p("SponsoredMessageInfoDescription4"),["br"])})]}),[p]),{isContextMenuOpen:g,contextMenuAnchor:A,handleContextMenu:f,handleContextMenuClose:b,handleContextMenuHide:C}=(0,Ds.A)(a,!m),y=(0,M.A)(()=>{i(),b(),C()}),S=(0,n.Kr)(()=>{if(o)return{header:(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{className:Vl,children:p("AboutRevenueSharingAds")}),(0,te.Y)("p",{className:(0,me.A)(_l,"hbsLlXSH"),children:p("RevenueSharingAdsAlertSubtitle")}),(0,te.Y)(Q.A,{ref:a,round:!0,size:"smaller",color:"translucent",className:"JdN5pGTw",onClick:f,children:(0,te.Y)(W.A,{name:"more"})})]}),listItemData:[["lock",p("RevenueSharingAdsInfo1Title"),(0,Dt.A)(p("RevenueSharingAdsInfo1Subtitle"),["simple_markdown"])],["revenue-split",p("RevenueSharingAdsInfo2Title"),(0,Dt.A)(p("RevenueSharingAdsInfo2Subtitle"),["simple_markdown"])],["nochannel",p("RevenueSharingAdsInfo3Title"),(0,Dt.A)(p("RevenueSharingAdsInfo3Subtitle",t),["simple_markdown"])]],footer:(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{className:Vl,children:(0,Dt.A)(p("RevenueSharingAdsInfo4Title"),["simple_markdown"])}),(0,te.FD)("p",{className:_l,children:[(0,Dt.A)(p("RevenueSharingAdsInfo4Subtitle2",""),["simple_markdown"]),(0,te.Y)(Ll.A,{url:p("PromoteUrl"),text:p("LearnMoreArrow")})]})]})}},[o,p,f,t]);return m?(0,te.FD)(te.FK,{children:[(0,te.Y)(El.A,{isOpen:o,listItemData:S?.listItemData,headerIconName:"channel",withSeparator:!0,header:S?.header,footer:S?.footer,buttonText:p("RevenueSharingAdsUnderstood"),onClose:y}),A&&c&&(0,te.Y)(xl.A,{isOpen:g,anchor:A,triggerRef:a,randomId:c,additionalInfo:d,canReport:l,sponsorInfo:h,shouldSkipAbout:!0,onItemClick:y,onClose:b,onCloseAnimationEnd:C})]}):(0,te.FD)(X.A,{isOpen:o,className:"LFkgLoAk",contentClassName:"TZE15Pt_",onClose:y,children:[v,(0,te.Y)(Q.A,{onClick:y,children:p("RevenueSharingAdsUnderstood")})]})})),Ol="t9iZUzOj",Kl=(0,n.ph)(({isOpen:e,onClose:t})=>{const i=(0,T.A)(),s=(0,Ui.A)(),a=(0,n.Kr)(()=>{const e=i("LearnMore");return s("ChannelEarnLearnCoinAbout",{link:(0,te.FD)(Ll.A,{url:i("MonetizationInfoTONLink"),text:e,children:[e,(0,te.Y)(W.A,{name:"next"})]})},{withNodes:!0})},[s,i]),o=(0,n.Kr)(()=>s("MonetizationInfoTONTitle",void 0,{withNodes:!0,specialReplacement:{"💎":(0,te.Y)(W.A,{className:"ATkOSqJ7",name:"toncoin"})}}),[s]),r=(0,n.Kr)(()=>{if(e)return{header:(0,te.Y)("h3",{className:Ol,children:i("lng_channel_earn_learn_title")}),listItemData:[["channel",i("lng_channel_earn_learn_in_subtitle"),(0,Dt.A)(i("lng_channel_earn_learn_in_about"),["simple_markdown"])],["revenue-split",i("lng_channel_earn_learn_split_subtitle"),(0,Dt.A)(i("Monetization.Intro.Split.Text"),["simple_markdown"])],["cash-circle",i("lng_channel_earn_learn_out_subtitle"),(0,Dt.A)(i("lng_channel_earn_learn_out_about"),["simple_markdown"])]],footer:(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{className:Ol,children:o}),(0,te.Y)("p",{className:"mjveZmdr",children:a})]})}},[e,i,o,a]);if(r)return(0,te.Y)(El.A,{isOpen:e,listItemData:r.listItemData,headerIconName:"cash-circle",withSeparator:!0,header:r.header,footer:r.footer,buttonText:i("RevenueSharingAdsUnderstood"),onClose:t})});var Jl=i(15535);const Gl="oofoCYlu",jl=(0,n.ph)((0,s.EK)(e=>{const{twoFaSettings:{hint:t}}=e;return{passwordHint:t}})(({modal:e,passwordHint:t})=>{const{closeMonetizationVerificationModal:i,clearMonetizationVerificationError:a,processMonetizationRevenueWithdrawalUrl:o}=(0,s.ko)(),r=Boolean(e),l=(0,Ri.A)(e),c=(0,Ui.A)(),[d,h]=(0,n.J0)(!1),u=(0,M.A)(e=>{l&&o({peerId:l.chatId,currentPassword:e})}),m=(0,M.A)(()=>{a()}),p=(0,M.A)(()=>{i()});return(0,te.Y)(X.A,{isOpen:r,hasCloseButton:!0,title:c("CheckPasswordTitle"),className:"WqeWhMAS",contentClassName:Gl,onClose:p,children:(0,te.Y)("div",{className:(0,me.A)(Gl,"settings-content password-form custom-scroll"),children:(0,te.Y)("div",{className:"settings-item pt-0",children:(0,te.Y)(Jl.A,{shouldShowSubmit:!0,placeholder:c("CheckPasswordPlaceholder"),error:l?.errorKey&&c.withRegular(l.errorKey),description:c("CheckPasswordDescription"),onClearError:m,isLoading:l?.isLoading,hint:t,isPasswordVisible:d,shouldResetValue:r,onChangePasswordVisibility:h,onSubmit:u})})})})})),zl={content:"MKdSUg2P",chatItem:"qEIwBtp0"},Hl=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.mBe)(e,e.currentUserId),i=(0,c.g29)(e);return{currentUser:t,stickerSet:e.defaultStatusIconsId?(0,c.ycM)(e,e.defaultStatusIconsId):void 0,isPremium:i,isAccountFrozen:(0,c.trm)(e)}})(({modal:e,currentUser:t,stickerSet:i,isPremium:a,isAccountFrozen:o})=>{const{closeEmojiStatusAccessModal:r,toggleUserEmojiStatusPermission:c,sendWebAppEvent:d,openPremiumModal:h,loadDefaultStatusIcons:u}=(0,s.ko)(),m=Boolean(e),p=(0,T.A)(),v=(0,Ui.A)(),g=(0,n.li)(),[A,f]=(0,n.J0)(0);(0,n.vJ)(()=>{!m||i?.stickers||o||u()},[m,i,o]);const b=(0,n.Kr)(()=>{if(t&&i?.stickers)return{...t,emojiStatus:{type:"regular",documentId:i.stickers[A].id}}},[t,i,A]),C=i?.stickers?.length;(0,Fs.A)(()=>{C&&f(e=>(e+1)%C)},C?3200:void 0);const y=(0,M.A)(()=>(0,te.Y)(cl.A,{withEmojiStatus:!0,className:zl.chatItem,itemClassName:zl.itemName,mockPeer:b})),S=(0,M.A)(()=>{e?.bot?.id&&(r(),e?.webAppKey&&(a?(d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"allowed"}}}),c({botId:e.bot.id,isEnabled:!0,isBotAccessEmojiGranted:!0})):(h(),d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}))))}),k=(0,M.A)(()=>{e?.bot?.id&&(r(),e?.webAppKey&&d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}),a&&c({botId:e.bot.id,isEnabled:!1}))}),w=(0,M.A)(()=>{if(e?.bot)return v("EmojiStatusAccessText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})});return(0,te.FD)(X.A,{className:(0,me.A)("confirm"),contentClassName:zl.content,isOpen:m,onClose:k,children:[y(),(0,te.FD)("div",{children:[w(),(0,te.FD)("div",{className:"dialog-buttons mt-2",ref:g,children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:S,color:"primary",children:p("lng_bot_allow_write_confirm")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:k,children:v("Cancel")})]})]})]})})),$l=(0,n.ph)((0,s.EK)(e=>({currentUser:(0,c.mBe)(e,e.currentUserId)}))(({modal:e,currentUser:t})=>{const{closeLocationAccessModal:i,toggleUserLocationPermission:a,sendWebAppEvent:o}=(0,s.ko)(),r=Boolean(e),c=(0,T.A)(),d=(0,Ui.A)(),h=(0,n.li)(),m=(0,M.A)(async()=>{const t=await(0,u.Bu)(),{geolocation:n}=t;e?.bot?.id&&(i(),e?.webAppKey&&(a({botId:e.bot.id,isAccessGranted:!0}),o({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!0,latitude:n?.latitude,longitude:n?.longitude,altitude:n?.altitude,course:n?.heading,speed:n?.speed,horizontal_accuracy:n?.accuracy,vertical_accuracy:n?.accuracy}}})))}),p=(0,M.A)(()=>{e?.bot?.id&&(i(),e?.webAppKey&&(a({botId:e.bot.id,isAccessGranted:!1}),o({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!1}}})))}),v=(0,M.A)(()=>{if(e?.bot)return(0,te.FD)("div",{className:"CGPoDaLo",children:[(0,te.Y)(Mt.A,{size:"large",peer:t}),(0,te.Y)(W.A,{name:"next",className:"pzERgD5x"}),(0,te.Y)(Mt.A,{size:"large",peer:e.bot})]})}),g=(0,M.A)(()=>{if(e?.bot)return d("LocationPermissionText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})});return(0,te.FD)(X.A,{className:(0,me.A)("confirm"),isOpen:r,onClose:p,children:[v(),(0,te.FD)("div",{children:[g(),(0,te.FD)("div",{className:"dialog-buttons mt-2",ref:h,children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"primary",children:c("lng_bot_allow_write_confirm")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:p,children:d("Cancel")})]})]})]})})),ql="qJDgUtjV",Wl=(0,n.ph)(({modal:e})=>{const{reportSponsored:t,closeReportAdModal:i,openPreviousReportAdModal:a}=(0,s.ko)(),o=(0,T.A)(),l=Boolean(e),c=(0,n.li)(),d=(0,M.A)((i,n)=>{const{chatId:s,randomId:a}=e;t({peerId:s,randomId:a,option:n})}),[h,u]=(0,n.Kr)(()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e.sections[t],t]},[e]),m=(0,M.A)(()=>{u?a():i()}),p=(0,n.Kr)(()=>{if(!e)return;const t=o("lng_report_sponsored_reported_learn").split("{link}");return[t[0],(0,te.Y)(Ll.A,{text:o("lng_report_sponsored_reported_link"),url:o("ReportAd.Help_URL")}),t[1]]},[o,e]),v=(0,n.Kr)(()=>{if(!e)return;const t=Boolean(h?.subtitle);return(0,te.FD)("div",{className:"modal-header-condensed",children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:o(u?"Back":"Close"),onClick:m,children:(0,te.Y)(W.A,{name:u?"arrow-left":"close"})}),(0,te.FD)("div",{className:(0,me.A)("modal-title","ZAdG13Ah",t&&"lVVyV0py"),children:[(0,te.Y)("h3",{className:"mMmY6YR4",children:o("ReportAd")}),t&&(0,te.Y)("span",{className:"gSkAFc4u",children:h.subtitle})]})]})},[o,e,u,h?.subtitle]);(0,n.vJ)(()=>{if(!e)return;const t=document.querySelector(`.${se.uo} > .${ql}`);if(!t)return;const i=t.scrollHeight;(0,r.RK)(()=>{c.current.style.height=`${i+56}px`})},[e]);const g=(0,M.A)(()=>{const e=document.querySelector(`.${se.VY} > .${ql}`);(0,r.YS)(()=>{const t=e.scrollHeight;(0,r.RK)(()=>{c.current.style.height=`${t+56}px`})})});return(0,te.Y)(X.A,{isOpen:l,hasCloseButton:!0,className:"njPBcVYr",header:v,onClose:i,children:(0,te.FD)(se.Ay,{name:"slide",className:"HjsGIG6e",ref:c,activeKey:u,onStart:g,children:[(0,te.FD)("div",{className:ql,children:[(0,te.Y)("h3",{className:"jrA2dOiw",children:h?.title}),h?.options.map(e=>(0,te.Y)(di.A,{narrow:!0,secondaryIcon:"next",className:"aFbjDzNo",buttonClassName:"VbE0HzDs",clickArg:e.option,onClick:d,children:(0,te.Y)("div",{className:"oWujoaSC",children:e.text})}))]}),(0,te.Y)("p",{className:"k71Zrc_P",children:p})]})})});var Ql=i(94079);const Zl="kq9LwNTZ",Xl=(0,n.ph)(({modal:e})=>{const{reportMessages:t,reportStory:i,closeReportModal:a,openPreviousReportModal:o}=(0,s.ko)(),l=(0,T.A)(),c=Boolean(e),d=(0,n.li)(),[h,u]=(0,n.J0)(""),m=(0,M.A)((n,s)=>{const{messageIds:a,subject:o,peerId:r,chatId:l}=e;if(a)switch(o){case"message":t({chatId:l,messageIds:a,option:s});break;case"story":i({storyId:a[0],peerId:r,option:s})}}),[p,v]=(0,n.Kr)(()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e?.sections[t],t]},[e]),g=(0,M.A)(()=>{o()}),A=(0,M.A)(()=>{a()}),f=(0,n.Kr)(()=>{if(!e)return;const t=Boolean(p?.subtitle);return(0,te.FD)("div",{className:"modal-header-condensed",children:[v?(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Back"),onClick:g,children:(0,te.Y)(W.A,{name:"arrow-left"})}):(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Close"),onClick:A,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.FD)("div",{className:(0,me.A)("modal-title","Lj_ezEWU",t&&"OYFbu8fQ"),children:[(0,te.Y)("h3",{className:(0,me.A)("QawchdxB",v&&"CV7kzv9H"),children:p?.options?l("story"===e?.subject?"ReportStory":"Report"):p?.title}),t&&(0,te.Y)("span",{className:"OUFckTb7",children:p.subtitle})]})]})},[l,e,v,p?.options,p?.subtitle,p?.title]),b=(0,M.A)(e=>{u(e.target.value)});(0,n.vJ)(()=>{if(!e)return;const t=document.querySelector(`.${se.uo} > .${Zl}`);if(!t)return;const i=t.scrollHeight;(0,r.RK)(()=>{d.current.style.height=`${i}px`})},[e]);const C=(0,M.A)(()=>{const e=document.querySelector(`.${se.VY} > .${Zl}`);(0,r.YS)(()=>{const t=e.scrollHeight;(0,r.RK)(()=>{d.current.style.height=`${t+20}px`})})}),y=(0,M.A)(()=>{u(""),a()}),S=(0,M.A)(()=>{const{messageIds:n,subject:s,peerId:a,chatId:o}=e;switch(s){case"message":t({chatId:o,messageIds:n,option:p?.option,description:h});break;case"story":i({storyId:n?.[0],peerId:a,option:p?.option,description:h})}y()});return(0,te.Y)(X.A,{isOpen:c,header:f,onClose:y,contentClassName:"tNysQgHL",className:(0,me.A)("E1bGWeON","story"===e?.subject&&"component-theme-dark"),children:(0,te.Y)(se.Ay,{name:"slide",className:"n2VxPirU",ref:d,activeKey:v,onStart:C,children:(0,te.FD)("div",{className:Zl,children:[p?.options?(0,te.Y)("h3",{className:"GSfUuTet",children:p?.title}):void 0,p?.options?.map(e=>(0,te.Y)(di.A,{narrow:!0,nonInteractive:!0,secondaryIcon:"next",className:"RoxwMzvA",buttonClassName:"Z6skYdvb",clickArg:e.option,onClick:m,children:(0,te.Y)("div",{className:"FU8m6NUU",children:e.text})})),p?.option?(0,te.FD)("div",{className:"KpptZ3Mk",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Report,size:100,className:"kO8JC4gK",nonInteractive:!0,forceAlways:!0,noLoop:!1}),(0,te.Y)(Ql.A,{id:"option",className:"yc3szGcx",label:p.isOptional?l("Report2CommentOptional"):l("Report2Comment"),onChange:b,value:h,maxLength:512,maxLengthIndicator:(512-h.length).toString(),noReplaceNewlines:!0}),(0,te.Y)(Q.A,{onClick:S,disabled:p.isOptional?void 0:!h.length,children:l("ReportSend")})]}):void 0]})})})});var ec=i(65632),tc=i(90596);const ic=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=(0,c.SJA)(e),{isBlurred:n,patternColor:s,background:a,backgroundColor:o}=(0,c.Gyz)(e,i)||{};return{theme:i,isBackgroundBlurred:n,patternColor:s,customBackground:a,backgroundColor:o,bot:t?(0,c.mBe)(e,t?.botId):void 0,currentUserId:e.currentUserId}})(({modal:e,theme:t,isBackgroundBlurred:i,patternColor:a,customBackground:o,backgroundColor:r,bot:c})=>{const{closePreparedInlineMessageModal:d,sendWebAppEvent:h,openSharePreparedMessageModal:u}=(0,s.ko)(),m=(0,Ui.A)(),p=Boolean(e),{webAppKey:v,message:g,botId:A}=e||{},f=(0,n.li)(),b=(0,ec.A)(t,o),C=(0,M.A)(()=>{v&&A&&g&&(u({webAppKey:v,message:g}),d())}),y=(0,M.A)(()=>{d(),v&&h({webAppKey:v,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})}),S=(0,n.Kr)(()=>{if(e)return(0,te.FD)("div",{className:"P1fPh6h8",children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:m("Close"),onClick:y,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("h3",{className:(0,me.A)("modal-title","E42tgAwD"),children:m("BotShareMessage")})]})},[m,e]),k=(0,n.Kr)(()=>{if(A&&g&&v)return(0,l.i7)(A,g)},[A,g,v]),w=(0,me.A)("_6w75ldP","lElCwweL",o&&"CZkpv8n0",r&&"VJAYrDF_",o&&i&&"m8xzfVvU");return(0,te.FD)(X.A,{dialogRef:f,isOpen:p,header:S,onClose:y,className:"Rzj2LMLf",contentClassName:"Ve4u2KVI",children:[(0,te.FD)("div",{className:(0,me.A)("McJgXCtB","MessageList"),inert:!0,style:(0,Mi.A)(`--pattern-color: ${a}`,r&&`--theme-background-color: ${r}`),children:[(0,te.Y)("div",{className:w,style:b?`--custom-background: ${b}`:void 0}),k&&(0,te.Y)(tc.A,{message:k,threadId:O.l3,messageListType:"thread",noComments:!0,noReplies:!0,appearanceOrder:0,isJustAdded:!1,isFirstInGroup:!0,isLastInGroup:!0,isLastInList:!1,isFirstInDocumentGroup:!1,isLastInDocumentGroup:!1},A)]}),(0,te.FD)("div",{className:"pNSCKAVN",children:[(0,te.Y)("p",{className:"xWnXsG7q",children:m("WebAppShareMessageInfo",{user:(0,l.Yg)(c)})}),(0,te.Y)(Q.A,{onClick:C,children:m("BotShareMessageShare")})]})]})}));var nc=i(20247),sc=i(48227);const ac=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e),{isPaymentMessageConfirmDialogOpen:i}=t;return{isPaymentMessageConfirmDialogOpen:i,starsBalance:e.stars?.balance.amount||0,isStarsBalanceModalOpen:Boolean(t.starsBalanceModal)}})(({modal:e,isPaymentMessageConfirmDialogOpen:t,isStarsBalanceModalOpen:i,starsBalance:a})=>{const{closeSharePreparedMessageModal:o,sendInlineBotResult:r,sendWebAppEvent:l,showNotification:d,updateSharePreparedMessageModalSendArgs:h}=(0,s.ko)(),u=(0,T.A)(),m=Boolean(e),[p,v,g]=(0,F.A)();(0,n.vJ)(()=>{m&&v()},[m,v]);const{message:A,filter:f,webAppKey:b,pendingSendArgs:C}=e||{},{starsForSendMessage:y}=C||{},{closeConfirmDialog:S,dialogHandler:k,shouldAutoApprove:w,setAutoApprove:N,handleWithConfirmation:I}=(0,nc.A)(y||0,i,a),P=(0,M.A)(()=>{o(),b&&l({webAppKey:b,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})}),Y=(0,M.A)((e,t)=>{if(A&&b){const i=(0,s.mS)(),n=(0,c.PVB)(i,e);r({chatId:e,threadId:t||O.l3,id:A.result.id,queryId:A.result.queryId}),y||d({message:u("BotSharedToOne",(0,Ft.F9)(u,n))}),l({webAppKey:b,event:{eventType:"prepared_message_sent"}}),o(),h({args:void 0})}}),D=(0,M.A)((e,t)=>{h({args:{peerId:e,threadId:t}})}),B=(0,M.A)(()=>{C&&I(Y,C.peerId,C.threadId)}),R=(0,M.A)(()=>{S(),h({args:void 0})});(0,n.vJ)(()=>{C&&B()},[C]);const L=(0,s.mS)(),x=C?(0,c.PVB)(L,C.peerId):void 0,E=x?(0,Ft.F9)(u,x):void 0;if(m||p)return(0,te.FD)(te.FK,{children:[(0,te.Y)(ts,{isOpen:m,searchPlaceholder:u("Search"),filter:f,onSelectRecipient:D,onClose:P,onCloseAnimationEnd:g,isLowStackPriority:!0}),(0,te.Y)(sc.A,{isOpen:t,onClose:R,userName:E,messagePriceInStars:y||0,messagesCount:1,shouldAutoApprove:w,setAutoApprove:N,confirmHandler:k})]})}));var oc=i(19408);const rc={content:"iGABsB4C",modalHeader:"Ofq4u4pq",section:"k44LZ99u",form:"VhNBPaMY",label:"anDcU5bi",input:"kYxuUcwe",description:"A_JjwhXv",timeInputIcon:"pHne2E6K",offerButton:"d_PCM2tC",currencySelector:"genSNudF",currencyIcon:"fT5aRs0H"},lc=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=e.stars?.balance,n=t?(0,c.PVB)(e,t.chatId):void 0,s=t?(0,oc.GA)(e,t.chatId,O.l3):void 0,{appConfig:a}=e,o=a.starsSuggestedPostAmountMax,r=a.starsSuggestedPostAmountMin,l=a.starsSuggestedPostAgeMin,d=a.starsSuggestedPostFutureMin,h=a.starsSuggestedPostFutureMax,u=a.tonSuggestedPostAmountMax,m=a.tonSuggestedPostAmountMin,p=!!t&&(0,c.ODG)(e,t.chatId);return{peer:n,starBalance:i,tonBalance:e.ton?.balance?.amount,currentDraft:s,maxStarsAmount:o,minStarsAmount:r,tonMaxAmount:u,tonMinAmount:m,ageMinSeconds:l,futureMin:d,futureMax:h,isMonoforumAdmin:p}})(({modal:e,starBalance:t,tonBalance:i,peer:a,currentDraft:r,maxStarsAmount:l,minStarsAmount:c,tonMaxAmount:d,tonMinAmount:h,ageMinSeconds:u,futureMin:m,futureMax:p,isMonoforumAdmin:v})=>{const{closeSuggestMessageModal:g,updateDraftSuggestedPostInfo:A,openStarsBalanceModal:f}=(0,s.ko)(),[b,C,y]=(0,F.A)(),S=r?.suggestedPostInfo,k=r?.replyInfo,w=Boolean(k),[N,I]=(0,n.J0)(S?.price?.amount||void 0),[P,Y]=(0,n.J0)(S?.price?.currency||o.OUy),[D,B]=(0,n.J0)(S?.scheduleDate?1e3*S.scheduleDate:void 0);(0,n.vJ)(()=>{const e=S?.price,t=e?.currency===o.ykW?(0,ka.wD)(e.amount):e?.amount;I(t),Y(S?.price?.currency||o.OUy),B(S?.scheduleDate?1e3*S.scheduleDate:void 0)},[S]);const R=(0,Ui.A)(),L=(0,T.A)(),x=P===o.OUy,E=Math.floor(Date.now()/1e3),V=1e3*(E+m),_=1e3*(E+p),U=1e3*(E+2*m),O=(0,M.A)(e=>{const t=e.target.value,i=parseFloat(t),n=""===t||Number.isNaN(i)?void 0:Math.min(Math.max(i,0),j);I(n)}),K=(0,M.A)(e=>{B(e.getTime()),y()}),J=(0,M.A)(()=>{B(void 0),y()}),G=x?c:(0,ka.wD)(h),j=x?l:(0,ka.wD)(d),z=Boolean(N)&&N<G,H=(0,M.A)(()=>{const e=N?x?N:(0,ka.tT)(N):0;if(!z){if(!v)if(x){if(e>(t?.amount||0))return void f({topup:{balanceNeeded:e}})}else if(e>(i||0))return void f({currency:o.ykW});A({price:{currency:P,amount:e,nanos:0},scheduleDate:D?Math.max(D/1e3,(0,ci.Fm)()+m+60):void 0}),g()}});return(0,te.Y)(X.A,{headerClassName:rc.modalHeader,isOpen:Boolean(e),onClose:g,isSlim:!0,isLowStackPriority:!0,hasCloseButton:!0,contentClassName:rc.content,title:R(w?"TitleSuggestedChanges":"TitleSuggestMessage"),children:(0,te.FD)("div",{className:rc.form,children:[(0,te.FD)("div",{className:rc.section,children:[(0,te.FD)("div",{className:rc.currencySelector,children:[(0,te.FD)(Q.A,{className:rc.currencyButton,color:x?"primary":"translucent",pill:!0,fluid:!0,size:"tiny",noFastClick:!0,onClick:()=>Y(o.OUy),children:[(0,te.Y)(W.A,{name:"star",className:rc.currencyIcon}),R("CurrencyStars")]}),(0,te.FD)(Q.A,{className:rc.currencyButton,fluid:!0,color:x?"translucent":"primary",pill:!0,size:"tiny",noFastClick:!0,onClick:()=>Y(o.ykW),children:[(0,te.Y)(W.A,{name:"toncoin",className:rc.currencyIcon}),R("CurrencyTon")]})]}),(0,te.Y)(Z.A,{label:R("InputPlaceholderPrice"),className:(0,me.A)(rc.input),value:N?.toString(),onChange:O,inputMode:"numeric",tabIndex:0,teactExperimentControlled:x}),(0,te.Y)("div",{className:rc.description,children:void 0!==N&&N>0&&N<G?R("DescriptionSuggestedPostMinimumOffer",{amount:x?(0,Ei.Kk)(R,G):(0,Ei.QH)(R,G)},{withNodes:!0,withMarkdown:!0}):R(x?"SuggestMessagePriceDescriptionStars":"SuggestMessagePriceDescriptionTon")})]}),(0,te.FD)("div",{className:rc.section,children:[(0,te.FD)("div",{className:(0,me.A)(rc.input,"input-group","touched"),children:[(0,te.Y)("input",{type:"text",className:(0,me.A)("form-control",b&&"focus"),value:D?(0,He.e0)(D/1e3,R,L):R("SuggestMessageAnytime"),autoComplete:"off",onClick:C,onFocus:C,readOnly:!0}),(0,te.Y)("label",{children:R("InputTitleSuggestMessageTime")}),(0,te.Y)(W.A,{name:"down",className:rc.timeInputIcon})]}),(0,te.Y)("div",{className:rc.description,children:R("SuggestMessageTimeDescription",{hint:R("SuggestMessageDateTimeHint"),duration:(0,He.A$)(R,u,!0)})})]}),(0,te.Y)(ys,{isOpen:b,isFutureMode:!0,withTimePicker:!0,minAt:V,maxAt:_,onClose:y,onSubmit:K,selectedAt:D||U,submitButtonLabel:R("Save"),secondButtonLabel:R("SuggestMessageAnytime"),onSecondButtonClick:J,description:R("SuggestMessageDateTimeHint")}),(0,te.Y)(Q.A,{className:rc.offerButton,onClick:H,disabled:z,children:w?R("ButtonUpdateTerms"):N?R("ButtonOfferAmount",{amount:x?(0,Ei.U2)(R,N,{asFont:!0}):(0,Ei.Ms)(R,N)},{withNodes:!0,withMarkdown:!0}):R("ButtonOfferFree")})]})})})),cc="xqyFGV8R",dc=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=t&&(0,c.O5q)(e,t.chatId,t.messageId),n=i?(0,c.Y7C)(e,i):void 0,s=t&&(0,c.ODG)(e,t.chatId),{appConfig:a}=e,o=a.starsSuggestedPostCommissionPermille,r=a.tonSuggestedPostCommissionPermille,l=a.starsSuggestedPostAgeMin,d=a.starsSuggestedPostFutureMin,h=a.starsSuggestedPostFutureMax,u=i?.suggestedPostInfo?.scheduleDate;return{minAge:l,futureMin:d,futureMax:h,message:i,sender:n,isAdmin:s,commissionPermille:o,tonCommissionPermille:r,scheduleDate:u}})(({modal:e,message:t,sender:i,isAdmin:a,commissionPermille:r,tonCommissionPermille:l,minAge:c,futureMin:d,futureMax:h,scheduleDate:u})=>{const{closeSuggestedPostApprovalModal:m,approveSuggestedPost:p}=(0,s.ko)(),v=(0,Ui.A)(),g=(0,T.A)(),[A,f,b]=(0,F.A)(),C=Math.floor(Date.now()/1e3),y=1e3*(C+d),S=1e3*(C+h),k=C+2*d,[w,N]=(0,n.J0)(k),I=(0,M.A)(()=>{m()}),P=(0,M.A)(t=>{e&&(p({chatId:e.chatId,messageId:e.messageId,scheduleDate:t}),m())}),Y=(0,M.A)(e=>{const t=Math.floor(e.getTime()/1e3);N(t)}),D=(0,M.A)(e=>{const t=Math.floor(e.getTime()/1e3);b(),P(t)}),B=(0,M.A)(()=>{b(),P()}),R=(0,M.A)(()=>{u?P(u):f()});if(!e||!t)return;const L=i?(0,Ft.em)(g,i):"";return(0,te.FD)(te.FK,{children:[(0,te.Y)(gi.A,{isOpen:Boolean(e)&&!A,onClose:I,title:v("SuggestedPostConfirmTitle"),confirmHandler:R,confirmLabel:v(u?"ButtonPublish":"Next"),children:(()=>{const e=t?.suggestedPostInfo?.price,i=e?.amount,n=e?.currency||o.OUy,s=v("SuggestedPostConfirmMessage",{peer:L},{withNodes:!0,withMarkdown:!0}),d=(0,Dt.A)(s);if(!i)return d;const h=(n===o.ykW?l:r)/10,m=i/100*h,p=n===o.ykW?(0,Ei.QH)(v,(0,ka.wD)(m)):(0,Ei.Kk)(v,m),A=c,f=(0,He.A$)(v,A,!0);if(u){const e=(0,He.e0)(u,v,g),t=a?"SuggestedPostConfirmDetailsWithTimeAdmin":"SuggestedPostConfirmDetailsWithTimeUser";return(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{children:d}),(0,te.Y)("div",{className:cc,children:(0,Dt.A)(v(t,{amount:p,commission:h,duration:f,time:e},{withNodes:!0,withMarkdown:!0}))})]})}const b=a?"SuggestedPostConfirmDetailsAdmin":"SuggestedPostConfirmDetailsUser";return(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{children:d}),(0,te.Y)("div",{className:cc,children:(0,Dt.A)(v(b,{amount:p,commission:h,duration:f},{withNodes:!0,withMarkdown:!0}))})]})})()}),(0,te.Y)(ys,{isOpen:A,isFutureMode:!0,withTimePicker:!0,minAt:y,maxAt:S,onClose:b,onSubmit:D,onDateChange:Y,selectedAt:1e3*w,submitButtonLabel:v("ButtonPublishAtTime",{time:(0,He.e0)(w,v,g)}),secondButtonLabel:v("PublishNow"),onSecondButtonClick:B,description:v("SuggestMessageDateTimeHint")})]})})),hc=["embedLinks","sendPolls","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs","sendStickers","sendGifs"],uc=[...hc,"sendPlain"];function mc(e){const[t,i]=(0,n.J0)({}),[s,a]=(0,n.J0)(!1),[o,r]=(0,n.J0)(!1);(0,n.vJ)(()=>{i(e||{}),a(!1),setTimeout(()=>{r(!1)},250)},[e]);const l=(0,n.hb)(n=>{const{name:s}=n.target,o=s;function r(e){return!e||void 0}const l=t;let c={...l,[o]:r(l[o]),..."sendStickers"===o&&{sendGifs:r(l[o])}};const d=()=>{const e=hc.map(e=>c[e]);e.some(e=>!e)?c={...c,sendMedia:void 0}:e.every(Boolean)&&(c={...c,sendMedia:!0})};"sendMedia"!==o?d():c={...c,...hc.reduce((e,t)=>Object.assign(e,{[t]:c.sendMedia}),{})},"embedLinks"!==o&&!c.embedLinks&&c.sendPlain&&(c={...c,embedLinks:!0}),"sendPlain"!==o&&!c.embedLinks&&c.sendPlain&&(c={...c,sendPlain:void 0}),"sendMedia"!==o&&d();const h=uc.every(e=>c[e]);c={...c,sendMessages:!!h||void 0},i(c),a(!e||Object.keys(c).some(t=>{const i=t;return Boolean(e[i])!==Boolean(c[i])}))},[e,t]),c=(0,n.hb)(()=>{i(e||{}),a(!1)},[e]);return{permissions:t,isLoading:o,havePermissionChanged:s,handlePermissionChange:l,setIsLoading:r,resetPermissions:c}}const pc=["sendPhotos","sendVideos","sendStickers","sendAudios","sendDocs","sendVoices","sendRoundvideos","embedLinks","sendPolls"],vc=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=t?(0,c.hds)(e,t):void 0,n=i&&(0,c.AWZ)(e,i.id);return{chat:i,hasLinkedChat:Boolean(n?.linkedChatId)}})(({chat:e,isMediaDropdownOpen:t,setIsMediaDropdownOpen:i,hasLinkedChat:a,permissions:o,handlePermissionChange:r,className:c,shiftedClassName:d,dropdownClassName:h,withCheckbox:u,getControlIsDisabled:m,permissionGroup:p})=>{const{showNotification:v}=(0,s.ko)(),{isForum:g}=e||{},A=(0,Ui.A)(),f=(0,n.Kr)(()=>e&&(0,l.gA)(e),[e]),b=a||f,C=(0,n.Kr)(()=>pc.reduce((e,t)=>(o[t]||(e+=1),e),0),[o]),S=(0,M.A)(e=>{(0,y.A)(e),i(!t)}),k=(0,M.A)(()=>{v({message:A("ChatPermissionNotAvailable")})});return(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendPlain",checked:!o.sendPlain,label:A("UserRestrictionsSend"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendPlain")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendMedia",checked:!o.sendMedia,label:A("UserRestrictionsSendMedia"),labelText:`${C}/${pc.length}`,blocking:!0,permissionGroup:p,rightIcon:t?"up":"down",onChange:r,onClickLabel:S,disabled:m&&m("sendMedia")})}),(0,te.Y)("div",{className:h,children:(0,te.FD)("div",{className:c,children:[(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendPhotos",checked:!o.sendPhotos,label:A("SendMediaPermissionPhotos"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendPhotos")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendVideos",checked:!o.sendVideos,label:A("SendMediaPermissionVideos"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendVideos")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendStickers",checked:!o.sendStickers&&!o.sendGifs,label:A("SendMediaPermissionStickersGifs"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendStickers")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendAudios",checked:!o.sendAudios,label:A("SendMediaPermissionAudios"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendAudios")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendDocs",checked:!o.sendDocs,label:A("SendMediaPermissionFiles"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendDocs")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendVoices",checked:!o.sendVoices,label:A("SendMediaPermissionVoices"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendVoices")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendRoundvideos",checked:!o.sendRoundvideos,label:A("SendMediaPermissionRoundVideos"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendRoundvideos")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"embedLinks",checked:!o.embedLinks,label:A("SendMediaPermissionWebPages"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("embedLinks")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"sendPolls",checked:!o.sendPolls,label:A("SendMediaPermissionPolls"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("sendPolls")})})]})}),(0,te.FD)("div",{className:d,children:[(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"inviteUsers",checked:!o.inviteUsers,label:A("UserRestrictionsInviteUsers"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("inviteUsers")})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),onClick:b?k:void 0,children:(0,te.Y)(ps.A,{name:"pinMessages",checked:!o.pinMessages,label:A("UserRestrictionsPinMessages"),disabled:m?m("pinMessages"):b,blocking:!0,permissionGroup:p,onChange:r})}),(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),onClick:b?k:void 0,children:(0,te.Y)(ps.A,{name:"changeInfo",checked:!o.changeInfo,label:A("UserRestrictionsChangeInfo"),blocking:!0,permissionGroup:p,disabled:m?m("changeInfo"):b,onChange:r})}),g&&(0,te.Y)("div",{className:(0,me.A)("ListItem",u&&"with-checkbox"),children:(0,te.Y)(ps.A,{name:"manageTopics",checked:!o.manageTopics,label:A("UserRestrictionsCreateTopics"),blocking:!0,permissionGroup:p,onChange:r,disabled:m&&m("manageTopics")})})]})]})}));var gc=i(77561);const Ac="yGhFKTl5",fc="goI3MITH",bc=(0,n.ph)((0,s.EK)(e=>{const{deleteMessageModal:t}=(0,c.nTw)(e),i=t?.messageIds,n=t?.chatId,{canDeleteForAll:s}=(0,c.jyG)(e,i),a=n?(0,c.hds)(e,n):void 0,o=a&&(0,c.AWZ)(e,a.id),r=o?.linkedChatId,d=Boolean(a)&&(0,l.WX)(a),h=Boolean(a)&&(0,l.Vs)(a),u=t?.isSchedule,m=t?.onConfirm,p=a&&(0,v.L8)(a.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(a))):void 0,g=Boolean(a&&!(0,l.DX)(a.id)&&(0,c.yps)(e,a.id)),A=o?.adminMembersById,f=a&&(0,l.ub)(a,"banUsers"),b=a?.isCreator,C=a?(0,c.ALW)(e,a):void 0,y=a&&(0,l.yn)(a)&&!s||C,S=a&&((0,l.Vs)(a)||d);return{chat:a,isChannel:d,isSuperGroup:h,messageIds:i,currentUserId:e.currentUserId,canDeleteForAll:!u&&s,contactName:p,willDeleteForCurrentUserOnly:y,willDeleteForAll:S,adminMembersById:A,chatBot:g,canBanUsers:f,linkedChatId:r,isSchedule:u,isCreator:b,onConfirm:m}})(({isOpen:e,chat:t,isChannel:i,isSuperGroup:a,isSchedule:o,currentUserId:r,messageIds:l,isCreator:d,canDeleteForAll:h,contactName:u,willDeleteForCurrentUserOnly:m,willDeleteForAll:p,chatBot:v,adminMembersById:g,canBanUsers:A,linkedChatId:f,onConfirm:b})=>{const{closeDeleteMessageModal:C,deleteMessages:y,reportChannelSpam:S,deleteChatMember:k,deleteScheduledMessages:w,exitMessageSelectMode:N,updateChatMemberBannedRights:I,deleteParticipantHistory:P}=(0,s.ko)(),Y=(0,_.A)(e),F=(0,T.A)(),D=(0,Ui.A)(),{permissions:B,havePermissionChanged:R,handlePermissionChange:L,resetPermissions:x}=mc(t?.defaultBannedRights),[E,V]=(0,n.J0)([]),[U,O]=(0,n.J0)([]),[K,J]=(0,n.J0)([]),[G,j]=(0,n.J0)(!1),[z,H]=(0,n.J0)(!1),[$,q]=(0,n.J0)(!0),Z=(0,n.Kr)(()=>{if(i||!l||!t)return yi.p;const e=(0,s.mS)(),n=(0,c.SpN)(e,t.id,l);return n?(0,Ci.Am)(n).filter(e=>e?.id!==t?.id&&e?.id!==f&&e?.id!==t?.linkedMonoforumId):yi.p},[t,i,f,l]),ee=(0,M.A)(()=>Z.map(e=>({value:e.id,label:(0,Ft.F9)(D,e)||"",leftElement:(0,te.Y)(Mt.A,{size:"small",peer:e})}))),ie=(0,n.Kr)(()=>Z.filter(e=>e.id!==f&&e.id!==t?.linkedMonoforumId&&e.id!==r),[Z,r,f,t?.linkedMonoforumId]),ne=(0,n.Kr)(()=>Z.filter(e=>e.id!==r&&e.id!==f&&e.id!==t?.linkedMonoforumId),[Z,r,f,t?.linkedMonoforumId]),se=(0,n.Kr)(()=>{const e=Z.some(e=>e.id===r);return!A||e||t?.isMonoforum?yi.p:Z.filter(e=>{const t=g?.[e.id];return d||!t})},[Z,d,r,A,g,t?.isMonoforum]),ae=(0,n.Kr)(()=>Boolean(ie.length||ne.length||se.length),[ie,ne,se])&&!h&&!o&&a,oe=(0,n.Kr)(()=>!Z||o?{}:(0,Ci.pA)(Z,e=>[e.id,(0,Ft.F9)(D,e)]),[o,D,Z]),re=(0,n.Kr)(()=>[{value:l&&Z.length>=2?"spam":Z?.[0]?.id,label:F("ReportSpamTitle"),nestedOptions:l&&Z.length>=2?[...ee().filter(e=>e.value!==f&&e.value!==t?.linkedMonoforumId&&e.value!==r)]:void 0}],[l,Z,F,f,t?.linkedMonoforumId,r]),le=(0,n.Kr)(()=>[{value:l&&Z.length>=2?"delete_all":Z?.[0]?.id,label:l&&Z.length>=2?F("DeleteAllFromUsers"):F("DeleteAllFrom",Object.values(oe)[0]),nestedOptions:l&&Z.length>=2?[...ee().filter(e=>e.value!==f&&e.value!==t?.linkedMonoforumId&&e.value!==r)]:void 0}],[l,Z,F,oe,f,t?.linkedMonoforumId,r]),ce=(0,n.Kr)(()=>[{value:l&&Z.length>=2?"ban":Z?.[0]?.id,label:l&&Z.length>=2?F(z?"DeleteRestrictUsers":"DeleteBanUsers"):z?F("KickFromSupergroup"):F("DeleteBan",Object.values(oe)[0]),nestedOptions:l&&Z.length>=2?[...ee()]:void 0}],[z,F,l,Z,oe]),de=(0,M.A)(()=>{H(e=>!e)}),he=(0,M.A)((e,i)=>{if(!t)return yi.p;const n=(0,s.mS)();return i.filter(i=>{const s=(0,c.LM$)(n,t.id,i);return s&&e.includes(s.id)})}),ue=(0,M.A)(e=>{Object.entries(e).forEach(([e,i])=>{i.length&&S({participantId:e,chatId:t.id,messageIds:i})})}),pe=(0,M.A)(e=>{y({messageIds:e,shouldDeleteForAll:!0})}),ve=(0,M.A)(e=>{t&&e.forEach(e=>{P({peerId:e,chatId:t.id})})}),ge=(0,M.A)(e=>{e.forEach(e=>{k({chatId:t.id,userId:e})})}),Ae=(0,M.A)(e=>{e.forEach(e=>{I({chatId:t.id,userId:e,bannedRights:B})})}),fe=(0,M.A)(()=>{if(t&&l){if(b?.(),o)w({messageIds:l});else if(ae){if(K?.length){const e=(0,s.mS)(),i=K.filter(e=>!Number.isNaN(Number(e))),n=l.reduce((n,s)=>{const a=(0,c.LM$)(e,t.id,s);return a&&i.includes(a.id)&&(n[a.id]||(n[a.id]=[]),n[a.id].push(Number(s))),n},{});ue(n)}if(E?.length){const e=E.filter(e=>!Number.isNaN(Number(e)));ve(e)}if(U?.length&&!R){const e=U.filter(e=>!Number.isNaN(Number(e)));ge(e);const t=he(e,l);pe(t)}if(U?.length&&R){const e=U.filter(e=>!Number.isNaN(Number(e)));Ae(e)}K?.length&&E?.length&&U?.length||y({messageIds:l,shouldDeleteForAll:$})}else y({messageIds:l,shouldDeleteForAll:$});C(),N()}}),be=(0,M.A)(()=>{C()});return(0,n.vJ)(()=>{!e&&Y&&(J([]),V([]),O([]),q(!0),j(!1),H(!1),x())},[e,Y,x]),(0,te.Y)(X.A,{isOpen:e,onClose:be,onEnter:fe,className:"SeaF_shb",children:(0,te.FD)("div",{className:"_YNfwDqt",children:[(0,te.FD)("div",{className:ae&&"axa67kqo",dir:F.isRtl?"rtl":void 0,children:[ae&&(0,te.Y)(bn.A,{size:"small",peers:Z}),(0,te.Y)("h3",{className:(0,me.A)(ae?"U4IFhV0a":"qd6OFHiG"),children:F("Chat.DeleteMessagesConfirmation",l?.length)})]}),ae&&(0,te.FD)(te.FK,{children:[(0,te.Y)("p",{className:Ac,children:F("DeleteAdditionalActions")}),(0,te.FD)("div",{className:"b6847Kh3",children:[(0,te.Y)(gc.A,{options:re,onChange:J,selected:K,nestedCheckbox:l&&Z.length>=2}),ie?.length>0&&(0,te.Y)(gc.A,{options:le,onChange:V,selected:E,nestedCheckbox:l&&Z.length>=2}),se?.length>0&&(0,te.Y)(gc.A,{options:ce,onChange:O,selected:U,nestedCheckbox:l&&Z.length>=2})]}),(0,te.FD)("div",{className:(0,me.A)("iv0u9Zw6",z&&"qCQftA04"),children:[(0,te.Y)("h3",{className:(0,me.A)(Ac,"t3KOsBfm"),children:F("UserRestrictionsCanDoUsers",Z.length)}),(0,te.Y)(vc,{withCheckbox:!0,chatId:t?.id,isMediaDropdownOpen:G,setIsMediaDropdownOpen:j,handlePermissionChange:L,permissions:B,className:(0,me.A)("czTjjKim",G&&"Ifpyv7Jp")})]}),U?.length&&A?(0,te.FD)(di.A,{narrow:!0,buttonClassName:fc,onClick:de,children:[F(z?"DeleteToggleBanUsers":"DeleteToggleRestrictUsers"),(0,te.Y)(W.A,{name:z?"up":"down",className:(0,me.A)(fc,"ml-2")})]}):H(!1)]}),(h||v||!ae)&&(0,te.FD)(te.FK,{children:[(0,te.Y)("p",{children:l&&l.length>1?D("AreYouSureDeleteFewMessages"):D("AreYouSureDeleteSingleMessage")}),m&&(0,te.Y)("p",{children:F("lng_delete_for_me_chat_hint",1,"i")}),p&&(0,te.Y)("p",{children:F("lng_delete_for_everyone_hint",1,"i")})]}),h&&(0,te.Y)(ps.A,{className:"dialog-checkbox",label:u?(0,Dt.A)(F("DeleteMessagesOptionAlso",u)):F("Conversation.DeleteMessagesForEveryone"),checked:$,onCheck:q}),(0,te.FD)("div",{className:(0,me.A)("dialog-buttons",G?"JTT_DIRv":"L4YzeG91"),children:[(0,te.Y)(Q.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:fe,children:ae?F("DeleteProceedBtn"):D("Delete")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:be,children:F("Cancel")})]})]})})})),Cc=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,v.L8)(t),n=(0,c.nZ4)(e,t),s=(0,c.hds)(e,t),a=Boolean(s)&&(0,l.WX)(s),o=Boolean(s)&&(0,l.yn)(s),r=Boolean(s)&&(0,l.Vs)(s);return{isPrivateChat:i,isChatWithSelf:n,isChannel:a,isGroup:o,isSuperGroup:r,canPinForAll:i&&!n||r||o,contactName:s&&(0,v.L8)(s.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(s))):void 0}})(({isOpen:e,chatId:t,messageId:i,isChannel:a,isGroup:o,isSuperGroup:r,canPinForAll:l,contactName:c,onClose:d})=>{const{pinMessage:h}=(0,s.ko)(),[u,m]=(0,n.J0)(!0),p=(0,M.A)(()=>{h({chatId:t,messageId:i,isUnpin:!1,isOneSide:!u,isSilent:!u}),d()}),v=(0,T.A)();return(0,te.FD)(X.A,{isOpen:e,onClose:d,className:"pin",title:v("PinMessageAlertTitle"),children:[(0,te.Y)("p",{children:v(a?"PinMessageAlertChannel":o||r?"PinMessageAlert":"PinMessageAlertChat")}),l&&(0,te.Y)(ps.A,{className:"dialog-checkbox",label:c?(0,Dt.A)(v("Conversation.PinMessagesFor",c)):v("Conversation.PinMessageAlert.PinAndNotifyMembers"),checked:u,onCheck:m}),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:p,children:v("DialogPin")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:v("Cancel")})]})]})})),yc=(0,n.ph)(({isOpen:e,pinnedMessagesCount:t=0,onClose:i,onUnpin:n})=>{const s=(0,T.A)();return(0,te.FD)(X.A,{isOpen:e,onClose:i,className:"unpin-all",title:s("Chat.PanelUnpinAllMessages"),children:[(0,te.Y)("p",{children:s("Chat.UnpinAllMessagesConfirmation",t,"i")}),(0,te.FD)("div",{className:"dialog-buttons mt-2",children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:n,children:s("DialogUnpin")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:i,children:s("Cancel")})]})]})});var Sc=i(2178);const kc=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e),{shouldWarnAboutFiles:i}=(0,Is.l)(e),n=(0,c.meB)(e),{type:s,chatId:a}=(0,c.Xf0)(e)||{},o="scheduled"===s,{canDelete:r}=(0,c.jyG)(e),l=Boolean(!o&&(0,c.mDG)(e)),d=(0,c.ori)(e),{messageIds:h}=t.selectedMessages||{},u=!!a&&(0,c.o45)(e,a,h),m=!(o||!a)&&(0,c.Y8y)(e,a,h),p=!(!h||!a)&&(0,c.h5w)(e,a,h),v=t.isShareMessageModalShown,g=Boolean(v||t.requestedDraft||t.requestedAttachBotInChat||t.requestedAttachBotInstall||t.reportModal||t.deleteMessageModal);return{chat:n,isSchedule:o,selectedMessagesCount:(0,c.ZZ2)(e),canDeleteMessages:r,canReportMessages:l,canDownloadMessages:d,canForwardMessages:m,selectedMessageIds:h,hasProtectedMessage:u,isAnyModalOpen:g,shouldWarnAboutFiles:i,hasIpRevealingMedia:p}})(({chat:e,canPost:t,isActive:i,messageListType:a,isSchedule:o,selectedMessagesCount:r,canDeleteMessages:l,canReportMessages:c,canDownloadMessages:d,canForwardMessages:h,hasProtectedMessage:u,isAnyModalOpen:m,selectedMessageIds:p,shouldWarnAboutFiles:v,hasIpRevealingMedia:g})=>{const{exitMessageSelectMode:A,openForwardMenuForSelectedMessages:f,downloadSelectedMessages:b,copySelectedMessages:C,showNotification:y,reportMessages:S,openDeleteMessageModal:k,setSharedSettingOption:w}=(0,s.ko)(),N=(0,T.A)();(e=>{function t(e){e.preventDefault(),(0,s.ko)().copySelectedMessages()}(0,Sc.v)((0,n.Kr)(()=>e?{"Mod+C":t}:void 0,[e]))})(i);const[I,P,Y]=(0,F.A)(),[D,B]=(0,n.J0)(!1),R=(0,M.A)(()=>{A()}),L=(0,M.A)(()=>{p&&e&&k({chatId:e.id,messageIds:p,isSchedule:o})});(0,n.vJ)(()=>i&&!m?(0,Li.A)({onBackspace:l?L:void 0,onDelete:l?L:void 0,onEsc:R}):void 0,[i,L,R,m,l]);const x=(0,M.A)(()=>{C(),y({message:N("Share.Link.Copied")}),A()}),E=(0,M.A)(()=>{b(),A()}),V=(0,M.A)(()=>{v&&g?P():E()}),U=(0,M.A)(()=>{w({shouldWarnAboutFiles:!D}),Y(),E()}),O=(0,_.A)(r||void 0,!0),K=N("VoiceOver.Chat.MessagesSelected",i?r:O,"i"),J=(0,M.A)(()=>{p&&e&&(S({chatId:e.id,messageIds:p}),A())}),G=(0,me.A)("MessageSelectToolbar",t&&"with-composer",i&&"shown"),j=(e,t,i,n)=>(0,te.Y)("div",{role:"button",tabIndex:0,className:(0,me.A)("div-button","item",n&&"destructive"),onClick:i,title:t,"aria-label":t,children:(0,te.Y)(W.A,{name:e})});return(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{className:G,children:(0,te.FD)("div",{className:"MessageSelectToolbar-inner",children:[(0,te.Y)(Q.A,{color:"translucent",round:!0,onClick:R,ariaLabel:"Exit select mode",children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("span",{className:"MessageSelectToolbar-count",title:K,children:K}),Boolean(r)&&(0,te.FD)("div",{className:"MessageSelectToolbar-actions",children:["scheduled"!==a&&h&&j("forward",N("Chat.ForwardActionHeader"),f),c&&j("flag",N("Conversation.ReportMessages"),J),d&&!u&&j("download",N("lng_media_download"),V),!u&&j("copy",N("lng_context_copy_selected_items"),x),l&&j("delete",N("EditAdminGroupDeleteMessages"),L,!0)]})]})}),(0,te.FD)(gi.A,{isOpen:I,onClose:Y,confirmHandler:U,children:[N("lng_launch_svg_warning"),(0,te.Y)(ps.A,{className:"dialog-checkbox",checked:D,label:N("lng_launch_exe_dont_ask"),onCheck:B})]})]})})),wc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).seenByModal||{};return t&&i?{seenByDates:(0,c.O5q)(e,t,i)?.seenByDates}:{seenByDates:void 0}})(function({isOpen:e,seenByDates:t}){const{openChat:i,closeSeenByModal:a}=(0,s.ko)(),o=(0,T.A)(),r=(0,Ri.A)(t,!0),l=(0,n.Kr)(()=>{if(!r)return;const e=Object.keys(r);return e.sort((e,t)=>r[t]-r[e]),e},[r]),c=(0,M.A)(e=>{a(),setTimeout(()=>{i({id:e})},100)}),d=(0,M.A)(()=>{a()});return(0,te.FD)(X.A,{isOpen:e,onClose:a,className:(0,me.A)("slqA9gR2","narrow"),title:`Seen by ${l?.length} users`,children:[(0,te.Y)("div",{dir:o.isRtl?"rtl":void 0,children:l&&l.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>c(e),children:(0,te.Y)(xn.A,{userId:e,noStatusOrTyping:!0,status:(0,He.U)(o,1e3*r[e]),statusIcon:"message-read"})},e))}),(0,te.Y)("div",{className:"dialog-buttons mt-2",children:(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:o("Close")})})]})}));var Nc=i(32581);const Ic="MQxuEIRA",Pc="AEAN1Au4",Yc="F7owtTHj",Fc=X.U+o.xB5,Dc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,isReadDate:i}=(0,c.nTw)(e).privacySettingsNoticeModal||{};return{user:t?(0,c.mBe)(e,t):void 0,isReadDate:i}})(({isOpen:e,isReadDate:t,user:i})=>{const n=(0,T.A)(),{updateGlobalPrivacySettings:a,openPremiumModal:o,closePrivacySettingsNoticeModal:r,showNotification:c,setPrivacyVisibility:d,loadUser:h}=(0,s.ko)(),u=(0,l.u0)(i),m=(0,M.A)(()=>{a({shouldHideReadMarks:!1}),r(),setTimeout(()=>{c({message:n("PremiumReadSet")})},Fc)}),p=(0,M.A)(()=>{d({privacyKey:"lastSeen",visibility:"everybody",onSuccess:()=>h({userId:i.id})}),r(),setTimeout(()=>{c({message:n("PremiumLastSeenSet")})},Fc)}),v=(0,M.A)(()=>{r(),setTimeout(()=>{o({initialSection:"last_seen"})},Fc)}),g=(0,M.A)(()=>{r()});return(0,te.Y)(X.A,{isSlim:!0,isOpen:e,onClose:g,children:(0,te.FD)("div",{className:"tauadiDm",dir:n.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{className:"i6iFv9YE",color:"translucent",round:!0,size:"smaller",onClick:g,ariaLabel:"Close",children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)(zr.A,{tgsUrl:t?jr.w.ReadTime:jr.w.LastSeen,size:84,className:"i4wZg_0J",nonInteractive:!0,noLoop:!0}),(0,te.Y)("h2",{className:Ic,children:n(t?"PremiumReadHeader1":"PremiumLastSeenHeader1")}),(0,te.Y)("p",{className:Pc,children:(0,Dt.A)(n(t?"PremiumReadText1":"PremiumLastSeenText1Locked",u),["simple_markdown"])}),(0,te.Y)(Q.A,{onClick:t?m:p,className:Yc,children:n(t?"PremiumReadButton1":"PremiumLastSeenButton1")}),(0,te.Y)(Nc.A,{className:"sXXb5yOS",children:n("PremiumOr")}),(0,te.Y)("h2",{className:Ic,children:n("PremiumReadHeader2")}),(0,te.Y)("p",{className:Pc,children:(0,Dt.A)(n(t?"PremiumReadText2":"PremiumLastSeenText2",u),["simple_markdown"])}),(0,te.Y)(Q.A,{withPremiumGradient:!0,onClick:v,className:Yc,children:n("PremiumLastSeenButton2")})]})})})),Mc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).reactorModal||{},n=t&&i?(0,c.O5q)(e,t,i):void 0;return{chatId:t,messageId:i,reactions:n?.reactions,reactors:n?.reactors,seenByDates:n?.seenByDates,availableReactions:e.reactions.availableReactions}})(({isOpen:e,reactors:t,reactions:i,chatId:o,messageId:r,seenByDates:c,availableReactions:d})=>{const{loadReactors:h,closeReactorListModal:u,openChat:m}=(0,s.ko)(),p=(0,s.mS)().chats.byId,v=(0,s.mS)().users.byId,g=(0,T.A)(),A=(0,Ui.A)(),[f,b,C]=(0,F.A)(!1),[y,S]=(0,n.J0)(void 0),k=t&&i&&t.count>=10&&i.results.length>1,w=(0,n.li)();(0,n.vJ)(()=>{e&&!f&&(w.current=void 0),f&&!e&&(C(),S(void 0))},[f,e,C]);const N=(0,M.A)(()=>{w.current&&m({id:w.current}),u()}),I=(0,M.A)(()=>{b()}),P=(0,M.A)(e=>{w.current=e,I()}),Y=(0,M.A)(()=>{h({chatId:o,messageId:r})}),D=(0,n.Kr)(()=>{const e=[];return t?.reactions?.forEach(({reaction:t})=>{e.some(e=>(0,l.a0)(e,t))||e.push(t)}),e},[t]),B=(0,n.Kr)(()=>{if(y)return t?.reactions.filter(({reaction:e})=>(0,l.a0)(e,y)).map(({peerId:e})=>e);const e=Object.keys(c||{});return(0,Ci.Am)(t?.reactions.map(({peerId:e})=>e).concat(e||[])||[])},[y,t,c]),[R,L]=(0,jn.A)(Y,B,t&&void 0===t.nextOffset);return(0,n.vJ)(()=>{L?.({direction:a.TN.Backwards})},[L]),(0,te.FD)(X.A,{isOpen:e&&!f,onClose:I,className:"ReactorListModal narrow",title:g("Reactions"),onCloseAnimationEnd:N,children:[k&&(0,te.FD)("div",{className:"Reactions",dir:g.isRtl?"rtl":void 0,children:[(0,te.FD)(Q.A,{className:(0,me.A)(!y&&"chosen"),size:"tiny",ripple:!0,onClick:()=>S(void 0),children:[(0,te.Y)(W.A,{name:"heart"}),Boolean(t?.count)&&(0,$e.Vw)(A,t.count)]}),D.map(e=>{const t=i?.results.find(t=>(0,l.a0)(t.reaction,e))?.count;return(0,te.FD)(Q.A,{className:(0,me.A)((0,l.a0)(y,e)&&"chosen"),size:"tiny",ripple:!0,onClick:()=>S(e),children:[(0,te.Y)(En.A,{reaction:e,className:"reaction-filter-emoji",availableReactions:d}),Boolean(t)&&(0,$e.Vw)(A,t)]},(0,l.Jj)(e))})]}),(0,te.Y)("div",{dir:g.isRtl?"rtl":void 0,className:"reactor-list-wrapper",children:R?.length?(0,te.Y)(Tn.A,{className:"reactor-list custom-scroll",items:R,onLoadMore:L,children:R?.flatMap(e=>{const i=v[e]||p[e],n=t?.reactions.filter(t=>t.peerId===e),s=[],a=c?.[e];return n?.forEach(t=>{y&&!(0,l.a0)(t.reaction,y)||s.push((0,te.FD)(di.A,{className:"chat-item-clickable reactors-list-item",onClick:()=>P(e),children:[(0,te.Y)(Mt.A,{peer:i,size:"medium"}),(0,te.FD)("div",{className:"info",children:[(0,te.Y)(qn.A,{peer:i,withEmojiStatus:!0}),(0,te.FD)("span",{className:"status",dir:"auto",children:[(0,te.Y)(W.A,{name:"heart-outline",className:"status-icon"}),(0,He.U)(g,1e3*t.addedDate)]})]}),t.reaction&&(0,te.Y)(En.A,{className:"reactors-list-emoji",reaction:t.reaction,availableReactions:d})]},`${e}-${(0,l.Jj)(t.reaction)}`))}),y||n?.length||s.push((0,te.Y)(di.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>P(e),children:(0,te.Y)(xn.A,{userId:e,noStatusOrTyping:!0,avatarSize:"medium",status:a?(0,He.U)(g,1e3*a):void 0,statusIcon:"message-read"})},`${e}-seen-by`)),s})}):(0,te.Y)($n.A,{})}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:I,children:g("Close")})]})})),Tc=(0,n.ph)((0,s.EK)((e,{activeEmojiInteraction:t})=>{const i=void 0!==t.animatedEffect&&(0,c.Nr8)(e,t.animatedEffect);return{effectAnimationId:i?i.id:void 0}})(({effectAnimationId:e,activeEmojiInteraction:t})=>{const{stopActiveEmojiInteraction:i}=(0,s.ko)(),[a,o]=(0,F.A)(!1),[r,l]=(0,F.A)(!1),c=(0,n.li)(),d=(0,M.A)(()=>{o(),c.current&&clearTimeout(c.current),setTimeout(()=>{i({id:t.id})},250)}),h=(0,M.A)(e=>{e.target?.closest(".AnimatedEmoji")||d()});(0,n.vJ)(()=>(document.addEventListener("touchstart",h),document.addEventListener("touchmove",h),document.addEventListener("mousedown",h),document.addEventListener("wheel",h),()=>{document.removeEventListener("touchstart",h),document.removeEventListener("touchmove",h),document.removeEventListener("mousedown",h),document.removeEventListener("wheel",h)}),[h]),(0,n.Nf)(()=>{const e=(0,n.VK)();c.current=setTimeout(()=>{d(),e()},3e3)},[d]);const m=e&&`sticker${e}`,p=(0,z.A)(m,!e);if(!t.startSize)return;const v=(t.startSize||0)/309;return(0,te.Y)("div",{className:(0,me.A)("EmojiInteractionAnimation",a&&"hiding",r&&"playing",t.isReversed&&"reversed"),style:`--scale: ${v}; --start-x: ${t.x}px; --start-y: ${t.y}px;`,children:(0,te.Y)(Ua.A,{size:309,tgsUrl:p,play:!0,quality:u.Ni?.5:void 0,forceAlways:!0,noLoop:!0,onLoad:l},`effect_${e}`)})})),Bc=(0,n.ph)((0,s.EK)(e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).chatLanguageModal||{},n=(0,c.wmb)(e);return{chatId:t,messageId:i,activeTranslationLanguage:t?i?(0,c.Rny)(e,t,i):(0,c.qZq)(e,t):void 0,currentLanguageCode:n}})(({isOpen:e,chatId:t,messageId:i,activeTranslationLanguage:a,currentLanguageCode:r})=>{const{requestMessageTranslation:l,closeChatLanguageModal:c,setSettingOption:d,requestChatTranslation:h}=(0,s.ko)(),[u,m]=(0,n.J0)(""),p=(0,T.A)(),v=(0,M.A)(e=>{t&&(i?l({chatId:t,id:i,toLanguageCode:e}):(d({translationLanguage:e}),h({chatId:t,toLanguageCode:e})),c())}),g=(0,M.A)(e=>{m(e.target.value)}),A=(0,n.Kr)(()=>o.N89.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([r],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})),[r]);(0,n.vJ)(()=>{e||m("")},[e]);const f=(0,n.Kr)(()=>u.trim()?A.filter(({langCode:e,translatedName:t,originalName:i})=>t.toLowerCase().includes(u.toLowerCase())||i.toLowerCase().includes(u.toLowerCase())||e.toLowerCase().includes(u.toLowerCase())):A,[A,u]);return(0,te.FD)(X.A,{className:"aMjNU9gm",isSlim:!0,isOpen:e,hasCloseButton:!0,title:p("Language"),onClose:c,children:[(0,te.Y)(Z.A,{value:u,onChange:g,placeholder:p("Search"),teactExperimentControlled:!0},"search"),(0,te.Y)("div",{className:(0,me.A)("r3YNWDQr","custom-scroll"),children:f.map(({langCode:e,originalName:t,translatedName:i})=>(0,te.FD)(di.A,{className:(0,me.A)("T3An6Hoz","no-icon"),secondaryIcon:a===e?"check":void 0,disabled:a===e,multiline:!0,narrow:!0,onClick:()=>v(e),children:[(0,te.Y)("span",{className:(0,me.A)("title","dQ9wwFu1"),children:(0,Dt.A)(t,["highlight"],{highlight:u})}),(0,te.Y)("span",{className:(0,me.A)("subtitle","m_J41YYl"),children:(0,Dt.A)(i,["highlight"],{highlight:u})})]},e))})]})}));var Rc=i(85982),Lc=i(24899);const xc={content:"WEJIbFQj",closeButton:"_vwPuDEM",icon:"BUiGM8qZ",title:"Q3NhXpNI",description:"frZbGQ0G"},Ec=(0,n.ph)((0,s.EK)(e=>{const{countryList:t}=e;return{phoneCodeList:t.phoneCodes}})(({modal:e,phoneCodeList:t})=>{const{closeCollectibleInfoModal:i,openChat:a,openUrl:o,showNotification:r}=(0,s.ko)(),l=(0,T.A)(),c="username"===e?.type,d=(0,M.A)(()=>{i()}),h=(0,M.A)(()=>{a({id:e.peerId}),d()}),u=(0,M.A)(()=>{o({url:e.url}),d()}),m=(0,M.A)(()=>{const i=c?(0,Lc.A)(e.collectible):(0,ks.Ox)(t,e.collectible);(0,Rc.eM)(i),r({message:l(c?"UsernameCopied":"PhoneCopied")}),d()}),p=(0,n.Kr)(()=>{if(!e)return;const i=c?"FragmentUsernameTitle":"FragmentPhoneTitle",n=c?(0,Lc.A)(e.collectible):(0,ks.Ox)(t,e.collectible);return l(i,n)},[e,c,t,l]),v=(0,n.Kr)(()=>{if(!e)return;const t=c?"FragmentUsernameMessage":"FragmentPhoneMessage",i=(0,He.U)(l,1e3*e.purchaseDate),n=(0,ka.Ad)(e.amount,e.currency,l.code),s=(0,ka.Ad)(e.cryptoAmount,e.cryptoCurrency,l.code);return l(t,[i,`${s} (${n})`])},[e,c,l]);return(0,te.FD)(X.A,{isOpen:Boolean(e),isSlim:!0,contentClassName:xc.content,onClose:i,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",className:xc.closeButton,ariaLabel:l("Close"),onClick:d,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:xc.icon,children:(0,te.Y)(zr.A,{tgsUrl:c?jr.w.Mention:jr.w.Fragment,size:60})}),(0,te.Y)("h3",{className:xc.title,children:p&&(0,Dt.A)(p,["simple_markdown"])}),(0,te.Y)(cl.A,{className:xc.chip,peerId:e?.peerId,forceShowSelf:!0,clickArg:e?.peerId,onClick:h}),(0,te.Y)("p",{className:xc.description,children:v&&(0,Dt.A)(v,["simple_markdown"])}),(0,te.FD)("div",{className:"dialog-buttons dialog-buttons-centered",children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",onClick:u,children:l("FragmentUsernameOpen")}),(0,te.Y)(Q.A,{isText:!0,className:"confirm-dialog-button",onClick:m,children:l(c?"FragmentUsernameCopy":"FragmentPhoneCopy")})]})]})}));var Vc=i(31460),_c=i(24680),Uc=i(57309);function Oc(e){return(t,i)=>{const n=(0,c.nTw)(t),{byId:s}=t.chats,{byId:a}=t.users,{fetchingStatus:o,resultsByType:r,chatId:l}=n.globalSearch,{shouldWarnAboutFiles:d}=(0,Is.l)(t),h="audio"!==e?e:i?.isVoice?"voice":"audio",{byChatId:u}=t.messages,m=r?.[h]?.foundIds,p=n.activeDownloads;return{theme:(0,c.SJA)(t),isLoading:void 0===m||!!o&&Boolean(o.chats||o.messages),chatsById:s,usersById:a,globalMessagesByChatId:u,foundIds:m,searchChatId:l,activeDownloads:p,isChatProtected:l?(0,c.hds)(t,l)?.isProtected:void 0,shouldWarnAboutFiles:d}}}var Kc=i(55429),Jc=i(65240),Gc=i(42827);const jc=(0,ge.nF)(e=>e(),500,!0),zc=(0,n.ph)((0,s.EK)(Oc("audio"))(({theme:e,isVoice:t,searchQuery:i,isLoading:r,chatsById:c,usersById:d,globalMessagesByChatId:h,foundIds:u,activeDownloads:m})=>{const{searchMessagesGlobal:p,focusMessage:v,openAudioPlayer:g}=(0,s.ko)(),A=(0,T.A)(),f=t?"voice":"audio",b=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&jc(()=>{p({type:f})})},[f,p,i]),C=(0,n.Kr)(()=>u&&h?u.map(e=>{const[t,i]=(0,Uc.a)(e);return h[t]?.byId[i]}).filter(Boolean):yi.p,[h,u]),y=(0,n.hb)(e=>{v({chatId:e.chatId,messageId:e.id})},[v]),S=(0,n.hb)((e,t)=>{g({chatId:t,messageId:e})},[g]),k=(0,Yr.A)([i],o.jhd)&&!r;return(0,te.Y)(se.Ay,{slideClassName:"LeftSearch--content",name:"fade",activeKey:k?1:0,shouldCleanup:!0,children:(0,te.FD)(Tn.A,{className:"search-content documents-list custom-scroll",items:k?C:void 0,onLoadMore:b,noFastList:!0,children:[!k&&(0,te.Y)($n.A,{}),k&&(!u||0===u.length)&&(0,te.Y)(Gc.A,{withSticker:!0,text:A("ChatList.Search.NoResults"),description:A("ChatList.Search.NoResultsDescription")}),k&&u&&u.length>0&&C.map((t,i)=>{const n=(0,s.mS)(),o=0===i||(0,He.$$)(t.date)!==(0,He.$$)(C[i-1].date),r=(0,Me.iS)(n,t);return(0,te.FD)(te.FK,{children:[o&&(0,te.Y)("p",{className:"section-heading",dir:A.isRtl?"rtl":void 0,children:(0,He.i6)(A,new Date(1e3*t.date))},t.date),(0,te.Y)("div",{className:"ListItem small-icon",children:(0,te.Y)(Jc.Ay,{theme:e,message:t,origin:a.d9.Search,senderTitle:(0,Kc.N)(A,t,c,d),date:t.date,className:"scroll-item",onPlay:S,onDateClick:y,canDownload:!c[t.chatId]?.isProtected&&!t.isProtected,isDownloading:(0,l.$r)(m,r)},t.id)},t.id)]})})]})})}));var Hc=i(27109),$c=i(47067);const qc=e=>{const t=(0,n.li)(),i=(0,n.hb)(i=>{"Enter"===i.key&&t.current===document.activeElement&&e()},[e]);return(0,n.vJ)(()=>(window.addEventListener("keydown",i,!1),()=>window.removeEventListener("keydown",i,!1)),[i]),t};var Wc=i(97967),Qc=i(97046);const Zc=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,user:(0,c.mBe)(e,t),isPinned:(0,c.D3D)(e,t),isMuted:i&&(0,Hc.If)(i,(0,c.K52)(e),(0,c.P5N)(e,i.id)),canChangeFolder:Boolean(e.chatFolders.orderedIds?.length)}})(({chatId:e,withUsername:t,chat:i,user:a,isPinned:r,isMuted:l,canChangeFolder:c,withOpenAppButton:d,onClick:h})=>{const{requestMainWebView:u,updateChatMutedState:m}=(0,s.ko)(),p=(0,T.A)(),[g,A,f]=(0,F.A)(),[b,C,y]=(0,F.A)(),[S,k,w]=(0,F.A)(),[N,I,P]=(0,F.A)(),Y=(0,n.hb)(()=>{k(),C()},[k,C]),D=(0,n.hb)(()=>{I(),A()},[I,A]),B=(0,M.A)(()=>{m({chatId:e,mutedUntil:o.Os5})}),R=(0,$c.A)({chat:i,user:a,isPinned:r,isMuted:l,canChangeFolder:c,handleMute:D,handleUnmute:B,handleChatFolderChange:Y},!0),L=(0,M.A)(()=>{h(e)}),x=(0,M.A)(t=>{t.stopPropagation();const i=(0,Vs.A)();u({botId:e,peerId:e,theme:i})}),E=qc(L);return(0,te.FD)(di.A,{className:"chat-item-clickable search-result",onClick:L,contextActions:R,buttonRef:E,children:[(0,v.L8)(e)?(0,te.Y)(xn.A,{userId:e,withUsername:t,avatarSize:"medium"}):(0,te.Y)(Ln.A,{chatId:e,withUsername:t,avatarSize:"medium"}),d&&a?.hasMainMiniApp&&(0,te.Y)(Q.A,{className:"ChatBadge miniapp",pill:!0,fluid:!0,size:"tiny",onClick:x,children:p("BotOpen")}),N&&(0,te.Y)(Qc.A,{isOpen:g,onClose:f,onCloseAnimationEnd:P,chatId:e}),S&&(0,te.Y)(Wc.A,{isOpen:b,onClose:y,onCloseAnimationEnd:w,chatId:e})]})})),Xc=(0,ge.nF)(e=>e(),500,!0),ed=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).globalSearch,i=t.popularBotApps?.peerIds;return{isLoading:!i&&t.fetchingStatus?.botApps,foundIds:i,recentBotIds:e.topBotApps.userIds}})(({searchQuery:e,isLoading:t,foundIds:i,recentBotIds:r})=>{const{searchPopularBotApps:l,openChatWithInfo:c}=(0,s.ko)(),d=(0,n.li)(),h=(0,T.A)(),[u,m]=(0,n.J0)(!1),p=(0,n.Kr)(()=>{if(!i)return[];const t=new Set(r),n=i.filter(e=>!t.has(e));return(0,Ft.PU)({ids:n,query:e,type:"user"})},[i,r,e]),v=(0,M.A)(e=>{c({id:e,shouldReplaceHistory:!0})}),g=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&Xc(()=>{l()})},[]),A=(0,M.A)(()=>{m(e=>!e)}),f=(0,Yr.A)([e],o.jhd)&&!t;return(0,te.Y)(se.Ay,{ref:d,slideClassName:"LeftSearch--content",name:"fade",activeKey:f?1:0,shouldCleanup:!0,children:(0,te.FD)(Tn.A,{className:"search-content custom-scroll",items:f?p:void 0,onLoadMore:g,noFastList:!0,children:[!f&&(0,te.Y)($n.A,{}),f&&!p?.length&&(0,te.Y)(Gc.A,{withSticker:!0,text:h("ChatList.Search.NoResults"),description:h("ChatList.Search.NoResultsDescription")}),f&&!e&&Boolean(r?.length)&&(0,te.FD)("div",{className:"search-section",children:[(0,te.FD)("h3",{className:"section-heading",children:[r.length>5&&(0,te.Y)(Wo.A,{className:"Link",onClick:A,children:h(u?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")}),h("SearchAppsMine")]}),r.map((e,t)=>{if(u||!(t>=5))return(0,te.Y)(Zc,{chatId:e,onClick:v,withOpenAppButton:!0})})]}),f&&Boolean(p?.length)&&(0,te.FD)("div",{className:"search-section",children:[(0,te.Y)("h3",{className:"section-heading",children:h("SearchAppsPopular")}),p.map(e=>(0,te.Y)(Zc,{chatId:e,onClick:v,withOpenAppButton:!0}))]})]})})}));var td=i(35749),id=i(2338);function nd(e,t,i,n,s){if(!i)return(0,A.C)(e,t,void 0,n);const a=(0,l.y2)(t);return(0,te.FD)("span",{className:"media-preview",children:[(0,te.Y)("img",{src:i,alt:"",className:(0,me.A)("media-preview--image",s&&"round",a&&"media-preview-spoiler"),draggable:!1}),(0,l.zX)(t)&&(0,te.Y)(W.A,{name:"play"}),(0,A.C)(e,t,!0,n)]})}const sd=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);if(!i)return{};const n=(0,l.e7)(i);return{chat:i,privateChatUser:n?(0,c.mBe)(e,n):void 0}})(({message:e,searchQuery:t,chatId:i,chat:n,privateChatUser:a})=>{const{focusMessage:o}=(0,s.ko)(),{isMobile:r}=(0,Y.Ay)(),c=(0,id.A)(e),d=(0,l.fP)(e)?void 0:c,h=(0,td.A)(e,"micro"),u=(0,z.A)(h),m=Boolean((0,l.lk)(e)),p=(0,M.A)(()=>{o({chatId:i,messageId:e.id,shouldReplaceHistory:!0})}),v=(0,Ui.A)(),g=(0,T.A)(),A=qc(p);if(!n)return;const f=a||n;return(0,te.FD)(di.A,{className:"ChatMessage chat-item-clickable",ripple:!r,onClick:p,buttonRef:A,children:[(0,te.Y)(Mt.A,{peer:f,isSavedMessages:a?.isSelf}),(0,te.FD)("div",{className:"info",children:[(0,te.FD)("div",{className:"info-row",children:[(0,te.Y)(qn.A,{peer:f,withEmojiStatus:!0,isSavedMessages:i===a?.id&&a?.isSelf}),(0,te.Y)("div",{className:"message-date",children:(0,te.Y)(Wo.A,{className:"date",children:(0,He.be)(g,1e3*e.date)})})]}),(0,te.Y)("div",{className:"subtitle",children:(0,te.Y)("div",{className:"message",dir:"auto",children:nd(v,e,u||d,t,m)})})]})]})})),ad=(0,n.ph)(({searchDate:e,onSelect:t})=>{const i=(0,n.Kr)(()=>function(e){if(e.match(/^\d{2,4}-\d{2}-\d{2}$/g)){const t=new Date(e);return[{date:t,text:(0,He.A)(t)}]}const t=[],i=new Date,n=i.getFullYear(),s=i.getTime()>new Date(`${n}-${e}`).getTime()?n:n-1;for(let i=0;i<8;i++){const n=new Date(`${s-i}-${e}`);t.push({date:n,text:(0,He.A)(n)})}return t}(e),[e]);return(0,te.Y)("section",{className:"DateSuggest custom-scroll custom-scroll-x",children:i.map(({date:e,text:i})=>(0,te.FD)("div",{onClick:()=>t(e),className:"date-item",children:[(0,te.Y)(W.A,{name:"calendar"}),(0,te.Y)("span",{children:i})]},i))})}),od=2*g.$,rd=(0,n.ph)((0,s.EK)((e,{chatId:t,topicId:i})=>({topic:(0,c.S0q)(e,t,i)}))(({topicId:e,topic:t,onClick:i})=>{const s=(0,n.hb)(()=>{i(e)},[e,i]),a=qc(s);if(t)return(0,te.FD)(di.A,{className:"chat-item-clickable search-result",onClick:s,buttonClassName:"topic-item",buttonRef:a,children:[(0,te.Y)(Wn.A,{size:od,topic:t,className:"topic-icon",letterClassName:"topic-icon-letter"}),(0,te.Y)("div",{dir:"auto",className:"fullName",children:(0,Dt.A)(t.title)})]})})),ld=(0,ge.nF)(e=>e(),500,!0),cd=(0,n.ph)((0,s.EK)(e=>{const{byId:t}=e.chats,{currentUserId:i,messages:{byChatId:n}}=e,{fetchingStatus:s,resultsByType:a,foundTopicIds:o,chatId:r}=(0,c.nTw)(e).globalSearch,{foundIds:l}=a?.text||{};return{currentUserId:i,foundIds:l,globalMessagesByChatId:n,chatsById:t,fetchingStatus:s,foundTopicIds:o,searchChatId:r}})(({searchQuery:e,dateSearchQuery:t,foundIds:i,globalMessagesByChatId:o,chatsById:r,fetchingStatus:l,foundTopicIds:c,searchChatId:d,onSearchDateSelect:h,onReset:u})=>{const{searchMessagesGlobal:m,openThread:p}=(0,s.ko)(),v=(0,Ui.A)(),{isMobile:g}=(0,Y.Ay)(),f=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&ld(()=>{m({type:"text"})})},[e]),b=(0,n.hb)(e=>{d&&(p({chatId:d,threadId:e,shouldReplaceHistory:!0}),g||u())},[d,g,u]),C=(0,n.Kr)(()=>i&&0!==i.length?i.map(e=>{const[t,i]=(0,Uc.a)(e);return o?.[t]?.byId[i]}).filter(Boolean).sort((e,t)=>t.date-e.date):yi.p,[i,o]),y=l&&!l.chats&&!l.messages&&!C.length&&!c?.length;return(0,te.Y)("div",{className:"LeftSearch--content",children:(0,te.FD)(Tn.A,{className:"search-content custom-scroll chat-list",items:C,onLoadMore:f,noFastList:!0,children:[t&&(0,te.Y)("div",{className:"chat-selection no-scrollbar",children:(0,te.Y)(ad,{searchDate:t,onSelect:h})}),y&&(0,te.Y)(Gc.A,{withSticker:!0,text:v("ChatListSearchNoResults"),description:v("ChatListSearchNoResultsDescription")}),Boolean(c?.length)&&(0,te.FD)("div",{className:"pb-2",children:[(0,te.Y)("h3",{className:"section-heading topic-search-heading",dir:v.isRtl?"auto":void 0,children:v("SearchResultTopics")}),c.map(e=>(0,te.Y)(rd,{chatId:d,topicId:e,onClick:b}))]}),Boolean(C.length)&&(0,te.FD)("div",{className:"pb-2",children:[(0,te.Y)("h3",{className:"section-heading topic-search-heading",dir:v.isRtl?"auto":void 0,children:v("SearchMessages")}),C.map(function(t){const i=(0,A.C)(v,t),n=r[t.chatId];if(i&&n)return(0,te.Y)(sd,{chatId:t.chatId,message:t,searchQuery:e})})]})]})})}));var dd=i(49763),hd=i(81949);const ud=(0,n.ph)(({sponsoredPeer:e,observeIntersection:t})=>{const i=(0,n.li)(),{clickSponsored:a,viewSponsored:o,openChat:r}=(0,s.ko)(),l=(0,Ui.A)(),{peerId:c,randomId:d,additionalInfo:h,sponsorInfo:u}=e;(0,Dr.mv)(i,t,e=>{1===e.intersectionRatio&&o({randomId:d})});const m=(0,M.A)(()=>{a({randomId:d}),r({id:c})}),{isContextMenuOpen:p,contextMenuAnchor:g,handleBeforeContextMenu:A,handleContextMenu:f,handleContextMenuClose:b,handleContextMenuHide:C}=(0,Ds.A)(i),{handleClick:y,handleMouseDown:S}=(0,mn.Q)(e=>{e.stopPropagation(),f(e)}),k=qc(m);return(0,te.FD)(di.A,{ref:i,className:"chat-item-clickable search-result",onClick:m,onMouseDown:A,onContextMenu:f,buttonRef:k,children:[(0,v.L8)(c)?(0,te.Y)(xn.A,{userId:c,withUsername:!0,avatarSize:"medium"}):(0,te.Y)(Ln.A,{chatId:c,withUsername:!0,avatarSize:"medium"}),(0,te.FD)(hd.A,{className:"search-sponsored-badge",onMouseDown:S,onClick:y,children:[l("SponsoredPeerBadge"),(0,te.Y)(W.A,{name:"more"})]}),g&&(0,te.Y)(xl.A,{isOpen:p,anchor:g,triggerRef:i,randomId:d,additionalInfo:h,canReport:!0,sponsorInfo:u,onClose:b,onCloseAnimationEnd:C})]})}),md=(0,ge.nF)(e=>e(),6e4,!0),pd=(0,n.ph)((0,s.EK)(e=>{const{userIds:t}=e.topPeers,i=e.users.byId,{recentlyFoundChatIds:n}=e;return{topUserIds:t,usersById:i,recentlyFoundChatIds:n}})(({topUserIds:e,usersById:t,recentlyFoundChatIds:i,onReset:a})=>{const{loadTopUsers:o,openChat:r,addRecentlyFoundChatId:c,clearRecentlyFoundChats:d}=(0,s.ko)(),h=(0,n.li)();(0,n.vJ)(()=>{md(()=>{o()})},[o]),(0,xs.A)(h,!e);const u=(0,n.hb)(e=>{r({id:e,shouldReplaceHistory:!0}),a(),setTimeout(()=>{c({id:e})},250)},[r,c,a]),m=(0,n.hb)(()=>{d()},[d]),p=(0,T.A)();return(0,te.FD)("div",{className:"RecentContacts custom-scroll",children:[e&&(0,te.Y)("div",{className:"top-peers-section",dir:p.isRtl?"rtl":void 0,children:(0,te.Y)("div",{ref:h,className:"top-peers",children:e.map(e=>(0,te.FD)("div",{className:"top-peer-item",onClick:()=>u(e),dir:p.isRtl?"rtl":void 0,children:[(0,te.Y)(Mt.A,{peer:t[e]}),(0,te.Y)("div",{className:"top-peer-name",children:(0,Dt.A)((0,l.u0)(t[e])||" ")})]},e))})}),i&&(0,te.FD)("div",{className:"search-section pt-1",children:[(0,te.FD)("h3",{className:(0,me.A)("section-heading mt-0 recent-chats-header",!e&&"without-border"),dir:p.isRtl?"rtl":void 0,children:[p("Recent"),(0,te.Y)(Q.A,{className:"clear-recent-chats",round:!0,size:"smaller",color:"translucent",ariaLabel:p("Clear"),onClick:m,isRtl:p.isRtl,children:(0,te.Y)(W.A,{name:"close"})})]}),i.map(e=>(0,te.Y)(Zc,{chatId:e,withOpenAppButton:!0,onClick:u}))]})]})})),vd=(0,ge.nF)(e=>e(),500,!1),gd=(0,n.ph)((0,s.EK)((e,{isChannelList:t})=>{const{userIds:i}=e.contactList||{},{currentUserId:n,messages:s}=e;if(!i)return{};const{fetchingStatus:a,globalResults:r,localResults:l,resultsByType:d,sponsoredPeer:h}=(0,c.nTw)(e).globalSearch,{peerIds:u}=r||{},{peerIds:m}=l||{},{byChatId:p}=s,v=d?.[t?"channels":"text"]?.foundIds,{similarChannelIds:g}=(0,c.dg4)(e,o.rBM)||{};return{currentUserId:n,contactIds:i,accountPeerIds:m,globalPeerIds:u,foundIds:v,globalMessagesByChatId:p,fetchingStatus:a,sponsoredPeer:h,suggestedChannelIds:g}})(({isChannelList:e,searchQuery:t,searchDate:i,dateSearchQuery:r,currentUserId:c,contactIds:d,accountPeerIds:h,globalPeerIds:u,foundIds:m,globalMessagesByChatId:p,fetchingStatus:v,suggestedChannelIds:g,sponsoredPeer:f,onReset:b,onSearchDateSelect:C})=>{const{openChat:y,addRecentlyFoundChatId:S,searchMessagesGlobal:k,setGlobalSearchChatId:w,loadChannelRecommendations:N}=(0,s.ko)(),I=(0,n.li)(),P=(0,n.li)(),F=(0,Ui.A)(),{isMobile:D}=(0,Y.Ay)(),[T,B]=(0,n.J0)(!1),[R,L]=(0,n.J0)(!1),[x,E]=(0,n.J0)("all"),V=(0,n.li)();(0,ye.A)(()=>{e&&N({})});const _=(0,n.hb)(({direction:t})=>{t===a.TN.Backwards&&vd(()=>{k({type:e?"channels":"text",context:x})})},[t,x]),U=(0,n.hb)(e=>{y({id:e,shouldReplaceHistory:!0}),e!==c&&S({id:e}),D||b()},[y,c,D,S,b]),O=(0,n.hb)(e=>{w({id:e})},[w]);function K(e){return F("users"===e?"PrivateChatsSearchContext":"groups"===e?"GroupChatsSearchContext":"channels"===e?"ChannelsSearchContext":"AllChatsSearchContext")}const{isContextMenuOpen:J,contextMenuAnchor:G,handleContextMenu:j,handleContextMenuClose:z,handleContextMenuHide:H}=(0,Ds.A)(V),$=(0,M.A)(()=>V.current),q=(0,M.A)(()=>V.current.querySelector(".chatResultsContextMenu .bubble")),Q=(0,M.A)(()=>V.current.querySelector(".menuTrigger")),Z=(0,M.A)(e=>{j(e)}),X=(0,me.A)("icon","iconPlaceholder"),ee=(0,n.Kr)(()=>{if(!e&&(!t||t.startsWith("@")&&t.length<2))return yi.p;const i=(0,s.mS)().chats.byId,n=((0,dd.YA)(o.DSF)??[]).filter(t=>{if(!e)return!0;const n=i[t];return n&&(0,l.WX)(n)}),a=(0,Ft.PU)({ids:n,query:t,type:"chat"});if(e)return a;const r=[...c?[c]:[],...d||[]],u=[...(0,Ft.PU)({ids:r,query:t,type:"user"}),...a];return(0,Ci.Am)([...(0,Jn.A)(u,void 0,c?[c]:void 0),...(0,Jn.A)(h||[])])},[t,c,d,h,e]);(0,xs.A)(P,!ee.length||e,!0);const ie=(0,n.Kr)(()=>{if(!t||t.length<4||!u)return yi.p;const i=(0,s.mS)().chats.byId,n=u.filter(t=>{if(!e)return!0;const n=i[t];return n&&(0,l.WX)(n)});return(0,Jn.A)(n,!0)},[u,e,t]),ne=(0,n.Kr)(()=>{if(!t&&!i||!m||0===m.length)return yi.p;const n=(0,s.mS)().chats.byId;return m.map(t=>{const[i,s]=(0,Uc.a)(t),a=n[i];if(a&&(!e||(0,l.WX)(a)))return p?.[i]?.byId[s]}).filter(Boolean)},[t,i,m,e,p]);(0,n.vJ)(()=>{t&&k({type:e?"channels":"text",context:x,shouldResetResultsByType:!0,shouldCheckFetchingMessagesStatus:!0})},[x]);const ae=(0,n.hb)(()=>{B(!T)},[T]),oe=(0,n.hb)(()=>{L(!R)},[R]),re=ne,le="all"===x&&v&&!v.chats&&!v.messages&&!ee.length&&!ie.length&&!re.length,ce=v?.messages,he=!t&&!i&&!e,{observe:ue}=(0,Dr.BL)({rootRef:I,throttleMs:200,isDisabled:!he});if(he)return(0,te.Y)(pd,{onReset:b});const pe="all"!==x||Boolean(re.length);return(0,te.FD)(Tn.A,{ref:I,className:"LeftSearch--content custom-scroll",items:re,onLoadMore:_,noScrollRestoreOnTop:!0,noFastList:!0,children:[r&&(0,te.Y)("div",{className:"chat-selection no-scrollbar",children:(0,te.Y)(ad,{searchDate:r,onSelect:C})}),le&&(0,te.Y)(Gc.A,{withSticker:!0,text:F("ChatListSearchNoResults"),description:F("ChatListSearchNoResultsDescription")}),Boolean(ee.length)&&!e&&(0,te.Y)("div",{className:"chat-selection no-scrollbar",dir:F.isRtl?"rtl":void 0,ref:P,children:ee.map(e=>(0,te.Y)(cl.A,{peerId:e,className:"left-search-local-suggestion",onClick:O,clickArg:e}))}),Boolean(ee.length)&&(0,te.FD)("div",{className:"search-section",children:[(0,te.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[ee.length>5&&(0,te.Y)(Wo.A,{className:"Link",onClick:ae,children:F(T?"ChatListSearchShowLess":"ChatListSearchShowMore")}),F(e?"SearchResultMyChannels":"DialogListSearchSectionDialogs")]}),ee.map((e,t)=>{if(T||!(t>=5))return(0,te.Y)(Zc,{withOpenAppButton:!0,chatId:e,onClick:U})})]}),Boolean(ie.length)&&(0,te.FD)("div",{className:"search-section",children:[(0,te.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[ie.length>5&&(0,te.Y)(Wo.A,{className:"Link",onClick:oe,children:F(R?"ChatListSearchShowLess":"ChatListSearchShowMore")}),F("DialogListSearchSectionGlobal")]}),f&&(0,te.Y)(ud,{sponsoredPeer:f,observeIntersection:ue}),ie.map((e,t)=>{if(R||!(t>=5))return(0,te.Y)(Zc,{chatId:e,withUsername:!0,onClick:U})})]}),Boolean(g?.length)&&!t&&(0,te.FD)("div",{className:"search-section",children:[(0,te.Y)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:F("SearchResultRecommendedChannels")}),g.map(e=>(0,te.Y)(Zc,{chatId:e,withUsername:!0,onClick:U}))]}),(0,te.FD)("div",{className:"menuOwner",ref:V,children:[(0,te.Y)(qe.A,{isOpen:J,anchor:G,getTriggerElement:Q,getRootElement:$,getMenuElement:q,className:"chatResultsContextMenu",onClose:z,onCloseAnimationEnd:H,autoClose:!0,children:(0,te.FD)(te.FK,{children:[(0,te.Y)(de.A,{icon:"all"===x?"check":void 0,customIcon:"all"!==x?(0,te.Y)("i",{className:X}):void 0,onClick:()=>E("all"),children:K("all")}),(0,te.Y)(de.A,{icon:"users"===x?"check":void 0,customIcon:"users"!==x?(0,te.Y)("i",{className:X}):void 0,onClick:()=>E("users"),children:K("users")}),(0,te.Y)(de.A,{icon:"groups"===x?"check":void 0,customIcon:"groups"!==x?(0,te.Y)("i",{className:X}):void 0,onClick:()=>E("groups"),children:K("groups")}),(0,te.Y)(de.A,{icon:"channels"===x?"check":void 0,customIcon:"channels"!==x?(0,te.Y)("i",{className:X}):void 0,onClick:()=>E("channels"),children:K("channels")})]})}),pe&&(0,te.FD)("div",{className:"search-section",children:[(0,te.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[!e&&(0,te.FD)(Wo.A,{className:"Link menuTrigger dropDownLink",onClick:Z,children:[F("SearchContextCaption",{type:K(x)},{withNodes:!0}),(0,te.FD)(se.Ay,{name:"fade",shouldCleanup:!0,activeKey:Number(ce),className:"iconContainer",slideClassName:"iconContainerSlide",children:[ce&&(0,te.Y)($n.A,{}),!ce&&(0,te.Y)(W.A,{name:"down"})]})]}),F("SearchMessages")]}),re.map(function(e){const i=(0,s.mS)().chats.byId,n=(0,A.C)(F,e),a=i[e.chatId];if(n&&a)return(0,te.Y)(sd,{chatId:e.chatId,message:e,searchQuery:t})})]})]})]})}));var Ad=i(55723);const fd="documents",bd=(0,ge.nF)(e=>e(),500,!0),Cd=(0,n.ph)((0,s.EK)(Oc(fd))(({searchQuery:e,isLoading:t,chatsById:i,usersById:r,globalMessagesByChatId:c,foundIds:d,activeDownloads:h,shouldWarnAboutFiles:u})=>{const{searchMessagesGlobal:m,focusMessage:p}=(0,s.ko)(),v=(0,n.li)(),g=(0,T.A)(),{observe:A}=(0,Dr.BL)({rootRef:v,throttleMs:500}),f=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&bd(()=>{m({type:fd})})},[e]),b=(0,n.Kr)(()=>d&&c?d.map(e=>{const[t,i]=(0,Uc.a)(e),n=c[t]?.byId[i];return n&&(0,l.zC)(n)?n:void 0}).filter(Boolean):yi.p,[c,d]),C=(0,n.hb)(e=>{p({chatId:e.chatId,messageId:e.id})},[p]),y=(0,Yr.A)([e],o.jhd)&&!t;return(0,te.Y)(se.Ay,{ref:v,slideClassName:"LeftSearch--content",name:"fade",activeKey:y?1:0,shouldCleanup:!0,children:(0,te.FD)(Tn.A,{className:"search-content documents-list custom-scroll",items:y?b:void 0,onLoadMore:f,noFastList:!0,children:[!y&&(0,te.Y)($n.A,{}),y&&(!d||0===d.length)&&(0,te.Y)(Gc.A,{withSticker:!0,text:g("ChatList.Search.NoResults"),description:g("ChatList.Search.NoResultsDescription")}),y&&d&&d.length>0&&b.map((e,t)=>{const n=0===t||(0,He.$$)(e.date)!==(0,He.$$)(b[t-1].date);return(0,te.FD)(te.FK,{children:[n&&(0,te.Y)("p",{className:"section-heading",dir:g.isRtl?"rtl":void 0,children:(0,He.i6)(g,new Date(1e3*e.date))},e.date),(0,te.Y)("div",{className:"ListItem small-icon",children:(0,te.Y)(Ad.A,{document:(0,l.zC)(e),message:e,withDate:!0,datetime:e.date,smaller:!0,sender:(0,Kc.N)(g,e,i,r),className:"scroll-item",isDownloading:(0,l.$r)(h,e.content.document),shouldWarnAboutFiles:u,observeIntersection:A,onDateClick:C})},e.id)]})})]})})}));var yd=i(37378);const Sd="links",kd=(0,ge.nF)(e=>e(),500,!0),wd=(0,n.ph)((0,s.EK)(Oc(Sd))(({searchQuery:e,isLoading:t,chatsById:i,usersById:r,globalMessagesByChatId:l,foundIds:c,isChatProtected:d})=>{const{searchMessagesGlobal:h,focusMessage:u}=(0,s.ko)(),m=(0,n.li)(),p=(0,T.A)(),{observe:v}=(0,Dr.BL)({rootRef:m,throttleMs:500}),g=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&kd(()=>{h({type:Sd})})},[e]),A=(0,n.Kr)(()=>c&&l?c.map(e=>{const[t,i]=(0,Uc.a)(e);return l[t]?.byId[i]}).filter(Boolean):yi.p,[l,c]),f=(0,n.hb)(e=>{u({chatId:e.chatId,messageId:e.id})},[u]),b=(0,Yr.A)([e],o.jhd)&&!t;return(0,te.Y)(se.Ay,{ref:m,slideClassName:"LeftSearch--content",name:"fade",activeKey:b?1:0,shouldCleanup:!0,children:(0,te.FD)(Tn.A,{className:"search-content documents-list custom-scroll",items:b?A:void 0,onLoadMore:g,noFastList:!0,children:[!b&&(0,te.Y)($n.A,{}),b&&(!c||0===c.length)&&(0,te.Y)(Gc.A,{withSticker:!0,text:p("ChatList.Search.NoResults"),description:p("ChatList.Search.NoResultsDescription")}),b&&c&&c.length>0&&A.map((e,t)=>{const n=0===t||(0,He.$$)(e.date)!==(0,He.$$)(A[t-1].date);return(0,te.FD)(te.FK,{children:[n&&(0,te.Y)("p",{className:"section-heading",dir:p.isRtl?"rtl":void 0,children:(0,He.i6)(p,new Date(1e3*e.date))},e.date),(0,te.Y)("div",{className:"ListItem small-icon",dir:p.isRtl?"rtl":void 0,children:(0,te.Y)(yd.A,{message:e,senderTitle:(0,Kc.N)(p,e,i,r),isProtected:d||e.isProtected,observeIntersection:v,onMessageClick:f},e.id)},e.id)]})})]})})}));var Nd=i(81524);const Id="media",Pd=(0,ge.nF)(e=>e(),500,!0),Yd=(0,n.ph)((0,s.EK)(Oc(Id))(({searchQuery:e,isLoading:t,globalMessagesByChatId:i,foundIds:r,isChatProtected:l})=>{const{searchMessagesGlobal:c,openMediaViewer:d}=(0,s.ko)(),h=(0,n.li)(),u=(0,T.A)(),{observe:m}=(0,Dr.BL)({rootRef:h,throttleMs:500}),p=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&Pd(()=>{c({type:Id})})},[c,e]),v=(0,n.Kr)(()=>r&&i?r.map(e=>{const[t,n]=(0,Uc.a)(e);return i[t]?.byId[n]}).filter(Boolean):yi.p,[i,r]),g=(0,n.hb)((e,t)=>{d({chatId:t,messageId:e,origin:a.TQ.SearchResult})},[d]),A=(0,Yr.A)([e],o.jhd)&&!t,f=A&&r&&r.length>0&&!e,b=A&&r&&r.length>0&&e,C=(0,me.A)("search-content custom-scroll",b&&"chat-list");return(0,te.Y)(se.Ay,{ref:h,slideClassName:"LeftSearch--content LeftSearch--media",name:"fade",activeKey:A?1:0,shouldCleanup:!0,children:(0,te.FD)(Tn.A,{className:C,items:A?v:void 0,itemSelector:e?".ListItem":".Media",onLoadMore:p,noFastList:!0,children:[!A&&(0,te.Y)($n.A,{}),A&&(!r||0===r.length)&&(0,te.Y)(Gc.A,{withSticker:!0,text:u("ChatList.Search.NoResults"),description:u("ChatList.Search.NoResultsDescription")}),f&&(0,te.Y)("div",{className:"media-list",dir:u.isRtl?"rtl":void 0,children:v.map(e=>(0,te.Y)(Nd.A,{idPrefix:"search-media",message:e,isProtected:l||e.isProtected,observeIntersection:m,onClick:g},`${e.chatId}-${e.id}`))}),b&&v.map(e=>(0,te.Y)(sd,{chatId:e.chatId,message:e},e.id))]})})}));var Fd=i(537);const Dd={container:"fHc6WtIe",content:"N8GlyYo0",loadingScreen:"l7JTscdP",searchButtonContent:"dqfofU9e",sticker:"bhaEA7Az",title:"HkiOz0kI",description:"B5FR0TSV",searchButton:"Ii0w2ObZ",remainingSearches:"fYxU7PVl",searchIcon:"NMdA935k",searchIconWithNext:"NqAG2PXY",searchQuery:"eRsI0lkH",limitTitle:"uAggPEqN",limitDescription:"oirV9yqd",paidSearchButton:"LMu5PMXS",freeSearchUnlock:"IdgXsecy",premiumTitle:"SBmNHjsL",premiumDescription:"KoW3G8Sv",subscribePremiumButton:"tGWjYFeK",premiumSubtitle:"o2V6uF3Y"},Md=(0,n.ph)((0,s.EK)(e=>({isCurrentUserPremium:(0,c.g29)(e),starsBalance:e.stars?.balance?.amount||0}))(({searchQuery:e,searchFlood:t,onSearch:i,isLoading:a,isCurrentUserPremium:r,starsBalance:l})=>{const c=(0,Ui.A)(),d=t?.queryIsFree,h=t?.query,u=(0,Fd.A)([e?.slice(0,18).trimEnd()]),m=(0,M.A)(()=>{i()});(0,n.vJ)(()=>{d&&e&&h===e&&i()},[d,e,h,i]);const p=(0,M.A)(()=>{const e=t?.starsAmount||0;l<e?A({topup:{balanceNeeded:e}}):i()}),{checkSearchPostsFlood:v,openPremiumModal:g,openStarsBalanceModal:A}=(0,s.ko)(),f=(0,M.A)(()=>{v({})}),b=(0,M.A)(()=>{g()}),C=(0,ci.Fm)(),y=0===t?.remains||t?.waitTill&&t.waitTill>C;return(0,te.Y)(se.Ay,{name:"fade",activeKey:r?a?2:y?0:1:3,children:r?a?(0,te.Y)("div",{className:Dd.container,children:(0,te.Y)("div",{className:(0,me.A)(Dd.content,Dd.loadingScreen),children:(0,te.Y)($n.A,{})})}):y?(()=>{const i=t?.waitTill,n=t?.starsAmount||o._tP,s=t?.totalDaily||o.M3$;return(0,te.Y)("div",{className:Dd.container,children:(0,te.FD)("div",{className:Dd.content,children:[(0,te.Y)(zr.A,{className:Dd.sticker,size:120,tgsUrl:jr.w.Search,previewUrl:jr.d.Search,nonInteractive:!0,noLoop:!1}),(0,te.Y)("div",{className:Dd.limitTitle,children:c("PublicPostsLimitReached")}),(0,te.Y)("div",{className:Dd.limitDescription,children:c("HintPublicPostsSearchQuota",{count:s},{pluralValue:s})}),(0,te.Y)(Q.A,{className:Dd.paidSearchButton,color:"primary",disabled:!e,noForcedUpperCase:!0,onClick:p,children:c("PublicPostsSearchForStars",{stars:(0,Ei.U2)(c,n,{asFont:!0})},{withNodes:!0})}),Boolean(i)&&(0,te.Y)("div",{className:Dd.freeSearchUnlock,children:(0,te.Y)(hi.A,{langKey:"UnlockTimerPublicPostsSearch",endsAt:i+2,onEnd:f})})]})})})():(()=>{const i=t?.remains||0;return(0,te.Y)("div",{className:Dd.container,children:(0,te.FD)("div",{className:Dd.content,children:[(0,te.Y)(zr.A,{className:Dd.sticker,size:120,tgsUrl:jr.w.Search,previewUrl:jr.d.Search,nonInteractive:!0,noLoop:!1}),(0,te.Y)("div",{className:Dd.title,children:c("GlobalSearch")}),(0,te.Y)("div",{className:Dd.description,children:c("DescriptionPublicPostsSearch")}),(0,te.Y)(Q.A,{className:Dd.searchButton,color:"primary",noForcedUpperCase:!0,disabled:!e,onClick:m,children:(0,te.Y)(se.Ay,{name:"fade",activeKey:u,children:(0,te.FD)("div",{className:Dd.searchButtonContent,children:[(0,te.Y)(W.A,{name:"search",className:(0,me.A)(Dd.searchIcon,e&&Dd.searchIconWithNext)}),c("ButtonSearchPublicPosts",{query:e?(0,te.Y)("span",{className:Dd.searchQuery,children:e}):""},{withNodes:!0}),e&&(0,te.Y)(W.A,{name:"next",className:Dd.nextIcon})]})})}),(0,te.Y)("div",{className:Dd.remainingSearches,children:c("RemainingPublicPostsSearch",{count:i},{pluralValue:i})})]})})})():(0,te.Y)("div",{className:Dd.container,children:(0,te.FD)("div",{className:Dd.content,children:[(0,te.Y)("div",{className:Dd.premiumTitle,children:c("GlobalSearch")}),(0,te.Y)("div",{className:Dd.premiumDescription,children:c("PublicPostsPremiumFeatureDescription")}),(0,te.Y)(Q.A,{className:Dd.subscribePremiumButton,color:"primary",noForcedUpperCase:!0,onClick:b,children:c("PublicPostsSubscribeToPremium")}),(0,te.Y)("div",{className:Dd.premiumSubtitle,children:c("PublicPostsPremiumFeatureSubtitle")})]})})})})),Td=(0,ge.nF)(e=>e(),500,!0),Bd=(0,n.ph)((0,s.EK)(e=>{const{messages:{byChatId:t}}=e,{resultsByType:i,searchFlood:n,fetchingStatus:s}=(0,c.nTw)(e).globalSearch,a=i?.publicPosts,{foundIds:o}=a||{},r=Boolean(s?.publicPosts&&!a),l=!a&&!r,d=a&&!o?.length,{animationLevel:h}=(0,Is.l)(e);return{foundIds:o,globalMessagesByChatId:t,searchFlood:n,shouldShowSearchLauncher:l,isNothingFound:d,isLoading:r,animationLevel:h}})(({searchQuery:e,foundIds:t,globalMessagesByChatId:i,searchFlood:o,shouldShowSearchLauncher:r,isNothingFound:l,isLoading:c,animationLevel:d})=>{const{searchMessagesGlobal:h}=(0,s.ko)(),u=(0,Ui.A)(),m=(0,M.A)(()=>{e&&h({type:"publicPosts",shouldResetResultsByType:!0})}),p=(0,n.hb)(({direction:e})=>{e===a.TN.Backwards&&Td(()=>{h({type:"publicPosts"})})},[]),v=(0,n.Kr)(()=>t&&0!==t.length?t.map(e=>{const[t,n]=(0,Uc.a)(e);return i?.[t]?.byId[n]}).filter(Boolean):yi.p,[t,i]);return(0,te.Y)(se.Ay,{name:(0,Vc.P)("slideOptimized",d,void 0,u.isRtl),activeKey:r||c?0:1,children:r||c?(0,te.Y)(Md,{searchQuery:e,searchFlood:o,onSearch:m,isLoading:c}):(0,te.Y)("div",{className:"LeftSearch--content",children:(0,te.FD)(Tn.A,{className:"search-content custom-scroll chat-list",items:v,onLoadMore:p,noFastList:!0,children:[l&&(0,te.Y)(Gc.A,{text:u("ChatListSearchNoResults"),description:u("ChatListSearchNoResultsDescription"),withSticker:!0}),Boolean(v.length)&&(0,te.FD)("div",{className:"pb-2",children:[(0,te.Y)("h3",{className:"section-heading",dir:u.isRtl?"auto":void 0,children:u("PublicPosts")}),v.map(function(t){const i=(0,s.mS)().chats.byId,n=(0,A.C)(u,t),a=i[t.chatId];if(n&&a)return(0,te.Y)(sd,{chatId:t.chatId,message:t,searchQuery:e},`${t.chatId}-${t.id}`)})]})]},e)})})})),Rd=[{type:a.$C.ChatList,key:"SearchTabChats"},{type:a.$C.ChannelList,key:"SearchTabChannels"},{type:a.$C.BotApps,key:"SearchTabApps"},{type:a.$C.PublicPosts,key:"SearchTabPublicPosts"},{type:a.$C.Media,key:"SearchTabMedia"},{type:a.$C.Links,key:"SearchTabLinks"},{type:a.$C.Files,key:"SearchTabFiles"},{type:a.$C.Music,key:"SearchTabMusic"},{type:a.$C.Voice,key:"SearchTabVoice"}],Ld=[{type:a.$C.ChatList,key:"SearchTabMessages"},...Rd.slice(3)],xd=(0,n.ph)((0,s.EK)(e=>{const{currentContent:t,chatId:i}=(0,c.nTw)(e).globalSearch,{animationLevel:n}=(0,Is.l)(e);return{currentContent:t,chatId:i,animationLevel:n}})(({searchQuery:e,searchDate:t,isActive:i,currentContent:o=a.$C.ChatList,chatId:r,animationLevel:l,onReset:c})=>{const{setGlobalSearchContent:d,setGlobalSearchDate:h,checkSearchPostsFlood:u}=(0,s.ko)(),m=(0,Ui.A)(),[p,v]=(0,n.J0)(o),g=(0,n.Kr)(()=>(0,He.Rm)(e),[e]);(0,n.vJ)(()=>{i&&u({})},[i]);const A=(0,n.Kr)(()=>(r?Ld:Rd).map(e=>({...e,title:m(e.key)})),[r,m]),f=(0,M.A)(e=>{const t=A[e];d({content:t.type}),v(e)}),b=(0,M.A)(e=>{h({date:e.getTime()/1e3})});(0,Ce.A)({isActive:i,onBack:c});const C=(0,n.li)(),y=(0,Hn.A)(C,i,void 0,".ListItem-button",!0);return(0,te.FD)("div",{className:"LeftSearch",ref:C,onKeyDown:y,children:[(0,te.Y)(_c.A,{activeTab:p,tabs:A,onSwitchTab:f}),(0,te.Y)(se.Ay,{name:(0,Vc.P)("slideOptimized",l,void 0,m.isRtl),renderCount:A.length,activeKey:o,children:(()=>{switch(o){case a.$C.ChatList:case a.$C.ChannelList:return r?(0,te.Y)(cd,{searchQuery:e,dateSearchQuery:g,onReset:c,onSearchDateSelect:b}):(0,te.Y)(gd,{isChannelList:o===a.$C.ChannelList,searchQuery:e,searchDate:t,dateSearchQuery:g,onReset:c,onSearchDateSelect:b});case a.$C.Media:return(0,te.Y)(Yd,{searchQuery:e});case a.$C.Links:return(0,te.Y)(wd,{searchQuery:e});case a.$C.Files:return(0,te.Y)(Cd,{searchQuery:e});case a.$C.Music:return(0,te.Y)(zc,{searchQuery:e},"audio");case a.$C.Voice:return(0,te.Y)(zc,{isVoice:!0,searchQuery:e},"voice");case a.$C.BotApps:return(0,te.Y)(ed,{searchQuery:e},"botApps");case a.$C.PublicPosts:return(0,te.Y)(Bd,{searchQuery:e},"publicPosts");default:return}})()})]})}));var Ed=i(42215);const Vd={currentPassword:"",password:"",hint:"",email:""},_d=(e,t)=>{switch(t.type){case"setCurrentPassword":return{...e,currentPassword:t.payload};case"setPassword":return{...e,password:t.payload};case"setHint":return{...e,hint:t.payload};case"setEmail":return{...e,email:t.payload};case"reset":return Vd;default:return e}};var Ud=i(60406),Od=i(31880),Kd=i(58968),Jd=i(74984);const Gd=(0,n.ph)((0,s.EK)(e=>({maxChats:(0,Sa.d)(e,"dialogFiltersChats")}))(({mode:e,state:t,dispatch:i,isActive:a,onReset:r,onSaveFilter:l,maxChats:c})=>{const d=(0,T.A)(),{openLimitReachedModal:h}=(0,s.ko)(),{chatFilter:u}=t,{selectedChatIds:m,selectedChatTypes:p}=(0,n.Kr)(()=>(0,Od.a)(t,e,!0),[e,t]),v="included"===e?Kd.V2:Kd.LS,[g,A]=(0,n.J0)(!1),f=(0,Jd.Rh)(o.DSF),b=(0,Jd.Rh)(o._E9),C=t.folder.isChatList;(0,n.vJ)(()=>{a||A(!1)},[a]);const y=(0,n.Kr)(()=>{const e=[...f||[],...b||[]];return(0,Ci.Am)([...(0,Ft.PU)({ids:e,query:u,type:"chat"})])},[f,b,u]),S=(0,M.A)(e=>{i({type:"setChatFilter",payload:e}),A(!0)}),k=(0,M.A)(n=>{if("included"===e){if(n.length>=c)return void h({limit:"dialogFiltersChats"});i({type:"setIncludeFilters",payload:{...t.includeFilters,includedChatIds:n}})}else i({type:"setExcludeFilters",payload:{...t.excludeFilters,excludedChatIds:n}});A(!0)}),w=(0,M.A)(t=>{const n={};t.forEach(e=>{n[e]=!0}),i("included"===e?{type:"setIncludeFilters",payload:{includedChatIds:m,...n}}:{type:"setExcludeFilters",payload:{excludedChatIds:m,...n}}),A(!0)});return(0,Ce.A)({isActive:a,onBack:r}),y?(0,te.FD)("div",{className:"Picker settings-folders-chat-list",children:[(0,te.Y)(Si.A,{categories:C?void 0:v,itemIds:y,selectedIds:m,selectedCategories:p,filterValue:u,filterPlaceholder:d("Search"),categoryPlaceholderKey:"FilterChatTypes",searchInputId:"new-group-picker-search",isSearchable:!0,withDefaultPadding:!0,withPeerTypes:!0,allowMultiple:!0,itemInputType:"checkbox",onSelectedIdsChange:k,onSelectedCategoriesChange:w,onFilterChange:S}),(0,te.Y)(Ni.A,{isShown:g,onClick:l,ariaLabel:d("Save"),children:(0,te.Y)(W.A,{name:"check"})})]}):(0,te.Y)($n.A,{})})),jd=[0,1,2,3,4,5,6],zd="Please provide a title for this folder.",Hd="ChatList.Filter.Error.Empty",$d=(0,n.ph)((0,s.EK)((e,{state:t})=>{const{listIds:i}=e.chats,{byId:n,invites:s}=e.chatFolders,a=Object.values(n).reduce((e,t)=>e+(t.isChatList?1:0),0),o=(0,c.g29)(e);return{loadedActiveChatIds:i.active,loadedArchivedChatIds:i.archived,invites:t.folderId?s[t.folderId]||yi.p:void 0,isRemoved:void 0!==t.folderId&&!n[t.folderId],maxInviteLinks:(0,Sa.d)(e,"chatlistInvites"),maxChatLists:(0,Sa.d)(e,"chatlistJoined"),chatListCount:a,isCurrentUserPremium:o}})(({state:e,dispatch:t,onAddIncludedChats:i,onAddExcludedChats:a,onShareFolder:r,onOpenInvite:l,isActive:d,onReset:h,isRemoved:u,onBack:m,loadedActiveChatIds:p,isOnlyInvites:g,loadedArchivedChatIds:A,invites:f,maxInviteLinks:b,maxChatLists:C,chatListCount:y,onSaveFolder:S,isCurrentUserPremium:k})=>{const{loadChatlistInvites:w,openLimitReachedModal:N,showNotification:I,openPremiumModal:P}=(0,s.ko)(),Y="create"===e.mode,F=e.folder.isChatList,[D,M]=(0,n.J0)(!1),[B,R]=(0,n.J0)(!1);(0,n.vJ)(()=>{u&&h()},[u,h]),(0,n.vJ)(()=>{d&&e.folderId&&e.folder.isChatList&&w({folderId:e.folderId})},[d,e.folder.isChatList,e.folderId]);const{selectedChatIds:L,selectedChatTypes:x}=(0,n.Kr)(()=>(0,Od.a)(e,"included"),[e]),{selectedChatIds:E,selectedChatTypes:V}=(0,n.Kr)(()=>(0,Od.a)(e,"excluded"),[e]);(0,n.vJ)(()=>{M(!1),R(!1)},[e.folderId]);const[_,U]=(0,n.Kr)(()=>{const e=new Set([...p||[],...A||[]]),t=(0,Ci.$h)(L,e),i=(0,Ci.$h)(E,e);return[D?t:t.slice(0,5-x.length),B?i:i.slice(0,5-V.length)]},[E,L,x,V,B,D,p,A]),O=(0,T.A)();(0,Ce.A)({isActive:d,onBack:m});const K=(0,n.hb)(e=>{const{currentTarget:i}=e;t({type:"setTitle",payload:i.value.trim()})},[t]),J=(0,n.hb)(()=>{t({type:"setIsLoading",payload:!0}),S(()=>{setTimeout(()=>{h()},500)})},[t,S,h]),G=(0,n.hb)(()=>{f?(0,c.w5O)((0,s.mS)(),e.folderId)?y>=C&&!e.folder.isChatList?N({limit:"chatlistJoined"}):f.length<b?e.isTouched?S(r):r():N({limit:"chatlistInvites"}):I({message:O("ChatList.Filter.InviteLink.IncludeExcludeError")}):Y&&S(r)},[f,e.folderId,e.isTouched,y,b,Y,S,r,O,C,e.folder.isChatList]),j=(0,n.hb)((t,i)=>{e.isTouched?S(()=>l(i)):l(i)},[S,l,e.isTouched]);function z(e){const t="included"===e?x:V,i="included"===e?_:U,n="included"===e?D:B,s=("included"===e?L:E).length-i.length,a="included"===e?()=>M(!0):()=>R(!0);return(0,te.FD)(te.FK,{children:[t.map(t=>function(e,t){const i="included"===t?Kd.V2.find(({type:t})=>t===e):Kd.LS.find(({type:t})=>t===e);if(i)return(0,te.Y)(di.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0,children:(0,te.Y)(xn.A,{avatarSize:"small",customPeer:i})},i.type)}(t,e)),i.map(e=>(0,te.Y)(di.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0,children:(0,v.L8)(e)?(0,te.Y)(xn.A,{avatarSize:"small",userId:e}):(0,te.Y)(Ln.A,{avatarSize:"small",chatId:e})})),!n&&s>0&&(0,te.Y)(di.A,{className:"settings-folders-list-item",narrow:!0,onClick:a,icon:"down",children:O("FilterShowMoreChats",s,"i")},"load-more")]})}return(0,te.FD)("div",{className:"settings-fab-wrapper",children:[(0,te.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header",children:[(0,te.Y)(zr.A,{size:o.fwn,tgsUrl:jr.w.FoldersNew,play:String(e.folderId),className:"settings-content-icon"}),Y&&(0,te.Y)("p",{className:"settings-item-description mb-3",dir:O.isRtl?"rtl":void 0,children:O("FilterIncludeInfo")}),(0,te.Y)(Z.A,{className:"mb-0",label:O("FilterNameHint"),value:e.folder.title.text,maxLength:o.kGl,onChange:K,error:e.error&&e.error===zd?zd:void 0})]}),!g&&(0,te.FD)("div",{className:"settings-item",children:[e.error&&e.error===Hd&&(0,te.Y)("p",{className:"settings-item-description color-danger mb-2",dir:O.isRtl?"rtl":void 0,children:O(e.error)}),(0,te.Y)("h4",{className:"settings-item-header mb-3",dir:O.isRtl?"rtl":void 0,children:O("FilterInclude")}),(0,te.Y)(di.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:i,children:O("FilterAddChats")}),z("included")]}),!g&&!F&&(0,te.FD)("div",{className:"settings-item pt-3",children:[(0,te.Y)("h4",{className:"settings-item-header mb-3",dir:O.isRtl?"rtl":void 0,children:O("FilterExclude")}),(0,te.Y)(di.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:a,children:O("FilterAddChats")}),z("excluded")]}),(0,te.FD)("div",{className:"settings-item pt-3",children:[(0,te.FD)("h4",{className:"settings-item-header mb-3 color-picker-title",dir:O.isRtl?"rtl":void 0,children:[O("FilterColorTitle"),(0,te.Y)("div",{className:(0,me.A)("color-picker-selected-color",k&&void 0!==e.folder.color&&-1!==e.folder.color?(0,hn.a)({color:e.folder.color}):"color-picker-item-disabled"),children:(0,un.fd)({text:e.folder.title.text,entities:e.folder.title.entities,noCustomEmojiPlayback:e.folder.noTitleAnimations})})]}),(0,te.FD)("div",{className:"color-picker",children:[jd.map(i=>(0,te.Y)("button",{type:"button",onClick:()=>{k?t({type:"setColor",payload:i}):P()},className:(0,me.A)("color-picker-item",(0,hn.a)({color:i}),!k&&"color-picker-item-hover-disabled",i===e.folder.color&&k&&"color-picker-item-active")},i)),(0,te.Y)("button",{type:"button",onClick:()=>{k?t({type:"setColor",payload:void 0}):P()},className:(0,me.A)("color-picker-item","color-picker-item-none",(void 0===e.folder.color||-1===e.folder.color||!k)&&"color-picker-item-active"),children:k?(0,te.Y)(W.A,{name:"close",className:"color-picker-item-none-icon"}):(0,te.Y)(W.A,{name:"lock-badge",className:"color-picker-item-none-icon"})})]}),(0,te.Y)("p",{className:"settings-item-description mb-0",dir:O.isRtl?"rtl":void 0,children:O("FilterColorHint")})]}),(0,te.FD)("div",{className:"settings-item pt-3",children:[(0,te.Y)("h4",{className:"settings-item-header mb-3",dir:O.isRtl?"rtl":void 0,children:O("FolderLinkScreen.Title")}),(0,te.Y)(di.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:G,children:O("ChatListFilter.CreateLinkNew")}),f?.map(e=>(0,te.FD)(di.A,{className:"settings-folders-list-item",icon:"link",narrow:!0,multiline:!0,onClick:j,clickArg:e.url,children:[(0,te.Y)("span",{className:"title",dir:"auto",children:e.title||e.url}),(0,te.Y)("span",{className:"subtitle",children:O("ChatListFilter.LinkLabelChatCount",e.peerIds.length,"i")})]}))]})]}),(0,te.Y)(Ni.A,{isShown:Boolean(e.isTouched),disabled:e.isLoading,onClick:J,ariaLabel:"edit"===e.mode?"Save changes":"Create folder",children:e.isLoading?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})}));var qd=i(80401);const Wd=(0,ge.nF)(e=>e(),6e4,!0),Qd=(0,n.ph)((0,s.EK)(e=>{const{orderedIds:t,byId:i,recommended:n,areTagsEnabled:s}=e.chatFolders;return{folderIds:t,foldersById:i,isPremium:(0,c.g29)(e),recommendedChatFolders:n,maxFolders:(0,Sa.d)(e,"dialogFilters"),areTagsEnabled:s}})(({isActive:e,onCreateFolder:t,onEditFolder:i,onReset:a,folderIds:r,foldersById:c,isPremium:d,recommendedChatFolders:h,maxFolders:u,areTagsEnabled:m})=>{const{loadRecommendedChatFolders:p,addChatFolder:v,openLimitReachedModal:g,openDeleteChatFolderModal:A,sortChatFolders:f,toggleDialogFilterTags:b,openPremiumModal:C}=(0,s.ko)(),[y,S]=(0,n.J0)({orderedFolderIds:r,dragOrderIds:r,draggedIndex:void 0}),k=(0,_.A)(r);(0,n.vJ)(()=>{k!==r&&S({orderedFolderIds:r,dragOrderIds:r,draggedIndex:void 0})},[k,r,y.orderedFolderIds?.length]),(0,n.vJ)(()=>{Wd(()=>{p()})},[p]);const w=(0,n.hb)(()=>{Object.keys(c).length>=u-1?g({limit:"dialogFilters"}):t()},[c,u,t,g]),N=(0,Ui.A)();(0,Ce.A)({isActive:e,onBack:a});const I=(0,Jd.g5)(),P=(0,n.Kr)(()=>{if(r)return r.length<=1?yi.p:r.map(e=>{const t=c[e];return e===o.DSF?{id:e,title:{text:N("FilterAllChats"),entities:[]}}:{id:t.id,title:t.title,subtitle:(0,l.A5)(N,t,I[t.id]),isChatList:t.isChatList,color:t.color,noTitleAnimations:t.noTitleAnimations}})},[r,c,N,I]),Y=(0,n.hb)(e=>{Object.keys(c).length>=u-1?g({limit:"dialogFilters"}):v({folder:e})},[c,u,v,g]),F=(0,n.hb)(()=>{d&&b({isEnabled:!m})},[m,d,b]),D=(0,n.hb)((e,t)=>{const i=Math.round(e.y/56),n=y.orderedFolderIds?.indexOf(t)||0,s=y.orderedFolderIds?.filter(e=>e!==t);s&&(0,ve.Bt)(n+i,0,r?.length||0)&&(s.splice(n+i+(d?0:1),0,t),S(e=>({...e,draggedIndex:n,dragOrderIds:s})))},[r?.length,d,y.orderedFolderIds]),M=(0,n.hb)(()=>{S(e=>(f({folderIds:e.dragOrderIds}),{...e,orderedFolderIds:e.dragOrderIds,draggedIndex:void 0}))},[f]),T=(0,n.Kr)(()=>!d||Object.keys(c).length<u-1,[c,d,u]);return(0,te.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header",children:[(0,te.Y)(zr.A,{size:o.fwn,tgsUrl:jr.w.FoldersAll,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:N("CreateNewFilterInfo")}),T&&(0,te.FD)(Q.A,{className:"settings-button with-icon",color:"primary",pill:!0,fluid:!0,onClick:w,isRtl:N.isRtl,children:[(0,te.Y)(W.A,{name:"add"}),N("CreateNewFilter")]})]}),(0,te.FD)("div",{className:"settings-item pt-3",children:[(0,te.Y)("h4",{className:"settings-item-header mb-3",dir:N.isRtl?"rtl":void 0,children:N("Filters")}),(0,te.Y)("div",{className:"settings-sortable-container",style:`height: ${56*(r?.length||0)}px`,children:P?.length?P.map((t,n)=>{const s=n>u-1,a=y.draggedIndex===n,r=56*(y.orderedFolderIds?.indexOf(t.id)??0),l=56*(y.dragOrderIds?.indexOf(t.id)??0),h=void 0!==t?.color&&-1!==t.color&&d;return t.id===o.DSF?(0,te.Y)(qd.A,{id:t.id,onDrag:D,onDragEnd:M,style:`top: ${a?r:l}px;`,knobStyle:(N.isRtl?"left":"right")+": 0.375rem;",isDisabled:!d||!e,children:(0,te.FD)(di.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,inactive:!0,multiline:!0,isStatic:!0,allowSelection:!0,children:[(0,te.Y)("span",{className:"title",children:(0,un.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})}),(0,te.Y)("span",{className:"subtitle",children:N("FoldersAllChatsDesc")})]},t.id)},t.id):(0,te.Y)(qd.A,{id:t.id,onDrag:D,onDragEnd:M,style:`top: ${a?r:l}px;`,knobStyle:`${N.isRtl?"left":"right"}: ${h?"3.5rem":"3rem"};`,isDisabled:s||!e,children:(0,te.FD)(di.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,secondaryIcon:"more",multiline:!0,contextActions:[{handler:()=>{A({folderId:t.id})},destructive:!0,title:N("Delete"),icon:"delete"}],onClick:()=>{s?g({limit:"dialogFilters"}):i(c[t.id])},children:[(0,te.FD)("span",{className:"title",children:[(0,un.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}),s&&(0,te.Y)(W.A,{name:"lock-badge",className:"settings-folders-blocked-icon"})]}),(0,te.FD)("span",{className:"subtitle",children:[t.isChatList&&(0,te.Y)(W.A,{name:"link",className:"mr-1"}),t.subtitle]}),h&&(0,te.Y)("div",{className:(0,me.A)("settings-folders-color-circle",(0,hn.a)({color:t.color}))})]})},t.id)}):P&&!P.length?(0,te.Y)("p",{className:"settings-item-description my-4",dir:"auto",children:N("SettingsFoldersEmpty")}):(0,te.Y)($n.A,{})})]}),h&&Boolean(h.length)&&(0,te.FD)("div",{className:"settings-item pt-3",children:[(0,te.Y)("h4",{className:"settings-item-header mb-3",dir:N.isRtl?"rtl":void 0,children:N("FilterRecommended")}),h.map(e=>(0,te.Y)(di.A,{narrow:!0,onClick:()=>Y(e),children:(0,te.FD)("div",{className:"settings-folders-recommended-item",children:[(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:(0,un.fd)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations})}),(0,te.Y)("span",{className:"subtitle",children:e.description})]}),(0,te.Y)(Q.A,{className:"px-3",color:"primary",size:"tiny",pill:!0,fluid:!0,isRtl:N.isRtl,children:N("Add")})]})}))]}),(0,te.Y)("div",{className:"settings-item pt-3",children:(0,te.FD)("div",{className:"settings-item-relative",children:[(0,te.Y)(ps.A,{label:N("ShowFolderTags"),subLabel:N("ShowFolderTagsHint"),checked:d&&m,onChange:F,onClickLabel:e=>{d||(e.preventDefault(),C())}}),!d&&(0,te.Y)(W.A,{name:"lock-badge",className:"settings-folders-lock-icon"})]})})]})}));var Zd=i(4438);const Xd=(0,n.ph)((0,s.EK)(e=>{const{folderId:t,url:i,isLoading:n}=(0,c.nTw)(e).shareFolderScreen||{},s=t?(0,c.$aQ)(e,t):void 0,a=t?e.chatFolders.invites[t]?.find(e=>e.url===i):void 0;return{folderId:t,folder:s,url:i,isLoading:n,peerIds:a?.peerIds}})(({isActive:e,onReset:t,folderId:i,folder:a,peerIds:r,url:d,isLoading:h})=>{const{createChatlistInvite:u,deleteChatlistInvite:m,editChatlistInvite:p,showNotification:v}=(0,s.ko)(),g=(0,Ui.A)(),A=(0,T.A)(),[f,b]=(0,n.J0)(!1);(0,Ce.A)({isActive:e,onBack:t}),(0,n.vJ)(()=>{h||b(!1)},[h]),(0,n.vJ)(()=>{!d&&i&&e&&u({folderId:i})},[i,e,d]);const C=(0,M.A)(()=>{d&&i&&(m({folderId:i,url:d}),t())}),y=(0,n.Kr)(()=>(a?.includedChatIds||[]).concat(a?.pinnedChatIds||[]),[a?.includedChatIds,a?.pinnedChatIds]),[S,k]=(0,n.Kr)(()=>{const e=(0,s.mS)();return(0,Ci.jB)(y,t=>(0,c.hXb)(e,t))},[y]),[w,N]=(0,n.J0)(r||[]),I=(0,n.li)(!0);(0,wi.A)(([e])=>{e!==d&&(I.current=!0),I.current&&(I.current=!1,d?r&&N(r):N(S))},[d,S,r]);const P=(0,M.A)(e=>{const t=(0,s.mS)(),i=(0,c.mBe)(t,e),n=(0,c.hds)(t,e);i&&(0,l.tv)(i)?v({message:A("FolderLinkScreen.AlertTextUnavailableBot")}):i?v({message:A("FolderLinkScreen.AlertTextUnavailableUser")}):n&&(0,l.WX)(n)?v({message:A("FolderLinkScreen.AlertTextUnavailablePublicChannel")}):v({message:A("FolderLinkScreen.AlertTextUnavailablePublicGroup")})}),Y=(0,M.A)(e=>{N(e),b(!0)}),F=(0,M.A)(()=>{i&&d&&f&&p({folderId:i,peerIds:w,url:d})}),D=w.length,B=!D||h;return(0,te.FD)("div",{className:"settings-content no-border custom-scroll SettingsFoldersChatsPicker",children:[(0,te.FD)("div",{className:"settings-content-header",children:[(0,te.Y)(Zd.A,{size:o.fwn,tgsUrl:jr.w.FoldersShare,className:"settings-content-icon"}),a&&(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:g("FolderLinkTitleDescription",{folder:(0,un.fd)({text:a.title.text,entities:a.title.entities,noCustomEmojiPlayback:a.noTitleAnimations}),chats:g("FolderLinkTitleDescriptionChats",{count:D},{pluralValue:D})},{withMarkdown:!0,withNodes:!0})})]}),(0,te.Y)(Al.A,{className:"settings-item",link:d||A("Loading"),withShare:!0,onRevoke:C,isDisabled:!D||f}),(0,te.Y)("div",{className:"settings-item settings-item-picker",children:(0,te.Y)(Si.A,{itemIds:y,lockedUnselectedIds:k,onSelectedIdsChange:Y,selectedIds:w,onDisabledClick:P,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})}),(0,te.Y)(Ni.A,{isShown:h||f,disabled:B,onClick:F,ariaLabel:"Save changes",children:h?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})})),eh=(0,n.ph)(({currentScreen:e,shownScreen:t,state:i,dispatch:o,isActive:r,onReset:l})=>{const{openShareChatFolderModal:c,editChatFolder:d,addChatFolder:h,openSettingsScreen:u}=(0,s.ko)(),m=(0,n.hb)(()=>{e!==a.VS.FoldersCreateFolder&&e!==a.VS.FoldersEditFolder&&e!==a.VS.FoldersEditFolderFromChatList&&e!==a.VS.FoldersEditFolderInvites||setTimeout(()=>{o({type:"reset"})},200),e!==a.VS.FoldersIncludedChats&&e!==a.VS.FoldersExcludedChats?l():"create"===i.mode?u({screen:a.VS.FoldersCreateFolder}):u({screen:a.VS.FoldersEditFolder})},[i.mode,o,e,l]),p="create"===i.mode,v=(0,n.hb)(e=>{const{title:{text:t}}=e.folder;if(!t)return o({type:"setError",payload:zd}),!1;const{selectedChatIds:i,selectedChatTypes:n}=(0,Od.a)(e,"included");return i.length||Object.keys(n).length?(p?h({folder:e.folder}):d({id:e.folderId,folderUpdate:e.folder}),o({type:"setError",payload:void 0}),o({type:"setIsTouched",payload:!1}),!0):(o({type:"setError",payload:Hd}),!1)},[o,p]),g=(0,n.hb)(e=>{v(i)&&e?.()},[v,i]),A=(0,n.hb)(()=>{o({type:"saveFilters"}),m()},[o,m]),f=(0,n.hb)(()=>{o({type:"reset"}),u({screen:a.VS.FoldersCreateFolder})},[o]),b=(0,n.hb)(e=>{o({type:"editFolder",payload:e}),u({screen:a.VS.FoldersEditFolder})},[o]),C=(0,n.hb)(()=>{o({type:"editIncludeFilters"}),u({screen:e===a.VS.FoldersEditFolderFromChatList?a.VS.FoldersIncludedChatsFromChatList:a.VS.FoldersIncludedChats})},[e,o]),y=(0,n.hb)(()=>{o({type:"editExcludeFilters"}),u({screen:e===a.VS.FoldersEditFolderFromChatList?a.VS.FoldersExcludedChatsFromChatList:a.VS.FoldersExcludedChats})},[e,o]),S=(0,n.hb)(()=>{c({folderId:i.folderId,noRequestNextScreen:!0}),o({type:"setIsChatlist",payload:!0}),u({screen:a.VS.FoldersShare})},[o,i.folderId]),k=(0,n.hb)(e=>{c({folderId:i.folderId,url:e,noRequestNextScreen:!0}),u({screen:a.VS.FoldersShare})},[i.folderId]);switch(e){case a.VS.Folders:return(0,te.Y)(Qd,{onCreateFolder:f,onEditFolder:b,isActive:r||[a.VS.FoldersCreateFolder,a.VS.FoldersEditFolder,a.VS.FoldersIncludedChats,a.VS.FoldersExcludedChats].includes(t),onReset:l});case a.VS.FoldersCreateFolder:case a.VS.FoldersEditFolder:case a.VS.FoldersEditFolderFromChatList:case a.VS.FoldersEditFolderInvites:return(0,te.Y)($d,{state:i,dispatch:o,onAddIncludedChats:C,onAddExcludedChats:y,onShareFolder:S,onOpenInvite:k,onReset:m,isActive:r||[a.VS.FoldersIncludedChats,a.VS.FoldersExcludedChats].includes(t),isOnlyInvites:e===a.VS.FoldersEditFolderInvites,onBack:l,onSaveFolder:g});case a.VS.FoldersIncludedChats:case a.VS.FoldersIncludedChatsFromChatList:return(0,te.Y)(Gd,{mode:"included",state:i,dispatch:o,onReset:m,onSaveFilter:A,isActive:r});case a.VS.FoldersExcludedChats:case a.VS.FoldersExcludedChatsFromChatList:return(0,te.Y)(Gd,{mode:"excluded",state:i,dispatch:o,onReset:m,onSaveFilter:A,isActive:r});case a.VS.FoldersShare:return(0,te.Y)(Xd,{isActive:r,onReset:m});default:return}});var th=i(70934),ih=i(3178);const nh=(0,n.ph)(({isActive:e,error:t,isLoading:i,shouldDisablePasswordManager:s,expectedPassword:a,placeholder:o,hint:r,submitLabel:l,onSubmit:c,onClearError:d,onReset:h})=>{const[u,m]=(0,n.J0)(""),[p,v]=(0,n.J0)(!1),g=(0,Ui.A)(),A=(0,n.hb)(e=>{a&&e!==a?m(g("SettingsPasswordEqual")):c(e)},[c,a,g]),f=(0,n.hb)(()=>{d&&d(),m("")},[d]);return(0,Ce.A)({isActive:e,onBack:h}),(0,te.FD)("div",{className:"settings-content password-form custom-scroll",children:[(0,te.Y)("div",{className:"settings-content-header no-border",children:(0,te.Y)(ih.A,{isBig:!0,isPasswordVisible:p})}),(0,te.Y)("div",{className:"settings-item settings-group",children:(0,te.Y)(Jl.A,{error:u||t,hint:r,placeholder:o||g("CurrentPasswordPlaceholder"),shouldDisablePasswordManager:s,submitLabel:l,onClearError:f,isLoading:i,isPasswordVisible:p,shouldResetValue:e,onChangePasswordVisibility:v,onSubmit:A})})]})}),sh=(0,n.ph)(({isActive:e,onReset:t})=>{const i=(0,T.A)(),s=(0,n.hb)(()=>{t(!0)},[t]);return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(Zd.A,{size:o.BYH,tgsUrl:jr.w.Congratulations,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Congratulations!"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Now you can lock the app with a passcode so that others can't open it."})]}),(0,te.Y)("div",{className:"settings-item settings-group",children:(0,te.Y)(Q.A,{onClick:s,children:i("Back")})})]})});var ah=i(89704);const oh=(0,n.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,s.ko)(),n=(0,T.A)();return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Lock,previewUrl:ah,size:160,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Local passcode is enabled."})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{icon:"edit",onClick:()=>i({screen:a.VS.PasscodeChangePasscodeCurrent}),children:n("Passcode.Change")}),(0,te.Y)(di.A,{icon:"password-off",onClick:()=>i({screen:a.VS.PasscodeTurnOff}),children:n("Passcode.TurnOff")})]})]})}),rh=(0,n.ph)(({isActive:e,onReset:t,onStart:i})=>{const n=(0,Ui.A)();return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Lock,previewUrl:ah,size:o.BYH,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description",dir:"auto",children:n("SettingsPasscodeStart1",void 0,{withNodes:!0,renderTextFilters:["br"]})}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:n("SettingsPasscodeStart2",void 0,{withNodes:!0,renderTextFilters:["br"]})})]}),(0,te.Y)("div",{className:"settings-item settings-group",children:(0,te.Y)(Q.A,{onClick:i,children:n("EnablePasscode")})})]})}),lh=(0,n.ph)((0,s.EK)(e=>({...e.passcode}))(({passcode:e,currentScreen:t,shownScreen:i,error:o,isActive:r,isLoading:l,onSetPasscode:c,onReset:d})=>{const{setPasscode:h,clearPasscode:u,setPasscodeError:m,clearPasscodeError:p,openSettingsScreen:v}=(0,s.ko)(),g=(0,T.A)(),A=(0,n.hb)(()=>{c(""),v({screen:a.VS.PasscodeNewPasscode})},[c]),f=(0,n.hb)(e=>{c(e),v({screen:a.VS.PasscodeNewPasscodeConfirm})},[c]),b=(0,n.hb)(()=>{h({passcode:e}),c(""),v({screen:a.VS.PasscodeCongratulations})},[c,e]),C=(0,n.hb)(e=>{c(""),(0,th.UQ)(e).then(()=>{v({screen:a.VS.PasscodeChangePasscodeNew})},()=>{m({error:g("PasscodeController.Error.Current")})})},[g,c]),y=(0,n.hb)(e=>{c(e),v({screen:a.VS.PasscodeChangePasscodeConfirm})},[c]),S=(0,n.hb)(e=>{(0,th.UQ)(e).then(()=>{u(),v({screen:a.VS.Privacy})},()=>{m({error:g("PasscodeController.Error.Current")})})},[g]);switch(t){case a.VS.PasscodeDisabled:return(0,te.Y)(rh,{onStart:A,isActive:r||[a.VS.PasscodeNewPasscode,a.VS.PasscodeNewPasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeNewPasscode:return(0,te.Y)(nh,{shouldDisablePasswordManager:!0,placeholder:g("EnterNewPasscode"),submitLabel:g("Continue"),onSubmit:f,isActive:r||[a.VS.PasscodeNewPasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeNewPasscodeConfirm:return(0,te.Y)(nh,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:g("ReEnterYourPasscode"),submitLabel:g("Continue"),isLoading:l,onSubmit:b,isActive:r||[a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeCongratulations:return(0,te.Y)(sh,{isActive:r,onReset:d});case a.VS.PasscodeEnabled:return(0,te.Y)(oh,{isActive:r||[a.VS.PasscodeChangePasscodeCurrent,a.VS.PasscodeChangePasscodeNew,a.VS.PasscodeChangePasscodeConfirm,a.VS.PasscodeCongratulations,a.VS.PasscodeTurnOff].includes(i),onReset:d});case a.VS.PasscodeChangePasscodeCurrent:return(0,te.Y)(nh,{shouldDisablePasswordManager:!0,error:o,onClearError:p,placeholder:g("PasscodeController.Current.Placeholder"),onSubmit:C,isActive:r||[a.VS.PasscodeChangePasscodeNew,a.VS.PasscodeChangePasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeChangePasscodeNew:return(0,te.Y)(nh,{shouldDisablePasswordManager:!0,placeholder:g("PleaseEnterNewFirstPassword"),onSubmit:y,isActive:r||[a.VS.PasscodeChangePasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeChangePasscodeConfirm:return(0,te.Y)(nh,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:g("PasscodeController.ReEnterPasscode.Placeholder"),isLoading:l,onSubmit:b,isActive:r||[a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeTurnOff:return(0,te.Y)(nh,{shouldDisablePasswordManager:!0,error:o?g(o):void 0,onClearError:p,placeholder:g("PasscodeController.Current.Placeholder"),onSubmit:S,isActive:r,onReset:d});default:return}})),ch=[50,100,500,1e3,2e3,5e3,1e4];function dh(e,t){const i=e.findIndex(e=>t<=e),n=e[i-1]||1,s=e[i]||e[e.length-1];return i+(t-n)/(s-n)}function hh(e,t){const i=Math.floor(t),n=e[i-1]||1,s=n+((e[i]||e[e.length-1])-n)*(t-i);return s<100?Math.round(s):10*Math.round(s/10)}const uh=(0,n.ph)(({min:e=0,max:t,value:i,disabled:s,readOnly:a,bold:o,className:r,defaultValue:l,onChange:c,canChangeChargeForMessages:d})=>{const h=(0,Ui.A)(),u=(0,n.Kr)(()=>{const e=[];for(let i=0;i<ch.length;i++)if(ch[i]<t&&e.push(ch[i]),ch[i]>=t){e.push(t);break}return e},[t]),m=(0,M.A)(e=>{const t=Number(e.currentTarget.value);c(hh(u,t))}),p=(0,me.A)(r,"RangeSlider",s&&"disabled",a&&"readOnly",o&&"bold");return(0,te.FD)("div",{className:p,children:[(0,te.FD)("div",{className:"slider-top-row",dir:h.isRtl?"rtl":void 0,children:[(0,te.Y)("span",{className:"value-min",dir:"auto",children:h.number(e)}),(0,te.FD)("span",{className:"settings-range-value",children:[!d&&(0,te.Y)(W.A,{name:"lock-badge"}),(0,Ei.Kk)(h,hh(u,dh(u,i)))]}),(0,te.Y)("span",{className:"value-max",dir:"auto",children:h.number(t)})]}),(0,te.FD)("div",{className:"slider-main",children:[(0,te.Y)("div",{className:"slider-fill-track",style:`width: ${dh(u,i)/u.length*100}%`}),(0,te.Y)("input",{min:0,max:u.length,defaultValue:dh(u,l),step:"any",type:"range",className:"RangeSlider__input",onChange:m})]})]})}),mh=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig.starsUsdWithdrawRateX1000,i=t?t/1e3:1,n=e.appConfig.starsPaidMessageCommissionPermille;return{starsPaidMessageCommissionPermille:n?n/1e3:100,starsUsdWithdrawRate:i,starsPaidMessageAmountMax:e.appConfig.starsPaidMessageAmountMax||o.$$v}})(function({starsUsdWithdrawRate:e,starsPaidMessageAmountMax:t,starsPaidMessageCommissionPermille:i,canChangeChargeForMessages:n,isGroupChat:a,chargeForMessages:r,onChange:l}){const{openPremiumModal:c}=(0,s.ko)(),d=(0,Ui.A)(),h=(0,M.A)(e=>{l?.(e)}),u=(0,M.A)(()=>{c({initialSection:"message_privacy"})});return(0,te.FD)(te.FK,{children:[(0,te.Y)("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0,children:d("SectionTitleStarsForForMessages")}),(0,te.Y)(uh,{defaultValue:r,min:o.BSg,max:t,value:r,onChange:h,canChangeChargeForMessages:n,readOnly:!n}),!n&&(0,te.Y)(Q.A,{color:"primary",fluid:!0,noForcedUpperCase:!0,className:"settings-unlock-button",onClick:u,children:(0,te.FD)("span",{className:"settings-unlock-button-title",children:[d("UnlockButtonTitle"),(0,te.Y)(W.A,{name:"lock-badge",className:"settings-unlock-button-icon"})]})}),n&&(0,te.Y)("p",{className:"settings-item-description-larger",dir:d.isRtl?"rtl":void 0,children:d(a?"SetPriceGroupDescription":"SectionDescriptionStarsForForMessages",{percent:(0,$e.l9)(100*i),amount:(0,ka.Ad)(r*e*i,"USD",d.code)},{withNodes:!0})})]})}));var ph=i(9267);const vh=(0,n.ph)(function({premiumSection:e}){const{openPremiumModal:t}=(0,s.ko)(),i=(0,T.A)(),n=(0,M.A)(()=>t({initialSection:e}));return(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{leftElement:(0,te.Y)(ph.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:n,children:i("PrivacyLastSeenPremium")}),(0,te.Y)("p",{className:"settings-item-description-larger premium-info",dir:i.isRtl?"rtl":void 0,children:i("lng_messages_privacy_premium_about")})]})}),gh=(0,n.ph)(function({label:e,isChecked:t}){const i=(0,T.A)(),{showNotification:n}=(0,s.ko)();return(0,te.FD)("div",{className:(0,me.A)("sBptmiga",t&&"U_6O1ebL"),onClick:()=>n({message:i("OptionPremiumRequiredMessage")}),children:[(0,te.Y)("span",{children:e}),(0,te.Y)(W.A,{name:"lock-badge",className:"jWxrRbkh"})]})}),Ah=(0,n.ph)((0,s.EK)(e=>{const{settings:{privacy:t}}=e,i=(0,c.Iv$)(e),n=e.settings.privacy.noPaidMessages?.allowUserIds.length||0;return{shouldNewNonContactPeersRequirePremium:(0,c.BSN)(e),shouldChargeForMessages:Boolean(i),nonContactPeersPaidStars:i||o.wZe,isCurrentUserPremium:(0,c.g29)(e),canLimitNewMessagesWithoutPremium:e.appConfig.canLimitNewMessagesWithoutPremium,canChargeForMessages:e.appConfig.starsPaidMessagesAvailable,noPaidReactionsForUsersCount:n,privacy:t}})(function({isActive:e,canLimitNewMessagesWithoutPremium:t,canChargeForMessages:i,shouldNewNonContactPeersRequirePremium:o,shouldChargeForMessages:r,nonContactPeersPaidStars:l,isCurrentUserPremium:c,noPaidReactionsForUsersCount:d,onReset:h,privacy:u}){const{updateGlobalPrivacySettings:m,openSettingsScreen:p,showNotification:v}=(0,s.ko)(),g=(0,T.A)(),A=(0,Ui.A)(),f=c||t,b=c&&i,[C,y]=(0,n.J0)(l),[S,k]=(0,n.J0)(!1),w=(0,n.Kr)(()=>r?"charge_for_messages":o?"contacts_and_premium":"everybody",[r,o]);(0,wi.A)(([e])=>{S||void 0===e||"everybody"===w||w===e||("everybody"===u.chatInvite?.visibility&&v({message:A("CheckPrivacyInviteText"),action:{action:"openSettingsScreen",payload:{screen:a.VS.PrivacyGroupChats}},actionText:{key:"Review"},duration:8e3}),"everybody"===u.phoneCall?.visibility&&v({message:A("CheckPrivacyCallsText"),action:{action:"openSettingsScreen",payload:{screen:a.VS.PrivacyPhoneCall}},actionText:{key:"Review"},duration:8e3}),k(!0))},[w,r,u,A,S]);const N=(0,n.Kr)(()=>[{value:"everybody",label:g("P2PEverybody")},{value:"contacts_and_premium",label:f?g("PrivacyMessagesContactsAndPremium"):(0,te.Y)(gh,{label:g("PrivacyMessagesContactsAndPremium"),isChecked:"contacts_and_premium"===w}),hidden:!f,isCanCheckedInDisabled:!0},{value:"charge_for_messages",label:b?A("PrivacyChargeForMessages"):(0,te.Y)(gh,{label:A("PrivacyChargeForMessages"),isChecked:"charge_for_messages"===w}),hidden:!b,isCanCheckedInDisabled:!0}],[g,A,f,b,w]),I=(0,M.A)(e=>{m({shouldNewNonContactPeersRequirePremium:"contacts_and_premium"===e,nonContactPeersPaidStars:"charge_for_messages"===e?C:null})}),P=(0,fe.A)(e=>{m({nonContactPeersPaidStars:e})},[m],300,!0),Y=(0,n.hb)(e=>{y(e),P(e)},[y,P]);(0,Ce.A)({isActive:e,onBack:h});const F=(0,n.Kr)(()=>A(r?"PrivacyDescriptionChargeForMessages":"PrivacyDescriptionMessagesContactsAndPremium"),[r,A]);return(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("PrivacyMessagesTitle")}),(0,te.Y)(ee.A,{name:"privacy-messages",options:N,onChange:I,selected:w}),(0,te.Y)("p",{className:"settings-item-description-larger",dir:g.isRtl?"rtl":void 0,children:F})]}),"charge_for_messages"===w&&(0,te.Y)("div",{className:"settings-item fluid-container",children:(0,te.Y)(mh,{canChangeChargeForMessages:b,chargeForMessages:C,onChange:Y})}),b&&"charge_for_messages"===w&&function(){const e=d?g("Users",d,"i"):A("SubtitlePrivacyAddUsers");return(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:A("RemoveFeeTitle")}),(0,te.Y)(di.A,{narrow:!0,icon:"delete-user",onClick:()=>{p({screen:a.VS.PrivacyNoPaidMessages})},children:(0,te.FD)("div",{className:"multiline-item full-size",children:[(0,te.Y)("span",{className:"title",children:A("ExceptionTitlePrivacyChargeForMessages")}),(0,te.Y)("span",{className:"subtitle",children:e})]})})]})}(),!c&&"charge_for_messages"!==w&&(0,te.Y)(vh,{premiumSection:"message_privacy"})]})}));function fh(e){const t=e.platform.toLowerCase(),i=e.deviceModel.toLowerCase(),n=e.systemVersion.toLowerCase();return i.includes("xbox")?"xbox":i.includes("chrome")&&!i.includes("chromebook")?"chrome":i.includes("brave")?"brave":i.includes("vivaldi")?"vivaldi":i.includes("safari")?"safari":i.includes("firefox")?"firefox":i.includes("opera")?"opera":i.includes("samsungbrowser")?"samsung":t.includes("android")?"android":i.includes("iphone")||i.includes("ipad")||t.includes("ios")||t.includes("macos")||n.includes("macos")?"apple":t.includes("ubuntu")||n.includes("ubuntu")?"ubuntu":t.includes("linux")||n.includes("linux")?"linux":t.includes("windows")||n.includes("windows")?"windows":"unknown"}const bh={SettingsActiveSession:"M84mrPgu",settingsActiveSession:"M84mrPgu",iconDevice:"Add8P_K4",iconDevice__android:"onkXVGY4",iconDeviceAndroid:"onkXVGY4",iconDevice__apple:"xw13aT8u",iconDeviceApple:"xw13aT8u",iconDevice__brave:"HESrGUdv",iconDeviceBrave:"HESrGUdv",iconDevice__chrome:"Vpej7wm7",iconDeviceChrome:"Vpej7wm7",iconDevice__edge:"ueWE77x9",iconDeviceEdge:"ueWE77x9",iconDevice__firefox:"_lMTmvya",iconDeviceFirefox:"_lMTmvya",iconDevice__linux:"cDVfvyG_",iconDeviceLinux:"cDVfvyG_",iconDevice__opera:"nWqlTxZt",iconDeviceOpera:"nWqlTxZt",iconDevice__safari:"ldFLp1Gf",iconDeviceSafari:"ldFLp1Gf",iconDevice__samsung:"VHNORBGL",iconDeviceSamsung:"VHNORBGL",iconDevice__ubuntu:"QBVivtdu",iconDeviceUbuntu:"QBVivtdu",iconDevice__unknown:"GbjIgrwU",iconDeviceUnknown:"GbjIgrwU",iconDevice__vivaldi:"yieVnjoI",iconDeviceVivaldi:"yieVnjoI",iconDevice__windows:"_0dnTFOE",iconDeviceWindows:"_0dnTFOE",iconDevice__xbox:"fbCjjDpU",iconDeviceXbox:"fbCjjDpU",title:"c6edjhlh",note:"lRqTZAYn",date:"oLnN6crs",box:"wVEXuPlZ",actionHeader:"olQS2T1n",actionName:"KuX1APpO",headerButton:"VT8pZfMu"};function Ch(e){return[e.region,e.country].filter(Boolean).join(", ")}const yh=(0,n.ph)((0,s.EK)((e,{hash:t})=>({session:t?e.activeSessions.byHash[t]:void 0}))(({isOpen:e,session:t,onClose:i})=>{const{changeSessionSettings:a,terminateAuthorization:o}=(0,s.ko)(),r=(0,Ui.A)(),l=(0,Ri.A)(t,!0),c=(0,n.hb)(()=>{a({hash:t.hash,areSecretChatsEnabled:!t.areSecretChatsEnabled})},[a,t]),d=(0,n.hb)(()=>{a({hash:t.hash,areCallsEnabled:!t.areCallsEnabled})},[a,t]),h=(0,n.hb)(()=>{o({hash:t.hash}),i()},[i,t,o]);if(l)return(0,te.FD)(X.A,{header:(0,te.FD)("div",{className:"modal-header-condensed",dir:r.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:r("Close"),onClick:i,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"modal-title",children:r("SessionPreviewTitle")}),(0,te.Y)(Q.A,{color:"danger",onClick:h,className:(0,me.A)("modal-action-button",bh.headerButton),children:r("SessionPreviewTerminateSession")})]}),isOpen:e,hasCloseButton:!0,onClose:i,className:bh.SettingsActiveSession,children:[(0,te.Y)("div",{className:(0,me.A)(bh.iconDevice,l&&bh[`iconDevice__${fh(l)}`])}),(0,te.Y)("h3",{className:bh.title,dir:"auto",children:l?.deviceModel}),(0,te.Y)("div",{className:bh.date,"aria-label":r("PrivacySettingsLastSeen"),children:(0,He.L2)(1e3*l.dateActive,r.code)}),(0,te.FD)("dl",{className:bh.box,children:[(0,te.Y)("dt",{children:r("SessionPreviewApp")}),(0,te.FD)("dd",{children:[l?.appName," ",l?.appVersion,","," ",l?.platform," ",l?.systemVersion]}),l?.ip&&(0,te.FD)(te.FK,{children:[(0,te.Y)("dt",{children:r("SessionPreviewIp")}),(0,te.Y)("dd",{children:l.ip})]}),(0,te.Y)("dt",{children:r("SessionPreviewLocation")}),(0,te.Y)("dd",{children:l&&Ch(l)})]}),(0,te.Y)("p",{className:bh.note,children:r("SessionPreviewIpDesc")}),(0,te.Y)("h4",{className:bh.actionHeader,children:r("AuthSessionsViewAcceptTitle")}),(0,te.FD)(di.A,{onClick:c,children:[(0,te.Y)("span",{className:bh.actionName,children:r("SessionPreviewAcceptSecret")}),(0,te.Y)(bi.A,{id:"accept_secrets",label:"On",checked:l.areSecretChatsEnabled})]}),(0,te.FD)(di.A,{onClick:d,children:[(0,te.Y)("span",{className:bh.actionName,children:r("SessionPreviewAcceptCalls")}),(0,te.Y)(bi.A,{id:"accept_calls",label:"On",checked:l.areCallsEnabled})]})]})}));function Sh(e){return[e.region,e.country].filter(Boolean).join(", ")}const kh=(0,n.ph)((0,s.EK)(e=>e.activeSessions)(({isActive:e,onReset:t,byHash:i,orderedHashes:a,ttlDays:o})=>{const{terminateAuthorization:r,terminateAllAuthorizations:l,changeSessionTtl:c}=(0,s.ko)(),d=(0,T.A)(),h=(0,Ui.A)(),[u,m,p]=(0,F.A)(),[v,g]=(0,n.J0)(),[A,f,b]=(0,F.A)(),C=(0,n.Kr)(()=>{if(void 0!==o)return o<=7?"7":o<=30?"30":o<=93?"90":o<=183?"183":o>183?"365":void 0},[o]),y=(0,n.Kr)(()=>{const e=[{label:h("Weeks",{count:1},{pluralValue:1}),value:"7"},{label:h("Months",{count:1},{pluralValue:1}),value:"30"},{label:h("Months",{count:3},{pluralValue:3}),value:"90"},{label:h("Months",{count:6},{pluralValue:6}),value:"183"}];return o&&o>=365&&e.push({label:h("Years",{count:1},{pluralValue:1}),value:"365"}),e},[h,o]),S=(0,n.hb)(e=>{r({hash:e})},[r]),k=(0,n.hb)(()=>{p(),l()},[p,l]),w=(0,n.hb)(e=>{g(e),f()},[f]),N=(0,n.hb)(()=>{g(void 0),b()},[b]),I=(0,n.hb)(e=>{c({days:Number(e)})},[c]),P=(0,n.Kr)(()=>{const e=a.find(e=>i[e].isCurrent);return e?i[e]:void 0},[i,a]),Y=(0,n.Kr)(()=>a.filter(e=>!i[e].isCurrent),[i,a]),D=Boolean(Y.length);return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content custom-scroll SettingsActiveSessions",children:[P&&(B=P,(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:h.isRtl?"rtl":void 0,children:h("AuthSessionsCurrentSession")}),(0,te.Y)(di.A,{narrow:!0,inactive:!0,icon:`device-${fh(B)}`,iconClassName:"icon-device",children:(0,te.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,te.Y)("span",{className:"title",dir:"auto",children:B.deviceModel}),(0,te.FD)("span",{className:"subtitle black tight",children:[B.appName," ",B.appVersion,","," ",B.platform," ",B.systemVersion]}),(0,te.FD)("span",{className:"subtitle",children:[B.ip," ","-"," ",Sh(B)]})]})}),D&&(0,te.Y)(di.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:m,children:h("TerminateAllSessions")})]})),D&&(M=Y,(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:h.isRtl?"rtl":void 0,children:h("OtherSessions")}),M.map(function(e){const t=i[e];return(0,te.Y)(di.A,{ripple:!0,narrow:!0,contextActions:[{title:h("SessionTerminate"),icon:"stop",destructive:!0,handler:()=>{S(t.hash)}}],icon:`device-${fh(t)}`,iconClassName:"icon-device",onClick:()=>{w(t.hash)},children:(0,te.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,te.Y)("span",{className:"date",children:(0,He.be)(d,1e3*t.dateActive)}),(0,te.Y)("span",{className:"title",children:t.deviceModel}),(0,te.FD)("span",{className:"subtitle black tight",children:[t.appName," ",t.appVersion,","," ",t.platform," ",t.systemVersion]}),(0,te.FD)("span",{className:"subtitle",children:[t.ip," ",Sh(t)]})]})},t.hash)})]})),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:h.isRtl?"rtl":void 0,children:h("TerminateOldSessionHeader")}),(0,te.Y)("p",{className:"settings-item-description-larger",children:h("IfInactiveFor")}),(0,te.Y)(ee.A,{name:"session_ttl",options:y,selected:C,onChange:I})]}),D&&(0,te.Y)(gi.A,{isOpen:u,onClose:p,text:h("AreYouSureSessions"),confirmLabel:h("TerminateAllSessions"),confirmHandler:k,confirmIsDestructive:!0,areButtonsInColumn:!0}),(0,te.Y)(yh,{isOpen:A,hash:v,onClose:N})]});var M,B})),wh="YRYk96ki",Nh=(0,n.ph)((0,s.EK)((e,{hash:t})=>{const i=t?e.activeWebSessions.byHash[t]:void 0;return{session:i,bot:i?e.users.byId[i.botId]:void 0}})(({isOpen:e,session:t,bot:i,onClose:a})=>{const{terminateWebAuthorization:o}=(0,s.ko)(),r=(0,T.A)(),l=(0,Ri.A)(t,!0),c=(0,Ri.A)(i,!0),d=(0,n.hb)(()=>{o({hash:t.hash}),a()},[a,t,o]);if(l)return(0,te.FD)(X.A,{header:(0,te.FD)("div",{className:"modal-header-condensed",dir:r.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:r("Close"),onClick:a,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"modal-title",children:r("WebSessionsTitle")}),(0,te.Y)(Q.A,{color:"danger",onClick:d,className:(0,me.A)("modal-action-button","lUf0RJ2h"),children:r("AuthSessions.LogOut")})]}),isOpen:e,hasCloseButton:!0,onClose:a,className:"Wd0fmiSY",children:[(0,te.Y)(Mt.A,{className:"OhZHdRsP",peer:c,size:"large"}),c&&(0,te.Y)(qn.A,{className:"EQ7__xGn",peer:c}),(0,te.Y)("div",{className:wh,children:l?.domain}),(0,te.FD)("dl",{className:"kmCTIfvf",children:[(0,te.Y)("dt",{children:r("AuthSessions.View.Browser")}),(0,te.Y)("dd",{children:l?.browser}),(0,te.Y)("dt",{children:r("SessionPreview.Ip")}),(0,te.Y)("dd",{children:l?.ip}),(0,te.Y)("dt",{children:r("SessionPreview.Location")}),(0,te.Y)("dd",{children:l?.region})]}),(0,te.Y)("p",{className:wh,children:r("AuthSessions.View.LocationInfo")})]})})),Ih={avatar:"v0wP46TR","clear-help":"WnnxcARX",clearHelp:"WnnxcARX",subtitle:"uEUfjByC"},Ph=(0,n.ph)((0,s.EK)(e=>{const{byHash:t,orderedHashes:i}=e.activeWebSessions;return{byHash:t,orderedHashes:i}})(({isActive:e,byHash:t,orderedHashes:i,onReset:a})=>{const{terminateWebAuthorization:o,terminateAllWebAuthorizations:r}=(0,s.ko)(),l=(0,T.A)(),[c,d,h]=(0,F.A)(),[u,m]=(0,n.J0)(),[p,v,g]=(0,F.A)(),A=(0,n.hb)(e=>{o({hash:e})},[o]),f=(0,n.hb)(()=>{h(),r()},[h,r]),b=(0,n.hb)(e=>{m(e),v()},[v]),C=(0,n.hb)(()=>{m(void 0),g()},[g]);var y;if((0,n.vJ)(()=>{i.length||a()},[a,i]),(0,Ce.A)({isActive:e,onBack:a}),i.length)return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:d,children:l("AuthSessions.LogOutApplications")}),(0,te.Y)("p",{className:(0,me.A)("settings-item-description",Ih.clearHelp),children:l("ClearOtherWebSessionsHelp")})]}),(y=i,(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("WebSessionsTitle")}),y.map(function(e){const i=t[e],n=(0,s.mS)().users.byId[i.botId];return(0,te.FD)(di.A,{ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{A(i.hash)}}],onClick:()=>b(i.hash),children:[(0,te.Y)(Mt.A,{className:Ih.avatar,peer:n,size:"tiny"}),(0,te.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,te.Y)("span",{className:"date",children:(0,He.be)(l,1e3*i.dateActive)}),n&&(0,te.Y)(qn.A,{className:Ih.title,peer:n}),(0,te.FD)("span",{className:(0,me.A)("subtitle","black","tight",Ih.platform),children:[i.domain,",",i.browser,",",i.platform]}),(0,te.FD)("span",{className:(0,me.A)("subtitle",Ih.subtitle),children:[i.ip," ",i.region]})]})]},i.hash)})]})),(0,te.Y)(gi.A,{isOpen:c,onClose:h,title:l("AuthSessions.LogOutApplications"),text:l("AreYouSureWebSessions"),confirmHandler:f,confirmIsDestructive:!0}),(0,te.Y)(Nh,{isOpen:p,hash:u,onClose:C})]})})),Yh=(0,n.ph)(({stickerSet:e,noPlay:t,className:i,observeIntersection:n,onClick:s})=>{const a=(0,T.A)(),r=e?.stickers?.[0],l=(0,M.A)(()=>{r&&s(r)});if(e?.stickers)return(0,te.FD)(di.A,{className:(0,me.A)("StickerSetCard","small-icon",i),style:"height: 56px;",inactive:!r,onClick:l,children:[function(){if(e)return e.hasThumbnail||!r?(0,te.Y)(Q.A,{ariaLabel:e.title,color:"translucent",isRtl:a.isRtl,children:(0,te.Y)(Vr,{stickerSet:e,size:o.RCH,noPlay:t,observeIntersection:n})}):(0,te.Y)(Kr,{sticker:r,size:o.RCH,title:e.title,noPlay:t,observeIntersection:n,noContextMenu:!0,isCurrentUserPremium:!0,clickArg:void 0})}(),(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("div",{className:"title",children:e.title}),(0,te.Y)("div",{className:"subtitle",children:a("StickerPack.StickerCount",e.count,"i")})]})]})}),Fh=(0,n.ph)((0,s.EK)(e=>({...(0,Ci.Up)(e.settings.byKey,["shouldSuggestCustomEmoji"]),customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({isActive:e,customEmojiSetIds:t,stickerSetsById:i,shouldSuggestCustomEmoji:a,canPlayAnimatedEmojis:o,onReset:r})=>{const{openStickerSet:l,setSettingOption:c}=(0,s.ko)(),d=(0,T.A)(),h=(0,n.li)(),{observe:u}=(0,Dr.BL)({rootRef:h});(0,Ce.A)({isActive:e,onBack:r});const m=(0,n.hb)(e=>{l({stickerSetInfo:e.stickerSetInfo})},[l]),p=(0,n.hb)(e=>{c({shouldSuggestCustomEmoji:e})},[c]),v=(0,n.Kr)(()=>t&&Object.values((0,Ci.Up)(i,t)),[t,i]);return(0,te.Y)("div",{className:"settings-content custom-scroll",children:v&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(ps.A,{label:d("SuggestAnimatedEmoji"),checked:a,onCheck:p}),(0,te.Y)("div",{className:"mt-4",ref:h,children:v.map(e=>(0,te.Y)(Yh,{stickerSet:e,observeIntersection:u,onClick:m,noPlay:!o},e.id))}),(0,te.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:(0,Dt.A)(d("EmojiBotInfo"),["links"])})]})})})),Dh=(0,n.ph)((0,s.EK)(e=>(0,Ci.Up)(e.settings.byKey,["canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","autoLoadFileMaxSizeMb"]))(({isActive:e,onReset:t,canAutoLoadPhotoFromContacts:i,canAutoLoadPhotoInPrivateChats:a,canAutoLoadPhotoInGroups:r,canAutoLoadPhotoInChannels:l,canAutoLoadVideoFromContacts:c,canAutoLoadVideoInPrivateChats:d,canAutoLoadVideoInGroups:h,canAutoLoadVideoInChannels:u,canAutoLoadFileFromContacts:m,canAutoLoadFileInPrivateChats:p,canAutoLoadFileInGroups:v,canAutoLoadFileInChannels:g,autoLoadFileMaxSizeMb:A})=>{const{setSettingOption:f}=(0,s.ko)(),b=(0,Ui.A)();(0,Ce.A)({isActive:e,onBack:t});const C=(0,n.hb)(e=>b("AutodownloadSizeLimitUpTo",{limit:b("FileSizeMB",{count:o.$gx[e]})}),[b]),y=(0,n.hb)(e=>{f({autoLoadFileMaxSizeMb:o.$gx[e]})},[f]);function S(){const e=o.$gx.indexOf(A);return(0,te.Y)("div",{className:"pt-5",children:(0,te.Y)(We.A,{label:b("AutoDownloadMaxFileSize"),min:0,max:5,value:-1!==e?e:2,renderValue:C,onChange:y})})}function k(e,t,i,n,s,a){return(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:b.isRtl?"rtl":void 0,children:e}),(0,te.Y)(ps.A,{label:b("AutoDownloadSettingsContacts"),checked:i,onCheck:e=>f({[`canAutoLoad${t}FromContacts`]:e})}),(0,te.Y)(ps.A,{label:b("AutoDownloadSettingsPrivateChats"),checked:n,onCheck:e=>f({[`canAutoLoad${t}InPrivateChats`]:e})}),(0,te.Y)(ps.A,{label:b("AutoDownloadSettingsGroupChats"),checked:s,onCheck:e=>f({[`canAutoLoad${t}InGroups`]:e})}),(0,te.Y)(ps.A,{label:b("AutoDownloadSettingsChannels"),checked:a,onCheck:e=>f({[`canAutoLoad${t}InChannels`]:e})}),"File"===t&&S()]})}return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[k(b("AutoDownloadPhotosTitle"),"Photo",i,a,r,l),k(b("AutoDownloadVideosTitle"),"Video",c,d,h,u),k(b("AutoDownloadFilesTitle"),"File",m,p,v,g)]})})),Mh={root:"Ys1i4ssl",item:"skaVPMTF"},Th=["af","als","am","an","ar","arz","as","ast","av","az","azb","ba","bar","bcl","be","bg","bh","bn","bo","bpy","br","bs","bxr","ca","cbk","ce","ceb","ckb","co","cs","cv","cy","da","de","diq","dsb","dty","dv","el","eml","en","eo","es","et","eu","fa","fi","fr","frr","fy","ga","gd","gl","gn","gom","gu","gv","he","hi","hif","hr","hsb","ht","hu","hy","ia","id","ie","ilo","io","is","it","ja","jbo","jv","ka","kk","km","kn","ko","krc","ku","kv","kw","ky","la","lb","lez","li","lmo","lo","lrc","lt","lv","mai","mg","mhr","min","mk","ml","mn","mr","mrj","ms","mt","mwl","my","myv","mzn","nah","nap","nds","ne","new","nl","nn","no","oc","or","os","pa","pam","pfl","pl","pms","pnb","ps","pt","qu","rm","ro","ru","rue","sa","sah","sc","scn","sco","sd","sh","si","sk","sl","so","sq","sr","su","sv","sw","ta","te","tg","th","tk","tl","tr","tt","tyv","ug","uk","ur","uz","vec","vep","vi","vls","vo","wa","war","wuu","xal","xmf","yi","yo","yue","zh"],Bh=o.N89.filter(e=>Th.includes(e)),Rh=(0,n.ph)((0,s.EK)(e=>{const{doNotTranslate:t}=e.settings.byKey;return{doNotTranslate:t}})(({isActive:e,doNotTranslate:t,onReset:i})=>{const{setSettingOption:a}=(0,s.ko)(),o=(0,T.A)().code||"en",[r,l]=(0,n.J0)([]),[c,d]=(0,n.J0)(""),h=(0,n.Kr)(()=>{const e=Bh.map(e=>({langCode:e,translatedName:new Intl.DisplayNames([o],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})).filter(Boolean).map(({langCode:e,translatedName:t,originalName:i})=>({label:t,subLabel:i,value:e}));if(!c.trim()){const t=e.find(e=>e.value===o),i=e.filter(e=>e.value!==o);return t?[t,...i]:e}return e?.filter(e=>e.label.toLowerCase().includes(c.toLowerCase()))},[o,c]);(0,wi.A)(([i,n])=>{if(i===e&&n?.find(e=>e===o))return;const[s]=(0,Ci.jB)(h,e=>t.includes(e.value));l([...s.map(e=>e.value)])},[e,t,r.length,o,h]);const u=(0,M.A)(e=>{l(e),a({doNotTranslate:e})});return(0,Ce.A)({isActive:e,onBack:i}),(0,te.Y)("div",{className:(0,me.A)(Mh.root,"settings-content infinite-scroll"),children:(0,te.Y)("div",{className:(0,me.A)(Mh.item),children:(0,te.Y)(zo,{className:Mh.picker,items:h,selectedValues:r,onSelectedValuesChange:u,filterValue:c,onFilterChange:d,isSearchable:!0,allowMultiple:!0,withDefaultPadding:!0,itemInputType:"checkbox",searchInputId:"lang-picker-search"})})})})),Lh=(0,n.ph)(({chatId:e,usernames:t,onEditUsername:i})=>{const{showNotification:a,toggleUsername:o,toggleChatUsername:r,sortUsernames:l,sortChatUsernames:c}=(0,s.ko)(),d=(0,T.A)(),[h,u]=(0,n.J0)(),m=(0,n.Kr)(()=>t.map(({username:e})=>e),[t]),p=(0,_.A)(m),[v,g]=(0,n.J0)({orderedUsernames:m,dragOrderUsernames:m,draggedIndex:void 0});(0,n.vJ)(()=>{p!==m&&g({orderedUsernames:m,dragOrderUsernames:m,draggedIndex:void 0})},[p,m]);const A=(0,n.hb)(e=>{(0,Rc.eM)(`@${e}`),a({message:d("UsernameCopied")})},[d,a]),f=(0,n.hb)(e=>{e.isEditable?i(e.username):u(e)},[i]),b=(0,n.hb)(()=>{u(void 0)},[]),C=(0,n.hb)(()=>{h&&(e?r({chatId:e,username:h.username,isActive:!h.isActive}):o({username:h.username,isActive:!h.isActive}),b())},[e,b,r,o,h]),y=(0,n.hb)((e,t)=>{const i=Math.round(e.y/56),n=v.orderedUsernames?.indexOf(t)||0,s=v.orderedUsernames?.filter(e=>e!==t);s&&(0,ve.Bt)(n+i,0,m.length)&&(s.splice(n+i,0,t),g(e=>({...e,draggedIndex:n,dragOrderUsernames:s})))},[v.orderedUsernames,m.length]),S=(0,n.hb)(()=>{g(t=>(e?c({chatId:e,usernames:t.dragOrderUsernames}):l({usernames:t.dragOrderUsernames}),{...t,orderedUsernames:t.dragOrderUsernames,draggedIndex:void 0}))},[e,c,l]);return(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"PaO1MMi5",children:[(0,te.Y)("h4",{className:"wSswdVkR",dir:d.isRtl?"rtl":void 0,children:d("lng_usernames_subtitle")}),(0,te.Y)("div",{className:"lAeeBh9K",style:`height: ${56*t.length}px`,children:t.map((e,t)=>{const i=v.draggedIndex===t,n=56*(v.orderedUsernames?.indexOf(e.username)??0),s=56*(v.dragOrderUsernames?.indexOf(e.username)??0),a=e.isEditable?"lng_usernames_edit":e.isActive?"lng_usernames_active":"lng_usernames_non_active";return(0,te.Y)(qd.A,{id:e.username,onDrag:y,onDragEnd:S,style:`top: ${i?n:s}px;`,knobStyle:(d.isRtl?"left":"right")+": 3rem;",isDisabled:!e.isActive,children:(0,te.FD)(di.A,{className:(0,me.A)("drag-item no-icon","l04OwRBg"),narrow:!0,secondaryIcon:"more",icon:e.isActive?"link":"link-broken",multiline:!0,contextActions:[{handler:()=>{A(e.username)},title:d("Copy"),icon:"copy"}],onClick:()=>{f(e)},children:[(0,te.FD)("span",{className:"title",children:["@",e.username]}),(0,te.Y)("span",{className:"subtitle",children:d(a)})]},e.username)},e.username)})}),(0,te.Y)("p",{className:"oiJc22Aj",dir:d.isRtl?"rtl":void 0,children:d("lng_usernames_description")})]}),(0,te.Y)(gi.A,{isOpen:Boolean(h),onClose:b,title:d(h?.isActive?"Username.DeactivateAlertTitle":"Username.ActivateAlertTitle"),text:d(h?.isActive?"Username.DeactivateAlertText":"Username.ActivateAlertText"),confirmLabel:d(h?.isActive?"Username.DeactivateAlertHide":"Username.ActivateAlertShow"),confirmHandler:C,confirmIsDestructive:!h?.isActive})]})});var xh=i(11116);const Eh=/https:\/\/t\.me\/?/i,Vh=(0,ge.sg)(e=>e(),250,!1),_h=(0,n.ph)(({currentUsername:e,asLink:t,isLoading:i,isUsernameAvailable:a,checkedUsername:r,onChange:l})=>{const{checkUsername:c,checkPublicLink:d}=(0,s.ko)(),[h,u]=(0,n.J0)(e||""),m=(0,T.A)(),p=t?"SetUrl":"Username",v=m(t?"SetUrlPlaceholder":"Username"),g=(0,_.A)(a),A=e!==h?a??g:void 0,f=h&&e!==h&&r!==h,[b,C]=(0,n.Kr)(()=>h.length?h.length<xh.tX?[void 0,m(`${p}InvalidShort`)]:h.length>xh.Tk?[void 0,m(`${p}InvalidLong`)]:xh.Ny.test(h)?void 0===A||f?[]:[A?m(`${p}Available`,v):void 0,!1===A?m(`${p}InUse`):void 0]:[void 0,m(`${p}Invalid`)]:[],[h,A,f,m,p,v]);(0,n.vJ)(()=>{u(e||"")},[t,e]);const y=(0,n.hb)(i=>{const n=i.target.value.trim();if(t&&!n.match(Eh))return void(n.length||(u(""),l?.("")));const s=n.replace(Eh,"");u(s),(""===s||(0,xh.BU)(s,!0))&&(l?.(s),Vh(()=>{s!==e&&(t?d:c)({username:s})}))},[t,d,c,e,l]);return(0,te.Y)(Z.A,{value:`${t?o.jsp:""}${h}`,onChange:y,label:f?m("Checking"):v,error:C,success:b,readOnly:i,teactExperimentControlled:!0})});var Uh=i(43434);const Oh=(0,ge.nF)(e=>e(),6e4,!0),Kh="Please provide your first name",Jh=(0,n.ph)((0,s.EK)(e=>{const{currentUserId:t}=e,{progress:i,isUsernameAvailable:n,checkedUsername:s,error:a}=(0,c.nTw)(e).profileEdit||{},o=t?(0,c.mBe)(e,t):void 0,r=(0,Sa.d)(e,"aboutLength"),{firstName:d,lastName:h,usernames:u}=o||{},m=t?(0,c.vGo)(e,t):void 0;return{currentAvatarHash:o&&(0,l.cP)(o),currentFirstName:d,currentLastName:h,currentBio:m?.bio,progress:i,isUsernameAvailable:n,checkedUsername:s,editUsernameError:a,maxBioLength:r,usernames:u}})(({isActive:e,currentAvatarHash:t,currentFirstName:i,currentLastName:r,currentBio:l,progress:c,checkedUsername:d,editUsernameError:h,isUsernameAvailable:u,maxBioLength:m,usernames:p,onReset:v})=>{const{loadCurrentUser:g,updateProfile:A}=(0,s.ko)(),f=(0,T.A)(),b=(0,n.Kr)(()=>p?.find(({isEditable:e})=>e),[p]),C=b?.username||"",[y,S]=(0,n.J0)(!1),[k,w]=(0,n.J0)(!1),[N,I]=(0,n.J0)(),[P,Y]=(0,n.J0)(),[F,D]=(0,n.J0)(i||""),[M,B]=(0,n.J0)(r||""),[R,L]=(0,n.J0)(l||""),[x,E]=(0,n.J0)(C),V=(0,z.A)(t,!1,O.qZ.BlobUrl),U=c===a.DV.InProgress,K=!1===x,J=(0,_.A)(u),G=u??J,j=p&&p.length>1,H=(0,n.Kr)(()=>!K&&(Boolean(P)||k||y&&!0===G),[K,P,k,y,G]);(0,Ce.A)({isActive:e,onBack:v}),(0,n.vJ)(()=>{Oh(()=>{g()})},[g]),(0,n.vJ)(()=>{Y(void 0)},[V]),(0,n.vJ)(()=>{D(i||""),B(r||""),L(l||"")},[i,r,l]),(0,n.vJ)(()=>{E(C||"")},[C]),(0,n.vJ)(()=>{c===a.DV.Complete&&(w(!1),S(!1),I(void 0))},[c]);const $=(0,n.hb)(e=>{Y(e)},[]),q=(0,n.hb)(e=>{D(e.target.value),w(!0)},[]),Q=(0,n.hb)(e=>{B(e.target.value),w(!0)},[]),X=(0,n.hb)(e=>{L(e.target.value),w(!0)},[]),ee=(0,n.hb)(e=>{E(e),S(C!==e)},[C]),ie=(0,n.hb)(()=>{const e=F.trim(),t=M.trim(),i=R.trim();x&&(e.length?A({photo:P,...k&&{firstName:e,lastName:t,bio:i},...y&&{username:x}}):I(Kh))},[P,F,M,R,k,x,y,A]);return(0,te.FD)("div",{className:"settings-fab-wrapper",children:[(0,te.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.FD)("div",{className:"settings-input",children:[(0,te.Y)(Uh.A,{currentAvatarBlobUrl:V,onChange:$,title:"Edit your profile photo",disabled:U}),(0,te.Y)(Z.A,{value:F,onChange:q,label:f("FirstName"),disabled:U,error:N===Kh?N:void 0}),(0,te.Y)(Z.A,{value:M,onChange:Q,label:f("LastName"),disabled:U}),(0,te.Y)(Ql.A,{value:R,onChange:X,label:f("UserBio"),disabled:U,maxLength:m,maxLengthIndicator:m?(m-R.length).toString():void 0})]}),(0,te.Y)("p",{className:"settings-item-description",dir:f.isRtl?"rtl":void 0,children:(0,Dt.A)(f("lng_settings_about_bio"),["br","simple_markdown"])})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:f.isRtl?"rtl":void 0,children:f("Username")}),(0,te.Y)("div",{className:"settings-input",children:(0,te.Y)(_h,{currentUsername:C,isLoading:U,isUsernameAvailable:u,checkedUsername:d,onChange:ee})}),h===o.Y3M&&function(){const e=`${o.jsp}${o.NjX}`;return(0,te.Y)("p",{className:"settings-item-description",dir:f.isRtl?"rtl":void 0,children:f("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map(t=>"PURCHASE_LINK"===t?(0,te.Y)(Ll.A,{url:e,text:`@${o.NjX}`}):t)})}(),(0,te.Y)("p",{className:"settings-item-description",dir:f.isRtl?"rtl":void 0,children:(0,Dt.A)(f("UsernameHelp"),["br","simple_markdown"])}),x&&(0,te.FD)("p",{className:"settings-item-description",dir:f.isRtl?"rtl":void 0,children:[f("lng_username_link"),(0,te.Y)("br",{}),(0,te.FD)("span",{className:"username-link",children:[o.jsp,x]})]})]}),j&&(0,te.Y)(Lh,{usernames:p,onEditUsername:E})]}),(0,te.Y)(Ni.A,{isShown:H,onClick:ie,disabled:U,ariaLabel:f("Save"),children:U?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})}));var Gh=i(61182),jh=i(4350),zh=i(93855),Hh=i(15006);const $h=(0,n.ph)((0,s.EK)(e=>{const{shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:n,shouldDebugExportedSenders:s}=(0,Is.l)(e);return{shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:n,shouldDebugExportedSenders:s}})(({isActive:e,shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:a,shouldDebugExportedSenders:r,onReset:l})=>{const{requestConfetti:c,setSharedSettingOption:d,requestWave:h}=(0,s.ko)(),m=(0,n.li)(),[p,v]=(0,n.J0)(!1),g=(0,T.A)(),A=(0,zh.A)();(0,Ce.A)({isActive:e,onBack:l});const f=(0,M.A)(()=>{const e=new File([(0,Gh.F8)()],o.lFE,{type:"text/plain"}),t=URL.createObjectURL(e);(0,xi.A)(t,o.lFE)}),b=(0,M.A)(e=>{h({startX:e.clientX,startY:e.clientY})}),C=(0,M.A)(()=>{c({withStars:!0})}),y=(0,M.A)(()=>{const e=m.current;e&&(0,Hh.U)(e)&&(v(!0),setTimeout(()=>{v(!1)},1500))}),S=(0,n.Kr)(()=>{if(!Object.values(A).length)return;let e=1;for(;A[e];)e+=1;return(0,jh.Nv)(e,!0,!0)},[A]);return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Experimental,size:200,className:"experimental-duck",nonInteractive:!0,noLoop:!1}),(0,te.Y)("p",{className:"settings-item-description pt-3",dir:"auto",children:g("lng_settings_experimental_about")})]}),(0,te.Y)("div",{className:"settings-item",children:(0,te.Y)(di.A,{href:S,icon:"add-user",children:(0,te.Y)("div",{className:"title",children:"Login on Test Server"})})}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{onClick:C,icon:"animations",children:(0,te.Y)("div",{className:"title",children:"Launch some confetti!"})}),(0,te.Y)(di.A,{onClick:b,icon:"story-expired",disabled:!u.J6,children:(0,te.Y)("div",{className:"title",children:"Start wave"})}),(0,te.Y)(di.A,{ref:m,onClick:y,icon:"spoiler",disabled:!u.bW,style:p?"visibility: hidden":"",children:(0,te.Y)("div",{className:"title",children:"Vaporize this button"})})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(ps.A,{label:"Allow HTTP Transport",checked:Boolean(i),onCheck:()=>d({shouldAllowHttpTransport:!i})}),(0,te.Y)(ps.A,{label:"Force HTTP Transport",disabled:!i,checked:Boolean(t),onCheck:()=>d({shouldForceHttpTransport:!t})})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(ps.A,{label:g("DebugMenuEnableLogs"),checked:Boolean(a),onCheck:()=>d({shouldCollectDebugLogs:!a})}),(0,te.Y)(ps.A,{label:"Enable exported senders debug",checked:Boolean(r),onCheck:()=>d({shouldDebugExportedSenders:!r})}),(0,te.Y)(di.A,{onClick:f,icon:"bug",children:(0,te.Y)("div",{className:"title",children:"Download log"})})]})]})}));var qh=i(6e4),Wh=i(84382);const Qh=(0,n.ph)((0,s.EK)(e=>{const{theme:t,shouldUseSystemTheme:i,messageSendKeyCombo:n,messageTextSize:s,timeFormat:a}=(0,Is.l)(e);return{messageSendKeyCombo:n,messageTextSize:s,timeFormat:a,theme:t,shouldUseSystemTheme:i}})(({isActive:e,messageTextSize:t,messageSendKeyCombo:i,timeFormat:o,theme:r,shouldUseSystemTheme:l,onReset:c})=>{const{setSharedSettingOption:d,openSettingsScreen:h}=(0,s.ko)(),m=(0,Ui.A)(),{isMobile:p}=(0,Y.Ay)(),v=p&&(u.pz||u.Ni),g=[{label:m("SettingsTimeFormat12"),value:"12h"},{label:m("SettingsTimeFormat24"),value:"24h"}],A=[{label:m("EmptyChatAppearanceLight"),value:"light"},{label:m("EmptyChatAppearanceDark"),value:"dark"},{label:m("EmptyChatAppearanceSystem"),value:"auto"}],f=v?void 0:[{value:"enter",label:m("SettingsSendEnter"),subLabel:m("SettingsSendEnterDescription")},{value:"ctrl-enter",label:m(u.MP||u.pz?"SettingsSendCmdenter":"SettingsSendCtrlenter"),subLabel:m("SettingsSendPlusEnterDescription")}],b=(0,n.hb)(e=>{document.documentElement.style.setProperty("--composer-text-size",`${Math.max(e,u.pz?16:15)}px`),document.documentElement.style.setProperty("--message-meta-height",`${Math.floor(1.3125*e)}px`),document.documentElement.style.setProperty("--message-text-size",`${e}px`),document.documentElement.setAttribute("data-message-text-size",e.toString()),d({messageTextSize:e})},[]),C=(0,n.hb)(e=>{const t="auto"===e?(0,Wh.V)():e;d({theme:t}),d({shouldUseSystemTheme:"auto"===e})},[]),y=(0,n.hb)(e=>{d({timeFormat:e}),d({wasTimeFormatSetManually:!0}),(0,qh.bV)(e)},[]),S=(0,n.hb)(e=>{d({messageSendKeyCombo:e})},[]);return(0,Ce.A)({isActive:e,onBack:c}),(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("Settings")}),(0,te.Y)(We.A,{label:m("TextSize"),min:12,max:20,value:t,onChange:b}),(0,te.Y)(di.A,{icon:"photo",narrow:!0,onClick:()=>h({screen:a.VS.GeneralChatBackground}),children:m("ChatBackground")})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("Theme")}),(0,te.Y)(ee.A,{name:"theme",options:A,selected:l?"auto":r,onChange:C})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("SettingsTimeFormat")}),(0,te.Y)(ee.A,{name:"timeformat",options:g,selected:o,onChange:y})]}),f&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("SettingsKeyboard")}),(0,te.Y)(ee.A,{name:"keyboard-send-settings",options:f,onChange:S,selected:i})]})]})}));var Zh=i(52844),Xh=i(74824);const eu=(0,n.ph)(({wallpaper:e,theme:t,isSelected:i,onClick:s})=>{const{slug:r,document:l}=e,c=`wallpaper${l.id}`,d=l.previewBlobUrl,h=(0,z.A)(`${c}?size=m`),u=(0,_i.A)(l.thumbnail?.dataUri,Boolean(h),!0),{transitionClassNames:m}=(0,Ke.A)(Boolean(h||d),void 0,void 0,"slow"),p=(0,n.li)(!1),[v,g]=(0,n.J0)(!1),{mediaData:A,loadProgress:f}=(0,H.A)(c,!v),b=!1===(0,_.A)(v),{shouldRender:C,transitionClassNames:y}=(0,Ke.A)(v&&!A||r===a.Vw,void 0,b,"slow"),S=(0,n.li)();S.current=t;const k=(0,n.hb)(()=>{(async()=>{const e=await(0,J.sZ)(A);await Xh.save(o.nfi,S.current,e),s(r)})()},[A,s,r]);(0,n.vJ)(()=>{A&&p.current&&(k(),p.current=!1)},[A,k]);const w=(0,n.hb)(()=>{A?k():(p.current=!0,g(e=>!e))},[A,k]),N=(0,me.A)("WallpaperTile",i&&"selected");return(0,te.Y)("div",{className:N,onClick:w,children:(0,te.FD)("div",{className:"media-inner",children:[(0,te.Y)("canvas",{ref:u,className:"thumbnail"}),(0,te.Y)("img",{src:h||d,className:(0,me.A)("full-media",m),alt:"",draggable:!1}),C&&(0,te.Y)("div",{className:(0,me.A)("spinner-container",y),children:(0,te.Y)(he.A,{progress:f,onClick:w})})]})})}),tu=(0,ge.nF)(e=>e(),6e4,!0),iu=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.SJA)(e),{background:i,isBlurred:n}=(0,c.Gyz)(e,t)||{},{loadedWallpapers:s}=e.settings;return{background:i,isBlurred:n,loadedWallpapers:s,theme:t}})(({isActive:e,onReset:t,background:i,isBlurred:r,loadedWallpapers:l,theme:c})=>{const{loadWallpapers:d,uploadWallpaper:h,setThemeSettings:u,openSettingsScreen:m}=(0,s.ko)(),p=(0,n.li)();p.current=c,(0,n.vJ)(()=>{tu(()=>{d()})},[d]);const v=(0,n.hb)(e=>{const{files:t}=e.target,i=(0,J.kc)(t);i?.length&&h(i[0])},[h]),g=(0,n.hb)(()=>{(0,Zh.p)("image/jpeg",v,!0)},[v]),A=(0,n.hb)(()=>{m({screen:a.VS.GeneralChatBackgroundColor})},[]),f=(0,n.hb)(()=>{u({theme:c,background:void 0,backgroundColor:void 0,isBlurred:!0,patternColor:"dark"===c?o.MkD:o.be8})},[u,c]),b=(0,n.hb)(e=>{u({theme:p.current,background:e});const t=l&&l.find(t=>t.slug===e);t?.document.thumbnail&&(0,Ps.rX)(t.document.thumbnail.dataUri).then(e=>{const t=(0,Ps.Yi)(e),i=`#${(0,Ps.v2)(e)}`;u({theme:p.current,backgroundColor:i,patternColor:t})})},[l,u]),C=(0,n.hb)(e=>{u({theme:p.current,isBlurred:e.target.checked})},[u]),y=(0,T.A)();(0,Ce.A)({isActive:e,onBack:t});const S=l?.[0]&&l[0].slug===a.Vw;return(0,te.FD)("div",{className:"SettingsGeneralBackground settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{icon:"camera-add",className:"mb-0",disabled:S,onClick:g,children:y("UploadImage")}),(0,te.Y)(di.A,{icon:"colorize",className:"mb-0",onClick:A,children:y("SetColor")}),(0,te.Y)(di.A,{icon:"favorite",onClick:f,children:y("ThemeResetToDefaults")}),(0,te.Y)(ps.A,{label:y("BackgroundBlurred"),checked:Boolean(r),onChange:C})]}),l?(0,te.Y)("div",{className:"settings-wallpapers",children:l.map(e=>(0,te.Y)(eu,{wallpaper:e,theme:c,isSelected:i===e.slug,onClick:b},e.slug))}):(0,te.Y)($n.A,{})]})})),nu=(0,Ps.bM)((0,Ps.xp)("e6ebee")),su=["#e6ebee","#b2cee1","#008dd0","#c6e7cb","#c4e1a6","#60b16e","#ccd0af","#a6a997","#7a7072","#fdd7af","#fdb76e","#dd8851"];function au(e,t){return{colorPosition:[Math.round(e[1]*(t.colorRect.width-1)),Math.round((1-e[2])*(t.colorRect.height-1))],huePosition:Math.round(e[0]*(t.hueRect.width-1))}}function ou({colorPosition:e,huePosition:t},i){return[t/(i.hueRect.width-1),e[0]/(i.colorRect.width-1),1-e[1]/(i.colorRect.height-1)]}const ru=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.SJA)(e),{backgroundColor:i}=(0,c.Gyz)(e,t)||{};return{backgroundColor:i,theme:t}})(({isActive:e,onReset:t,theme:i,backgroundColor:a})=>{const{setThemeSettings:o}=(0,s.ko)(),r=(0,n.li)();r.current=i;const l=(0,n.li)(),c=(0,n.li)(),d=(0,n.li)(),h=(0,n.li)(!0),[u,m]=(0,n.J0)(function(e){return e&&e.startsWith("#")?(0,Ps.bM)((0,Ps.xp)(e.replace("#",""))):nu}(a)),p=(0,n.li)(u);(0,n.vJ)(()=>{p.current=u},[u]);const[v,g,A]=(0,F.A)(),[f,b]=(0,n.J0)(""),[C,y]=(0,n.J0)(""),S=(0,n.li)(),k=(0,n.li)();(0,n.vJ)(()=>{const e={offsetLeft:c.current.offsetLeft,...(0,Ci.Up)(c.current.getBoundingClientRect(),["top","width","height"])},t={offsetLeft:d.current.offsetLeft,...(0,Ci.Up)(d.current.getBoundingClientRect(),["width"])};function i(t){const i=[Math.min(Math.max(0,t.pageX-e.offsetLeft),e.width-1),Math.min(Math.max(0,t.pageY-e.top+l.current.scrollTop),e.height-1)],{huePosition:n}=au(p.current,S.current);return m(ou({colorPosition:i,huePosition:n},S.current)),g(),!0}function n(e){const{colorPosition:i}=au(p.current,S.current),n=Math.min(Math.max(0,e.pageX-t.offsetLeft),t.width-1);return m(ou({colorPosition:i,huePosition:n},S.current)),g(),!0}S.current={colorRect:e,hueRect:t},(0,pe.wJ)(c.current,{onCapture:i,onDrag:i,onRelease:A,onClick:A,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0}),(0,pe.wJ)(d.current,{onCapture:n,onDrag:n,onRelease:A,onClick:A,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0})},[g,A]);const{colorPosition:w=[0,0],huePosition:N=0}=S.current?au(u,S.current):{},I=(0,Ps.v2)((0,Ps.Zf)(u)),P=u[0],Y=(0,Ps.v2)((0,Ps.Zf)([P,1,1]));(0,n.vJ)(()=>{const e=(0,Ps.Zf)(u),t=`#${(0,Ps.v2)(e)}`;if(b(e.join(", ")),y(t),!h.current){const i=(0,Ps.Yi)(e);o({theme:r.current,background:void 0,backgroundColor:t,patternColor:i})}h.current=!1},[u,o]),(0,n.vJ)(()=>{!function(e,t,i,n){let s,a,o;i.current&&n.current?(s=n.current.colorRect.width,a=n.current.colorRect.height,o=i.current):(s=e.offsetWidth,a=e.offsetHeight,o=e.getContext("2d"),e.width=s,e.height=a,i.current=o);const r=o.createImageData(s,a),l=r.data,c=(0,Ps.Zf)([t,1,1]);let d=0;for(let e=0;e<a;e++){const t=1-e/(a-1),i=[255*t,255*t,255*t],n=[c[0]*t,c[1]*t,c[2]*t];for(let e=0;e<s;e++){const t=e/(s-1);l[d++]=i[0]+(n[0]-i[0])*t,l[d++]=i[1]+(n[1]-i[1])*t,l[d++]=i[2]+(n[2]-i[2])*t,l[d++]=255}}o.putImageData(r,0,0)}(c.current.firstChild,P,k,S)},[P]),(0,n.vJ)(()=>{!function(e){const t=e.offsetWidth;e.width=t,e.height=1;const i=e.getContext("2d"),n=i.createImageData(t,1),s=n.data;let a=0;for(let e=0;e<t;e++){const i=e/(t-1),n=(0,Ps.Zf)([i,1,1]);s[a++]=n[0],s[a++]=n[1],s[a++]=n[2],s[a++]=255}i.putImageData(n,0,0)}(d.current.firstChild)},[]);const D=(0,n.hb)(e=>{const t=e.currentTarget.value.replace(/[^\d, ]/g,"").slice(0,13);if(t.match(/^\d{1,3},\s?\d{1,3},\s?\d{1,3}$/)){const e=t.split(",").map(e=>Number(e.trim()));m((0,Ps.bM)(e))}e.currentTarget.value=t},[]),M=(0,n.hb)(e=>{const t=e.currentTarget.value.replace(/[^0-9a-fA-F]/g,"").slice(0,6);t.match(/^#?[0-9a-fA-F]{6}$/)&&m((0,Ps.bM)((0,Ps.xp)(t.replace("#","")))),e.currentTarget.value=t},[]),T=(0,n.hb)(e=>{m((0,Ps.bM)((0,Ps.xp)(e.currentTarget.dataset.color.replace("#",""))))},[]),B=(0,me.A)("SettingsGeneralBackgroundColor settings-content custom-scroll",v&&"is-dragging");return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{ref:l,className:B,children:[(0,te.FD)("div",{className:"settings-item pt-3",children:[(0,te.FD)("div",{ref:c,className:"color-picker",children:[(0,te.Y)("canvas",{}),(0,te.Y)("div",{className:"handle",style:`transform: translate(${w[0]}px, ${w[1]}px); background-color: #${I};`})]}),(0,te.FD)("div",{ref:d,className:"hue-picker",children:[(0,te.Y)("canvas",{}),(0,te.Y)("div",{className:"handle",style:`transform: translateX(${N}px); background-color: #${Y};`})]}),(0,te.FD)("div",{className:"tools",children:[(0,te.Y)(Z.A,{value:C,label:"HEX",onChange:M}),(0,te.Y)(Z.A,{value:f,label:"RGB",onChange:D})]})]}),(0,te.Y)("div",{className:"predefined-colors",children:su.map(e=>(0,te.Y)("div",{className:(0,me.A)("predefined-color",e===`#${I}`?"active":void 0),"data-color":e,style:`background-color: ${e};`,onClick:T}))})]})})),lu=(0,n.ph)(({currentScreen:e,editedFolderId:t,onReset:i})=>{const{signOut:o,openDeleteChatFolderModal:r,openSettingsScreen:l}=(0,s.ko)(),{isMobile:c}=(0,Y.Ay)(),[d,h]=(0,n.J0)(!1),u=function(e,t){const i=(0,n.li)(0),s=(0,n.li)();return(0,n.hb)(()=>{if(i.current++,5===i.current)return i.current=0,void t();s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{i.current=0},300)},[5,t])}(0,()=>{l({screen:a.VS.Experimental})}),m=(0,n.hb)(()=>{h(!0)},[]),p=(0,n.hb)(()=>{h(!1)},[]),v=(0,n.hb)(()=>{t&&r({folderId:t})},[t,r]),g=(0,n.hb)(()=>{p(),o({forceInitApi:!0})},[p,o]),A=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.Y)(Q.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",children:(0,te.Y)(W.A,{name:"more"})}),[c]),f=(0,T.A)(),b=(0,Ui.A)();return(0,te.FD)("div",{className:"left-header",children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:i,ariaLabel:f("AccDescrGoBack"),children:(0,te.Y)(W.A,{name:"arrow-left"})}),function(){switch(e){case a.VS.EditProfile:return(0,te.Y)("h3",{children:f("lng_settings_information")});case a.VS.General:return(0,te.Y)("h3",{children:f("General")});case a.VS.QuickReaction:return(0,te.Y)("h3",{children:f("DoubleTapSetting")});case a.VS.CustomEmoji:return(0,te.Y)("h3",{children:f("Emoji")});case a.VS.Notifications:return(0,te.Y)("h3",{children:f("Notifications")});case a.VS.DataStorage:return(0,te.Y)("h3",{children:f("DataSettings")});case a.VS.Privacy:return(0,te.Y)("h3",{children:f("PrivacySettings")});case a.VS.Language:return(0,te.Y)("h3",{children:f("Language")});case a.VS.DoNotTranslate:return(0,te.Y)("h3",{children:f("DoNotTranslate")});case a.VS.Stickers:return(0,te.Y)("h3",{children:f("StickersName")});case a.VS.Experimental:return(0,te.Y)("h3",{children:f("lng_settings_experimental")});case a.VS.GeneralChatBackground:return(0,te.Y)("h3",{children:f("ChatBackground")});case a.VS.GeneralChatBackgroundColor:return(0,te.Y)("h3",{children:f("SetColor")});case a.VS.PrivacyPhoneNumber:return(0,te.Y)("h3",{children:f("PrivacyPhone")});case a.VS.PrivacyLastSeen:return(0,te.Y)("h3",{children:f("PrivacyLastSeen")});case a.VS.PrivacyProfilePhoto:return(0,te.Y)("h3",{children:f("Privacy.ProfilePhoto")});case a.VS.PrivacyBio:return(0,te.Y)("h3",{children:f("PrivacyBio")});case a.VS.PrivacyBirthday:return(0,te.Y)("h3",{children:f("PrivacyBirthday")});case a.VS.PrivacyGifts:return(0,te.Y)("h3",{children:b("PrivacyGifts")});case a.VS.PrivacyForwarding:return(0,te.Y)("h3",{children:f("PrivacyForwards")});case a.VS.PrivacyVoiceMessages:return(0,te.Y)("h3",{children:f("PrivacyVoiceMessages")});case a.VS.PrivacyMessages:return(0,te.Y)("h3",{children:f("PrivacyMessages")});case a.VS.PrivacyGroupChats:return(0,te.Y)("h3",{children:f("AutodownloadGroupChats")});case a.VS.PrivacyPhoneCall:return(0,te.Y)("h3",{children:f("Calls")});case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyGroupChatsAllowedContacts:return(0,te.Y)("h3",{children:f("AlwaysShareWith")});case a.VS.PrivacyLastSeenDeniedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:case a.VS.PrivacyBioDeniedContacts:case a.VS.PrivacyGroupChatsDeniedContacts:return(0,te.Y)("h3",{children:f("NeverShareWith")});case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneP2PAllowedContacts:return(0,te.Y)("h3",{children:f("AlwaysAllow")});case a.VS.PrivacyPhoneNumberDeniedContacts:case a.VS.PrivacyBirthdayDeniedContacts:case a.VS.PrivacyGiftsDeniedContacts:case a.VS.PrivacyForwardingDeniedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:return(0,te.Y)("h3",{children:f("NeverAllow")});case a.VS.PrivacyNoPaidMessages:return(0,te.Y)("h3",{children:b("RemoveFeeTitle")});case a.VS.Performance:return(0,te.Y)("h3",{children:b("MenuAnimations")});case a.VS.ActiveSessions:return(0,te.Y)("h3",{children:f("SessionsTitle")});case a.VS.ActiveWebsites:return(0,te.Y)("h3",{children:f("OtherWebSessions")});case a.VS.PrivacyBlockedUsers:return(0,te.Y)("h3",{children:f("BlockedUsers")});case a.VS.TwoFaDisabled:case a.VS.TwoFaEnabled:return(0,te.Y)("h3",{children:f("TwoStepVerification")});case a.VS.TwoFaNewPassword:case a.VS.TwoFaChangePasswordNew:case a.VS.TwoFaChangePasswordConfirm:return(0,te.Y)("h3",{children:f("PleaseEnterCurrentPassword")});case a.VS.TwoFaNewPasswordConfirm:return(0,te.Y)("h3",{children:f("PleaseReEnterPassword")});case a.VS.TwoFaNewPasswordHint:case a.VS.TwoFaChangePasswordHint:return(0,te.Y)("h3",{children:f("PasswordHint")});case a.VS.TwoFaNewPasswordEmail:case a.VS.TwoFaRecoveryEmail:return(0,te.Y)("h3",{children:f("RecoveryEmailTitle")});case a.VS.TwoFaNewPasswordEmailCode:case a.VS.TwoFaRecoveryEmailCode:return(0,te.Y)("h3",{children:"Recovery Email Code"});case a.VS.TwoFaCongratulations:return(0,te.Y)("h3",{children:f("TwoStepVerificationPasswordSet")});case a.VS.TwoFaChangePasswordCurrent:case a.VS.TwoFaTurnOff:case a.VS.TwoFaRecoveryEmailCurrentPassword:return(0,te.Y)("h3",{children:f("PleaseEnterCurrentPassword")});case a.VS.PasscodeDisabled:case a.VS.PasscodeEnabled:case a.VS.PasscodeNewPasscode:case a.VS.PasscodeNewPasscodeConfirm:case a.VS.PasscodeCongratulations:return(0,te.Y)("h3",{children:f("Passcode")});case a.VS.PasscodeTurnOff:return(0,te.Y)("h3",{children:f("PasscodeController.Disable.Title")});case a.VS.PasscodeChangePasscodeCurrent:case a.VS.PasscodeChangePasscodeNew:return(0,te.Y)("h3",{children:f("PasscodeController.Change.Title")});case a.VS.PasscodeChangePasscodeConfirm:return(0,te.Y)("h3",{children:f("PasscodeController.ReEnterPasscode.Placeholder")});case a.VS.Folders:return(0,te.Y)("h3",{children:f("Filters")});case a.VS.FoldersCreateFolder:return(0,te.Y)("h3",{children:f("FilterNew")});case a.VS.FoldersShare:return(0,te.Y)("h3",{children:f("FolderLinkScreen.Title")});case a.VS.FoldersEditFolder:case a.VS.FoldersEditFolderFromChatList:case a.VS.FoldersEditFolderInvites:return(0,te.FD)("div",{className:"settings-main-header",children:[(0,te.Y)("h3",{children:f("FilterEdit")}),Boolean(t)&&(0,te.Y)(ce.A,{className:"settings-more-menu",trigger:A,positionX:"right",children:(0,te.Y)(de.A,{icon:"delete",destructive:!0,onClick:v,children:f("Delete")})})]});case a.VS.FoldersIncludedChats:case a.VS.FoldersIncludedChatsFromChatList:case a.VS.FoldersExcludedChats:case a.VS.FoldersExcludedChatsFromChatList:return(0,te.Y)("h3",{children:f(e===a.VS.FoldersIncludedChats||e===a.VS.FoldersIncludedChatsFromChatList?"FilterInclude":"FilterExclude")});default:return(0,te.FD)("div",{className:"settings-main-header",children:[(0,te.Y)("h3",{onClick:u,children:f("SETTINGS")}),(0,te.Y)(Q.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",onClick:()=>l({screen:a.VS.EditProfile}),ariaLabel:f("lng_settings_information"),children:(0,te.Y)(W.A,{name:"edit"})}),(0,te.Y)(ce.A,{className:"settings-more-menu",trigger:A,positionX:"right",children:(0,te.Y)(de.A,{icon:"logout",onClick:m,children:f("LogOutTitle")})})]})}}(),(0,te.Y)(gi.A,{isOpen:d,onClose:p,text:f("lng_sure_logout"),confirmLabel:f("AccountSettings.Logout"),confirmHandler:g,confirmIsDestructive:!0})]})}),cu=(0,n.ph)((0,s.EK)(e=>{const{canTranslate:t,canTranslateChats:i,doNotTranslate:n}=e.settings.byKey,{language:s,languages:a}=(0,Is.l)(e);return{isCurrentUserPremium:(0,c.g29)(e),languages:a,language:s,canTranslate:t,canTranslateChats:i,doNotTranslate:n}})(({isActive:e,isCurrentUserPremium:t,languages:i,language:o,canTranslate:r,canTranslateChats:l,doNotTranslate:c,onReset:d})=>{const{loadLanguages:h,setSettingOption:m,setSharedSettingOption:p,openPremiumModal:v,openSettingsScreen:g}=(0,s.ko)(),[A,f]=(0,n.J0)(o),[b,C,y]=(0,F.A)(),S=t&&l,k=(0,T.A)();(0,n.vJ)(()=>{i?.length||h()},[i]);const w=(0,M.A)(e=>{f(e),C(),(0,qh.wT)(e,()=>{y(),p({language:e})})}),N=(0,n.Kr)(()=>{if(!i)return;const e=(window.navigator.language||"en").toLowerCase(),t=e.substr(0,2);return i.map(({langCode:e,nativeName:t,name:i})=>({value:e,label:t,subLabel:i,isLoading:e===A&&b})).sort(i=>!e||i.value!==e&&i.value!==t?0:-1)},[b,i,A]),I=(0,M.A)(e=>{m({canTranslate:e})}),P=(0,M.A)(e=>{m({canTranslateChats:e})}),Y=(0,M.A)(()=>{t||v({initialSection:"translations"})}),D=(0,n.Kr)(()=>{if(u.CM&&c.length)return 1===c.length?new Intl.DisplayNames([o],{type:"language"}).of(c[0]):k("Languages",c.length)},[c,k,o]),B=(0,M.A)(()=>{g({screen:a.VS.DoNotTranslate})});return(0,Ce.A)({isActive:e,onBack:d}),(0,te.FD)("div",{className:"settings-content settings-language custom-scroll",children:[u.CM&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(ps.A,{label:k("ShowTranslateButton"),checked:r,onCheck:I}),(0,te.Y)(ps.A,{label:k("ShowTranslateChatButton"),checked:S,disabled:!t,rightIcon:t?void 0:"lock",onClickLabel:Y,onCheck:P}),(r||S)&&(0,te.FD)(di.A,{narrow:!0,onClick:B,children:[k("DoNotTranslate"),(0,te.Y)("span",{className:"settings-item__current-value",children:D})]}),(0,te.Y)("p",{className:"settings-item-description mb-0 mt-1",children:k("lng_translate_settings_about")})]}),(0,te.FD)("div",{className:"settings-item settings-item-picker",children:[(0,te.Y)("h4",{className:"settings-item-header",children:k("Localization.InterfaceLanguage")}),N?(0,te.Y)(zo,{items:N,selectedValue:A,forceRenderAllItems:!0,onSelectedValueChange:w,itemInputType:"radio",className:"settings-picker"}):(0,te.Y)($n.A,{})]})]})}));var du=i(86046),hu=i(44784),uu=i(87970);const mu=(0,n.ph)((0,s.EK)(e=>{const{currentUserId:t}=e,i=(0,c.hc)(e),n=e.stars?.balance,s=e.ton?.balance;return{sessionCount:e.activeSessions.orderedHashes.length,currentUserId:t,canBuyPremium:!(0,c.n_C)(e),isGiveawayAvailable:i,starsBalance:n,tonBalance:s}})(({isActive:e,currentUserId:t,sessionCount:i,canBuyPremium:r,isGiveawayAvailable:l,starsBalance:c,tonBalance:d,onReset:h})=>{const{loadMoreProfilePhotos:u,openPremiumModal:m,openSupportChat:p,openUrl:v,openGiftRecipientPicker:g,openStarsBalanceModal:A,openSettingsScreen:f}=(0,s.ko)(),[b,C,y]=(0,F.A)(!1),S=(0,Ui.A)();(0,n.vJ)(()=>{t&&u({peerId:t,isPreload:!0})},[t]),(0,Ce.A)({isActive:e,onBack:h});const k=(0,M.A)(()=>{p(),y()});return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-main-menu self-profile",children:[t&&(0,te.Y)(uu.A,{peerId:t,canPlayVideo:Boolean(e),isForSettings:!0}),t&&(0,te.Y)(hu.A,{chatOrUserId:t,isInSettings:!0})]}),(0,te.FD)("div",{className:"settings-main-menu",children:[(0,te.Y)(di.A,{icon:"settings",narrow:!0,onClick:()=>f({screen:a.VS.General}),children:S("TelegramGeneralSettingsViewController")}),(0,te.Y)(di.A,{icon:"animations",narrow:!0,onClick:()=>f({screen:a.VS.Performance}),children:S("MenuAnimations")}),(0,te.Y)(di.A,{icon:"unmute",narrow:!0,onClick:()=>f({screen:a.VS.Notifications}),children:S("Notifications")}),(0,te.Y)(di.A,{icon:"data",narrow:!0,onClick:()=>f({screen:a.VS.DataStorage}),children:S("DataSettings")}),(0,te.Y)(di.A,{icon:"lock",narrow:!0,onClick:()=>f({screen:a.VS.Privacy}),children:S("PrivacySettings")}),(0,te.Y)(di.A,{icon:"folder",narrow:!0,onClick:()=>f({screen:a.VS.Folders}),children:S("Filters")}),(0,te.FD)(di.A,{icon:"active-sessions",narrow:!0,onClick:()=>f({screen:a.VS.ActiveSessions}),children:[S("SessionsTitle"),i>0&&(0,te.Y)("span",{className:"settings-item__current-value",children:i})]}),(0,te.FD)(di.A,{icon:"language",narrow:!0,onClick:()=>f({screen:a.VS.Language}),children:[S("Language"),(0,te.Y)("span",{className:"settings-item__current-value",children:S.languageInfo.nativeName})]}),(0,te.Y)(di.A,{icon:"stickers",narrow:!0,onClick:()=>f({screen:a.VS.Stickers}),children:S("MenuStickers")})]}),(0,te.FD)("div",{className:"settings-main-menu",children:[r&&(0,te.Y)(di.A,{leftElement:(0,te.Y)(ph.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),narrow:!0,onClick:()=>m(),children:S("TelegramPremium")}),(0,te.FD)(di.A,{leftElement:(0,te.Y)(ph.A,{className:"icon ListItem-main-icon",type:"gold",size:"big"}),narrow:!0,onClick:()=>A({}),children:[S("MenuStars"),Boolean(c)&&(0,te.Y)("span",{className:"settings-item__current-value",children:(0,du.ZF)(S,c)})]}),(0,te.FD)(di.A,{leftElement:(0,te.Y)(W.A,{className:"icon ListItem-main-icon",name:"toncoin"}),narrow:!0,onClick:()=>A({currency:o.ykW}),children:[S("MenuTon"),Boolean(d)&&(0,te.Y)("span",{className:"settings-item__current-value",children:(0,ka.UL)(d.amount,d.currency)})]}),l&&(0,te.Y)(di.A,{icon:"gift",narrow:!0,onClick:()=>g(),children:S("MenuSendGift")})]}),(0,te.FD)("div",{className:"settings-main-menu",children:[(0,te.Y)(di.A,{icon:"ask-support",narrow:!0,onClick:C,children:S("AskAQuestion")}),(0,te.Y)(di.A,{icon:"help",narrow:!0,onClick:()=>v({url:o.r9K}),children:S("MenuTelegramFaq")}),(0,te.Y)(di.A,{icon:"privacy-policy",narrow:!0,onClick:()=>v({url:o.pkx}),children:S("MenuPrivacyPolicy")})]}),(0,te.Y)(gi.A,{isOpen:b,confirmLabel:S("OK"),title:S("AskAQuestion"),textParts:S("MenuAskText",void 0,{withNodes:!0,renderTextFilters:["br"]}),confirmHandler:k,onClose:y})]})}));var pu=i(5560),vu=i(56133);const gu=(0,n.ph)((0,s.EK)(e=>({hasContactJoinedNotifications:Boolean(e.settings.byKey.hasContactJoinedNotifications),hasWebNotifications:e.settings.byKey.hasWebNotifications,hasPushNotifications:e.settings.byKey.hasPushNotifications,notificationSoundVolume:e.settings.byKey.notificationSoundVolume,notifyDefaults:e.settings.notifyDefaults}))(({isActive:e,onReset:t,notifyDefaults:i,hasContactJoinedNotifications:a,hasPushNotifications:o,hasWebNotifications:r,notificationSoundVolume:l})=>{const{loadNotificationSettings:c,updateContactSignUpNotification:d,updateNotificationSettings:h,updateWebNotificationSettings:u}=(0,s.ko)();(0,n.vJ)(()=>{c()},[c]);const m=(0,vu.A)(500,!0),p=(0,pu.M2)(),v=p&&!(0,pu.Ac)(),g=Boolean(i?.channels?.mutedUntil),A=Boolean(i?.groups?.mutedUntil),f=Boolean(i?.users?.mutedUntil),b=(0,n.hb)((e,t,n)=>{const s=Boolean(i?.[t]?.mutedUntil),a=Boolean(i?.[t]?.shouldShowPreviews);h({peerType:t,isMuted:"mute"===n?!e.target.checked:s,shouldShowPreviews:"showPreviews"===n?e.target.checked:a})},[i]),C=(0,n.hb)(e=>{const t=e.target.checked;u({hasWebNotifications:t,...!t&&{hasPushNotifications:!1}})},[u]),y=(0,n.hb)(e=>{u({hasPushNotifications:e.target.checked})},[u]),S=(0,n.hb)(e=>{b(e,"users","mute")},[b]),k=(0,n.hb)(e=>{b(e,"users","showPreviews")},[b]),w=(0,n.hb)(e=>{b(e,"groups","mute")},[b]),N=(0,n.hb)(e=>{b(e,"groups","showPreviews")},[b]),I=(0,n.hb)(e=>{b(e,"channels","mute")},[b]),P=(0,n.hb)(e=>{b(e,"channels","showPreviews")},[b]),Y=(0,n.hb)(e=>{d({isSilent:!e.target.checked})},[d]),F=(0,n.hb)(e=>{u({notificationSoundVolume:e}),m(()=>(0,pu.BA)(void 0,e))},[m,u]),D=(0,Ui.A)();return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("NotificationsWeb")}),(0,te.Y)(ps.A,{label:D("NotificationsWeb"),subLabel:D(r?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:r,disabled:!p,onChange:C}),(0,te.Y)(ps.A,{label:D("NotificationsOffline"),disabled:!r||!v,subLabel:D(v?o?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled":"SettingsOfflineNotificationUnsupported"),checked:o,onChange:y}),(0,te.Y)("div",{className:"settings-item-slider",children:(0,te.Y)(We.A,{label:D("NotificationsSound"),min:0,max:10,disabled:!p,value:l,onChange:F})})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("AutodownloadPrivateChats")}),(0,te.Y)(ps.A,{label:D("NotificationsForPrivateChats"),subLabel:D(f?"UserInfoNotificationsDisabled":"UserInfoNotificationsEnabled"),checked:!f,onChange:S}),(0,te.Y)(ps.A,{label:D("MessagePreview"),disabled:f,subLabel:D(i?.users?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.users?.shouldShowPreviews),onChange:k})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("FilterGroups")}),(0,te.Y)(ps.A,{label:D("NotificationsForGroups"),subLabel:D(A?"UserInfoNotificationsDisabled":"UserInfoNotificationsEnabled"),checked:!A,onChange:w}),(0,te.Y)(ps.A,{label:D("MessagePreview"),disabled:A,subLabel:D(i?.groups?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.groups?.shouldShowPreviews),onChange:N})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("FilterChannels")}),(0,te.Y)(ps.A,{label:D("NotificationsForChannels"),subLabel:D(g?"UserInfoNotificationsDisabled":"UserInfoNotificationsEnabled"),checked:!g,onChange:I}),(0,te.Y)(ps.A,{label:D("MessagePreview"),disabled:g,subLabel:D(i?.channels?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.channels?.shouldShowPreviews),onChange:P})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:D.isRtl?"rtl":void 0,children:D("PhoneOther")}),(0,te.Y)(ps.A,{label:D("ContactJoined"),checked:a,onChange:Y})]})]})}));var Au=i(20714),fu=i(22986);const bu=["SettingsPerformanceSliderLow","SettingsPerformanceSliderMedium","SettingsPerformanceSliderHigh"],Cu=["SettingsPerformanceSliderLow","SettingsPerformanceSliderCustom","SettingsPerformanceSliderHigh"],yu=[["SettingsPerformanceInterfaceAnimations",[{key:"pageTransitions",label:"SettingsPerformancePageTransitions"},{key:"messageSendingAnimations",label:"SettingsPerformanceSending"},{key:"mediaViewerAnimations",label:"SettingsPerformanceMediaViewer"},{key:"messageComposerAnimations",label:"SettingsPerformanceComposer"},{key:"contextMenuAnimations",label:"SettingsPerformanceContextAnimation"},{key:"contextMenuBlur",label:"SettingsPerformanceContextBlur",disabled:!u.Fy},{key:"rightColumnAnimations",label:"SettingsPerformanceRightColumn"},{key:"snapEffect",label:"SettingsPerformanceThanos"}]],["SettingsPerformanceStickers",[{key:"animatedEmoji",label:"SettingsPerformanceAnimatedEmoji"},{key:"loopAnimatedStickers",label:"SettingsPerformanceLoopStickers"},{key:"reactionEffects",label:"SettingsPerformanceReactionEffects"},{key:"stickerEffects",label:"SettingsPerformanceStickerEffects"}]],["SettingsPerformanceMediaAutoplay",[{key:"autoplayGifs",label:"SettingsPerformanceAutoplayGif"},{key:"autoplayVideos",label:"SettingsPerformanceAutoplayVideo"}]]],Su=(0,n.ph)((0,s.EK)(e=>({performanceSettings:(0,c.Cw0)(e)}))(function({isActive:e,performanceSettings:t,onReset:i}){const{setSharedSettingOption:a,updatePerformanceSettings:r}=(0,s.ko)();(0,Ce.A)({isActive:e,onBack:i});const l=(0,Ui.A)(),[c,d]=(0,n.J0)({}),h=(0,n.Kr)(()=>yu.reduce((e,[,i],n)=>(e[n]=i.every(({key:e})=>t[e]),e),{}),[t]),m=(0,n.Kr)(()=>(0,fu.T)(t,Au.LH)?o.zP3:(0,fu.T)(t,Au.PI)?o.dnp:(0,fu.T)(t,Au.tS)?o.zHL:o.M8B,[t]),p=(0,n.Kr)(()=>(m===o.M8B?Cu:bu).map(e=>l(e)),[m,l]),v=(0,n.hb)((e,t)=>{e.preventDefault();const i=Number(t);d(e=>({...e,[i]:!e[i]}))},[]),g=(0,n.hb)(e=>{const t=e===o.dnp?Au.PI:e===o.zHL?Au.tS:Au.LH;a({animationLevel:e,wasAnimationLevelSetManually:!0}),r(t)},[]),A=(0,n.hb)(e=>{const{name:t,checked:i}=e.target,n=yu.find(([e])=>e===t);if(!n)return;const s=n[1].reduce((e,{key:t})=>(e[t]=i,e),{});r(s)},[]),f=(0,n.hb)(e=>{const{name:t,checked:i}=e.target;r({[t]:i})},[]);return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("SettingsPerformanceSliderTitle")}),(0,te.Y)("p",{className:"settings-item-description",dir:l.isRtl?"rtl":void 0,children:l("SettingsPerformanceSliderSubtitle")}),(0,te.Y)(We.A,{options:p,value:m===o.M8B?o.zHL:m,onChange:g})]}),(0,te.FD)("div",{className:"settings-item-simple settings-item__with-shifted-dropdown",children:[(0,te.Y)("h3",{className:"settings-item-header",dir:"auto",children:l("SettingsPerformanceGranularTitle")}),yu.map(([e,i],n)=>(0,te.FD)("div",{className:"settings-dropdown-section",children:[(0,te.Y)("div",{className:"ListItem with-checkbox",children:(0,te.Y)(ps.A,{name:e,value:n.toString(),checked:h[n],label:l(e),rightIcon:c[n]?"up":"down",onChange:A,onClickLabel:v})}),Boolean(c[n])&&(0,te.Y)("div",{className:"DropdownList DropdownList--open",children:i.map(({key:e,label:i,disabled:n})=>{if("snapEffect"!==e||u.bW)return(0,te.Y)(ps.A,{name:e,checked:t[e],label:l(i),disabled:n,onChange:f},e)})})]},e))]})]})})),ku=(0,n.ph)((0,s.EK)(e=>{const{settings:{byKey:{hasPassword:t,isSensitiveEnabled:i,canChangeSensitive:n,shouldArchiveAndMuteNewNonContact:s,shouldNewNonContactPeersRequirePremium:a,nonContactPeersPaidStars:o},privacy:r,accountDaysTtl:l},blocked:d,passcode:{hasPasscode:h},appConfig:u}=e,{canDisplayChatInTitle:m}=(0,Is.l)(e),p=Boolean(o),v=(0,c.trm)(e),g=(0,c.g29)(e);return{isCurrentUserPremium:g,hasPassword:t,hasPasscode:Boolean(h),blockedCount:d.totalCount,webAuthCount:e.activeWebSessions.orderedHashes.length,isSensitiveEnabled:i,canDisplayAutoarchiveSetting:u.canDisplayAutoarchiveSetting||g,shouldArchiveAndMuteNewNonContact:s,canChangeSensitive:n,shouldNewNonContactPeersRequirePremium:a,shouldChargeForMessages:p,needAgeVideoVerification:Boolean(u.needAgeVideoVerification),privacy:r,canDisplayChatInTitle:m,canSetPasscode:(0,c.Ntz)(e),isCurrentUserFrozen:v,accountDaysTtl:l}})(({isActive:e,isCurrentUserPremium:t,hasPassword:i,hasPasscode:r,blockedCount:l,webAuthCount:c,isSensitiveEnabled:d,canChangeSensitive:h,canDisplayAutoarchiveSetting:u,shouldArchiveAndMuteNewNonContact:m,shouldNewNonContactPeersRequirePremium:p,shouldChargeForMessages:v,canDisplayChatInTitle:g,canSetPasscode:A,needAgeVideoVerification:f,privacy:b,onReset:C,isCurrentUserFrozen:y,accountDaysTtl:S})=>{const{openDeleteAccountModal:k,loadPrivacySettings:w,loadBlockedUsers:N,updateContentSettings:I,loadGlobalPrivacySettings:P,updateGlobalPrivacySettings:Y,loadWebAuthorizations:F,setSharedSettingOption:D,openSettingsScreen:B,loadAccountDaysTtl:R,openAgeVerificationModal:L}=(0,s.ko)();(0,n.vJ)(()=>{y||(N(),w(),F())},[y]),(0,n.vJ)(()=>{e&&!y&&(P(),R())},[e,y,P]);const x=(0,T.A)(),E=(0,Ui.A)();(0,Ce.A)({isActive:e,onBack:C});const V=(0,n.hb)(e=>{Y({shouldArchiveAndMuteNewNonContact:e})},[Y]),_=(0,n.hb)(e=>{D({canDisplayChatInTitle:e})},[]),U=(0,n.hb)(e=>{I({isSensitiveEnabled:e})},[I]),O=(0,n.hb)(()=>{L()},[L]),K=(0,M.A)(()=>{S&&k({days:S})}),J=(0,n.Kr)(()=>{if(S)return yl(o.WF4,S/30).toString()},[S]);function G(e){if(!e)return x("Loading");const{visibility:t,shouldAllowPremium:i,botsPrivacy:n}=e,s="everybody"===t,a="allow"===n&&!s,o=e.blockChatIds.length+e.blockUserIds.length,r=e.allowChatIds.length+e.allowUserIds.length,l=[];o&&l.push(`-${o}`),r&&!s&&l.push(`+${r}`);const c=[a?E("PrivacyValueBots"):"",E.conjunction(l)].filter(Boolean).join(" ");if(a&&!s)return c;if(i)return x(c?"ContactsAndPremium":"PrivacyPremium");switch(t){case"everybody":return`${x("P2PEverybody")} ${c}`;case"contacts":return`${x("P2PContacts")} ${c}`;case"nobody":return`${x("P2PNobody")} ${c}`}}return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.FD)(di.A,{icon:"delete-user",narrow:!0,onClick:()=>B({screen:a.VS.PrivacyBlockedUsers}),children:[x("BlockedUsers"),(0,te.Y)("span",{className:"settings-item__current-value",children:l||""})]}),A&&(0,te.Y)(di.A,{icon:"key",narrow:!0,onClick:()=>B({screen:r?a.VS.PasscodeEnabled:a.VS.PasscodeDisabled}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("Passcode")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:x(r?"PasswordOn":"PasswordOff")})]})}),(0,te.Y)(di.A,{icon:"lock",narrow:!0,onClick:()=>B({screen:i?a.VS.TwoFaEnabled:a.VS.TwoFaDisabled}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("TwoStepVerification")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:x(i?"PasswordOn":"PasswordOff")})]})}),c>0&&(0,te.FD)(di.A,{icon:"web",narrow:!0,onClick:()=>B({screen:a.VS.ActiveWebsites}),children:[x("PrivacySettings.WebSessions"),(0,te.Y)("span",{className:"settings-item__current-value",children:c})]})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:x.isRtl?"rtl":void 0,children:x("PrivacyTitle")}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyPhoneNumber}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyPhoneTitle")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.phoneNumber)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyLastSeen}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("LastSeenTitle")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.lastSeen)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyProfilePhoto}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyProfilePhotoTitle")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.profilePhoto)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyBio}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyBio")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.bio)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyBirthday}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyBirthday")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.birthday)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyGifts}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:E("PrivacyGifts")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.gifts)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyForwarding}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyForwardsTitle")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.forwards)})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyPhoneCall}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("WhoCanCallMe")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.phoneCall)})]})}),(0,te.Y)(di.A,{narrow:!0,allowDisabledClick:!0,rightElement:t&&(0,te.Y)(ph.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyVoiceMessages}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyVoiceMessagesTitle")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.voiceMessages)})]})}),(0,te.Y)(di.A,{narrow:!0,rightElement:t&&(0,te.Y)(ph.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyMessages}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("PrivacyMessagesTitle")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:v?E("PrivacyPaidMessagesValue"):x(p?"PrivacyMessagesContactsAndPremium":"P2PEverybody")})]})}),(0,te.Y)(di.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyGroupChats}),children:(0,te.FD)("div",{className:"multiline-item",children:[(0,te.Y)("span",{className:"title",children:x("WhoCanAddMe")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:G(b.chatInvite)})]})})]}),h&&(0,te.FD)("div",{className:"settings-item fluid-container",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:x.isRtl?"rtl":void 0,children:x("lng_settings_sensitive_title")}),(0,te.Y)(ps.A,{label:x("lng_settings_sensitive_disable_filtering"),subLabel:x("lng_settings_sensitive_about"),checked:Boolean(d),disabled:!h||!d&&f,onCheck:U}),!d&&f&&(0,te.Y)(Q.A,{color:"primary",fluid:!0,noForcedUpperCase:!0,className:"settings-unlock-button",onClick:O,children:(0,te.Y)("span",{className:"settings-unlock-button-title",children:E("ButtonAgeVerification")})})]}),u&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:x.isRtl?"rtl":void 0,children:x("NewChatsFromNonContacts")}),(0,te.Y)(ps.A,{label:x("ArchiveAndMute"),subLabel:x("ArchiveAndMuteInfo"),checked:Boolean(m),onCheck:V})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:x.isRtl?"rtl":void 0,children:x("lng_settings_window_system")}),(0,te.Y)(ps.A,{label:x("lng_settings_title_chat_name"),checked:Boolean(g),onCheck:_})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:x.isRtl?"rtl":void 0,children:E("DeleteMyAccount")}),(0,te.FD)(di.A,{narrow:!0,onClick:K,children:[E("DeleteAccountIfAwayFor"),(0,te.Y)("span",{className:"settings-item__current-value",children:E("Months",{count:J},{pluralValue:1})})]})]})]})})),wu=(0,n.ph)((0,s.EK)(e=>{const{users:{byId:t},blocked:{ids:i},contactList:n,currentUserId:s}=e;return{usersById:t,blockedIds:i,contactIds:n?.userIds,localContactIds:(0,c.nTw)(e).userSearch.localUserIds,currentUserId:s}})(({usersById:e,blockedIds:t,contactIds:i,localContactIds:a,currentUserId:o,isOpen:r,onClose:c})=>{const{setUserSearchQuery:d,blockUser:h}=(0,s.ko)(),u=(0,T.A)(),[m,p]=(0,n.J0)("");(0,n.vJ)(()=>{d({query:m})},[m,d]);const v=(0,n.Kr)(()=>{const n=(0,Ci.Am)([...i||[],...a||[]].filter(e=>e!==o&&!t.includes(e)));return(0,Ft.PU)({ids:n,query:m,type:"user"}).sort((t,i)=>{const n=(0,l.Yg)(e[t])||"",s=(0,l.Yg)(e[i])||"";return n.localeCompare(s)})},[t,i,o,m,a,e]),g=(0,n.hb)(e=>{h({userId:e}),c()},[c]);return(0,te.Y)(es,{isOpen:r,chatOrUserIds:v,searchPlaceholder:u("BlockedUsers.BlockUser"),search:m,onSearchChange:p,onSelectChatOrUser:g,onClose:c})})),Nu=(0,n.ph)((0,s.EK)(e=>{const{chats:{byId:t},users:{byId:i},blocked:{ids:n},countryList:{phoneCodes:s}}=e;return{chatsByIds:t,usersByIds:i,blockedIds:n,phoneCodeList:s}})(({isActive:e,onReset:t,chatsByIds:i,usersByIds:a,blockedIds:r,phoneCodeList:c})=>{const{unblockUser:d}=(0,s.ko)(),h=(0,T.A)(),[u,m,p]=(0,F.A)(),g=(0,n.hb)(e=>{d({userId:e})},[d]);(0,Ce.A)({isActive:e,onBack:t});const A=(0,n.Kr)(()=>r.reduce((e,t)=>{const i=(0,v.L8)(t)?a[t]:void 0,n=i&&!i.phoneNumber&&(0,l.Kl)(i);return n&&(e[t]=n),e},{}),[r,a]);return(0,te.FD)("div",{className:"settings-fab-wrapper",children:[(0,te.FD)("div",{className:"settings-content infinite-scroll",children:[(0,te.Y)("div",{className:"settings-item no-border",children:(0,te.Y)("p",{className:"settings-item-description-larger mt-0 mb-2",dir:h.isRtl?"rtl":void 0,children:h("BlockedUsersInfo")})}),(0,te.Y)("div",{className:"chat-list custom-scroll",children:r?.length?(0,te.Y)("div",{className:"scroll-container settings-item",children:r.map((e,t)=>function(e,t){const n=(0,v.L8)(e),s=a[e],r=i[e],l=s||r,d=(0,me.A)("Chat chat-item-clickable blocked-list-item small-icon",n?"private":"group"),h=A[e];return(0,te.FD)(di.A,{className:d,ripple:!0,narrow:!0,contextActions:[{title:"Unblock",icon:"unlock",handler:()=>{g(e)}}],style:`top: ${(0+t)*o.yq1}px;`,children:[(0,te.Y)(Mt.A,{size:"medium",peer:l}),(0,te.FD)("div",{className:"contact-info",dir:"auto",children:[l&&(0,te.Y)(qn.A,{peer:l}),s?.phoneNumber&&(0,te.Y)("div",{className:"contact-phone",dir:"auto",children:(0,ks.Ox)(c,s.phoneNumber)}),h&&(0,te.FD)("div",{className:"contact-username",dir:"auto",children:["@",h]})]})]},`blocked_${e}`)}(e,t))}):r&&!r.length?(0,te.Y)("div",{className:"no-results",dir:"auto",children:h("NoBlocked")}):(0,te.Y)($n.A,{},"loading")})]}),(0,te.Y)(Ni.A,{isShown:!0,className:"block-user-button",onClick:m,ariaLabel:h("BlockContact"),children:(0,te.Y)(W.A,{name:"add"})}),(0,te.Y)(wu,{isOpen:u,onClose:p})]})}));function Iu(e){switch(e){case a.VS.PrivacyPhoneNumber:case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyPhoneNumberDeniedContacts:return"phoneNumber";case a.VS.PrivacyLastSeen:case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyLastSeenDeniedContacts:return"lastSeen";case a.VS.PrivacyProfilePhoto:case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:return"profilePhoto";case a.VS.PrivacyBio:case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyBioDeniedContacts:return"bio";case a.VS.PrivacyBirthday:case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyBirthdayDeniedContacts:return"birthday";case a.VS.PrivacyGifts:case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyGiftsDeniedContacts:return"gifts";case a.VS.PrivacyForwarding:case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyForwardingDeniedContacts:return"forwards";case a.VS.PrivacyVoiceMessages:case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:return"voiceMessages";case a.VS.PrivacyGroupChats:case a.VS.PrivacyGroupChatsAllowedContacts:case a.VS.PrivacyGroupChatsDeniedContacts:return"chatInvite";case a.VS.PrivacyPhoneCall:case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:return"phoneCall";case a.VS.PrivacyPhoneP2P:case a.VS.PrivacyPhoneP2PAllowedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:return"phoneP2P";case a.VS.PrivacyAddByPhone:return"addByPhone";case a.VS.PrivacyNoPaidMessages:return"noPaidMessages"}}const Pu=(0,n.ph)((0,s.EK)(e=>{const{settings:{byKey:{disallowedGifts:t}}}=e;return{disallowedGifts:t,isCurrentUserPremium:(0,c.g29)(e)}})(({disallowedGifts:e,isCurrentUserPremium:t})=>{const{showNotification:i,updateGlobalPrivacySettings:n}=(0,s.ko)(),a=(0,Ui.A)(),o=(0,M.A)(()=>{i({message:a("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})}),r=(0,M.A)(()=>{t?n({disallowedGifts:{...e,shouldDisallowLimitedStarGifts:!e?.shouldDisallowLimitedStarGifts||void 0}}):o()}),l=(0,M.A)(()=>{t?n({disallowedGifts:{...e,shouldDisallowUnlimitedStarGifts:!e?.shouldDisallowUnlimitedStarGifts||void 0}}):o()}),c=(0,M.A)(()=>{t?n({disallowedGifts:{...e,shouldDisallowUniqueStarGifts:!e?.shouldDisallowUniqueStarGifts||void 0}}):o()}),d=(0,M.A)(()=>{t?n({disallowedGifts:{...e,shouldDisallowPremiumGifts:!e?.shouldDisallowPremiumGifts||void 0}}):o()});return(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:a.isRtl?"rtl":void 0,children:a("PrivacyAcceptedGiftTitle")}),(0,te.FD)(di.A,{onClick:r,children:[(0,te.Y)("span",{children:a("PrivacyGiftLimitedEdition")}),(0,te.Y)(bi.A,{id:"limited_edition",label:a(e?.shouldDisallowLimitedStarGifts?"PrivacyDisableLimitedEditionStarGifts":"PrivacyEnableLimitedEditionStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowLimitedStarGifts})]}),(0,te.FD)(di.A,{onClick:l,children:[(0,te.Y)("span",{children:a("PrivacyGiftUnlimited")}),(0,te.Y)(bi.A,{id:"unlimited",label:a(e?.shouldDisallowUnlimitedStarGifts?"PrivacyDisableUnlimitedStarGifts":"PrivacyEnableUnlimitedStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUnlimitedStarGifts})]}),(0,te.FD)(di.A,{onClick:c,children:[(0,te.Y)("span",{children:a("PrivacyGiftUnique")}),(0,te.Y)(bi.A,{id:"unique",label:a(e?.shouldDisallowUniqueStarGifts?"PrivacyDisableUniqueStarGifts":"PrivacyEnableUniqueStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUniqueStarGifts})]}),(0,te.FD)(di.A,{onClick:d,children:[(0,te.Y)("span",{children:a("PrivacyGiftPremiumSubscription")}),(0,te.Y)(bi.A,{id:"premium_subscription",label:a(e?.shouldDisallowPremiumGifts?"PrivacyDisablePremiumGifts":"PrivacyEnablePremiumGifts"),disabled:!t,checked:!t||!e?.shouldDisallowPremiumGifts})]}),(0,te.Y)("p",{className:"settings-item-description-larger",dir:a.isRtl?"rtl":void 0,children:a("PrivacyAcceptedGiftInfo")})]})})),Yu=(0,n.ph)((0,s.EK)(e=>({isCurrentUserPremium:(0,c.g29)(e),shouldHideReadMarks:Boolean((0,c.KIM)(e))}))(({isCurrentUserPremium:e,shouldHideReadMarks:t,visibility:i})=>{const{updateGlobalPrivacySettings:n,openPremiumModal:a}=(0,s.ko)(),o=(0,T.A)(),r="nobody"===i||"contacts"===i,l=(0,M.A)(e=>n({shouldHideReadMarks:e})),c=(0,M.A)(()=>{a({initialSection:"last_seen"})});return(0,te.FD)(te.FK,{children:[r&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(ps.A,{label:o("HideReadTime"),checked:t,onCheck:l}),(0,te.Y)("p",{className:"settings-item-description-larger",dir:o.isRtl?"rtl":void 0,children:(0,Dt.A)(o("HideReadTimeInfo"),["br"])})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{leftElement:(0,te.Y)(ph.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:c,children:o(e?"PrivacyLastSeenPremiumForPremium":"PrivacyLastSeenPremium")}),(0,te.Y)("p",{className:"settings-item-description-larger premium-info",dir:o.isRtl?"rtl":void 0,children:o(e?"PrivacyLastSeenPremiumInfoForPremium":"PrivacyLastSeenPremiumInfo")})]})]})}));var Fu=i(91356);const Du=(0,n.ph)(({currentUserId:e,hasCurrentUserFullInfo:t,currentUserFallbackPhoto:i})=>{const{loadFullUser:a,uploadProfilePhoto:o,deleteProfilePhoto:r,showNotification:l}=(0,s.ko)(),c=(0,T.A)(),[d,h,u]=(0,F.A)(!1),m=(0,n.li)();(0,n.vJ)(()=>{t||a({userId:e})},[t,e,a]);const p=(0,n.hb)(e=>{o({file:e,isFallback:!0}),l({message:c("Privacy.ProfilePhoto.PublicPhotoSuccess")})},[c,l,o]),v=(0,n.hb)(()=>{u(),r({photo:i})},[u,r,i]),g=(0,n.hb)(()=>{m.current?.click()},[]);return(0,te.FD)("div",{className:"settings-item",children:[(0,te.FD)(di.A,{narrow:!0,icon:"camera-add",onClick:g,children:[(0,te.Y)(Fu.A,{onChange:p,inputRef:m}),c(i?"Privacy.ProfilePhoto.UpdatePublicPhoto":"Privacy.ProfilePhoto.SetPublicPhoto")]}),i&&(0,te.FD)(di.A,{narrow:!0,leftElement:(0,te.Y)(Mt.A,{photo:i,size:"mini",className:"Qvhl9Jjv"}),onClick:h,destructive:!0,children:[c(i.isVideo?"Privacy.ProfilePhoto.RemovePublicVideo":"Privacy.ProfilePhoto.RemovePublicPhoto"),(0,te.Y)(gi.A,{isOpen:d,onClose:u,text:c("Privacy.ResetPhoto.Confirm"),confirmLabel:c("Delete"),confirmHandler:v,confirmIsDestructive:!0})]}),(0,te.Y)("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0,children:c("Privacy.ProfilePhoto.PublicPhotoInfo")})]})});function Mu({screen:e,privacy:t,isPremiumRequired:i}){const{setPrivacyVisibility:o,openSettingsScreen:r}=(0,s.ko)(),l=(0,T.A)(),c=(0,Ui.A)(),d=(0,n.Kr)(()=>{const t=e!==a.VS.PrivacyAddByPhone,n=[{value:"everybody",label:l("P2PEverybody")},{value:"contacts",label:i?(0,te.Y)(gh,{label:l("P2PContacts")}):l("P2PContacts"),hidden:i}];return t&&n.push({value:"nobody",label:i?(0,te.Y)(gh,{label:l("P2PNobody")}):l("P2PNobody"),hidden:i}),n},[l,e,i]),h=(0,n.Kr)(()=>e===a.VS.PrivacyAddByPhone?{shouldShowDenied:!1,shouldShowAllowed:!1}:{shouldShowDenied:"nobody"!==t?.visibility,shouldShowAllowed:"everybody"!==t?.visibility},[t,e]),u=Iu(e),m=(0,n.Kr)(()=>{switch(e){case a.VS.PrivacyGifts:return c("PrivacyGiftsInfo");case a.VS.PrivacyLastSeen:return l("CustomHelp");case a.VS.PrivacyAddByPhone:return l("everybody"===t?.visibility?"PrivacyPhoneInfo":"PrivacyPhoneInfo3");case a.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesInfo");default:return}},[l,c,e,t]),p=(0,n.Kr)(()=>{switch(e){case a.VS.PrivacyPhoneNumber:return l("PrivacyPhoneTitle");case a.VS.PrivacyAddByPhone:return l("PrivacyPhoneTitle2");case a.VS.PrivacyLastSeen:return l("LastSeenTitle");case a.VS.PrivacyProfilePhoto:return l("PrivacyProfilePhotoTitle");case a.VS.PrivacyBio:return l("PrivacyBioTitle");case a.VS.PrivacyBirthday:return l("PrivacyBirthdayTitle");case a.VS.PrivacyGifts:return c("PrivacyGiftsTitle");case a.VS.PrivacyForwarding:return l("PrivacyForwardsTitle");case a.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesTitle");case a.VS.PrivacyGroupChats:return l("WhoCanAddMe");case a.VS.PrivacyPhoneCall:return l("WhoCanCallMe");case a.VS.PrivacyPhoneP2P:return l("PrivacyP2P");default:return}},[l,c,e]),v=(0,M.A)((e,t,i,n)=>{const s=e?.length||0,a=t?.length||0,o="allow"===n;if(!s&&!a&&!o)return l(i?"PrivacyPremium":"EditAdminAddUsers");if(i)return l("ContactsAndPremium");const r=s>0?l("Users",s):void 0,d=a>0?l("Chats",a):void 0;return[o?c("PrivacyValueBots"):"",c.conjunction([r,d].filter(Boolean))].filter(Boolean).join(" ")}),g=(0,n.Kr)(()=>v(t?.allowUserIds,t?.allowChatIds,t?.shouldAllowPremium,t?.botsPrivacy),[t]),A=(0,n.Kr)(()=>v(t?.blockUserIds,t?.blockChatIds),[t]),f=(0,n.hb)(e=>{o({privacyKey:u,visibility:e})},[u]),b=(()=>{switch(e){case a.VS.PrivacyPhoneNumber:return a.VS.PrivacyPhoneNumberAllowedContacts;case a.VS.PrivacyLastSeen:return a.VS.PrivacyLastSeenAllowedContacts;case a.VS.PrivacyProfilePhoto:return a.VS.PrivacyProfilePhotoAllowedContacts;case a.VS.PrivacyBio:return a.VS.PrivacyBioAllowedContacts;case a.VS.PrivacyBirthday:return a.VS.PrivacyBirthdayAllowedContacts;case a.VS.PrivacyGifts:return a.VS.PrivacyGiftsAllowedContacts;case a.VS.PrivacyForwarding:return a.VS.PrivacyForwardingAllowedContacts;case a.VS.PrivacyPhoneCall:return a.VS.PrivacyPhoneCallAllowedContacts;case a.VS.PrivacyPhoneP2P:return a.VS.PrivacyPhoneP2PAllowedContacts;case a.VS.PrivacyVoiceMessages:return a.VS.PrivacyVoiceMessagesAllowedContacts;default:return a.VS.PrivacyGroupChatsAllowedContacts}})(),C=(()=>{switch(e){case a.VS.PrivacyPhoneNumber:return a.VS.PrivacyPhoneNumberDeniedContacts;case a.VS.PrivacyLastSeen:return a.VS.PrivacyLastSeenDeniedContacts;case a.VS.PrivacyProfilePhoto:return a.VS.PrivacyProfilePhotoDeniedContacts;case a.VS.PrivacyBio:return a.VS.PrivacyBioDeniedContacts;case a.VS.PrivacyBirthday:return a.VS.PrivacyBirthdayDeniedContacts;case a.VS.PrivacyGifts:return a.VS.PrivacyGiftsDeniedContacts;case a.VS.PrivacyForwarding:return a.VS.PrivacyForwardingDeniedContacts;case a.VS.PrivacyPhoneCall:return a.VS.PrivacyPhoneCallDeniedContacts;case a.VS.PrivacyPhoneP2P:return a.VS.PrivacyPhoneP2PDeniedContacts;case a.VS.PrivacyVoiceMessages:return a.VS.PrivacyVoiceMessagesDeniedContacts;default:return a.VS.PrivacyGroupChatsDeniedContacts}})();return(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:p}),(0,te.Y)(ee.A,{name:`visibility-${u}`,options:d,onChange:f,selected:t?.visibility}),m&&(0,te.Y)("p",{className:"settings-item-description-larger",dir:l.isRtl?"rtl":void 0,children:m})]}),!i&&(h.shouldShowAllowed||h.shouldShowDenied)&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("PrivacyExceptions")}),h.shouldShowAllowed&&(0,te.Y)(di.A,{narrow:!0,icon:"add-user",onClick:()=>{r({screen:b})},children:(0,te.FD)("div",{className:"multiline-item full-size",children:[(0,te.Y)("span",{className:"title",children:l("AlwaysAllow")}),(0,te.Y)("span",{className:"subtitle",children:g})]})}),h.shouldShowDenied&&(0,te.Y)(di.A,{narrow:!0,icon:"delete-user",onClick:()=>{r({screen:C})},children:(0,te.FD)("div",{className:"multiline-item full-size",children:[(0,te.Y)("span",{className:"title",children:l("NeverAllow")}),(0,te.Y)("span",{className:"subtitle",children:A})]})})]}),i&&(0,te.Y)(vh,{})]})}const Tu=(0,n.ph)((0,s.EK)((e,{screen:t})=>{let i,n;const{currentUserId:s,settings:{privacy:o,byKey:{shouldDisplayGiftsButton:r}}}=e,l=(0,c.vGo)(e,s);switch(t){case a.VS.PrivacyPhoneNumber:i=o.phoneNumber,n=o.addByPhone;break;case a.VS.PrivacyLastSeen:i=o.lastSeen;break;case a.VS.PrivacyProfilePhoto:i=o.profilePhoto;break;case a.VS.PrivacyBio:i=o.bio;break;case a.VS.PrivacyBirthday:i=o.birthday;break;case a.VS.PrivacyGifts:i=o.gifts;break;case a.VS.PrivacyPhoneP2P:case a.VS.PrivacyPhoneCall:i=o.phoneCall,n=o.phoneP2P;break;case a.VS.PrivacyForwarding:i=o.forwards;break;case a.VS.PrivacyVoiceMessages:i=o.voiceMessages;break;case a.VS.PrivacyGroupChats:i=o.chatInvite}return i?{primaryPrivacy:i,secondaryPrivacy:n,currentUserId:s,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto,isPremiumRequired:t===a.VS.PrivacyVoiceMessages&&!(0,c.g29)(e),shouldDisplayGiftsButton:r,isCurrentUserPremium:(0,c.g29)(e)}:{currentUserId:s,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto}})(({screen:e,isActive:t,primaryPrivacy:i,secondaryPrivacy:o,currentUserId:r,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c,isPremiumRequired:d,onReset:h,shouldDisplayGiftsButton:u,isCurrentUserPremium:m})=>{const{updateGlobalPrivacySettings:p,showNotification:v}=(0,s.ko)(),g=(0,Ui.A)();(0,Ce.A)({isActive:t,onBack:h});const A=(0,M.A)(()=>{m?p({shouldDisplayGiftsButton:!u}):v({message:g("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})}),f=(0,n.Kr)(()=>{switch(e){case a.VS.PrivacyPhoneCall:return a.VS.PrivacyPhoneP2P;case a.VS.PrivacyPhoneNumber:return"nobody"===i?.visibility?a.VS.PrivacyAddByPhone:void 0;default:return}},[i,e]);return(0,te.FD)("div",{className:"settings-content custom-scroll",children:[e===a.VS.PrivacyGifts&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.FD)(di.A,{onClick:A,children:[(0,te.Y)("span",{children:g("PrivacyDisplayGiftsButton")}),(0,te.Y)(bi.A,{id:"gift",disabled:!m,label:g(u?"HideGiftsButton":"DisplayGiftsButton"),checked:u})]}),(0,te.Y)("p",{className:"settings-item-description-larger",dir:g.isRtl?"rtl":void 0,children:g("PrivacyDisplayGiftIconInChats",{icon:(0,te.Y)(W.A,{name:"gift",className:"gift-icon"}),gift:g("PrivacyDisplayGift")},{withNodes:!0})})]}),(0,te.Y)(Mu,{screen:e,privacy:i,isPremiumRequired:d}),e===a.VS.PrivacyProfilePhoto&&"everybody"!==i?.visibility&&(0,te.Y)(Du,{currentUserId:r,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c}),e===a.VS.PrivacyLastSeen&&(0,te.Y)(Yu,{visibility:i?.visibility}),e===a.VS.PrivacyGifts&&(0,te.Y)(Pu,{}),Boolean(f)&&(0,te.Y)(Mu,{screen:f,privacy:o})]})})),Bu=[Kd.lw];function Ru(e,t){const{privacy:i}=e.settings;switch(t){case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyPhoneNumberDeniedContacts:return i.phoneNumber;case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyLastSeenDeniedContacts:return i.lastSeen;case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:return i.profilePhoto;case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyBioDeniedContacts:return i.bio;case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyBirthdayDeniedContacts:return i.birthday;case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyGiftsDeniedContacts:return i.gifts;case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:return i.phoneCall;case a.VS.PrivacyPhoneP2PAllowedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:return i.phoneP2P;case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyForwardingDeniedContacts:return i.forwards;case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:return i.voiceMessages;case a.VS.PrivacyGroupChatsDeniedContacts:case a.VS.PrivacyGroupChatsAllowedContacts:return i.chatInvite;case a.VS.PrivacyNoPaidMessages:return i.noPaidMessages}}const Lu=(0,n.ph)((0,s.EK)((e,{screen:t})=>({currentUserId:e.currentUserId,settings:Ru(e,t)}))(({isAllowList:e,withPremiumCategory:t,withMiniAppsCategory:i,screen:a,isActive:r,currentUserId:c,settings:d,usersOnly:h=!1,onReset:u})=>{const{setPrivacySettings:m}=(0,s.ko)(),p=(0,T.A)(),v=(0,Ui.A)(),g=(0,n.Kr)(()=>({isCustomPeer:!0,type:"bots",title:v("PrivacyValueBots"),avatarIcon:"bots",isAvatarSquare:!0,peerColorId:6}),[v]),A=(0,n.Kr)(()=>[g],[g]),f=(0,n.Kr)(()=>d?e?[...d.allowUserIds,...d.allowChatIds]:[...d.blockUserIds,...d.blockChatIds]:[],[e,d]),b=(0,n.Kr)(()=>d?d.shouldAllowPremium?[Kd.lw.type]:"allow"===d.botsPrivacy&&e?[g.type]:[]:[],[d,e,g]),[C,y]=(0,n.J0)(""),[S,k]=(0,n.J0)(!1),[w,N]=(0,n.J0)(f),[I,P]=(0,n.J0)(b);(0,n.vJ)(()=>{r||(N(f),P(b))},[r,b,f]);const Y=(0,Jd.Rh)(o.DSF),F=(0,Jd.Rh)(o._E9),D=(0,n.Kr)(()=>{const e=(0,s.mS)().chats.byId,t=(0,s.mS)().users.byId,i=(0,Ci.Am)([...Y||[],...F||[]]).filter(i=>{const n=e[i],s=t[i],a=s&&(0,l.PL)(s),r=n&&(0,l.WX)(n);return(!h||s)&&i!==c&&i!==o.zv8&&!r&&!a}),n=(0,Ft.PU)({ids:i,query:C});return C?n:(0,Ci.Am)([...f,...i])},[Y,F,f,C,c,h]),M=(0,n.hb)(e=>{P(e),k(!0)},[]),B=(0,n.hb)(e=>{N(e),k(!0)},[]),R=(0,n.hb)(()=>{m({privacyKey:Iu(a),isAllowList:Boolean(e),updatedIds:w,isPremiumAllowed:I.includes(Kd.lw.type)||void 0,botsPrivacy:i?I.includes(g.type)?"allow":"disallow":"none"}),u()},[e,i,I,w,u,a,g]);return(0,Ce.A)({isActive:r,onBack:u}),(0,te.FD)("div",{className:"NewChat-inner step-1",children:[(0,te.Y)(Si.A,{categories:t?Bu:i&&e?A:void 0,itemIds:D||[],selectedIds:w,selectedCategories:I,filterValue:C,filterPlaceholder:p(e?"AlwaysAllowPlaceholder":"NeverAllowPlaceholder"),categoryPlaceholderKey:"PrivacyUserTypes",searchInputId:"new-group-picker-search",isSearchable:!0,onSelectedIdsChange:B,onSelectedCategoriesChange:M,onFilterChange:y,allowMultiple:!0,itemInputType:"checkbox",withDefaultPadding:!0,withStatus:!0}),(0,te.Y)(Ni.A,{isShown:S,onClick:R,ariaLabel:p(e?"AlwaysAllow":"NeverAllow"),children:(0,te.Y)(W.A,{name:"check"})})]})})),xu=(0,n.ph)((0,s.EK)(e=>{const{config:t,reactions:i}=e;return{availableReactions:i.availableReactions,selectedReaction:t?.defaultReaction}})(({isActive:e,availableReactions:t,selectedReaction:i,onReset:a})=>{const{setDefaultReaction:o}=(0,s.ko)();(0,Ce.A)({isActive:e,onBack:a});const r=(0,n.Kr)(()=>(t||[]).filter(e=>!e.isInactive).map(e=>({label:(0,te.FD)(te.FK,{children:[(0,te.Y)(En.A,{reaction:e.reaction,availableReactions:t}),e.title]}),value:e.reaction.emoticon})),[t]),l=(0,n.hb)(e=>{o({reaction:{type:"emoji",emoticon:e}})},[o]);return(0,te.Y)("div",{className:"settings-content settings-item custom-scroll settings-quick-reaction",children:(0,te.Y)(ee.A,{name:"quick-reaction-settings",options:r,selected:"emoji"===i?.type?i.emoticon:void 0,onChange:l,withIcon:!0})})})),Eu=1.5*g.$,Vu=(0,n.ph)((0,s.EK)(e=>({...(0,Ci.Up)(e.settings.byKey,["shouldSuggestStickers","shouldUpdateStickerSetOrder"]),addedSetIds:e.stickers.added.setIds,customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,defaultReaction:e.config?.defaultReaction,availableReactions:e.reactions.availableReactions,canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({isActive:e,addedSetIds:t,customEmojiSetIds:i,stickerSetsById:o,defaultReaction:r,shouldSuggestStickers:l,shouldUpdateStickerSetOrder:c,availableReactions:d,canPlayAnimatedEmojis:h,onReset:u})=>{const{setSettingOption:m,openStickerSet:p,openSettingsScreen:v}=(0,s.ko)(),g=(0,T.A)(),A=(0,n.li)(),{observe:f}=(0,Dr.BL)({rootRef:A}),b=(0,n.hb)(e=>{p({stickerSetInfo:e.stickerSetInfo})},[p]),C=(0,n.hb)(e=>{m({shouldUpdateStickerSetOrder:e})},[m]),y=(0,n.hb)(e=>{m({shouldSuggestStickers:e})},[m]),S=(0,n.Kr)(()=>t&&Object.values((0,Ci.Up)(o,t)),[t,o]);return(0,Ce.A)({isActive:e,onBack:u}),(0,te.FD)("div",{className:"settings-content custom-scroll",children:[(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(ps.A,{label:g("SuggestStickers"),checked:l,onCheck:y}),(0,te.FD)(di.A,{narrow:!0,onClick:()=>v({screen:a.VS.CustomEmoji}),icon:"smile",children:[g("StickersList.EmojiItem"),i&&(0,te.Y)("span",{className:"settings-item__current-value",children:i.length})]}),r&&(0,te.FD)(di.A,{className:"SettingsDefaultReaction",narrow:!0,onClick:()=>v({screen:a.VS.QuickReaction}),children:[(0,te.Y)(En.A,{reaction:r,className:"current-default-reaction",size:Eu,availableReactions:d}),(0,te.Y)("div",{className:"title",children:g("DoubleTapSetting")})]})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("InstalledStickers.DynamicPackOrder")}),(0,te.Y)(ps.A,{label:g("InstalledStickers.DynamicPackOrder"),checked:c,onCheck:C}),(0,te.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:g("InstalledStickers.DynamicPackOrderInfo")})]}),S&&(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("ChooseStickerMyStickerSets")}),(0,te.Y)("div",{ref:A,children:S.map(e=>(0,te.Y)(Yh,{stickerSet:e,observeIntersection:f,onClick:b,noPlay:!h},e.id))}),(0,te.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:(0,Dt.A)(g("StickersBotInfo"),["links"])})]})]})})),_u=(0,n.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,s.ko)(),n=(0,T.A)(),r=(0,M.A)(()=>{i({screen:a.VS.Privacy})});return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(Zd.A,{size:o.r2x,tgsUrl:jr.w.Congratulations,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:n("TwoStepVerificationPasswordSetInfo")})]}),(0,te.Y)("div",{className:"settings-item settings-group",children:(0,te.Y)(Q.A,{onClick:r,children:n("TwoStepVerificationPasswordReturnSettings")})})]})});var Uu=i(79577);const Ou=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e).recoveryEmail;return{animatedEmoji:(0,c.oei)(e,"💌"),codeLength:e.twoFaSettings.waitingEmailCodeLength,recoveryEmail:t}})(({animatedEmoji:e,codeLength:t,isLoading:i,error:s,clearError:a,onSubmit:o,isActive:r,onReset:l,recoveryEmail:c})=>{const d=(0,n.li)(),{isMobile:h}=(0,Y.Ay)(),m=h?550:400,[p,v]=(0,n.J0)("");(0,n.vJ)(()=>{u.TF||setTimeout(()=>{d.current.focus()},m)},[m]);const g=(0,T.A)();(0,Ce.A)({isActive:r,onBack:l});const A=(0,n.hb)(e=>{s&&a&&a();const i=e.target.value.slice(0,t);i.length===t&&o(i),v(i),e.target.value=i},[a,t,s,o]);return(0,te.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(Uu.A,{sticker:e,size:160,className:"settings-content-icon"}),c&&(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:g("TwoStepAuth.ConfirmEmailDescription",c)})]}),(0,te.FD)("div",{className:"settings-item settings-group",children:[(0,te.Y)(Z.A,{value:p,ref:d,inputMode:"decimal",label:g("YourEmailCode"),error:s,onChange:A}),i&&(0,te.Y)($n.A,{})]})]})})),Ku=(0,n.ph)(({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,s.ko)(),n=(0,T.A)();return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Lock,previewUrl:ah,size:160,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:(0,Dt.A)(n("EnabledPasswordText"),["br"])})]}),(0,te.FD)("div",{className:"settings-item",children:[(0,te.Y)(di.A,{icon:"edit",onClick:()=>i({screen:a.VS.TwoFaChangePasswordCurrent}),children:n("ChangePassword")}),(0,te.Y)(di.A,{icon:"password-off",onClick:()=>i({screen:a.VS.TwoFaTurnOff}),children:n("TurnPasswordOff")}),(0,te.Y)(di.A,{icon:"email",onClick:()=>i({screen:a.VS.TwoFaRecoveryEmailCurrentPassword}),children:n("SetRecoveryEmail")})]})]})}),Ju=(0,n.ph)((0,s.EK)((e,{icon:t})=>({animatedEmoji:(0,c.oei)(e,"email"===t?"💌":"💡")}))(({animatedEmoji:e,type:t="text",isLoading:i,error:s,placeholder:a,shouldConfirm:o,clearError:r,onSubmit:l,isActive:c,onReset:d})=>{const h=(0,n.li)(),{isMobile:m}=(0,Y.Ay)(),p=m?550:400,[v,g]=(0,n.J0)(""),[A,f,b]=(0,F.A)(!1);(0,n.vJ)(()=>{u.TF||setTimeout(()=>{h.current.focus()},p)},[p]);const C=(0,n.hb)(e=>{s&&r&&r(),g(e.target.value)},[r,s]),y=(0,n.hb)(()=>{l()},[l]),S=(0,n.hb)(()=>{b(),l()},[l,b]),k=(0,T.A)();return(0,Ce.A)({isActive:c,onBack:d}),(0,te.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(Uu.A,{sticker:e,size:160,className:"settings-content-icon"}),"email"===t&&(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:k("RecoveryEmailSubtitle")})]}),(0,te.FD)("div",{className:"settings-item settings-group",children:[(0,te.FD)("form",{action:"",onSubmit:e=>{e.preventDefault(),h.current&&l(v)},children:[(0,te.Y)(Z.A,{ref:h,value:v,inputMode:t,label:a,error:s,onChange:C}),v?(0,te.Y)(Q.A,{type:"submit",isLoading:i,ripple:!0,children:k("Continue")}):(0,te.Y)(Q.A,{isText:!0,isLoading:i,ripple:!0,onClick:o?f:y,children:k("YourEmailSkip")})]}),o&&(0,te.FD)(X.A,{className:"narrow",isOpen:A,title:k("YourEmailSkipWarning"),onClose:b,children:[(0,Dt.A)(k("YourEmailSkipWarningText"),["br","simple_markdown"]),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{color:"danger",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:S,children:k("YourEmailSkip")}),(0,te.Y)(Q.A,{color:"primary",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:b,children:k("Cancel")})]})]})]})]})})),Gu=(0,n.ph)(({isActive:e,onReset:t,onStart:i})=>{const n=(0,T.A)();return(0,Ce.A)({isActive:e,onBack:t}),(0,te.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,te.FD)("div",{className:"settings-content-header no-border",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Lock,previewUrl:ah,size:160,className:"settings-content-icon"}),(0,te.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:n("SetAdditionalPasswordInfo")})]}),(0,te.Y)("div",{className:"settings-item settings-group",children:(0,te.Y)(Q.A,{onClick:i,children:n("EditAdminTransferSetPassword")})})]})}),ju=(0,n.ph)((0,s.EK)(e=>({...e.twoFaSettings}))(({currentScreen:e,shownScreen:t,state:i,hint:o,isLoading:r,errorKey:l,waitingEmailCodeLength:c,dispatch:d,isActive:h,onReset:u})=>{const{updatePassword:m,checkPassword:p,clearTwoFaError:v,updateRecoveryEmail:g,provideTwoFaEmailCode:A,clearPassword:f,openSettingsScreen:b}=(0,s.ko)(),C=(0,Ui.A)(),y=(0,T.A)();(0,n.vJ)(()=>{c&&(e===a.VS.TwoFaNewPasswordEmail?b({screen:a.VS.TwoFaNewPasswordEmailCode}):e===a.VS.TwoFaRecoveryEmail&&b({screen:a.VS.TwoFaRecoveryEmailCode}))},[e,c,b]);const S=(0,n.hb)(()=>{d({type:"reset"}),b({screen:a.VS.TwoFaNewPassword})},[d,b]),k=(0,n.hb)(e=>{d({type:"setPassword",payload:e}),b({screen:a.VS.TwoFaNewPasswordConfirm})},[d,b]),w=(0,n.hb)(()=>{b({screen:a.VS.TwoFaNewPasswordHint})},[b]),N=(0,n.hb)(e=>{d({type:"setHint",payload:e}),b({screen:a.VS.TwoFaNewPasswordEmail})},[d,b]),I=(0,n.hb)(e=>{d({type:"setEmail",payload:e}),m({...i,email:e,onSuccess:()=>{b({screen:a.VS.TwoFaCongratulations})}})},[d,i,m,b]),P=(0,n.hb)(e=>{d({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{b({screen:a.VS.TwoFaChangePasswordNew})}})},[p,d,b]),Y=(0,n.hb)(e=>{d({type:"setPassword",payload:e}),b({screen:a.VS.TwoFaChangePasswordConfirm})},[d,b]),F=(0,n.hb)(()=>{b({screen:a.VS.TwoFaChangePasswordHint})},[b]),D=(0,n.hb)(e=>{d({type:"setHint",payload:e}),m({...i,hint:e,onSuccess:()=>{b({screen:a.VS.TwoFaCongratulations})}})},[d,i,m,b]),M=(0,n.hb)(e=>{f({currentPassword:e,onSuccess:()=>{b({screen:a.VS.Privacy})}})},[f,b]),B=(0,n.hb)(e=>{d({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{b({screen:a.VS.TwoFaRecoveryEmail})}})},[p,d,b]),R=(0,n.hb)(e=>{d({type:"setEmail",payload:e}),g({...i,email:e,onSuccess:()=>{b({screen:a.VS.TwoFaCongratulations})}})},[d,i,g,b]),L=(0,n.hb)(e=>{A({code:e})},[A]);switch(e){case a.VS.TwoFaDisabled:return(0,te.Y)(Gu,{onStart:S,isActive:h||[a.VS.TwoFaNewPassword,a.VS.TwoFaNewPasswordConfirm,a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaNewPassword:return(0,te.Y)(nh,{placeholder:y("PleaseEnterPassword"),submitLabel:y("Continue"),onSubmit:k,isActive:h||[a.VS.TwoFaNewPasswordConfirm,a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaNewPasswordConfirm:return(0,te.Y)(nh,{expectedPassword:i.password,placeholder:y("PleaseReEnterPassword"),submitLabel:y("Continue"),onSubmit:w,isActive:h||[a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaNewPasswordHint:return(0,te.Y)(Ju,{icon:"hint",placeholder:y("PasswordHintPlaceholder"),onSubmit:N,isActive:h||[a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaNewPasswordEmail:return(0,te.Y)(Ju,{icon:"email",type:"email",isLoading:r,error:l&&C.withRegular(l),clearError:v,placeholder:y("RecoveryEmailTitle"),shouldConfirm:!0,onSubmit:I,isActive:h||[a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaNewPasswordEmailCode:return(0,te.Y)(Ou,{isLoading:r,error:l&&C.withRegular(l),clearError:v,onSubmit:L,isActive:h||t===a.VS.TwoFaCongratulations,onReset:u});case a.VS.TwoFaCongratulations:return(0,te.Y)(_u,{isActive:h,onReset:u});case a.VS.TwoFaEnabled:return(0,te.Y)(Ku,{isActive:h||[a.VS.TwoFaChangePasswordCurrent,a.VS.TwoFaChangePasswordNew,a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaTurnOff,a.VS.TwoFaRecoveryEmailCurrentPassword,a.VS.TwoFaRecoveryEmail,a.VS.TwoFaRecoveryEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaChangePasswordCurrent:return(0,te.Y)(nh,{isLoading:r,error:l&&C.withRegular(l),onClearError:v,hint:o,onSubmit:P,isActive:h||[a.VS.TwoFaChangePasswordNew,a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaChangePasswordNew:return(0,te.Y)(nh,{placeholder:y("PleaseEnterNewFirstPassword"),onSubmit:Y,isActive:h||[a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaChangePasswordConfirm:return(0,te.Y)(nh,{expectedPassword:i.password,placeholder:y("PleaseReEnterPassword"),onSubmit:F,isActive:h||[a.VS.TwoFaChangePasswordHint,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaChangePasswordHint:return(0,te.Y)(Ju,{isLoading:r,error:l&&C.withRegular(l),clearError:v,icon:"hint",placeholder:y("PasswordHintPlaceholder"),onSubmit:D,isActive:h||t===a.VS.TwoFaCongratulations,onReset:u});case a.VS.TwoFaTurnOff:return(0,te.Y)(nh,{isLoading:r,error:l&&C.withRegular(l),onClearError:v,hint:o,onSubmit:M,isActive:h,onReset:u});case a.VS.TwoFaRecoveryEmailCurrentPassword:return(0,te.Y)(nh,{isLoading:r,error:l&&C.withRegular(l),onClearError:v,hint:o,onSubmit:B,isActive:h||[a.VS.TwoFaRecoveryEmail,a.VS.TwoFaRecoveryEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaRecoveryEmail:return(0,te.Y)(Ju,{icon:"email",type:"email",placeholder:y("RecoveryEmailTitle"),onSubmit:R,isActive:h||[a.VS.TwoFaRecoveryEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:u});case a.VS.TwoFaRecoveryEmailCode:return(0,te.Y)(Ou,{isLoading:r,error:l&&C.withRegular(l),clearError:v,onSubmit:L,isActive:h||t===a.VS.TwoFaCongratulations,onReset:u});default:return}})),zu=Object.keys(a.VS).length/2,Hu=[a.VS.TwoFaDisabled,a.VS.TwoFaNewPassword,a.VS.TwoFaNewPasswordConfirm,a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations,a.VS.TwoFaEnabled,a.VS.TwoFaChangePasswordCurrent,a.VS.TwoFaChangePasswordNew,a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaTurnOff,a.VS.TwoFaRecoveryEmailCurrentPassword,a.VS.TwoFaRecoveryEmail,a.VS.TwoFaRecoveryEmailCode],$u=[a.VS.PasscodeDisabled,a.VS.PasscodeEnabled],qu=[a.VS.Folders,a.VS.FoldersCreateFolder,a.VS.FoldersEditFolder,a.VS.FoldersEditFolderFromChatList,a.VS.FoldersEditFolderInvites,a.VS.FoldersIncludedChats,a.VS.FoldersIncludedChatsFromChatList,a.VS.FoldersExcludedChats,a.VS.FoldersExcludedChatsFromChatList,a.VS.FoldersShare],Wu=[a.VS.PrivacyBlockedUsers,a.VS.ActiveWebsites],Qu=[a.VS.PrivacyPhoneNumberAllowedContacts,a.VS.PrivacyPhoneNumberDeniedContacts],Zu=[a.VS.PrivacyLastSeenAllowedContacts,a.VS.PrivacyLastSeenDeniedContacts],Xu=[a.VS.PrivacyProfilePhotoAllowedContacts,a.VS.PrivacyProfilePhotoDeniedContacts],em=[a.VS.PrivacyBioAllowedContacts,a.VS.PrivacyBioDeniedContacts],tm=[a.VS.PrivacyBirthdayAllowedContacts,a.VS.PrivacyBirthdayDeniedContacts],im=[a.VS.PrivacyGiftsAllowedContacts,a.VS.PrivacyGiftsDeniedContacts],nm=[a.VS.PrivacyPhoneCallAllowedContacts,a.VS.PrivacyPhoneCallDeniedContacts],sm=[a.VS.PrivacyPhoneP2PAllowedContacts,a.VS.PrivacyPhoneP2PDeniedContacts],am=[a.VS.PrivacyForwardingAllowedContacts,a.VS.PrivacyForwardingDeniedContacts],om=[a.VS.PrivacyVoiceMessagesAllowedContacts,a.VS.PrivacyVoiceMessagesDeniedContacts],rm=[a.VS.PrivacyGroupChatsAllowedContacts,a.VS.PrivacyGroupChatsDeniedContacts],lm=[a.VS.PrivacyNoPaidMessages],cm=(0,n.ph)(({isActive:e,currentScreen:t,foldersState:i,foldersDispatch:o,onReset:r,animationLevel:l,shouldSkipTransition:d})=>{const{closeShareChatFolderModal:h,openSettingsScreen:u}=(0,s.ko)(),m=(0,n.li)(),[p,v]=(0,Ed.A)(_d,Vd),[g,A]=(0,n.J0)("");(0,Ud.A)({containerRef:m,selector:".settings-content"},[t]);const f=(0,M.A)(e=>{const n=(0,c.nTw)((0,s.mS)()).shareFolderScreen?.isFromSettings;t===a.VS.FoldersShare&&h(),!0===e||void 0!==n&&!n?r(!0):(t!==a.VS.FoldersCreateFolder&&t!==a.VS.FoldersEditFolder&&t!==a.VS.FoldersEditFolderFromChatList&&t!==a.VS.FoldersEditFolderInvites||setTimeout(()=>{o({type:"reset"})},200),t!==a.VS.FoldersIncludedChats&&t!==a.VS.FoldersExcludedChats?r():"create"===i.mode?u({screen:a.VS.FoldersCreateFolder}):u({screen:a.VS.FoldersEditFolder}))});function b(n,s){const r={[a.VS.PrivacyPhoneNumber]:Qu.includes(s),[a.VS.PrivacyLastSeen]:Zu.includes(s),[a.VS.PrivacyProfilePhoto]:Xu.includes(s),[a.VS.PrivacyBio]:em.includes(s),[a.VS.PrivacyBirthday]:tm.includes(s),[a.VS.PrivacyGifts]:im.includes(s),[a.VS.PrivacyPhoneCall]:nm.includes(s),[a.VS.PrivacyPhoneP2P]:sm.includes(s),[a.VS.PrivacyForwarding]:am.includes(s),[a.VS.PrivacyVoiceMessages]:om.includes(s),[a.VS.PrivacyGroupChats]:rm.includes(s),[a.VS.PrivacyMessages]:lm.includes(s)},l=Hu.includes(s),c=$u.includes(s),d=qu.includes(s),h=Wu.includes(s)||l||c||Object.keys(r).map(Number).includes(s)||Object.values(r).includes(!0);switch(t){case a.VS.Main:return(0,te.Y)(mu,{isActive:e,onReset:f});case a.VS.EditProfile:return(0,te.Y)(Jh,{isActive:e&&n,onReset:f});case a.VS.General:return(0,te.Y)(Qh,{isActive:n||s===a.VS.GeneralChatBackgroundColor||s===a.VS.GeneralChatBackground||s===a.VS.QuickReaction||s===a.VS.CustomEmoji||h||d,onReset:f});case a.VS.QuickReaction:return(0,te.Y)(xu,{isActive:n,onReset:f});case a.VS.CustomEmoji:return(0,te.Y)(Fh,{isActive:n,onReset:f});case a.VS.Notifications:return(0,te.Y)(gu,{isActive:n,onReset:f});case a.VS.DataStorage:return(0,te.Y)(Dh,{isActive:n,onReset:f});case a.VS.Privacy:return(0,te.Y)(ku,{isActive:n||h,onReset:f});case a.VS.Language:return(0,te.Y)(cu,{isActive:n||s===a.VS.DoNotTranslate,onReset:f});case a.VS.DoNotTranslate:return(0,te.Y)(Rh,{isActive:n,onReset:f});case a.VS.Stickers:return(0,te.Y)(Vu,{isActive:n,onReset:f});case a.VS.Experimental:return(0,te.Y)($h,{isActive:n,onReset:f});case a.VS.GeneralChatBackground:return(0,te.Y)(iu,{isActive:n||s===a.VS.GeneralChatBackgroundColor,onReset:f});case a.VS.GeneralChatBackgroundColor:return(0,te.Y)(ru,{isActive:n,onReset:f});case a.VS.ActiveSessions:return(0,te.Y)(kh,{isActive:n,onReset:f});case a.VS.ActiveWebsites:return(0,te.Y)(Ph,{isActive:n,onReset:f});case a.VS.PrivacyBlockedUsers:return(0,te.Y)(Nu,{isActive:n,onReset:f});case a.VS.PrivacyPhoneNumber:case a.VS.PrivacyLastSeen:case a.VS.PrivacyProfilePhoto:case a.VS.PrivacyBio:case a.VS.PrivacyBirthday:case a.VS.PrivacyGifts:case a.VS.PrivacyPhoneCall:case a.VS.PrivacyForwarding:case a.VS.PrivacyVoiceMessages:case a.VS.PrivacyGroupChats:return(0,te.Y)(Tu,{screen:t,isActive:n||r[t],onReset:f});case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneP2PAllowedContacts:case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyGroupChatsAllowedContacts:case a.VS.PrivacyNoPaidMessages:return(0,te.Y)(Lu,{isAllowList:!0,usersOnly:t===a.VS.PrivacyNoPaidMessages,withPremiumCategory:t===a.VS.PrivacyGroupChatsAllowedContacts,withMiniAppsCategory:t===a.VS.PrivacyGiftsAllowedContacts,screen:t,isActive:n||r[t],onReset:f});case a.VS.PrivacyPhoneNumberDeniedContacts:case a.VS.PrivacyLastSeenDeniedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:case a.VS.PrivacyBioDeniedContacts:case a.VS.PrivacyBirthdayDeniedContacts:case a.VS.PrivacyGiftsDeniedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:case a.VS.PrivacyForwardingDeniedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:case a.VS.PrivacyGroupChatsDeniedContacts:return(0,te.Y)(Lu,{screen:t,isActive:n,onReset:f});case a.VS.PrivacyMessages:return(0,te.Y)(Ah,{isActive:n,onReset:f});case a.VS.Folders:case a.VS.FoldersCreateFolder:case a.VS.FoldersEditFolder:case a.VS.FoldersEditFolderFromChatList:case a.VS.FoldersEditFolderInvites:case a.VS.FoldersIncludedChats:case a.VS.FoldersIncludedChatsFromChatList:case a.VS.FoldersExcludedChats:case a.VS.FoldersExcludedChatsFromChatList:case a.VS.FoldersShare:return(0,te.Y)(eh,{currentScreen:t,shownScreen:s,state:i,dispatch:o,isActive:n,onReset:f});case a.VS.TwoFaDisabled:case a.VS.TwoFaNewPassword:case a.VS.TwoFaNewPasswordConfirm:case a.VS.TwoFaNewPasswordHint:case a.VS.TwoFaNewPasswordEmail:case a.VS.TwoFaNewPasswordEmailCode:case a.VS.TwoFaCongratulations:case a.VS.TwoFaEnabled:case a.VS.TwoFaChangePasswordCurrent:case a.VS.TwoFaChangePasswordNew:case a.VS.TwoFaChangePasswordConfirm:case a.VS.TwoFaChangePasswordHint:case a.VS.TwoFaTurnOff:case a.VS.TwoFaRecoveryEmailCurrentPassword:case a.VS.TwoFaRecoveryEmail:case a.VS.TwoFaRecoveryEmailCode:return(0,te.Y)(ju,{currentScreen:t,state:p,dispatch:v,shownScreen:s,isActive:n,onReset:f});case a.VS.PasscodeDisabled:case a.VS.PasscodeNewPasscode:case a.VS.PasscodeNewPasscodeConfirm:case a.VS.PasscodeChangePasscodeCurrent:case a.VS.PasscodeChangePasscodeNew:case a.VS.PasscodeChangePasscodeConfirm:case a.VS.PasscodeCongratulations:case a.VS.PasscodeEnabled:case a.VS.PasscodeTurnOff:return(0,te.Y)(lh,{currentScreen:t,passcode:g,onSetPasscode:A,shownScreen:s,isActive:n,onReset:f});case a.VS.Performance:return(0,te.Y)(Su,{isActive:n,onReset:f});default:return}}return(0,te.Y)(se.Ay,{ref:m,id:"Settings",name:(0,Vc.P)("layers",l,d),activeKey:t,renderCount:zu,shouldWrap:!0,withSwipeControl:!0,children:function(e,n,s,a){return(0,te.FD)(te.FK,{children:[(0,te.Y)(lu,{currentScreen:t,onReset:f,editedFolderId:i.folderId}),b(e,a)]})}})}),dm=(0,n.ph)((0,s.EK)(e=>{const{userIds:t}=e.contactList||{},{byId:i,statusesById:n}=e.users;return{usersById:i,userStatusesById:n,contactIds:t}})(({isActive:e,filter:t,usersById:i,userStatusesById:a,contactIds:o,onReset:r})=>{const{openChat:c,openNewContactDialog:d}=(0,s.ko)(),h=(0,T.A)(),{isMobile:u}=(0,Y.Ay)();(0,Ce.A)({isActive:e,onBack:r});const m=(0,n.hb)(e=>{c({id:e,shouldReplaceHistory:!0})},[c]),p=(0,n.Kr)(()=>{if(!o)return;const e=(0,Ft.PU)({ids:o,query:t,type:"user"});return(0,l.UB)(e,i,a)},[o,t,i,a]),[v,g]=(0,jn.A)(void 0,p,Boolean(t));return(0,te.FD)(Tn.A,{items:v,onLoadMore:g,className:"chat-list custom-scroll",children:[v?.length?v.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable contact-list-item",onClick:()=>m(e),children:(0,te.Y)(xn.A,{userId:e,forceShowSelf:!0,avatarSize:"large",ripple:!u})},e)):v&&!v.length?(0,te.Y)("p",{className:"no-results",dir:"auto",children:t.length?"No contacts matched your search.":"Contact list is empty."},"no-results"):(0,te.Y)($n.A,{},"loading"),(0,te.Y)(Ni.A,{isShown:!0,onClick:d,ariaLabel:h("CreateNewContact"),children:(0,te.Y)(W.A,{name:"add-user-filled"})},"create-new-contact")]})})),hm=(0,n.ph)((0,s.EK)(e=>{const{userIds:t}=e.contactList||{},{query:i,fetchingStatus:n,globalResults:s,localResults:a}=(0,c.nTw)(e).globalSearch,{peerIds:o}=s||{},{peerIds:r}=a||{};return{localContactIds:t,searchQuery:i,isSearching:n?.chats,globalPeerIds:o,localPeerIds:r}})(({isChannel:e,isActive:t,selectedMemberIds:i,localContactIds:a,searchQuery:o,isSearching:r,localPeerIds:c,globalPeerIds:d,onSelectedMemberIdsChange:h,onNextStep:u,onReset:m})=>{const{setGlobalSearchQuery:p}=(0,s.ko)(),v=(0,T.A)();(0,Ce.A)({isActive:t,onBack:m});const g=(0,n.hb)(e=>{p({query:e})},[]),A=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId,t=a?(0,Ft.PU)({ids:a,query:o,type:"user"}):[];return(0,Jn.A)((0,Ci.Am)([...t,...c||[],...d||[]]).filter(t=>{const i=e[t];return i&&!i.isSelf&&(i.canBeInvitedToGroup||!(0,l.tv)(i))}),!1,i)},[a,o,c,d,i]),f=(0,n.hb)(()=>{p({query:""}),u()},[u]);return(0,te.FD)("div",{className:"NewChat step-1",children:[(0,te.FD)("div",{className:"left-header",children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:m,ariaLabel:"Return to Chat List",children:(0,te.Y)(W.A,{name:"arrow-left"})}),(0,te.Y)("h3",{children:v("GroupAddMembers")})]}),(0,te.FD)("div",{className:"NewChat-inner step-1",children:[(0,te.Y)(Si.A,{itemIds:A,selectedIds:i,filterValue:o,filterPlaceholder:v("SendMessageTo"),searchInputId:"new-group-picker-search",isLoading:r,isSearchable:!0,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox",withDefaultPadding:!0,onSelectedIdsChange:h,onFilterChange:g}),(0,te.Y)(Ni.A,{isShown:!0,onClick:f,ariaLabel:e?"Continue To Channel Info":"Continue To Group Info",children:(0,te.Y)(W.A,{name:"arrow-right"})})]})]})})),um=(0,n.ph)((0,s.EK)(e=>{const{progress:t,error:i}=(0,c.nTw)(e).chatCreation||{};return{creationProgress:t,creationError:i,maxGroupSize:e.config?.maxGroupSize}})(({isChannel:e,isActive:t,memberIds:i,maxGroupSize:o,creationProgress:r,creationError:c,onReset:d})=>{const{createGroupChat:h,createChannel:u}=(0,s.ko)(),m=(0,T.A)();(0,Ce.A)({isActive:t,onBack:d});const[p,v]=(0,n.J0)(""),[g,A]=(0,n.J0)(""),[f,b]=(0,n.J0)(),[C,y]=(0,n.J0)(),S="Chat title can't be empty",k="Channel title can't be empty",w=r===a.n7.InProgress;(0,n.vJ)(()=>{if(e)return;if(!i.length||i.length>4)return void v("");const t=(0,s.mS)(),n=t.users.byId,a=[t.currentUserId,...i].map(e=>(0,l.u0)(n[e])).filter(Boolean),o=a.slice(0,-1).join(", ")+m("CreateGroup.PeersTitleLastDelimeter")+a[a.length-1];v(o)},[e,i,m]);const N=(0,n.hb)(e=>{const{value:t}=e.currentTarget,i=t.replace(/^\s+/,"");v(i),i!==t&&(e.currentTarget.value=i)},[]),I=(0,n.hb)(e=>{A(e.currentTarget.value)},[]),P=(0,n.hb)(()=>{p.length?o&&i.length>=o?y("Sorry, creating supergroups is not yet supported"):h({title:p,photo:f,memberIds:i}):y(S)},[p,i,o,h,f]),Y=(0,n.hb)(()=>{p.length?u({title:p,about:g,photo:f,memberIds:i,isChannel:!0}):y(k)},[p,u,g,f,i,k]);(0,n.vJ)(()=>{r===a.n7.Complete&&d(!0)},[r,d]);const F=c&&m(c)||(C!==S&&C!==k?C:void 0);return(0,te.FD)("div",{className:"NewChat",children:[(0,te.FD)("div",{className:"left-header",children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>d(),ariaLabel:"Return to member selection",children:(0,te.Y)(W.A,{name:"arrow-left"})}),(0,te.Y)("h3",{children:m(e?"NewChannel":"NewGroup")})]}),(0,te.FD)("div",{className:"NewChat-inner step-2",children:[(0,te.Y)(Uh.A,{onChange:b,title:m("AddPhoto")}),(0,te.Y)(Z.A,{value:p,onChange:N,label:m(e?"EnterChannelName":"GroupName"),error:C===S||C===k?C:void 0}),e&&(0,te.FD)(te.FK,{children:[(0,te.Y)(Z.A,{value:g,onChange:I,label:m("DescriptionOptionalPlaceholder")}),(0,te.Y)("p",{className:"note",children:m("DescriptionInfo")})]}),F&&(0,te.Y)("p",{className:"error",children:F}),i.length>0&&(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{className:"chat-members-heading",children:m("GroupInfo.ParticipantCount",i.length,"i")}),(0,te.Y)("div",{className:"chat-members-list custom-scroll",children:i.map(e=>(0,te.Y)(di.A,{inactive:!0,className:"chat-item-clickable",children:(0,te.Y)(xn.A,{userId:e})}))})]})]}),(0,te.Y)(Ni.A,{isShown:0!==p.length,onClick:e?Y:P,disabled:w,ariaLabel:e?m("ChannelIntro.CreateChannel"):"Create Group",children:w?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"arrow-right"})})]})})),mm=Object.keys(a.Bn).length/2,pm=(0,n.ph)(({isActive:e,isChannel:t=!1,content:i,animationLevel:o,onReset:r})=>{const{openLeftColumnContent:l,setGlobalSearchQuery:c}=(0,s.ko)(),[d,h]=(0,n.J0)([]),u=(0,n.hb)(()=>{l({contentKey:t?a.Bn.NewChannelStep2:a.Bn.NewGroupStep2})},[t]),m=(0,M.A)(e=>{const t=e.length>d.length;h(e),t&&c({query:""})});return(0,te.Y)(se.Ay,{id:"NewChat",name:(0,Vc.P)("layers",o),renderCount:mm,activeKey:i,children:n=>{switch(i){case a.Bn.NewChannelStep1:case a.Bn.NewGroupStep1:return(0,te.Y)(hm,{isChannel:t,isActive:e,selectedMemberIds:d,onSelectedMemberIdsChange:m,onNextStep:u,onReset:r});case a.Bn.NewChannelStep2:case a.Bn.NewGroupStep2:return(0,te.Y)(um,{isChannel:t,isActive:n&&e,memberIds:d,onReset:r});default:return}}})}),vm="HMp3KTKQ",gm="unYkDic1",Am="dZJGfaXC",fm=250,bm=.25*g.$,Cm=11,ym=.1875*g.$,Sm=.125*g.$,km=new Set;function wm(e){let t=document.getElementById("LeftColumn");if(t&&e&&(t=t.querySelector(".ArchivedChats")),!t)return{};const i=t.querySelector("#StoryToggler"),n=t.querySelector("#StoryRibbon"),s=t.querySelector(".left-header"),a=n?.querySelectorAll(`.${xt}`),o=i?.querySelectorAll(".Avatar");return{container:t,toggler:i,leftMainHeader:s,ribbonPeers:a,toggleAvatars:o}}function Nm(e){const t=e.cloneNode(!0);t.classList.add("E1IeDpeb"),t.classList.remove("animating"),t.draggable=!1,t.oncontextmenu=y.A;const i=e.querySelector("canvas");if(i){const e=t.querySelector("canvas");e?.getContext("2d")?.drawImage(i,0,0)}return t}function Im(e){return e?.getAttribute("data-peer-id")}function Pm(e,t){return e?.querySelector(`[data-peer-id="${t}"]`)}function Ym(e,t){const i=setTimeout(e,t);return()=>{clearTimeout(i),e()}}function Fm(){km.forEach(e=>e()),km.clear()}var Dm=i(11462),Mm=i(24920);const Tm=(0,n.ph)(function({peer:e,isArchived:t}){const{openChat:i,openChatWithInfo:o,openStoryViewer:r,toggleStoriesHidden:l}=(0,s.ko)(),c=(0,T.A)(),d=(0,n.li)(),h="isSelf"in e&&e.isSelf,u=!(0,v.L8)(e.id);nn(e.id);const{isContextMenuOpen:m,contextMenuAnchor:p,handleBeforeContextMenu:g,handleContextMenu:A,handleContextMenuClose:f,handleContextMenuHide:b}=(0,Ds.A)(d),C=(0,M.A)(()=>d.current),y=(0,M.A)(()=>document.body),S=(0,M.A)(()=>d.current.querySelector(".story-peer-context-menu .bubble")),k=(0,M.A)(()=>({withPortal:!0,isDense:!0})),w=(0,M.A)(()=>{m||r({peerId:e.id,origin:a.G9.StoryRibbon})}),N=(0,M.A)(e=>{(0,_r.u)(e),g(e)}),I=(0,M.A)(()=>{o({id:e.id,shouldReplaceHistory:!0,profileTab:"stories"})}),P=(0,M.A)(()=>{o({id:e.id,shouldReplaceHistory:!0,profileTab:"storiesArchive"})}),Y=(0,M.A)(()=>{i({id:e.id,shouldReplaceHistory:!0})}),F=(0,M.A)(()=>{o({id:e.id,shouldReplaceHistory:!0})}),D=(0,M.A)(()=>{l({peerId:e.id,isHidden:!t})});return(0,te.FD)("div",{ref:d,role:"button","data-peer-id":e.id,tabIndex:0,className:xt,onMouseDown:N,onClick:w,onContextMenu:A,children:[(0,te.Y)(Mt.A,{peer:e}),(0,te.Y)("div",{className:(0,me.A)("BDZrSTO_",e.hasUnreadStories&&"OoUm5AUZ"),children:h?c("MyStory"):(0,Ft.F9)(c,e)}),void 0!==p&&(0,te.Y)(qe.A,{isOpen:m,anchor:p,getTriggerElement:C,getRootElement:y,getMenuElement:S,getLayout:k,className:(0,me.A)("story-peer-context-menu","N1sagA0s"),autoClose:!0,withPortal:!0,onClose:f,onCloseAnimationEnd:b,children:h?(0,te.FD)(te.FK,{children:[(0,te.Y)(de.A,{onClick:I,icon:"play-story",children:c("StoryList.Context.SavedStories")}),(0,te.Y)(de.A,{onClick:P,icon:"archive",children:c("StoryList.Context.ArchivedStories")})]}):(0,te.FD)(te.FK,{children:[!u&&(0,te.Y)(de.A,{onClick:Y,icon:"message",children:c("SendMessageTitle")}),u?(0,te.Y)(de.A,{onClick:F,icon:"channel",children:c("ChatList.ContextOpenChannel")}):(0,te.Y)(de.A,{onClick:F,icon:"user",children:c("StoryList.Context.ViewProfile")}),(0,te.Y)(de.A,{onClick:D,icon:t?"unarchive":"archive",children:c(t?"StoryList.Context.Unarchive":"StoryList.Context.Archive")})]})})]})}),Bm=(0,n.ph)((0,s.EK)((e,{isArchived:t})=>{const{orderedPeerIds:{active:i,archived:n}}=e.stories;return{orderedPeerIds:t?n:i,usersById:e.users.byId,chatsById:e.chats.byId}})(function({isArchived:e,className:t,orderedPeerIds:i,usersById:s,chatsById:a,isClosing:o}){const r=(0,T.A)(),l=(0,me.A)(Lt,!i.length&&"lnVtxMZI",o&&"EZbKn_M3",t,"no-scrollbar"),c=(0,n.li)();return(0,xs.A)(c,(0,Y.Ny)()),(0,te.Y)("div",{ref:c,id:"StoryRibbon",className:l,dir:r.isRtl?"rtl":void 0,children:i.map(t=>{const i=s[t]||a[t];if(i)return(0,te.Y)(Tm,{peer:i,isArchived:e},t)})})}));var Rm=i(34201);const Lm=(0,n.ph)((0,s.EK)((e,{isArchived:t})=>{const{orderedPeerIds:{archived:i,active:n},byPeerId:s}=e.stories,{storyViewer:{isRibbonShown:a,isArchivedRibbonShown:o}}=(0,c.nTw)(e),r=(0,c.clw)(e),l=(0,c.xYJ)(e,"storyRibbonAnimations");return{currentUserId:e.currentUserId,orderedPeerIds:t?i:n,isShown:t?!o:!a,isForumPanelOpen:r,withAnimation:l,usersById:e.users.byId,chatsById:e.chats.byId,peerStories:s}})(function({currentUserId:e,orderedPeerIds:t,usersById:i,chatsById:a,canShow:l,isShown:c,isForumPanelOpen:d,isArchived:h,withAnimation:u,peerStories:m}){const{toggleStoryRibbon:p}=(0,s.ko)(),v=(0,T.A)(),g=(0,n.Kr)(()=>1===t.length?[i[t[0]]||a[t[0]]]:t.map(e=>i[e]||a[e]).filter(t=>t&&t.id!==e).slice(0,o.dqH).reverse(),[e,t,i,a]),A=((0,n.Kr)(()=>g?.length?g.reduce((e,t)=>{const i=m[t.id];if(!i)return e;const n=i.orderedIds.some(e=>{const t=i.byId[e];if(!t||!("isForCloseFriends"in t))return!1;const n=i.lastReadId&&t.id<=i.lastReadId;return t.isForCloseFriends&&!n});return e[t.id]=n,e},{}):{},[m,g]),(0,n.Kr)(()=>t.slice(0,5),[t]));nn(A);const f=l&&c,{ref:b,shouldRender:y}=(0,Rm.A)({isOpen:f,className:"slow",withShouldRender:!0});if((0,n.vJ)(()=>{u&&!d&&(f?((0,n.VK)(fm+o.xB5),function(e){Fm();const{container:t,toggler:i,toggleAvatars:n,ribbonPeers:s,leftMainHeader:a}=wm(e);if(!(i&&n&&s&&t&&a))return;const{right:l}=a.getBoundingClientRect(),c=n[0],d=n[n.length-1],h=Im(c);Array.from(s).reverse().forEach((e,n,{length:s})=>{const a=Im(e);if(!a)return;const u=a===h;let m=Pm(i,a),p=Cm+n+1;if(m||(m=n===s-1?d:c,p=Cm),!m)return;const{top:v,left:g,width:A}=e.getBoundingClientRect();let{left:f,width:b,top:y}=m.getBoundingClientRect();if(g>l)return;f-=ym,b+=2*ym;const S=f-g,k=y-v-Sm,w=b/A;y-=ym;const N=g-f+2*ym,I=v-y+ym,P=A/(b+2*ym);(0,r.RK)(()=>{const i=Nm(e);let n;p>Cm?(n=Nm(m),u&&n.classList.add(Am)):i.classList.add(vm,gm),(0,C.ZM)(i,{top:`${v}px`,left:`${g}px`,width:`${A}px`,zIndex:String(p)}),n&&(0,C.ZM)(n,{top:`${y}px`,left:`${f}px`,zIndex:String(p),opacity:"0",transform:`translate3d(${N}px, ${I}px, 0) scale(${P})`}),e.classList.add("animating"),m.classList.add("animating"),t.appendChild(i),n&&t.appendChild(n),(0,r.RK)(()=>{(0,C.ZM)(i,{opacity:n?"0":"",transform:`translate3d(${S}px, ${k}px, 0) scale(${w})`}),n?(0,C.ZM)(n,{opacity:"",transform:""}):i.classList.remove(gm);const s=Ym(()=>{(0,r.RK)(()=>{t.contains(i)&&t.removeChild(i),n&&t.contains(n)&&t.removeChild(n),e.classList.remove("animating"),m.classList.remove("animating")}),km.delete(s)},fm+o.xB5);km.add(s)})})})}(h)):((0,n.VK)(fm+o.xB5),function(e){Fm();const{container:t,toggler:i,leftMainHeader:n,ribbonPeers:s,toggleAvatars:a}=wm(e);if(!(i&&a&&s&&t&&n))return;const{bottom:l,right:c}=n.getBoundingClientRect(),d=l+bm,h=a[0],u=a[a.length-1],m=Im(h);Array.from(s).reverse().forEach((e,n,{length:s})=>{const a=Im(e);if(!a)return;const l=a===m;let p=Pm(i,a),v=Cm+n+1;if(p||(p=n===s-1?u:h,v=Cm),!p)return;let{top:g,left:A,width:f}=p.getBoundingClientRect();const{left:b,width:y}=e.getBoundingClientRect();if(b>c)return;A-=ym,f+=2*ym;const S=A-b,k=g-d,w=f/y;g-=ym;const N=b-A+2*ym,I=d-g+ym,P=y/(f+2*ym);(0,r.RK)(()=>{if(!p)return;const i=Nm(e);let n;v>Cm?(n=Nm(p),l&&n.classList.add(Am)):i.classList.add(vm),(0,C.ZM)(i,{top:`${d}px`,left:`${b}px`,zIndex:String(v),opacity:n?"0":"",transform:`translate3d(${S}px, ${k}px, 0) scale(${w})`}),n&&(0,C.ZM)(n,{top:`${g}px`,left:`${A}px`,zIndex:String(v)}),t.appendChild(i),n&&t.appendChild(n),p.classList.add("animating"),e.classList.add("animating"),(0,r.RK)(()=>{(0,C.ZM)(i,{opacity:"",transform:""}),n?(0,C.ZM)(n,{opacity:"0",transform:`translate3d(${N}px, ${I}px, 0) scale(${P})`}):i.classList.add(gm);const s=Ym(()=>{(0,r.RK)(()=>{t.contains(i)&&t.removeChild(i),n&&t.contains(n)&&t.removeChild(n),p?.classList.remove("animating"),e.classList.remove("animating"),km.delete(s)})},fm+o.xB5);km.add(s)})})})}(h)))},[h,f,u,d]),y)return(0,te.Y)("button",{ref:b,type:"button",id:"StoryToggler",className:"QOz6fQFU","aria-label":v("Chat.Context.Peer.OpenStory"),onClick:()=>p({isShown:!0,isArchived:h}),dir:v.isRtl?"rtl":void 0,children:g.map(e=>(0,te.Y)(Mt.A,{peer:e,size:"tiny",className:"dXSy0i2c"},e.id))})}));var xm=i(51067),Em=i(90054);const Vm=(0,n.ph)(({isActive:e,isForumPanelOpen:t,archiveSettings:i,isStoryRibbonShown:n,onReset:a,onTopicSearch:r,foldersDispatch:l})=>{const{updateArchiveSettings:c}=(0,s.ko)(),d=(0,T.A)();(0,Ce.A)({isActive:e,onBack:a});const h=(0,M.A)(()=>{c({isHidden:!1})}),{shouldDisableDropdownMenuTransitionRef:u,handleDropdownMenuTransitionEnd:m}=(0,Mm.A)(t),{shouldRender:p,transitionClassNames:v}=(0,Ke.A)(!t,void 0,void 0,!1),{shouldRenderForumPanel:g,handleForumPanelAnimationEnd:A,handleForumPanelAnimationStart:f,isAnimationStarted:b}=(0,Dm.A)(t),C=t&&b,{shouldRender:y,transitionClassNames:S,isClosing:k}=(0,Ke.A)(n,void 0,void 0,"",!1,fm+o.xB5);return(0,te.FD)("div",{className:"ArchivedChats",children:[(0,te.FD)("div",{className:(0,me.A)("left-header",!y&&"left-header-shadow"),children:[d.isRtl&&(0,te.Y)("div",{className:"DropdownMenuFiller"}),(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:a,ariaLabel:"Return to chat list",className:(0,me.A)(d.isRtl&&"rtl",C&&d.isRtl&&"right-aligned",u.current&&d.isRtl&&"disable-transition"),onTransitionEnd:m,children:(0,te.Y)(W.A,{name:"arrow-left"})}),p&&(0,te.Y)("h3",{className:v,children:d("ArchivedChats")}),(0,te.Y)("div",{className:"story-toggler-wrapper",children:(0,te.Y)(Lm,{canShow:!0,isArchived:!0})}),i.isHidden&&(0,te.Y)(ce.A,{className:"archived-chats-more-menu",positionX:"right",onTransitionEnd:d.isRtl?m:void 0,children:(0,te.Y)(de.A,{icon:"archive-from-main",onClick:h,children:d("lng_context_archive_to_list")})})]}),(0,te.FD)("div",{className:(0,me.A)("chat-list-wrapper",y&&"with-story-ribbon",S),children:[y&&(0,te.Y)(Bm,{isArchived:!0,className:"left-header-shadow",isClosing:k}),(0,te.Y)(xm.A,{folderType:"archived",isActive:e,isForumPanelOpen:C,isMainList:!0,foldersDispatch:l,archiveSettings:i})]}),g&&(0,te.Y)(Em.A,{isOpen:t,onTopicSearch:r,onOpenAnimationStart:f,onCloseAnimationEnd:A})]})}),_m=(0,n.ph)((0,s.EK)(e=>{const{byId:t,orderedIds:i}=e.chatFolders;return{foldersById:t,folderOrderedIds:i}})(({isOpen:e,chatId:t,foldersById:i,folderOrderedIds:a,onClose:r,onCloseAnimationEnd:l})=>{const{editChatFolders:c}=(0,s.ko)(),d=(0,T.A)(),h=(0,n.Kr)(()=>i?Object.keys(i).reduce((e,n)=>{const{includedChatIds:s,pinnedChatIds:a}=i[Number(n)];return(s.includes(t)||a?.includes(t))&&e.push(n),e},[]):[],[t,i]),[u,m]=(0,n.J0)(h),p=(0,n.Kr)(()=>a?.filter(e=>e!==o.DSF).map(e=>{const t=i?i[e]:void 0;return{label:t?(0,un.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}):"",value:String(e)}})||[],[a,i]),v=(0,n.hb)(()=>{const e=h.filter(e=>!u.includes(e)).map(Number),i=u.filter(e=>!h.includes(e)).map(Number);c({chatId:t,idsToRemove:e,idsToAdd:i}),r()},[t,c,h,r,u]);if(i&&a)return(0,te.FD)(X.A,{isOpen:e,onClose:r,onCloseAnimationEnd:l,onEnter:v,className:(0,me.A)("_fJBBCCE","delete"),contentClassName:"EG5lPWY1",title:d("FilterAddTo"),children:[(0,te.Y)("div",{className:(0,me.A)("heYMHiUt","custom-scroll"),children:(0,te.Y)(gc.A,{options:p,selected:u,onChange:m})}),(0,te.Y)("div",{className:"_jtqAaUU",children:(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:v,children:d("FilterAddTo")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:r,children:d("Cancel")})]})})]})}));var Um=function(e){return e.OneHour="3600",e.FourHours="14400",e.EightHours="28800",e.OneDay="86400",e.ThreeDays="259200",e.Forever="-1",e}(Um||{});const Om=(0,n.ph)(({isOpen:e,chatId:t,topicId:i,onClose:a,onCloseAnimationEnd:r})=>{const[l,c]=(0,n.J0)(Um.Forever),{updateChatMutedState:d,updateTopicMutedState:h}=(0,s.ko)(),u=(0,T.A)(),m=(0,n.Kr)(()=>[{label:u("MuteFor.Hours",1),value:Um.OneHour},{label:u("MuteFor.Hours",4),value:Um.FourHours},{label:u("MuteFor.Hours",8),value:Um.EightHours},{label:u("MuteFor.Days",1),value:Um.OneDay},{label:u("MuteFor.Days",3),value:Um.ThreeDays},{label:u("MuteFor.Forever"),value:Um.Forever}],[u]),p=(0,n.hb)(()=>{let e;e=l===Um.Forever?o.xEh:Math.floor(Date.now()/1e3)+Number(l),i?h({chatId:t,topicId:i,mutedUntil:e}):d({chatId:t,mutedUntil:e}),a()},[t,l,a,i]);return(0,te.FD)(X.A,{isOpen:e,onClose:a,onCloseAnimationEnd:r,onEnter:p,className:"delete",title:u("Notifications"),children:[(0,te.Y)(ee.A,{className:"dialog-checkbox-group",name:"muteFor",options:m,selected:l,onChange:c}),(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(Q.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:p,children:u("Common.Done")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:a,children:u("Cancel")})]})]})});var Km=i(99515),Jm=i(24531);const Gm=(0,n.ph)((0,s.EK)((e,{fromSticker:t,stickerSetShortName:i})=>{const n=(0,c.Xf0)(e),{chatId:s,threadId:a}=n||{},o=s&&(0,c.hds)(e,s),r=s?(0,c.AWZ)(e,s):void 0,d=s&&(0,c.yps)(e,s),h=s?(0,c.nZ4)(e,s):void 0,u=o?(0,l.Q_)(o,r,Boolean(d),h):void 0,m=s&&a?(0,c.Vw0)(e,s,a):void 0,p=Boolean(!m?.isCommentsInfo&&m?.fromChannelId),v=s&&a?(0,c.S0q)(e,s,a):void 0,g=Boolean(o&&a&&(0,l.__)(o,v,p,r)&&u?.canSendStickers),A=t?t.stickerSetInfo:i?{shortName:i}:void 0,f=A?(0,c.ycM)(e,A):void 0,b=s?(0,c.WA9)(e,s):void 0;return{canScheduleUntilOnline:Boolean(s)&&(0,c.RBq)(e,s),canSendStickers:g,isSavedMessages:h,shouldSchedule:!b&&(0,c.PIP)(e),stickerSet:f,isCurrentUserPremium:(0,c.g29)(e),shouldUpdateStickerSetOrder:e.settings.byKey.shouldUpdateStickerSetOrder,currentMessageList:n}})(({isOpen:e,fromSticker:t,stickerSetShortName:i,stickerSet:a,canSendStickers:r,canScheduleUntilOnline:l,shouldSchedule:c,isSavedMessages:d,isCurrentUserPremium:h,shouldUpdateStickerSetOrder:u,currentMessageList:m,onClose:p})=>{const{loadStickers:v,toggleStickerSet:g,sendMessage:A,showNotification:f}=(0,s.ko)(),b=(0,n.li)(),C=(0,n.li)(),y=(0,T.A)(),{isMobile:S}=(0,Y.Ay)(),k=(0,_.A)(a),w=a||k,N=Boolean(!w?.isArchived&&w?.installedDate),I=w?.isEmoji,[P,F]=(0,Jm.A)(l),{handleScroll:D,isAtBeginning:M}=Mn(),{observe:B}=(0,Dr.BL)({rootRef:b,throttleMs:200,isDisabled:!e});(0,n.vJ)(()=>{e&&!w?.stickers&&v({stickerSetInfo:t?t.stickerSetInfo:{shortName:i}})},[e,t,v,i,w]);const R=(0,n.hb)((e,t,i)=>{m&&(e={...e,isPreloadedGlobally:!0},c||i?P(i=>{A({messageList:m,sticker:e,isSilent:t,scheduledAt:i}),p()}):(A({messageList:m,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:u&&N}),p()))},[m,c,P,p,u,N]),L=(0,n.hb)(()=>{w&&(g({stickerSetId:w.id}),p())},[p,w,g]),x=(0,n.hb)(()=>{if(!w)return;const{shortName:e}=w,t=I?"addemoji":"addstickers",i=`${o.jsp}${t}/${e}`;(0,Rc.eM)(i),f({message:y("LinkCopied")})},[I,y,w,f]),E=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.Y)(Q.A,{round:!0,ripple:!S,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",children:(0,te.Y)(W.A,{name:"more"})}),[S]);return(0,te.FD)(X.A,{className:(0,me.A)("StickerSetModal",I&&"custom-emoji"),isOpen:e,onClose:p,header:function(){const e=(0,me.A)("modal-header",!M&&"with-top-border");return(0,te.FD)("div",{className:e,dir:y.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:y("Close"),onClick:p,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"modal-title",children:w?(0,Dt.A)(w.title,["emoji","links"]):y("AccDescrStickerSet")}),(0,te.Y)(ce.A,{className:"stickers-more-menu with-menu-transitions",trigger:E,positionX:"right",children:(0,te.Y)(de.A,{icon:"copy",onClick:x,children:y("StickersCopy")})})]})}(),children:[w?.stickers?(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{ref:b,className:"stickers custom-scroll",onScroll:D,children:(0,te.FD)("div",{className:"shared-canvas-container stickers-grid",children:[(0,te.Y)("canvas",{ref:C,className:"shared-canvas"}),w.stickers.map(e=>(0,te.Y)(Kr,{sticker:e,size:I?o.$nk:o.GhT,observeIntersection:B,onClick:r&&!I?R:void 0,clickArg:e,isSavedMessages:d,isCurrentUserPremium:h,sharedCanvasRef:C}))]})}),(0,te.Y)("div",{className:"button-wrapper",children:(0,te.Y)(Q.A,{fluid:!0,color:N?"danger":"primary",onClick:L,children:(()=>{if(!w)return y("Loading");const e=I?"Emoji":"Sticker";return y(N?`StickerPack.Remove${e}Count`:`StickerPack.Add${e}Count`,w.count,"i")})()})})]}):(0,te.Y)($n.A,{}),F]})})),jm={root:"nZYT4vJ3",sets:"JzkmXjFF"},zm=(0,n.ph)((0,s.EK)(e=>({canPlayAnimatedEmojis:(0,c.BWX)(e)}))(({customEmojiSetIds:e,canPlayAnimatedEmojis:t,onClose:i})=>{const{openStickerSet:a}=(0,s.ko)(),o=(0,T.A)(),r=(0,n.Kr)(()=>e?.map(e=>(0,s.mS)().stickers.setsById[e]),[e]),l=(0,n.li)(),{observe:c}=(0,Dr.BL)({rootRef:l,isDisabled:!r}),d=(0,_.A)(r),h=r||d,u=(0,M.A)(e=>{a({stickerSetInfo:e.stickerSetInfo})});return(0,te.Y)(X.A,{isOpen:Boolean(r),className:jm.root,onClose:i,hasCloseButton:!0,title:o("lng_custom_emoji_used_sets"),children:(0,te.Y)("div",{className:(0,me.A)(jm.sets,"custom-scroll"),ref:l,teactFastList:!0,children:h?.map(e=>(0,te.Y)(Yh,{className:jm.setCard,stickerSet:e,onClick:u,observeIntersection:c,noPlay:!t},e.id))})})}));var Hm=i(54314),$m=i(60859);const qm={settings:{icon:"bots",label:"BotSettings"},help:{icon:"help",label:"BotHelp"}},Wm=(0,n.ph)((0,s.EK)((e,{chatId:t,threadId:i})=>{const n=(0,c.hds)(e,t),s=(0,c._ls)(e,t);if(!n||s)return{};const a=(0,v.L8)(n.id),o=a?(0,c.mBe)(e,t):void 0,r=o&&(0,l.Gh)(o),d=i===O.l3,h=(0,c.nZ4)(e,t),{chatId:u,threadId:m}=(0,c.Xf0)(e)||{},p=d&&!o&&((0,l.WX)(n)||(0,l.YE)(n))&&!(0,l.SJ)(n),g=(0,l.DX)(t)?void 0:(0,c.yps)(e,t),A=a?(0,c.vGo)(e,t):void 0,f=a?void 0:(0,c.AWZ)(e,t),b=A||f,C=(0,c.X2D)(e,t),y=(0,c.S0q)(e,t,i),S=n.isForum&&(n.isCreator||!(0,l.Sq)(n,"manageTopics")||(0,l.ub)(n,"manageTopics")),k=y&&(0,l.l1)(n,y),w=(0,c.e5V)(e,t),N=(0,c.jGY)(e,t)&&b?.isTranslationDisabled,I=(0,l.cG)(t,i,e.currentUserId)?(0,c.hds)(e,String(i)):void 0,P=(0,c.trm)(e);return{chat:n,isMuted:(0,Hc.If)(n,(0,c.K52)(e),(0,c.P5N)(e,n.id)),isPrivate:a,isTopic:n?.isForum&&!d,isForum:n?.isForum,isForumAsMessages:n?.isForumAsMessages,canAddContact:r,canDeleteChat:(0,l.IC)(n),canReportChat:p,canGift:C,hasLinkedChat:Boolean(f?.linkedChatId),botCommands:g?A?.botInfo?.commands:void 0,botPrivacyPolicyUrl:g?A?.botInfo?.privacyPolicyUrl:void 0,isChatInfoShown:(0,c.nTw)(e).isChatInfoShown&&u===t&&m===i,canCreateTopic:S,canEditTopic:k,canManage:w,isRightColumnShown:(0,c.gjV)(e),canTranslate:N,isBlocked:A?.isBlocked,isBot:Boolean(g),isChatWithSelf:h,savedDialog:I,disallowedGifts:A?.disallowedGifts,isAccountFrozen:P}})(({chatId:e,threadId:t,isOpen:i,withExtraActions:a,anchor:r,isChannel:l,botCommands:c,botPrivacyPolicyUrl:d,withForumActions:h,isTopic:u,isForum:m,isForumAsMessages:p,isChatInfoShown:v,canStartBot:g,canSubscribe:A,canReportChat:f,canSearch:b,canCall:C,canMute:y,canViewStatistics:S,canViewMonetization:k,canViewBoosts:w,pendingJoinRequests:N,canLeave:I,canEnterVoiceChat:P,canCreateVoiceChat:D,chat:B,isPrivate:R,isMuted:L,canDeleteChat:x,canGift:E,hasLinkedChat:V,canAddContact:_,canCreateTopic:U,canEditTopic:O,canManage:K,isRightColumnShown:J,canTranslate:G,isBlocked:j,isBot:z,isChatWithSelf:H,savedDialog:$,canShowBoostModal:q,disallowedGifts:W,isAccountFrozen:Q,channelMonoforumId:Z,onJoinRequestsClick:X,onSubscribeChannel:ee,onSearchClick:ie,onAsMessagesClick:ne,onClose:se,onCloseAnimationEnd:ae})=>{const{updateChatMutedState:oe,enterMessageSelectMode:re,sendBotCommand:le,restartBot:ce,requestMasterAndJoinGroupCall:he,createGroupCall:ue,openLinkedChat:me,openAddContactDialog:pe,openFrozenAccountModal:ve,requestMasterAndRequestCall:ge,toggleStatistics:Ae,openMonetizationStatistics:fe,openBoostStatistics:be,openGiftModal:Ce,openThreadWithInfo:ye,openCreateTopicPanel:Se,openEditTopicPanel:ke,openChat:we,openUrl:Ne,toggleManagement:Ie,togglePeerTranslations:Pe,blockUser:Ye,unblockUser:Fe,setViewForumAsMessages:De,openBoostModal:Me,reportMessages:Te,showNotification:Be}=(0,s.ko)(),Re=(0,T.A)(),Le=(0,Ui.A)(),{isMobile:xe}=(0,Y.Ay)(),[Ee,Ve]=(0,n.J0)(!0),[_e,Ue]=(0,n.J0)(!1),[Oe,Je]=(0,n.J0)(!1),[Ge,je]=(0,n.J0)(!1),[ze,He,$e]=(0,F.A)(),{x:We,y:Qe}=r;(0,Ke.A)(i,ae,void 0,!1);const Ze=(0,dn.A)(!(v||!m)||void 0,200),Xe=(0,n.Kr)(()=>{if(W)return Object.values(W).every(Boolean)},[W]),et=(0,M.A)(()=>{je(!1),se()}),tt=(0,M.A)(()=>{Q?ve():(Ve(!1),Te({chatId:e,messageIds:[]})),se()}),it=(0,M.A)(()=>{Q?(ve(),se()):Je(!0),Ve(!1)}),nt=(0,M.A)(()=>{Ve(!1),se()}),st=(0,M.A)(()=>{ye({chatId:e,threadId:t}),Ue(!J),nt()}),at=(0,M.A)(()=>{Je(!1),se()}),ot=(0,M.A)(()=>{Q?ve():le({command:"/start"})}),rt=(0,M.A)(()=>{Q?ve():ce({chatId:e})}),lt=(0,M.A)(()=>{Q?ve():oe({chatId:e,mutedUntil:o.Os5}),nt()}),ct=(0,M.A)(()=>{Q?(ve(),nt()):(He(),je(!0)),Ve(!1)}),dt=(0,M.A)(()=>{Q?ve():(Se({chatId:e}),Ue(!J)),nt()}),ht=(0,M.A)(()=>{Q?ve():(Ie({force:!0}),Ue(!J)),nt()}),ut=(0,M.A)(()=>{Q?ve():(ke({chatId:e,topicId:Number(t)}),Ue(!J)),nt()}),mt=(0,M.A)(()=>{we({id:void 0}),De({chatId:e,isEnabled:!1}),nt()}),pt=(0,M.A)(()=>{Q?ve():D?ue({chatId:e}):he({chatId:e}),nt()}),vt=(0,M.A)(()=>{me({id:e}),nt()}),gt=(0,M.A)(()=>{Xe&&B?Be({message:Le("SendDisallowError")}):(Ce({forUserId:e}),Q?ve():Ce({forUserId:e}),nt())}),At=(0,M.A)(()=>{Q?ve():pe({userId:e}),nt()}),ft=(0,M.A)(()=>{Q?ve():ee(),nt()}),bt=(0,M.A)(()=>{Q?ve():ge({userId:e,isVideo:!0}),nt()}),Ct=(0,M.A)(()=>{Q?ve():ge({userId:e}),nt()}),yt=(0,M.A)(()=>{ie(),nt()}),St=(0,M.A)(()=>{Ae(),Ue(!J),nt()}),kt=(0,M.A)(()=>{fe({chatId:e}),Ue(!J),nt()}),wt=(0,M.A)(()=>{Q?ve():w?(be({chatId:e}),Ue(!J)):Me({chatId:e}),nt()}),Nt=(0,M.A)(()=>{Pe({chatId:e,isEnabled:!0}),nt()}),It=(0,M.A)(()=>{Q?ve():re(),nt()}),Pt=(0,M.A)(()=>{ne(),nt()}),Yt=(0,M.A)(()=>{Q?ve():Ye({userId:e}),nt()}),Ft=(0,M.A)(()=>{Q?ve():Fe({userId:e}),nt()}),Dt=(0,M.A)(()=>{we({id:Z}),nt()});(0,n.vJ)(Bi.M6,[]);const Mt=(0,n.Kr)(()=>{const e=c?.map(({command:e})=>{const t=qm[e];if(t)return(0,te.Y)(de.A,{icon:t.icon,onClick:()=>{le({command:`/${e}`}),nt()},children:Re(t.label)},e)}),t=c?.some(({command:e})=>"privacy"===e);return[...e||[],z&&(0,te.Y)(de.A,{icon:"privacy-policy",onClick:()=>{t&&!d?le({command:"/privacy"}):Ne({url:d||Re("BotDefaultPrivacyPolicy")}),nt()},children:Re("BotPrivacyPolicy")})].filter(Boolean)},[c,Re,d,z]),Tt=(0,n.Kr)(()=>{if(B)return Re($?"Delete":R?"DeleteChatUser":x?"GroupInfo.DeleteAndExit":l?"LeaveChannel":"Group.LeaveGroup")},[x,B,l,R,$,Re]);return(0,te.Y)(rl.A,{children:(0,te.FD)("div",{className:"HeaderMenuContainer",children:[(0,te.FD)(qe.A,{isOpen:Ee,positionX:"right",style:`left: ${We}px;top: ${Qe}px;`,onClose:nt,shouldCloseFast:_e,children:[xe&&b&&(0,te.Y)(de.A,{icon:"search",onClick:yt,children:Re("Search")}),h&&U&&(0,te.FD)(te.FK,{children:[(0,te.Y)(de.A,{icon:"comments",onClick:dt,children:Re("lng_forum_create_topic")}),(0,te.Y)($m.A,{})]}),Z&&(0,te.Y)(de.A,{icon:"message",onClick:Dt,children:Le("ChannelSendMessage")}),Ze&&(0,te.Y)(de.A,{icon:"info",onClick:st,children:Re(u?"lng_context_view_topic":"lng_context_view_group")}),K&&!O&&(0,te.Y)(de.A,{icon:"edit",onClick:ht,children:Re("Edit")}),O&&(0,te.Y)(de.A,{icon:"edit",onClick:ut,children:Re("lng_forum_topic_edit")}),xe&&!h&&m&&!u&&(0,te.Y)(de.A,{icon:"forums",onClick:mt,children:Re("Chat.ContextViewAsTopics")}),h&&Boolean(N)&&(0,te.FD)(de.A,{icon:"user",onClick:X,children:[Re(l?"SubscribeRequests":"MemberRequests"),(0,te.Y)("div",{className:"right-badge",children:N})]}),h&&!u&&!p&&(0,te.Y)(de.A,{icon:"message",onClick:Pt,children:Re("lng_forum_view_as_messages")}),a&&g&&(0,te.Y)(de.A,{icon:"bots",onClick:ot,children:Re("BotStart")}),a&&A&&(0,te.Y)(de.A,{icon:l?"channel":"group",onClick:ft,children:Re(l?"ProfileJoinChannel":"ProfileJoinGroup")}),q&&!w&&(0,te.Y)(de.A,{icon:"boost-outline",onClick:wt,children:Re(l?"BoostingBoostChannelMenu":"BoostingBoostGroupMenu")}),_&&(0,te.Y)(de.A,{icon:"add-user",onClick:At,children:Re("AddContact")}),xe&&C&&(0,te.Y)(de.A,{icon:"phone",onClick:Ct,children:Re("Call")}),C&&(0,te.Y)(de.A,{icon:"video-outlined",onClick:bt,children:Re("VideoCall")}),y&&(L?(0,te.Y)(de.A,{icon:"unmute",onClick:lt,children:Re("ChatsUnmute")}):(0,te.FD)(de.A,{icon:"mute",onClick:ct,children:[Re("ChatsMute"),"..."]})),(P||D)&&(0,te.Y)(de.A,{icon:"voice-chat",onClick:pt,children:Re(D?"StartVoipChat":"VoipGroupJoinCall")}),V&&(0,te.Y)(de.A,{icon:l?"comments":"channel",onClick:vt,children:Re(l?"ViewDiscussion":"lng_profile_view_channel")}),!h&&(0,te.Y)(de.A,{icon:"select",onClick:It,children:Re("ReportSelectMessages")}),w&&(0,te.Y)(de.A,{icon:"boost-outline",onClick:wt,children:Re("Boosts")}),S&&(0,te.Y)(de.A,{icon:"stats",onClick:St,children:Re("Statistics")}),l&&k&&(0,te.Y)(de.A,{icon:"cash-circle",onClick:kt,children:Re("lng_channel_earn_title")}),G&&(0,te.Y)(de.A,{icon:"language",onClick:Nt,children:Re("lng_context_translate")}),f&&(0,te.Y)(de.A,{icon:"flag",onClick:tt,children:Re("ReportPeer.Report")}),Mt,E&&(0,te.Y)(de.A,{icon:"gift",onClick:gt,children:Re("ProfileSendAGift")}),z&&(0,te.Y)(de.A,{icon:j?"bots":"hand-stop",onClick:j?rt:Yt,children:Re(j?"BotRestart":"Bot.Stop")}),R&&!H&&!z&&(0,te.Y)(de.A,{icon:j?"user":"hand-stop",onClick:j?Ft:Yt,children:Re(j?"Unblock":"BlockUser")}),I&&(0,te.FD)(te.FK,{children:[(0,te.Y)($m.A,{}),(0,te.Y)(de.A,{destructive:!0,icon:"delete",onClick:it,children:Tt})]})]}),B&&(0,te.Y)(Hm.A,{isOpen:Oe,onClose:at,chat:$||B,isSavedDialog:Boolean($)}),y&&ze&&B?.id&&(0,te.Y)(Qc.A,{isOpen:Ge,onClose:et,onCloseAnimationEnd:$e,chatId:B.id})]})})}));var Qm=i(35854),Zm=i(92915),Xm=i(81642),ep=i(18653);const tp={root:"vv5ppXel",active:"FVgqrSSK",info:"DboxqiZd",topRow:"Ymu2m1PR",meta:"A2rsvUBm",subtitle:"qUzmwaIn",webPageInfo:"oJc5we4P",webPageSite:"s3_9Vro3",webPageTitle:"yHiXuUNs",mediaPreview:"i0nNHWse",clickable:"zZTQ0N6S",mediaImage:"q7pECane",round:"POIISsPN",spoiler:"hTsgqcW9",playIcon:"nQXtQwpa"},ip=(0,n.ph)((0,s.EK)((e,{message:t})=>({webPage:(0,c.Pn$)(e,t)}))(({isActive:e,message:t,senderPeer:i,messageChat:n,shouldShowChat:a,query:o,className:r,onClick:c,webPage:d})=>{const h=(0,Ui.A)(),u=t.forwardInfo?.hiddenUserName,m=a?n:i,p=a&&i?(0,Ft.Q5)(h,t.chatId,i):void 0,v=(0,id.A)(t),g=(0,l.fP)(t)?void 0:v,A=(0,td.A)(t,"pictogram"),f=(0,z.A)(A),b=Boolean((0,l.lk)(t)),C=Boolean((0,l.zX)(t)),y=(0,l.y2)(t),S=Boolean(f||g),k="full"===d?.webpageType?{siteName:d.siteName||d.displayUrl,title:d.title,url:d.url,isSafe:t.content.webPage?.isSafe}:void 0,w=(0,M.A)(()=>{c(t)}),N=(0,M.A)(e=>{if(e.stopPropagation(),!k?.url)return;const{openUrl:t}=(0,s.ko)();t({url:k.url,shouldSkipModal:k.isSafe})}),I=(0,M.A)(e=>{if(k?.url){e.stopPropagation();const{openUrl:t}=(0,s.ko)();t({url:k.url,shouldSkipModal:k.isSafe})}});return(0,te.FD)("div",{role:"button",tabIndex:0,className:(0,me.A)(tp.root,e&&tp.active,r),onClick:w,children:[(0,te.Y)(Mt.A,{className:tp.avatar,peer:m,text:u,size:"medium"}),(0,te.FD)("div",{className:tp.info,children:[(0,te.FD)("div",{className:tp.topRow,children:[m&&(0,te.Y)(qn.A,{peer:m,withEmojiStatus:!0})||u,(0,te.Y)(Xm.A,{className:tp.meta,message:t})]}),(0,te.FD)("div",{className:tp.subtitle,dir:"auto",children:[p&&(0,te.FD)(te.FK,{children:[(0,te.Y)("span",{className:"sender-name",children:(0,Dt.A)(p)}),(0,te.Y)("span",{className:"colon",children:":"})]}),(0,te.Y)(ep.A,{message:t,highlight:o,truncateLength:200})]}),k&&(0,te.FD)("div",{className:tp.webPageInfo,onClick:N,role:"button",tabIndex:0,title:k.url,children:[(0,te.Y)("div",{className:tp.webPageSite,children:(0,Dt.A)(k.siteName)}),k.title&&(0,te.Y)("div",{className:tp.webPageTitle,children:(0,Dt.A)(k.title)})]})]}),S&&(0,te.FD)("div",{className:(0,me.A)(tp.mediaPreview,k&&tp.clickable),onClick:I,role:k?"button":void 0,tabIndex:k?0:void 0,title:k?.url,children:[(0,te.Y)("img",{src:f||g,alt:"",className:(0,me.A)(tp.mediaImage,b&&tp.round,y&&tp.spoiler),draggable:!1}),C&&(0,te.Y)("i",{className:(0,me.A)(tp.playIcon,"icon icon-play")})]})]})}));var np=i(69988);const sp={root:"FTMljUuX",header:"OvmjSMwA",active:"DEIUzXQd",avatar:"mp1PmoMq",input:"z2K8Q7ib",mobile:"u0fb78AA",focused:"dqF8dYNx",withDropdown:"AqhBggrp",adaptSearchBorders:"Q9RZQaTu",dropdown:"MFGvbICO",dropdownHidden:"Alee0CKy",results:"RtfTOE72",placeholder:"O1HoZFge",separator:"_Yy43QLl",savedTags:"BcvAfv1E",domainButtons:"KamajtjH",domainButtonWrapper:"bNdv38ki",domainButton:"wTJ6uBy1",removeDomainButton:"YLtqVQ3h",addDomainButton:"VPrUqLUm",newDomainInput:"cDiKK557",wrap:"JkESCST6",searchTags:"rO3pH3LI",savedSearchTag:"qA4gov4D",hash:"q5NOmUAM",searchTypes:"rVYZG__K",searchType:"nE1Xwoo7",selectedType:"i29dP8iT",footer:"jyS1l9yn","keyboard-visible":"ao05jKHW",keyboardVisible:"ao05jKHW",counter:"NmmL_cO3",mobileNavigation:"dLO1hlHU",navigationButton:"Z4vLAlsu",navigationDisabled:"IqA7R2xO",jumpIn:"n9kXbTu6"},ap={isCustomPeer:!0,avatarIcon:"channel-filled",titleKey:"SearchPublicPosts"},op="MiddleSearchResult",rp=(0,ge.sg)(e=>e(),200,!1),lp=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.Xf0)(e);if(!t)return{};const{chatId:i,threadId:n}=t,s=(0,c.hds)(e,i);if(!s)return{};const{requestedQuery:a,savedTag:o,results:r,fetchingQuery:d,isHashtag:h,type:u}=(0,c.TCk)(e)||{},{totalCount:m,foundIds:p,query:v}=r||{},g=e.currentUserId,A=(0,c.nZ4)(e,i),f=(0,l.cG)(i,n,g),b=A&&!f?e.savedReactionTags?.byKey:void 0;return{chat:s,monoforumChat:(0,c.k2W)(e,i),requestedQuery:a,totalCount:m,threadId:n,foundIds:p,isHistoryCalendarOpen:Boolean((0,c.nTw)(e).historyCalendarSelectedAt),savedTags:b,savedTag:o,isCurrentUserPremium:(0,c.g29)(e),isSavedMessages:A,fetchingQuery:d,isHashtagQuery:h,currentUserId:g,searchType:u,lastSearchQuery:v}})(({isActive:e,chat:t,monoforumChat:i,threadId:a,requestedQuery:d,savedTags:h,savedTag:p,totalCount:v,lastSearchQuery:g,foundIds:A,isHistoryCalendarOpen:f,isCurrentUserPremium:b,isSavedMessages:C,fetchingQuery:y,isHashtagQuery:S,searchType:k="chat",currentUserId:w})=>{const{updateMiddleSearch:N,resetMiddleSearch:I,performMiddleSearch:P,focusMessage:D,closeMiddleSearch:B,openHistoryCalendar:R,openPremiumModal:L,loadSavedReactionTags:x}=(0,s.ko)(),E=(0,n.li)(),V=(0,n.li)(),_=(0,n.li)(),U=(0,n.li)(!1),{isMobile:O}=(0,Y.Ay)(),K=(0,T.A)(),J=(0,Ui.A)(),[G,j]=(0,n.J0)(d||""),[z,H]=(0,n.J0)(0),$=A&&z>0,q=A&&z<A.length-1,[Z,X]=(0,n.J0)(!e),ee=(0,n.li)(),ie=(0,n.li)(!0),[ne,se,ae]=(0,F.A)(),[oe,re]=(0,n.J0)(!0),[le,ce]=(0,n.J0)(!1),[de,he]=(0,Qm.M)({key:"search_custom_terms",initValue:[]}),[ue,pe]=(0,n.J0)(!1),[ve,Ae]=(0,n.J0)(""),fe=(0,n.li)();!function(e,t){const i=(0,M.A)(i=>{e.every(e=>e.current&&!e.current.contains(i.target))&&t(i)});(0,n.vJ)(()=>(document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}),[i])}([E],(0,M.A)(e=>{ie.current||e.target.closest(".Modal")||ae()}));const be=Boolean((G||p)&&A||S),ye=S&&!G,Se=Boolean((G||p)&&A&&!A.length&&!le&&!ye),ke=e&&(oe||!O)&&(ne||"myChats"===k||"channels"===k)&&Boolean(be||Se||ye||h),we=Boolean(G&&!ye||p),Ne="chat"===k&&Boolean(A?.length),Ie=(0,M.A)(()=>{B()}),Pe=(0,M.A)(()=>{(0,r.YS)(()=>{V.current?.focus()})}),Ye=(0,M.A)(()=>{V.current?.blur()});(0,n.vJ)(()=>{const{visualViewport:e}=window;if(!e)return;const t=document.getElementById("Main"),i=()=>{const{activeElement:i}=document;if(i&&i===V.current){const{pageTop:i,height:n}=e;(0,r.RK)(()=>{t.style.transform=`translateY(${i}px)`,t.style.height=`${n}px`,document.documentElement.scrollTop=i})}else(0,r.RK)(()=>{t.style.transform="",t.style.height=""})};return e.addEventListener("resize",i),()=>{e.removeEventListener("resize",i)}},[]),(0,n.vJ)(()=>{H(-1)},[g]),(0,n.Nf)(()=>{u.pz&&Array.from(document.querySelectorAll("input")).forEach(t=>{t.disabled=Boolean(e&&t!==V.current)})},[e]),(0,n.vJ)(()=>{e?(X(!1),clearTimeout(ee.current)):(V.current.blur(),re(!0),H(0),j(""),ee.current=window.setTimeout(()=>X(!0),200))},[e]),(0,n.vJ)(()=>{d&&t?.id&&(j(d),N({chatId:t.id,threadId:a,update:{requestedQuery:void 0}}),ce(!0),(0,r.Uz)(()=>{const e=V.current;e&&((0,Ti.A)(e,!0,!0),se())}))},[t?.id,d,a]),(0,wi.A)(([t])=>{e!==t&&!G&&g&&j(g)},[e,g,G]),(0,wi.A)(([t])=>{e&&t!==f&&(f?(Ye(),ae()):Pe())},[f,e]);const Fe=(0,M.A)(()=>{G?.length||p?(j(""),ce(!1),I(),Pe()):Ie()});(0,n.vJ)(()=>e?(0,m.A)(Fe):void 0,[e,Ie]);const De=(0,n.Kr)(()=>{if(h)return Object.values(h)},[h]),Me=Boolean(De?.length),Te=Me&&!b;(0,n.vJ)(()=>{C&&e&&x()},[C,e]);const Be=(0,M.A)(()=>{const e=t?.id;e&&rp(()=>{U.current||P({chatId:e,threadId:a,query:G})})}),Re=(0,M.A)(e=>{if(U.current=!1,e.startsWith("#")&&!S)return N({chatId:t.id,threadId:a,update:{isHashtag:!0}}),j(e.slice(1)),void Be();j(e),e||(ce(!1),p||(I(),U.current=!0))});(0,n.vJ)(()=>{(G||p)&&Be()},[G,p]),(0,n.vJ)(()=>{ce(Boolean(y))},[y]),(0,n.vJ)(()=>{ue&&fe.current&&fe.current.focus()},[ue]),(0,n.vJ)(()=>{A?.length&&A.length-z<5&&Be()},[z,A?.length]),(0,n.vJ)(()=>{if(e)return ie.current=!0,window.addEventListener("touchend",t),window.addEventListener("mouseup",t),window.addEventListener("touchstart",i),window.addEventListener("mousedown",i),()=>{i(),window.removeEventListener("touchstart",i),window.removeEventListener("mousedown",i)};function t(){V.current?.focus(),se(),(0,ge.IJ)(()=>{ie.current=!1})}function i(){window.removeEventListener("touchend",t),window.removeEventListener("mouseup",t),(0,ge.IJ)(()=>{ie.current=!1})}},[e]),(0,Ce.A)({isActive:e,onBack:Ie});const[Le,xe,Ee=0]=(0,jn.A)(Be,A),Ve=(0,n.Kr)(()=>{if(!G&&!p||!Le?.length)return yi.p;const e=(0,s.mS)();return Le.map(t=>{const[i,n]=(0,Uc.a)(t),s=(0,c.O5q)(e,i,n);if(!s)return;const a=C||(0,l.DX)(i)||i===o.Ckz?(0,c.Szq)(e,s):void 0,r=(0,c.Y7C)(e,s);return{searchResultKey:t,message:s,messageChat:(0,c.hds)(e,s.chatId),senderPeer:a||r}}).filter(Boolean)},[G,p,Le,C]),_e=(0,M.A)(e=>{const t=(0,Uc.D)(e),i=A?.indexOf(t)||0;H(i+Ee),"chat"===k&&re(!1),D({chatId:e.chatId,messageId:e.id,threadId:S?void 0:a}),ae()}),Ue=(0,M.A)(()=>{re(e=>!e),se()}),Oe=(0,Hn.A)(_,be,e=>{const t=Ve?.[-1===e?0:e];t&&(_e(t.message),H(e+Ee))},`.${op}`,!0),Ke=(0,M.A)(e=>{N({chatId:t.id,threadId:a,update:e}),Be()}),Je=(0,M.A)(e=>{Te?L({initialSection:"saved_tags"}):(U.current=!1,Ke({savedTag:e}))}),Ge=(0,M.A)(()=>{Ke({savedTag:void 0})}),je=(0,M.A)(()=>{S?Ke({isHashtag:!1}):p&&Ge()}),ze=(0,M.A)(e=>{Ke({type:e}),re(!0)}),$e=(0,M.A)(()=>{if("chat"===k&&(ae(),Ye(),A)){const e=z+1,[t,i]=(0,Uc.a)(A[e]);D({chatId:t,messageId:i,threadId:a}),H(e)}}),qe=(0,M.A)(()=>{if("chat"===k&&(ae(),Ye(),A)){const e=z-1,[t,i]=(0,Uc.a)(A[e]);D({chatId:t,messageId:i,threadId:a}),H(e)}});function We(e,i){const n=!i&&k===e;switch(e){case"chat":return(0,te.Y)(cl.A,{className:(0,me.A)(sp.searchType,n&&sp.selectedType),peerId:t?.id,title:K("SearchThisChat"),clickArg:"chat",onClick:i?je:ze});case"myChats":return(0,te.Y)(cl.A,{className:(0,me.A)(sp.searchType,n&&sp.selectedType),peerId:w,forceShowSelf:!0,title:K("SearchMyMessages"),clickArg:"myChats",onClick:i?je:ze});case"channels":return(0,te.Y)(cl.A,{className:(0,me.A)(sp.searchType,n&&sp.selectedType),customPeer:ap,title:K("SearchPublicPosts"),clickArg:"channels",onClick:i?je:ze})}}const Qe=(0,n.Kr)(()=>["youtube.com","youtu.be"],[]),Ze=(0,n.Kr)(()=>[...Qe,...de],[Qe,de]),Xe=(0,M.A)(e=>{Re(G===e?"":e),Pe()}),et=(0,M.A)(()=>{pe(!0)}),tt=(0,M.A)(()=>{const e=ve.trim();e&&!Ze.includes(e)&&he([...de,e]),Ae(""),pe(!1)}),it=(0,M.A)(()=>{Ae(""),pe(!1)}),nt=(0,M.A)(e=>{he(de.filter(t=>t!==e)),G===e&&j("")}),st=(0,M.A)(e=>{"Enter"===e.key?(e.preventDefault(),tt()):"Escape"===e.key&&(e.preventDefault(),it())});function at(){return(0,te.FD)("div",{className:(0,me.A)(sp.dropdown,!ke&&sp.dropdownHidden),children:[!O&&(0,te.Y)("div",{className:sp.separator}),!S&&(0,te.FD)("div",{className:(0,me.A)(sp.domainButtons,!O&&sp.wrap,"no-scrollbar"),children:[Ze.map(e=>{const t=G===e,i=de.includes(e);return(0,te.FD)("div",{className:sp.domainButtonWrapper,children:[(0,te.Y)(Q.A,{className:(0,me.A)(np.A.root,sp.domainButton,t&&np.A.chosen),size:"tiny",onClick:()=>Xe(e),children:e}),i&&(0,te.Y)("button",{className:sp.removeDomainButton,onClick:t=>{t.stopPropagation(),nt(e)},"aria-label":"Remove",children:(0,te.Y)(W.A,{name:"close"})})]},e)}),ue?(0,te.Y)("input",{ref:fe,type:"text",className:sp.newDomainInput,value:ve,placeholder:"Enter search term...",onChange:e=>Ae(e.target.value),onKeyDown:st,onBlur:()=>{setTimeout(it,100)}}):(0,te.Y)(Q.A,{className:(0,me.A)(np.A.root,sp.addDomainButton),size:"tiny",onClick:et,children:(0,te.Y)(W.A,{name:"add"})})]}),(0,te.Y)("div",{className:sp.separator}),Me&&!S&&(0,te.Y)("div",{className:(0,me.A)(sp.savedTags,!O&&sp.wrap,"no-scrollbar"),children:De.map(e=>{const t=(0,l.a0)(e.reaction,p);return(0,te.Y)(Zm.A,{containerId:"local-search",reaction:e.reaction,tag:e,withCount:!0,isDisabled:Te,isChosen:t,onClick:t?Ge:Je},(0,l.Jj)(e.reaction))})}),S&&(0,te.FD)("div",{className:(0,me.A)(sp.searchTypes,"no-scrollbar"),children:[We("chat"),We("myChats"),We("channels")]}),be&&(0,te.FD)(Tn.A,{ref:_,className:(0,me.A)(sp.results,"custom-scroll"),items:Ve,itemSelector:`.${op}`,preloadBackwards:0,onLoadMore:xe,onKeyDown:Oe,children:[Se&&(0,te.Y)("span",{className:sp.placeholder,children:G?K("NoResultFoundFor",G):K("NoResult")},"nothing"),ye&&(0,te.Y)("span",{className:sp.placeholder,children:K("HashtagSearchPlaceholder")},"enterhash"),Ve?.map(({message:e,senderPeer:t,messageChat:i,searchResultKey:n},s)=>(0,te.Y)(ip,{teactOrderKey:-e.date,className:op,query:G,message:e,senderPeer:t,messageChat:i,shouldShowChat:S,isActive:z-Ee===s,onClick:_e},n))]})]})}return(0,te.FD)("div",{id:"MiddleSearch",className:(0,me.A)(sp.root,e&&sp.active,!e&&Z&&"visually-hidden",ne&&sp.focused,O&&sp.mobile),ref:E,children:[(0,te.FD)("div",{className:sp.header,children:[!O&&(0,te.Y)(Mt.A,{className:sp.avatar,peer:i||t,size:"medium",isSavedMessages:C}),(0,te.FD)(Rn.A,{ref:V,value:G,className:(0,me.A)(sp.input,ke&&sp.withDropdown,ke&&!O&&sp.adaptSearchBorders),canClose:!O,isLoading:le,resultsItemSelector:`.${sp.results} .${op}`,hasUpButton:Ne&&!O,hasDownButton:Ne&&!O,placeholder:K(S?"SearchHashtagsHint":"Search"),teactExperimentControlled:!0,onChange:Re,onStartBackspace:je,onReset:Fe,withBackIcon:O,onFocus:se,focused:ne,onUpClick:q?$e:void 0,onDownClick:$?qe:void 0,children:[(0,te.FD)("div",{className:sp.searchTags,children:[p&&(0,te.Y)(Zm.A,{containerId:"local-search-tags",className:sp.savedSearchTag,reaction:p,tag:h[(0,l.Jj)(p)],onClick:Ge}),S&&(0,te.Y)("div",{className:sp.hash,children:"#"})]}),!O&&at()]}),!O&&(0,te.Y)("div",{className:sp.icons,children:(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>R({selectedAt:(0,He.CS)(Date.now())}),ariaLabel:K("JumpToDate"),children:(0,te.Y)(W.A,{name:"calendar"})})})]}),O&&at(),O&&(0,te.FD)("div",{className:sp.footer,children:[(0,te.Y)(Q.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>R({selectedAt:(0,He.CS)(Date.now())}),ariaLabel:K("JumpToDate"),children:(0,te.Y)(W.A,{name:"calendar"})}),(0,te.Y)("div",{className:sp.counter,children:we&&(A?.length?K("Of",[Math.max(z+1,1),v]):A&&!A.length&&K("NoResult"))}),"chat"===k&&Boolean(A?.length)&&(0,te.Y)(Q.A,{className:sp.viewStyle,size:"smaller",isText:!0,fluid:!0,noForcedUpperCase:!0,onClick:Ue,children:K(oe?"SearchAsChat":"SearchAsList")}),Ne&&!ke&&(0,te.FD)("div",{className:sp.mobileNavigation,children:[(0,te.Y)(Q.A,{className:(0,me.A)(sp.navigationButton,!q&&sp.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:$e,nonInteractive:!q,ariaLabel:J("AriaSearchOlderResult"),children:(0,te.Y)(W.A,{name:"up"})}),(0,te.Y)(Q.A,{className:(0,me.A)(sp.navigationButton,!$&&sp.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:qe,nonInteractive:!$,ariaLabel:J("AriaSearchNewerResult"),children:(0,te.Y)(W.A,{name:"down"})})]})]})]})}));var cp=i(80539),dp=i(58734),hp=i(73172);const up=2.5*g.$,mp=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{setsById:i,added:n,recent:s,favorite:a,effect:o}=e.stickers,r=(0,c.nZ4)(e,t),l=(0,c.hds)(e,t),d=(0,v.L8)(t)?void 0:(0,c.AWZ)(e,t)?.stickerSet?.id;return{chat:l,effectStickers:o?.stickers,effectEmojis:o?.emojis,recentStickers:s.stickers,favoriteStickers:a.stickers,stickerSetsById:i,addedSetIds:n.setIds,canAnimate:(0,c.ML4)(e),isSavedMessages:r,isCurrentUserPremium:(0,c.g29)(e),chatStickerSetId:d}})(({chat:e,threadId:t,className:i,isHidden:a,isTranslucent:r,loadAndPlay:l,canSendStickers:c,recentStickers:d,favoriteStickers:h,effectStickers:m,effectEmojis:p,addedSetIds:v,stickerSetsById:g,chatStickerSetId:A,canAnimate:f,isSavedMessages:b,isCurrentUserPremium:C,noContextMenus:y,idPrefix:S,onStickerSelect:k,isForEffects:w})=>{const{loadRecentStickers:N,addRecentSticker:I,unfaveSticker:P,faveSticker:Y,removeRecentSticker:F}=(0,s.ko)(),D=(0,n.li)(),B=(0,n.li)(),R=(0,n.li)(),{handleScroll:L,isAtBeginning:x}=Mn(),E=(0,hp.A)(e?.id,t),V=`${S}-sticker-set`,{activeSetIndex:_,observeIntersectionForSet:U,observeIntersectionForPlayingItems:O,observeIntersectionForShowingItems:K,observeIntersectionForCovers:J,selectStickerSet:G}=Br(D,B,V,a),j=(0,T.A)(),z=Boolean(v),H=(0,n.Kr)(()=>{if(w&&m){const e=[];return p?.length&&e.push({id:o.hfH,accessHash:"0",title:"",stickers:p,count:p.length,isEmoji:!0}),m?.length&&e.push({id:o.Kp3,accessHash:"0",title:j("StickerEffects"),stickers:m,count:m.length}),e}if(!v)return yi.p;const e=[];h.length&&e.push({id:o.tRH,accessHash:"0",title:j("FavoriteStickers"),stickers:h,count:h.length}),d.length&&e.push({id:o.sR2,accessHash:"0",title:j("RecentStickers"),stickers:d,count:d.length});const t=[...v||[]];A&&t.unshift(A);const i=Object.values((0,Ci._E)(g,t));return[...e,...i]},[v,g,h,d,A,j,m,w,p]),$=(0,n.Kr)(()=>z&&0===H.filter(e=>e.stickers?.length).length,[H,z]);(0,n.vJ)(()=>{l&&(N(),c&&E({type:"chooseSticker"}))},[c,l,N,E]);const q=(0,Yr.A)([],o.jhd),Z=z&&q&&!$&&(c||w);(0,xs.A)(B,!Z||!B.current),(0,n.vJ)(()=>{if(!z)return;const e=B.current;if(!e)return;const t=_*up-(e.offsetWidth/2-up/2);(0,Da.A)(e,t)},[z,_]);const X=(0,M.A)((e,t,i)=>{k(e,t,i,!0),I({sticker:e})}),ee=(0,M.A)(e=>{P({sticker:e})}),ie=(0,M.A)(e=>{Y({sticker:e})}),ne=(0,M.A)(()=>{c&&E({type:"chooseSticker"})}),ae=(0,M.A)(e=>{F({sticker:e})});if(!e)return;const oe=(0,me.A)("lq8BD6Hc",i),re=(0,me.A)(Xr,"no-scrollbar",!x&&el),le=!Z&&(c||w)&&!$;return(0,te.Y)(se.Ay,{className:oe,activeKey:le?0:1,name:"fade",shouldCleanup:!0,children:Z?(0,te.FD)(te.FK,{children:[!w&&(0,te.Y)("div",{ref:B,className:re,children:(0,te.FD)("div",{className:"shared-canvas-container",children:[(0,te.Y)("canvas",{ref:R,className:"shared-canvas"}),H.map(function(t,i){const n=t.stickers?.[0],s=(0,me.A)(tl,i===_&&"y02WwQk6"),a=i<o.j41;return t.id===o.sR2||t.id===o.tRH||t.id===o.eKB||t.hasThumbnail||!n?(0,te.Y)(Q.A,{className:s,ariaLabel:t.title,round:!0,faded:t.id===o.sR2||t.id===o.tRH,color:"translucent",onClick:()=>G(i),children:t.id===o.sR2?(0,te.Y)(W.A,{name:"recent"}):t.id===o.tRH?(0,te.Y)(W.A,{name:"favorite"}):t.id===o.eKB?(0,te.Y)(Mt.A,{peer:e,size:"small"}):(0,te.Y)(Vr,{stickerSet:t,noPlay:!f||!l,observeIntersection:J,sharedCanvasRef:a?R:void 0,forcePlayback:!0})},t.id):(0,te.Y)(Kr,{sticker:n,size:o.TBj,title:t.title,className:s,noPlay:!f||!l,observeIntersection:J,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:a?R:void 0,withTranslucentThumb:r,onClick:G,clickArg:i,forcePlayback:!0},t.id)})]})}),(0,te.Y)("div",{ref:D,onMouseMove:ne,onScroll:L,className:(0,me.A)(Qr,u.TF?"no-scrollbar":"custom-scroll",!w&&Zr),children:H.map((e,t)=>(0,te.Y)(qr,{stickerSet:e,loadAndPlay:Boolean(f&&l),noContextMenus:y,index:t,idPrefix:V,observeIntersection:U,observeIntersectionForPlayingItems:O,observeIntersectionForShowingItems:K,isNearActive:_>=t-1&&_<=t+1,favoriteStickers:h,isSavedMessages:b,isCurrentUserPremium:C,isTranslucent:r,isChatStickerSet:e.id===A,onStickerSelect:X,onStickerUnfave:ee,onStickerFave:ie,onStickerRemoveRecent:ae,forcePlayback:!0,shouldHideHeader:e.id===o.hfH},e.id))})]}):c||w?$?(0,te.Y)("div",{className:il,children:j("NoStickers")}):(0,te.Y)($n.A,{}):(0,te.Y)("div",{className:il,children:j("ErrorSendRestrictedStickersAll")})})})),pp=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{availableReactions:i,topReactions:n}=e.reactions,{maxUniqueReactions:s}=e.appConfig,{enabledReactions:a,isPaidReactionAvailable:o}=(0,c.AWZ)(e,t)||{};return{enabledReactions:a,availableReactions:i,topReactions:n,reactionsLimit:s,isWithPaidReaction:o}})(({loadAndPlay:e,enabledReactions:t,availableReactions:i,topReactions:s,selectedReactionIds:a,isWithPaidReaction:o,message:r,reactionsLimit:c,onReactionSelect:d,onReactionContext:h})=>{const u=(0,n.li)(),m=(0,n.li)(),{width:p}=(0,we.A)(),{isTouchScreen:v}=(0,Y.Ay)(),A=r?.reactions?.results,f=c&&A&&A.length>=c,b=(0,n.Kr)(()=>{if(f){const e=A.map(({reaction:e})=>e);return o&&e.unshift({type:"paid"}),e}if(!t)return[];if("all"===t.type){const e=(i||[]).map(({reaction:e})=>e);return o&&e.unshift({type:"paid"}),(0,l.fu)(e,s)}const e=t.allowed.slice();return o&&e.unshift({type:"paid"}),(0,l.fu)(e,s)},[i,t,s,f,A,o]),C=(0,n.Kr)(()=>{const e=Math.min(26.25*g.$,p),t=(p>600?.625:.5)*g.$,i=e-.5*g.$,n=Math.floor((i+t)/(36+t)),s=Math.ceil(b.length/n),a=36*s+(s-1)*t+.5*g.$*2;return Math.min(18*g.$,a)},[b.length,p]);return(0,te.Y)("div",{className:"MhpiTAwi",style:`height: ${C}px`,children:(0,te.Y)("div",{className:(0,me.A)("NIaqmosK",v?"no-scrollbar":"custom-scroll"),children:(0,te.FD)("div",{className:"symbol-set-container shared-canvas-container",children:[(0,te.Y)("canvas",{ref:u,className:"shared-canvas"}),(0,te.Y)("canvas",{ref:m,className:"shared-canvas"}),b.map(t=>{const n=(0,l.Jj)(t),s=n?a?.includes(n):void 0;return(0,te.Y)(Hr,{reaction:t,isSelected:s,loadAndPlay:e,availableReactions:i,onClick:d,onContextMenu:h,sharedCanvasRef:u,sharedCanvasHqRef:m},n)})]})})})})),vp=16.375*g.$,gp=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.nTw)(e),i=e.availableEffectById,{chatId:n,messageId:s,storyPeerId:a,storyId:o,position:r,sendAsMessage:l,isForEffects:d}=t.reactionPicker||{},h=a&&o?(0,c.Msb)(e,a,o):void 0,u=n?(0,c.hds)(e,n):void 0,m=n?(0,c.AWZ)(e,n):void 0,p=n&&s?(0,c.O5q)(e,n,s):void 0,g=(0,v.L8)(n||a||""),A="some"===m?.enabledReactions?.type,{maxUniqueReactions:f}=e.appConfig,b="all"===m?.enabledReactions?.type&&m?.enabledReactions?.areCustomAllowed,C=p?.reactions?.results,y=Boolean(f&&C&&C.length>=f);return{message:p,story:h,position:r,shouldUseFullPicker:!(u?.isForbidden||A||y)&&(b||g),isTranslucent:(0,c.cwE)(e),isCurrentUserPremium:(0,c.g29)(e),sendAsMessage:l,isForEffects:d,chatId:n,availableEffectById:i}})(({isOpen:e,message:t,story:i,position:a,isTranslucent:o,isCurrentUserPremium:r,shouldUseFullPicker:c,sendAsMessage:d,chatId:h,isForEffects:u,availableEffectById:m})=>{const{toggleReaction:p,closeReactionPicker:v,sendMessage:g,showNotification:A,sendStoryReaction:f,saveEffectInDraft:b,requestEffectInComposer:C,addLocalPaidReaction:y,openPaidReactionModal:S}=(0,s.ko)(),k=(0,T.A)(),w=(0,Ri.A)(t?.id,!0),N=(0,Ri.A)(t?.chatId,!0),I=(0,Ri.A)(i?.peerId,!0),P=(0,Ri.A)(i?.id),F=(0,Ri.A)(a,!0),D=(0,n.li)(),B=(0,n.Kr)(()=>{if(F)return P?F:{x:F.x+(c?-23:-21),y:F.y+(c?-64:-10)}},[P,F,c]),R=(0,M.A)(()=>D.current),L=(0,M.A)(()=>({withPortal:!0,isDense:!I,deltaX:!(0,Y.Ny)()&&D.current?-(D.current.offsetWidth-vp)/2- -11.5:0})),x=(0,M.A)(e=>{if(!N||!w)return;const t=e.isCustomEmoji?{type:"custom",documentId:e.id}:{type:"emoji",emoticon:e.emoji};p({chatId:N,messageId:w,reaction:t,shouldAddToRecent:!0}),v()}),E=(0,M.A)(e=>{N&&w&&("paid"===e.type?y({chatId:N,messageId:w,count:1}):p({chatId:N,messageId:w,reaction:e,shouldAddToRecent:!0}),v())}),V=(0,M.A)(e=>{"paid"===e.type&&(S({chatId:N,messageId:w}),v())}),_=(0,M.A)(e=>{if("type"in e&&"paid"===e.type)return;const t="id"in e?{type:"custom",documentId:e.id}:e,i="type"in e&&"custom"===e.type?(0,s.mS)().customEmojis.byId[e.documentId]:"id"in e?e:void 0;if(i&&!i.isFree&&!r)return A({message:k("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:k("PremiumMore")}),void v();if(!d)return f({peerId:I,storyId:P,containerId:(0,l.$_)(I,P),reaction:t,shouldAddToRecent:!0}),void v();let n,a;if("type"in e&&"emoji"===e.type)n=e.emoticon;else{const e=(0,cp.Ay)((0,dp.hB)(i));n=e.text,a=e.entities}g({text:n,entities:a,isReaction:!0}),v()}),U=(0,M.A)(e=>{const t=Object.values(m),i=t.find(t=>t.effectStickerId===e.id)?.id;h&&b({chatId:h,threadId:O.l3,effectId:i}),i&&C({}),v()}),K=(0,n.Kr)(()=>(t?.reactions?.results||[]).reduce((e,{chosenOrder:t,reaction:i})=>(void 0!==t&&e.push((0,l.Jj)(i)),e),[]),[t?.reactions?.results]);return(0,te.Y)(qe.A,{isOpen:e,ref:D,className:(0,me.A)("gBh4WvBC","ReactionPicker"),bubbleClassName:(0,me.A)("qSfKwMzX",!c&&!P&&"dRNSqkOC",P&&"srpBMrqr"),withPortal:!0,noCompact:!0,anchor:B,positionY:i&&"bottom",getTriggerElement:Ap,getRootElement:fp,getMenuElement:R,getLayout:L,backdropExcludedSelector:".Modal.confirm",onClose:v,children:u&&h?(0,te.Y)(mp,{className:"",isHidden:!e,loadAndPlay:Boolean(e&&c),idPrefix:"message-effect",canSendStickers:!1,noContextMenus:!1,chatId:h,isTranslucent:o,onStickerSelect:U,isForEffects:u}):(0,te.FD)(te.FK,{children:[(0,te.Y)(ol,{chatId:N,idPrefix:"message-emoji-set-",isHidden:!e||!(c||P),loadAndPlay:Boolean(e&&c),isReactionPicker:!0,className:c||P?void 0:"KVwgF6DG",selectedReactionIds:K,isTranslucent:o,onCustomEmojiSelect:P?_:x,onReactionSelect:P?_:E,onReactionContext:V}),!c&&Boolean(N)&&(0,te.Y)(pp,{chatId:N,loadAndPlay:e,onReactionSelect:P?_:E,onReactionContext:V,selectedReactionIds:K,message:t})]})})}));function Ap(){return document.querySelector("body")}function fp(){return document.querySelector("body")}var bp=i(39074),Cp=i(45761);const yp=document.createElement("div");var Sp=i(41316),kp=i(3225),wp=i(25498),Np=i(9442),Ip=i(91525),Pp=i(52988),Yp=i(27860);const Fp="SHoF85Vw",Dp="Zo7u5epf",Mp=15*g.$,Tp=(0,n.ph)(({attachment:e,className:t,isSingle:i,shouldDisplayCompressed:s,shouldDisplayGrouped:a,index:r,onDelete:l,onToggleSpoiler:c})=>{const d=function(e,t){if(t&&e.quick){if(o.gex.has(e.mimeType))return"photo";if(o.fNs.has(e.mimeType))return"video"}return"file"}(e,s),h=(0,M.A)(()=>{c?.(r)}),u=(0,n.Kr)(()=>{switch(d){case"photo":return(0,te.Y)("img",{className:Fp,src:e.blobUrl,alt:"",draggable:!1});case"video":return(0,te.FD)(te.FK,{children:[Boolean(e.quick?.duration)&&(0,te.Y)("div",{className:"nI2M1SBH",children:(0,He.QO)(e.quick.duration)}),(0,te.Y)("video",{className:Fp,src:e.blobUrl,autoPlay:!0,muted:!0,loop:!0,disablePictureInPicture:!0})]});default:return(0,te.FD)(te.FK,{children:[(0,te.Y)(Pp.A,{className:"B6f6GcvN",name:e.filename,extension:(0,Ip.QC)(e.filename,e.mimeType),previewData:e.previewBlobUrl,size:e.size,smaller:!0}),l&&(0,te.Y)(W.A,{name:"delete",className:(0,me.A)(Dp,"CYJwy9T_"),onClick:()=>l(r)})]})}},[e,d,r,l]),m="file"===d||!a,p=Boolean("file"!==d&&e.shouldSendAsSpoiler),v="file"!==d,g=(0,me.A)(t,"QucaiGVU",i&&"FjrnqGba",m&&"g0cTsM9d");return(0,te.FD)("div",{className:g,children:[u,(0,te.Y)(Yp.A,{isVisible:p,thumbDataUri:e.previewBlobUrl||e.blobUrl,width:Mp,height:Mp}),v&&(0,te.FD)("div",{className:"bX7LdgxW",children:[(0,te.Y)(W.A,{name:e.shouldSendAsSpoiler?"spoiler-disable":"spoiler",className:Dp,onClick:h}),l&&(0,te.Y)(W.A,{name:"delete",className:Dp,onClick:()=>l(r)})]})]})});var Bp=i(25897),Rp=i(6070),Lp=i(49068);function xp(e,t,i=!1){const n=e[i?"scrollLeft":"scrollTop"],s=n+e[i?"offsetWidth":"offsetHeight"],a=t[i?"offsetLeft":"offsetTop"],o=a+t[i?"offsetWidth":"offsetHeight"];return a>n&&o<s}function Ep(e,t,i=0,n=!1,s=!1,a=!1){const o=e[a?"scrollLeft":"scrollTop"],r=o+e[a?"offsetWidth":"offsetHeight"],l="string"==typeof t?e.querySelectorAll(t):t,{length:c}=l,d=[];let h=!1;for(let e=0;e<c;e++){const t=l[e],c=t[a?"offsetLeft":"offsetTop"],u=c+t[a?"offsetWidth":"offsetHeight"];if(s?u>=o-i&&u<=r+i:c<=r+i&&u>=o-i)d.push(e),h=!0;else if(h&&!n)break}return{allElements:l,visibleIndexes:d}}function Vp(e,t,i){const n=i.current;if(!n||t<0)return;const{visibleIndexes:s,allElements:a}=Ep(n,e,8,!0,!0);if(!a.length||!a[t])return;const o=s[0];if(!s.includes(t)||t===o&&!xp(n,a[o])){const e=t>s[s.length-1]?"start":"end";(0,Fr.Ay)({container:n,element:a[t],position:e,margin:10})}}function _p({isActive:e,isHorizontal:t,shouldSaveSelectionOnUpdateItems:i,shouldRemoveSelectionOnReset:s,noArrowNavigation:a,items:o,shouldSelectOnTab:r,onSelect:l,onClose:c}){const[d,h]=(0,n.J0)(-1),u=(0,M.A)(e=>o?(0,_a.A)(o.length,e):-1),m=(0,M.A)((e,t)=>{t.preventDefault(),h(t=>u(t+e))}),p=(0,M.A)(t=>{if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return!1;if(!e)return!1;if(o&&o.length&&d>-1){const e=o[d];if(e){if(!1===l(e))return!1;t.preventDefault()}}return!0});(0,n.vJ)(()=>{e||h(s?-1:0)},[e,s]);const v=!o||d>o.length-1;return(0,n.vJ)(()=>{i&&!v||h(s?-1:0)},[v,s,i]),(0,n.vJ)(()=>e?(0,Li.A)({onEsc:c,onUp:a||t?void 0:e=>m(-1,e),onDown:a||t?void 0:e=>m(1,e),onLeft:a||!t?void 0:e=>m(-1,e),onRight:a||!t?void 0:e=>m(1,e),onTab:r?p:void 0,onEnter:p}):void 0,[a,m,p,e,t,c,r]),d}const Up=(0,n.ph)(({isOpen:e,onClose:t,onInsertUserName:i,filteredUsers:a})=>{const o=(0,n.li)(),{shouldRender:r,transitionClassNames:l}=(0,Ke.A)(e,void 0,void 0,!1),c=(0,M.A)((e,t=!1)=>{const n=(0,s.mS)().users.byId[e];n&&i(n,t)}),d=(0,M.A)((e,t)=>{e.preventDefault(),c(t)}),h=(0,M.A)(e=>{c(e.id,!0)}),u=_p({isActive:e,items:a,onSelect:h,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:t});(0,n.vJ)(()=>{Vp(".chat-item-clickable",u,o)},[u]),(0,n.vJ)(()=>{a&&!a.length&&t()},[a,t]);const m=(0,_.A)(a?.length?a:void 0,r),p=a&&!a.length?m:a;if(!r||p&&!p.length)return;const v=(0,me.A)("MentionTooltip composer-tooltip custom-scroll",l);return(0,te.Y)("div",{className:v,ref:o,children:p?.map(({id:e},t)=>(0,te.Y)(di.A,{className:"chat-item-clickable scroll-item smaller-icon",onClick:d,clickArg:e,focus:u===t,children:(0,te.Y)(xn.A,{userId:e,avatarSize:"small",withUsername:!0})},e))})});var Op=i(78407),Kp=i(26440);const Jp="AT_d9l0W",Gp="AnO3BgVv",jp="caption-input-text",zp=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{currentUserId:i,recentEmojis:n,customEmojis:s,attachmentSettings:a}=e,r=(0,c.AWZ)(e,t),l=(0,c.nZ4)(e,t),{shouldSuggestCustomEmoji:d}=e.settings.byKey,{language:h}=(0,Is.l)(e),u=e.emojiKeywords[o.cUY],m=h!==o.cUY?e.emojiKeywords[h]:void 0;return{isChatWithSelf:l,currentUserId:i,groupChatMembers:r?.members,recentEmojis:n,baseEmojiKeywords:u?.keywords,emojiKeywords:m?.keywords,shouldSuggestCustomEmoji:d,customEmojiForEmoji:s.forEmoji.stickers,captionLimit:(0,Sa.d)(e,"captionLength"),attachmentSettings:a}})(({chatId:e,threadId:t,attachments:i,getHtml:a,editingMessage:c,canShowCustomSendMenu:d,captionLimit:h,isReady:u,isChatWithSelf:p,currentUserId:v,groupChatMembers:g,recentEmojis:A,baseEmojiKeywords:f,emojiKeywords:b,isForMessage:C,shouldSchedule:y,shouldSuggestCustomEmoji:S,customEmojiForEmoji:k,attachmentSettings:w,shouldForceCompression:N,shouldForceAsFile:I,isForCurrentMessageList:P,forceDarkTheme:D,onAttachmentsUpdate:B,onCaptionUpdate:R,onSend:L,onFileAppend:x,onClear:E,onSendSilent:V,onSendScheduled:U,onCustomEmojiSelect:O,onRemoveSymbol:K,onEmojiSelect:G,canScheduleUntilOnline:j,canSchedule:z,onSendWhenOnline:H,paidMessagesStars:$})=>{const q=(0,n.li)(),Z=(0,n.li)(),{addRecentCustomEmoji:ee,addRecentEmoji:ie,updateAttachmentSettings:ne}=(0,s.ko)(),se=(0,T.A)(),ae=(0,Ui.A)(),oe=(0,n.li)(),re=(0,n.li)(),le=(0,n.li)(),he=(0,_.A)(i),ue=i.length?i:he,{isMobile:pe}=(0,Y.Ay)(),ve=c&&Boolean(c),ge=c&&c?.groupedId,Ae="file"!==(ve&&i?.length&&(0,l.ES)(i[0])),[fe,Ce,Se]=(0,F.A)(),ke=w.shouldCompress,we=Boolean((ke||N||ge)&&!I),[Ne,Ie]=(0,n.J0)(w.shouldSendGrouped),Pe=w.isInvertedMedia,[Ye,Fe]=(0,n.J0)(w.shouldSendInHighQuality),[De,Me]=(0,n.J0)(Ye),{handleScroll:Te,isAtBeginning:Be,isAtEnd:Re}=Mn(),{handleScroll:Le,isAtBeginning:xe}=Mn(),Ee=Boolean(i.length),Ve=Boolean(ue?.length),[_e,Ue,Oe]=(0,F.A)(),Ke=(0,n.li)();(0,n.vJ)(()=>{Ee||(Se(),ne({isInvertedMedia:void 0}))},[Se,Ee]);const[Je,Ge]=(0,n.Kr)(()=>Boolean(ue?.every(e=>e.quick||e.audio))?[!0,!0]:[Boolean(ue?.some(e=>e.quick||e.audio)),!1],[ue]),[je,ze]=(0,n.Kr)(()=>Boolean(ue?.every(e=>e.shouldSendAsSpoiler))?[!0,!0]:[Boolean(ue?.some(e=>e.shouldSendAsSpoiler)),!1],[ue]),He=(0,Sp.A)(`#${o.e0F}`),{isEmojiTooltipOpen:$e,filteredEmojis:qe,filteredCustomEmojis:We,insertEmoji:Qe,closeEmojiTooltip:Ze}=(0,wp.A)(Boolean(u&&(P||!C)&&Ve),a,R,o.e0F,A,f,b),{isCustomEmojiTooltipOpen:Xe,insertCustomEmoji:et,closeCustomEmojiTooltip:tt}=(0,kp.A)(Boolean(u&&(P||!C)&&Ve&&S),a,R,He,re,k),{isMentionTooltipOpen:it,closeMentionTooltip:nt,insertMention:st,mentionFilteredUsers:at}=(0,Np.A)(Boolean(u&&P&&Ve),a,R,He,re,g,void 0,v);function ot(e){ne({isInvertedMedia:e})}(0,n.vJ)(()=>Ee?(0,m.A)(E):void 0,[Ee,E]),(0,n.vJ)(()=>{Ee&&(Ie(w.shouldSendGrouped),Fe(w.shouldSendInHighQuality))},[w,Ee]),(0,n.vJ)(()=>{Ee||ne({isInvertedMedia:void 0})},[ne,Ee]),(0,n.vJ)(()=>{Ee&&pe&&(0,bp.DY)()},[pe,Ee]);const{isContextMenuOpen:rt,handleContextMenu:lt,handleContextMenuClose:ct,handleContextMenuHide:dt}=(0,Ds.A)(oe,!d||!Ee),ht=(0,M.A)((e,t)=>{Ee&&(((y||t)&&C&&!c?U:e?V:L)(we,Ne,Pe),ne({shouldCompress:we,shouldSendGrouped:Ne,isInvertedMedia:Pe,shouldSendInHighQuality:Ye}))}),ut=(0,M.A)(()=>{ht(!0)}),mt=(0,M.A)(()=>{ht()}),pt=(0,M.A)(()=>{ht(!1,!0)}),vt=(0,M.A)(async e=>{e.preventDefault(),Oe();const{dataTransfer:t}=e,i=await(0,Cp.A)(t.items);i?.length&&x(i,ze)}),gt=(0,M.A)(e=>{const{files:t}=e.target,i=(0,J.kc)(t);i?.length&&x(i,ze)}),At=(0,M.A)(()=>{(0,Zh.p)("*",e=>gt(e))}),ft=(0,M.A)(e=>{B(i.filter((t,i)=>i!==e))}),bt=(0,M.A)(()=>{B(i.map(e=>({...e,shouldSendAsSpoiler:!0})))}),Ct=(0,M.A)(()=>{ne({shouldCompress:!ke})}),yt=(0,M.A)(()=>{const e=!Ye;Fe(e),ne({shouldSendInHighQuality:e})}),St=(0,M.A)(()=>{B(i.map(e=>({...e,shouldSendAsSpoiler:void 0})))}),kt=(0,M.A)(e=>{B(i.map((t,i)=>i===e?{...t,shouldSendAsSpoiler:!t.shouldSendAsSpoiler||void 0}:t))}),wt=(0,M.A)(()=>{const e=Z.current;if(!e)return;const{width:t,height:i}=e.getBoundingClientRect();e.viewBox.baseVal.width=t,e.viewBox.baseVal.height=i});(0,Jr.A)(q,wt),(0,ye.A)(wt),(0,n.vJ)(()=>{const e=oe.current,t=document.getElementById(jp);if(!e||!t)return;const{width:i}=e.getBoundingClientRect();(0,r.RK)(()=>{t.style.setProperty("--margin-for-scrollbar",`${i}px`)})},[se,Ee]);const Nt=(0,n.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,te.Y)(Q.A,{round:!0,ripple:!pe,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",children:(0,te.Y)(W.A,{name:"more"})}),[pe]),It=(0,be.A)(()=>{if(!Ve)return;const e=h-(t=a(),yp.innerHTML=t,(0,cp.g4)(yp),yp.querySelectorAll("br").forEach(e=>{e.replaceWith("\n")}),yp.textContent?.trim().length||0);var t;return e<=100?e:void 0},[h,a,Ve]),Pt=we&&Ge,[Yt,Ft,Dt,Mt]=(0,n.Kr)(()=>Pt&&ue?[ue.every(e=>o.gex.has(e.mimeType)),ue.every(e=>o.fNs.has(e.mimeType)),ue.every(e=>o.IH3.has(e.mimeType)),ue.some(e=>o.gex.has(e.mimeType))]:[!1,!1,!1],[ue,Pt]),Tt=(0,n.Kr)(()=>!!ue&&ue.some(e=>!o.IH3.has(e.mimeType)),[ue]);if((0,n.vJ)(()=>{if(Ye!==De)return Ke.current&&clearTimeout(Ke.current),Ke.current=window.setTimeout(()=>{Me(Ye)},200),()=>{Ke.current&&(clearTimeout(Ke.current),Ke.current=void 0)}},[Ye,De]),!ue)return;const Bt=ue.length>1,Rt=!(ve||!Je||!(I||N||we)||Bt&&Ne);let Lt="";const xt=ue.length;Lt=se(Yt?ve?"EditMessageReplacePhoto":"PreviewSender.SendPhoto":Ft?ve?"EditMessageReplaceVideo":"PreviewSender.SendVideo":Dt?ve?"EditMessageReplaceAudio":"PreviewSender.SendAudio":ve?"EditMessageReplaceFile":"PreviewSender.SendFile",xt,"i");const Et=!Re||!xe,Vt=$?(0,Ei.U2)(ae,xt*$,{className:"C1OOt81o",asFont:!0}):se("Send");return(0,te.Y)(X.A,{isOpen:Ee,onClose:E,header:function(){if(ue)return(0,te.FD)("div",{className:"modal-header-condensed",dir:se.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel attachments",onClick:E,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"modal-title",children:Lt}),Ae&&!ge&&(0,te.FD)(ce.A,{className:"attachmeneditingMessaget-modal-more-menu with-menu-transitions",trigger:Nt,positionX:"right",children:[Boolean(!c)&&(0,te.Y)(de.A,{icon:"add",onClick:At,children:se("Add")}),Je&&(0,te.FD)(te.FK,{children:[Rt&&(Pe?(0,te.Y)(de.A,{icon:"move-caption-down",onClick:()=>ot(void 0),children:ae("ContextMoveTextDown")}):(0,te.Y)(de.A,{icon:"move-caption-up",onClick:()=>ot(!0),children:ae("ContextMoveTextUp")})),!I&&!N&&(we?(0,te.Y)(de.A,{icon:"document",onClick:Ct,children:se(Bt?"Attachment.SendAsFiles":"Attachment.SendAsFile")}):(0,te.Y)(de.A,{icon:"photo",onClick:Ct,children:Bt?"Send All as Media":"Send as Media"})),we&&!c&&Mt&&(0,te.Y)(de.A,{icon:De?"sd-photo":"hd-photo",onClick:yt,children:ae(De?"SendInStandardQuality":"SendInHighQuality")}),we&&Tt&&Boolean(!c)&&(je?(0,te.Y)(de.A,{icon:"spoiler-disable",onClick:St,children:se("Attachment.DisableSpoiler")}):(0,te.Y)(de.A,{icon:"spoiler",onClick:bt,children:se("Attachment.EnableSpoiler")}))]}),Bt&&(Ne?(0,te.Y)(de.A,{icon:"grouped-disable",onClick:()=>Ie(!1),children:"Ungroup All Media"}):(0,te.Y)(de.A,{icon:"grouped",onClick:()=>Ie(!0),children:"Group All Media"}))]})]})}(),className:(0,me.A)("a27O2Qlr",_e&&Gp,!Be&&"Pc1k8G8s",pe&&"khvUZbGZ",fe&&"ir5kkMy1",D&&"component-theme-dark"),noBackdropClose:!0,isLowStackPriority:!0,children:(0,te.FD)("div",{className:Jp,onDragEnter:Ue,onDrop:vt,onDragOver:function(e){e.preventDefault(),le.current&&(window.clearTimeout(le.current),le.current=void 0)},onDragLeave:e=>{const{relatedTarget:t,target:i}=e;i.matches(`.${Jp}`)&&!t&&(le.current=window.setTimeout(Oe,150)),i&&i.closest(`.${Gp}`)||(t&&e.stopPropagation(),Oe())},onClick:Oe,"data-attach-description":se("Preview.Dragging.AddItems",10),"data-dropzone":!0,children:[(0,te.Y)("svg",{className:"d9O65j_I",children:(0,te.Y)("rect",{className:"jzCBDWMw",x:"0",y:"0",width:"100%",height:"100%",rx:"8"})}),(0,te.Y)("div",{className:(0,me.A)("_bxSIFgj","custom-scroll",Et&&"RPVunBe2"),onScroll:Te,children:ue.map((e,t)=>(0,te.Y)(Tp,{attachment:e,shouldDisplayCompressed:we,shouldDisplayGrouped:Ne,isSingle:1===ue.length,index:t,onDelete:ft,onToggleSpoiler:kt},e.uniqueId||t))}),(0,te.FD)("div",{className:(0,me.A)("EtmiUn2k",Et&&"FjjSKMYe"),children:[(0,te.Y)(Up,{isOpen:it,filteredUsers:at,onInsertUserName:st,onClose:nt}),(0,te.Y)(Lp.A,{isOpen:$e,emojis:qe,customEmojis:We,addRecentEmoji:ie,addRecentCustomEmoji:ee,onEmojiSelect:Qe,onCustomEmojiSelect:Qe,onClose:Ze}),(0,te.Y)(Bp.A,{chatId:e,isOpen:Xe,addRecentCustomEmoji:ee,onCustomEmojiSelect:et,onClose:tt}),(0,te.FD)("div",{className:"Te7lIfpB",children:[(0,te.Y)(Kp.A,{chatId:e,threadId:t,isMobile:pe,isReady:u,isSymbolMenuOpen:fe,openSymbolMenu:Ce,closeSymbolMenu:Se,onCustomEmojiSelect:O,onRemoveSymbol:K,onEmojiSelect:G,isAttachmentModal:!0,canSendPlainText:!0,className:"attachment-modal-symbol-menu with-menu-transitions",idPrefix:"attachment",forceDarkTheme:D}),(0,te.Y)(Op.A,{ref:re,id:jp,chatId:e,threadId:t,isAttachmentModalInput:!0,customEmojiPrefix:"attachment",isReady:u,isActive:Ee,getHtml:a,editableInputId:o.e0F,placeholder:se("AddCaption"),onUpdate:R,onSend:mt,onScroll:Le,canAutoFocus:Boolean(u&&P&&i.length),captionLimit:It,shouldSuppressFocus:pe&&fe,onSuppressedFocus:Se}),(0,te.FD)("div",{className:"wDqWK9MD",children:[(0,te.Y)(Q.A,{ref:oe,className:"kNlWmBJI",size:"smaller",onClick:mt,onContextMenu:d?lt:void 0,children:y&&!c?se("Next"):c?se("Save"):Vt}),d&&(0,te.Y)(Rp.A,{isOpen:rt,canSchedule:z&&C,onSendSilent:p?void 0:ut,onSendSchedule:pt,onClose:ct,onCloseAnimationEnd:dt,isSavedMessages:p,onSendWhenOnline:H,canScheduleUntilOnline:j})]})]})]})]})})})),Hp=(0,n.ph)(({isOpen:e,isQuiz:t,shouldBeAnonymous:i,maxOptionsCount:s=12,onSend:a,onClear:o})=>{const l=(0,n.li)(),c=(0,n.li)(),[d,h]=(0,n.J0)(""),[u,p]=(0,n.J0)([""]),[v,g]=(0,n.J0)(!0),[A,f]=(0,n.J0)(!1),[b,C]=(0,n.J0)(t||!1),[y,S]=(0,n.J0)(""),[k,w]=(0,n.J0)(),[N,I]=(0,n.J0)(!1),P=(0,T.A)(),Y=(0,M.A)(e=>{S(e.target.value)}),F=(0,M.A)(t=>{e&&t.current&&t.current.focus()});(0,n.vJ)(()=>e?(0,m.A)(o):void 0,[e,o]),(0,n.vJ)(()=>{e||(h(""),p([""]),g(!0),f(!1),C(t||!1),S(""),w(void 0),I(!1))},[t,e]),(0,n.vJ)(()=>F(l),[F,e]);const D=(0,M.A)((e=[])=>{p([...e,""]),(0,r.Uz)(()=>{const e=c.current;e&&(0,r.YS)(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})})}),B=(0,M.A)(()=>{if(I(!1),!e)return;const t=b&&(void 0===k||!u[k].trim()),i=u.map((e,t)=>{if(e=e.trim())return{text:{text:e},option:String(t),...t===k&&{correct:!0}}}).filter(Boolean),n=d.trim().substring(0,255);if(!n||i.length<2){if(h(n),i.length){const e=u.map(e=>e.trim().substring(0,100)).filter(Boolean);e.length<2?D(e):p(e)}else D();return void I(!0)}if(t)return void I(!0);const s={summary:{question:{text:n},answers:i,...!v&&{isPublic:!0},...A&&{multipleChoice:!0},...b&&{quiz:!0}}};if(b){const{text:e,entities:t}=y&&(0,cp.Ay)(y.substring(0,200))||{};s.quiz={correctAnswers:[String(k)],...e&&{solution:e},...t&&{solutionEntities:t}}}a(s)}),R=(0,M.A)((e,t)=>{const i=[...u];i[e]=t,i[i.length-1].trim().length&&i.length<s?D(i):p(i)}),L=(0,M.A)(e=>{const t=[...u];t.splice(e,1),p(t),void 0!==k&&(k===e?w(void 0):e<k&&w(k-1)),(0,r.Uz)(()=>{c.current&&c.current.classList.toggle("overflown",c.current.scrollHeight>320)})}),x=(0,M.A)(e=>{w(Number(e))}),E=(0,M.A)(e=>{g(e.target.checked)}),V=(0,M.A)(e=>{f(e.target.checked)}),_=(0,M.A)(e=>{C(e.target.checked)}),U=(0,M.A)(e=>{13===e.keyCode&&B()}),O=(0,M.A)(e=>{h(e.target.value)}),K=(0,M.A)(()=>{if(N&&!d.trim().length)return P("lng_polls_choose_question")}),J=(0,M.A)(e=>{const t=u.map(e=>e.trim()).filter(e=>e.length);if(N&&t.length<2&&!u[e].trim().length)return P("lng_polls_choose_answers")});function G(){return u.map((e,t)=>(0,te.FD)("div",{className:"option-wrapper",children:[(0,te.Y)(Z.A,{maxLength:100,label:t!==u.length-1||u.length===s?P("OptionHint"):P("CreatePoll.AddOption"),error:J(t),value:e,onChange:e=>R(t,e.currentTarget.value),onKeyPress:U}),t!==u.length-1&&(0,te.Y)(Q.A,{className:"option-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:P("Delete"),onClick:()=>L(t),children:(0,te.Y)(W.A,{name:"close"})})]}))}return(0,te.FD)(X.A,{isOpen:e,onClose:o,header:(0,te.FD)("div",{className:"modal-header-condensed",children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel poll creation",onClick:o,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"modal-title",children:P("NewPoll")}),(0,te.Y)(Q.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:B,children:P("Create")})]}),className:"PollModal",children:[(0,te.Y)(Z.A,{ref:l,label:P("AskAQuestion"),value:d,error:K(),onChange:O,onKeyPress:U}),(0,te.Y)("div",{className:"options-divider"}),(0,te.FD)("div",{className:"options-list custom-scroll",ref:c,children:[(0,te.Y)("h3",{className:"options-header",children:P("PollOptions")}),N&&function(){const e=u.map(e=>e.trim()).filter(e=>e.length);return b&&(void 0===k||!e[k])&&(0,te.Y)("p",{className:"poll-error",children:P("lng_polls_choose_correct")})}(),b?(0,te.Y)(ee.A,{name:"correctOption",options:G().map((e,t)=>({value:String(t),label:e,hidden:!u[t].trim()})),selected:String(k),onChange:x}):G()]}),(0,te.Y)("div",{className:"options-divider"}),(0,te.FD)("div",{className:"quiz-mode",children:[(0,te.FD)("div",{className:"dialog-checkbox-group",children:[!i&&(0,te.Y)(ps.A,{label:P("PollAnonymous"),checked:v,onChange:E}),(0,te.Y)(ps.A,{label:P("PollMultiple"),checked:A,disabled:b,onChange:V}),(0,te.Y)(ps.A,{label:P("PollQuiz"),checked:b,disabled:A||void 0!==t,onChange:_})]}),b&&(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{className:"options-header",children:P("lng_polls_solution_title")}),(0,te.Y)(Ql.A,{value:y,onChange:Y,noReplaceNewlines:!0}),(0,te.Y)("div",{className:"note",children:P("CreatePoll.ExplanationInfo")})]})]})]})});var $p=i(14235);const qp=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const{appConfig:i}=e;return{editingMessage:t?.messageId?(0,c.O5q)(e,t.chatId,t.messageId):void 0,maxItemsCount:i.todoItemsMax,maxTitleLength:i.todoTitleLengthMax,maxItemLength:i.todoItemLengthMax}})(({modal:e,maxItemsCount:t,maxTitleLength:i,maxItemLength:a,editingMessage:o,onSend:l,onClear:c})=>{const{editTodo:d,closeTodoListModal:h,appendTodoList:u}=(0,s.ko)(),p=(0,n.li)(),v=(0,n.li)(),[g,A]=(0,n.J0)(""),[f,b]=(0,n.J0)([{id:(0,$p.t)(),text:""}]),[C,y]=(0,n.J0)(!0),[S,k]=(0,n.J0)(!0),[w,N]=(0,n.J0)(!1),I=(0,Ui.A)(),P=Boolean(e),Y=(0,Ri.A)(e),F=Y?.forNewTask&&!o?.isOutgoing,D=o?.content.todo?.todo,T=(0,n.Kr)(()=>F&&D?D.items.map(e=>({id:e.id,text:e.title.text,isDisabled:!0})):yi.p,[F,D]),B=(0,M.A)(e=>{P&&e.current&&e.current.focus()});(0,n.Nf)(()=>{if(D&&(A(D.title.text),y(D.othersCanAppend??!1),k(D.othersCanComplete??!1),!F)){const e=D.items.map(e=>({id:e.id,text:e.title.text}));e.length<t&&e.push({id:(0,$p.t)(),text:""}),b(e)}},[D,F,t]),(0,n.vJ)(()=>P?(0,m.A)(c):void 0,[P,c]),(0,n.vJ)(()=>{P||(A(""),b([{id:(0,$p.t)(),text:""}]),y(!0),k(!0),N(!1))},[P]),(0,n.vJ)(()=>{P&&(0,r.YS)(()=>{if(Y?.forNewTask){const e=v.current?.querySelectorAll("input"),t=e?.[e.length-1];t?.focus()}else B(p)})},[B,P,Y?.forNewTask]);const R=(0,M.A)(e=>{const t=(0,$p.t)();b([...e,{id:t,text:""}]),(0,r.Uz)(()=>{const e=v.current;e&&(0,r.YS)(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})})}),L=(0,M.A)(()=>{if(N(!1),!P)return;const e=f.map(e=>{const t=e.text.trim();if(t)return{id:e.id,title:{text:t.substring(0,a)}}}).filter(Boolean),t=g.trim().substring(0,i);if(!t||0===e.length){if(A(t),e.length){const e=f.map(e=>({...e,text:e.text.trim().substring(0,a)})).filter(e=>e.text.length);0===e.length?R([]):b([...e,{id:(0,$p.t)(),text:""}])}else R([]);return void N(!0)}if(F&&o)return u({chatId:o.chatId,messageId:o.id,items:e}),void h();const n={todo:{title:{text:t},items:e,othersCanAppend:C,othersCanComplete:S}};o?d({chatId:o.chatId,todo:n,messageId:o.id}):l(n),h()}),x=(0,M.A)((e,i)=>{const n=[...f];n[e]={...n[e],text:i},n[n.length-1].text.trim().length&&n.length<t?R(n):b(n)}),E=(0,M.A)(e=>{const t=[...f];t.splice(e,1),b(t),(0,r.Uz)(()=>{v.current&&v.current.classList.toggle("overflown",v.current.scrollHeight>320)})}),V=(0,M.A)(e=>{y(e.target.checked)}),_=(0,M.A)(e=>{k(e.target.checked)}),U=(0,M.A)(e=>{"Enter"===e.key&&L()}),O=(0,M.A)(e=>{A(e.target.value)}),K=(0,M.A)(()=>{if(w&&!g.trim().length)return I("ToDoListErrorChooseTitle")}),J=(0,M.A)(e=>{const t=f.map(e=>e.text.trim()).filter(e=>e.length);if(w&&t.length<1&&!f[e].text.trim().length)return I("ToDoListErrorChooseTasks")}),G=t-f.length-(F&&D?D.items.length:0);return(0,te.FD)(X.A,{isOpen:P,onClose:c,header:function(){const e=F?"TitleAppendToDoList":o?"TitleEditToDoList":"TitleNewToDoList";return(0,te.FD)("div",{className:"modal-header-condensed",children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:I("AriaToDoCancel"),onClick:c,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)("div",{className:"modal-title",children:I(e)}),(0,te.Y)(Q.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:L,children:I(F?"Add":o?"Save":"Create")})]})}(),className:"ToDoListModal",children:[!F&&(0,te.Y)(Z.A,{ref:p,label:I("InputTitle"),value:g,error:K(),onChange:O,onKeyPress:U}),F&&(0,te.Y)("div",{className:"readonly-title",children:g}),(0,te.Y)("div",{className:"options-divider"}),(0,te.FD)("div",{className:"options-list custom-scroll",ref:v,children:[(0,te.Y)("h3",{className:"items-header",children:I("TitleToDoList")}),function(){const e=[...T,...f];return e.map((i,n)=>{const s=n-T.length;return(0,te.FD)("div",{className:"item-wrapper",children:[(0,te.Y)(Z.A,{maxLength:100,label:n!==e.length-1||e.length===t?I("TitleTask"):I("TitleAddTask"),error:J(s),value:i.text,disabled:i.isDisabled,onChange:e=>x(s,e.currentTarget.value),onKeyPress:U}),n!==e.length-1&&!i.isDisabled&&(0,te.Y)(Q.A,{className:"item-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:I("Delete"),onClick:()=>E(s),children:(0,te.Y)(W.A,{name:"close"})})]})})}()]}),(0,te.Y)("div",{className:"items-count-hint",children:I("HintTodoListTasksCount2",{count:G},{pluralValue:G})}),(0,te.Y)("div",{className:"options-divider"}),!F&&(0,te.Y)("div",{className:"options-footer",children:(0,te.FD)("div",{className:"dialog-checkbox-group",children:[(0,te.Y)(ps.A,{label:I("AllowOthersAddTasks"),checked:C,onChange:V}),(0,te.Y)(ps.A,{label:I("AllowOthersMarkAsDone"),checked:S,onChange:_})]})})]})}));var Wp=i(36680),Qp=i(52491);const Zp=(0,n.ph)(({emoji:e,focus:t,onClick:i})=>{const n=(0,M.A)(t=>{t.preventDefault(),i(e.native,e.id)}),s=(0,me.A)("EmojiButton",t&&"focus"),a=`./img-apple-64/${e.image}.png`,o=Qp.On.has(a);return(0,te.Y)("div",{className:s,onMouseDown:n,title:`:${e.names[0]}:`,children:u.TL?e.native:(0,te.Y)("img",{src:a,className:o?void 0:"opacity-transition shown",alt:e.native,loading:"lazy","data-path":a,onLoad:o?void 0:Qp.P_,draggable:!1})})}),Xp=.625*g.$,ev=.25*g.$,tv=.5*g.$,iv=.5*g.$,nv=(0,n.ph)(({category:e,index:t,allEmojis:i,observeIntersection:s,shouldRender:a,onEmojiSelect:r})=>{const l=(0,n.li)();(0,Dr.mv)(l,s);const c=(0,Ki.A)(a),d=(0,T.A)(),{isMobile:h}=(0,Y.Ay)(),u=h?Math.floor((w.A.get().width-iv+Xp)/(o.g0Q+Xp)):8,m=Math.ceil(e.emojis.length/u)*(o.g0Q+(h?tv:ev));return(0,te.FD)("div",{ref:l,id:`emoji-category-${t}`,className:"symbol-set",children:[(0,te.Y)("div",{className:"symbol-set-header",children:(0,te.Y)("p",{className:"symbol-set-name",dir:"auto",children:d(e.id===o.sR2?"RecentStickers":`Emoji${t}`)})}),(0,te.Y)("div",{className:(0,me.A)("symbol-set-container",c),style:`height: ${m}px;`,dir:d.isRtl?"rtl":void 0,children:a&&e.emojis.map(e=>{const t=i[e];if(!t)return;const n="id"in t?t:t[1];return(0,te.Y)(Zp,{emoji:n,onClick:r},n.id)})})]},e.id)}),sv={recent:"recent",people:"smile",nature:"animals",foods:"eats",activity:"sport",places:"car",objects:"lamp",symbols:"language",flags:"flag"},av=3.25*g.$,ov=2.625*g.$,rv=[];let lv,cv,dv;const hv=(0,n.ph)((0,s.EK)(e=>(0,Ci.Up)(e,["recentEmojis"]))(({className:e,recentEmojis:t,onEmojiSelect:s})=>{const a=(0,n.li)(),r=(0,n.li)(),[l,c]=(0,n.J0)(),[d,h]=(0,n.J0)(),[m,p]=(0,n.J0)(0),{isMobile:v}=(0,Y.Ay)(),{handleScroll:g,isAtBeginning:A}=Mn(),{observe:f}=(0,Dr.BL)({rootRef:a,throttleMs:200},e=>{e.forEach(e=>{const{id:t}=e.target;if(!t||!t.startsWith("emoji-category-"))return;const i=Number(t.replace("emoji-category-",""));rv[i]=e.isIntersecting});const t=rv.reduce((e,t,i)=>t&&i<e?i:e,1/0);t!==1/0&&p(t)}),b=(0,Yr.A)([],o.vVF),C=d&&b;(0,xs.A)(r,!(v&&C)),(0,n.vJ)(()=>{if(!l)return;const e=r.current;if(!e)return;const t=m*ov-e.offsetWidth/2+ov/2;(0,Da.A)(e,t)},[l,m]);const y=(0,T.A)(),S=(0,n.Kr)(()=>{if(!l)return yi.p;const e=[...l];return t?.length&&e.unshift({id:o.sR2,name:y("RecentStickers"),emojis:t}),e},[l,y,t]);(0,n.vJ)(()=>{setTimeout(()=>{const e=()=>{c(dv.categories),h(dv.emojis)};dv?e():async function(){return lv||(lv=i.e(996).then(i.t.bind(i,20996,19)),cv=(await lv).default,dv=(0,Qp.cp)(cv)),lv}().then(e)},200)},[]);const k=(0,M.A)(e=>{p(e);const t=a.current.closest(".SymbolMenu-main").querySelector(`#emoji-category-${e}`);(0,Fr.Ay)({container:a.current,element:t,position:"start",margin:av,maxDistance:100})}),w=(0,M.A)((e,t)=>{s(e,t)}),N=(0,me.A)("EmojiPicker",e),I=(0,me.A)("EmojiPicker-header",!A&&"with-top-border");return(0,te.Y)(se.Ay,{className:N,activeKey:C?1:0,name:"fade",shouldCleanup:!0,children:C?(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{ref:r,className:I,dir:y.isRtl?"rtl":void 0,children:S.map(function(e,t){const i=sv[e.id];return i&&(0,te.Y)(Q.A,{className:"symbol-set-button "+(t===m?"activated":""),round:!0,faded:!0,color:"translucent",onClick:()=>k(t),ariaLabel:e.name,children:(0,te.Y)(W.A,{name:i})})})}),(0,te.Y)("div",{ref:a,onScroll:g,className:(0,me.A)("EmojiPicker-main",u.TF?"no-scrollbar":"custom-scroll"),children:S.map((e,t)=>(0,te.Y)(nv,{category:e,index:t,allEmojis:d,observeIntersection:f,shouldRender:m>=t-1&&m<=t+1,onEmojiSelect:w}))})]}):(0,te.Y)($n.A,{})})})),uv=(0,n.ph)(({gif:e,isDisabled:t,className:i,observeIntersection:s,onClick:a,onUnsaveClick:o,isSavedMessages:r})=>{const c=(0,n.li)(),d=(0,T.A)(),h=(0,Dr.Vz)(c,s)&&!t,m=!e.hasVideoPreview&&e.thumbnail&&(0,l.sC)(e,"pictogram"),p=(0,z.A)(m,!h),[v]=(0,n.J0)(e.thumbnail?.dataUri&&!p),g=(0,_i.A)(e.thumbnail?.dataUri,!v),A=(0,l.Ct)(e)||(0,l.sC)(e,"full"),f=(0,z.A)(A,!h),b=Boolean(h&&f),{isBuffered:C,bufferingHandlers:y}=(0,Oe.A)(!0),S=h&&!C,k=h&&C,{isContextMenuOpen:w,contextMenuAnchor:N,handleBeforeContextMenu:I,handleContextMenu:P,handleContextMenuClose:Y,handleContextMenuHide:F}=(0,Ds.A)(c),D=(0,M.A)(()=>c.current),B=(0,M.A)(()=>c.current.closest(".custom-scroll, .no-scrollbar")),R=(0,M.A)(()=>c.current.querySelector(".gif-context-menu .bubble")),L=(0,M.A)(()=>{!w&&a&&a({...e,blobUrl:f})}),x=(0,M.A)(t=>{t.stopPropagation(),t.preventDefault(),o(e)}),E=(0,M.A)(()=>{o?.(e)}),V=(0,M.A)(()=>{a({...e,blobUrl:f},!0)}),_=(0,M.A)(()=>{a({...e,blobUrl:f},void 0,!0)}),U=(0,M.A)(e=>{(0,_r.u)(e),I(e)});(0,n.vJ)(()=>{t&&Y()},[Y,t]);const O=(0,me.A)("GifButton",e.width&&e.height&&e.width<e.height?"vertical":"horizontal",a&&"interactive",i);return(0,te.FD)("div",{ref:c,className:O,onMouseDown:U,onClick:L,onContextMenu:P,children:[!u.TF&&o&&(0,te.Y)(Q.A,{className:"gif-unsave-button",color:"dark",pill:!0,noFastClick:!0,onClick:x,children:(0,te.Y)(W.A,{name:"close",className:"gif-unsave-button-icon"})}),v&&(0,te.Y)("canvas",{ref:g,className:"thumbnail"}),p&&!k&&(0,te.Y)("img",{src:p,alt:"",className:"preview",draggable:!1}),b&&(0,te.Y)(an.A,{canPlay:!0,src:f,autoPlay:!0,loop:!0,muted:!0,disablePictureInPicture:!0,playsInline:!0,preload:"none",...y}),S&&(0,te.Y)(Ee.A,{color:p||v?"white":"black"}),a&&void 0!==N&&(0,te.FD)(qe.A,{isOpen:w,anchor:N,getTriggerElement:D,getRootElement:B,getMenuElement:R,className:"gif-context-menu",autoClose:!0,onClose:Y,onCloseAnimationEnd:F,children:[!r&&(0,te.Y)(de.A,{onClick:V,icon:"mute",children:d("SendWithoutSound")}),(0,te.Y)(de.A,{onClick:_,icon:"calendar",children:d(r?"SetReminder":"ScheduleMessage")}),o&&(0,te.Y)(de.A,{destructive:!0,icon:"delete",onClick:E,children:d("Delete")})]})]})}),mv=(0,n.ph)((0,s.EK)(e=>{const{chatId:t}=(0,c.Xf0)(e)||{},i=Boolean(t)&&(0,c.nZ4)(e,t);return{savedGifs:e.gifs.saved.gifs,isSavedMessages:i}})(({className:e,loadAndPlay:t,canSendGifs:i,savedGifs:a,isSavedMessages:r,onGifSelect:l})=>{const{loadSavedGifs:c,saveGif:d}=(0,s.ko)(),h=(0,n.li)(),{observe:m}=(0,Dr.BL)({rootRef:h,debounceMs:300});(0,n.vJ)(()=>{t&&c()},[t,c]);const p=(0,M.A)(e=>{d({gif:e,shouldUnsave:!0})}),v=(0,Yr.A)([],o.jhd),g=i&&(!v||!a);return(0,te.Y)(se.Ay,{ref:h,className:(0,me.A)("GifPicker",e,u.TF?"no-scrollbar":"custom-scroll"),slideClassName:"GifPickerGrid",activeKey:g?0:1,name:"fade",shouldCleanup:!0,children:i?v&&a&&a.length?a.map(e=>(0,te.Y)(uv,{gif:e,observeIntersection:m,isDisabled:!t,onClick:i?l:void 0,onUnsaveClick:p,isSavedMessages:r},e.id)):v&&a?(0,te.Y)("div",{className:"picker-disabled",children:"No saved GIFs."}):(0,te.Y)($n.A,{color:"yellow"}):(0,te.Y)("div",{className:"picker-disabled",children:"Sending GIFs is not allowed in this chat."})})}));let pv=function(e){return e[e.Emoji=0]="Emoji",e[e.CustomEmoji=1]="CustomEmoji",e[e.Stickers=2]="Stickers",e[e.GIFs=3]="GIFs",e}({});const vv={[pv.Emoji]:"Emoji",[pv.CustomEmoji]:"StickersList.EmojiItem",[pv.Stickers]:"AccDescrStickers",[pv.GIFs]:"GifsTab"},gv={[pv.Emoji]:"icon-smile",[pv.CustomEmoji]:"icon-favorite",[pv.Stickers]:"icon-stickers",[pv.GIFs]:"icon-gifs"},Av=(0,n.ph)(({activeTab:e,onSwitchTab:t,onRemoveSymbol:i,onSearchOpen:n,isAttachmentModal:s,canSendPlainText:a,canSearch:o})=>{const r=(0,T.A)();function l(i){return(0,te.Y)(Q.A,{className:"symbol-tab-button "+(e===i?"activated":""),onClick:()=>t(i),ariaLabel:r(vv[i]),round:!0,faded:!0,color:"translucent",children:(0,te.Y)("i",{className:(0,me.A)("icon",gv[i])})})}const c=(0,M.A)(()=>{n(e===pv.Stickers?"stickers":"gifs")});return(0,te.FD)("div",{className:"SymbolMenu-footer",onClick:function(e){e.stopPropagation()},dir:r.isRtl?"rtl":void 0,children:[e!==pv.Emoji&&e!==pv.CustomEmoji&&o&&(0,te.Y)(Q.A,{className:"symbol-search-button",ariaLabel:e===pv.Stickers?"Search Stickers":"Search GIFs",round:!0,faded:!0,color:"translucent",onClick:c,children:(0,te.Y)(W.A,{name:"search"})}),a&&l(pv.Emoji),a&&l(pv.CustomEmoji),!s&&l(pv.Stickers),!s&&l(pv.GIFs),(e===pv.Emoji||e===pv.CustomEmoji)&&(0,te.Y)(Q.A,{className:"symbol-delete-button",onClick:i,ariaLabel:"Remove Symbol",round:!0,faded:!0,color:"translucent",children:(0,te.Y)(W.A,{name:"delete-left"})})]})});let fv=!1;const bv=(0,n.ph)((0,s.EK)(e=>({isLeftColumnShown:(0,c.nTw)(e).isLeftColumnShown,isBackgroundTranslucent:(0,c.cwE)(e),animationLevel:(0,Is.l)(e).animationLevel}))(({chatId:e,threadId:t,isOpen:i,canSendStickers:s,canSendGifs:a,isMessageComposer:o,idPrefix:l,isAttachmentModal:c,canSendPlainText:d,className:h,onLoad:m,onClose:p,onEmojiSelect:v,onCustomEmojiSelect:g,onStickerSelect:A,onGifSelect:f,onRemoveSymbol:b,onSearchOpen:C,addRecentEmoji:y,addRecentCustomEmoji:S,isLeftColumnShown:k,isBackgroundTranslucent:w,animationLevel:N,...I})=>{const[P,F]=(0,n.J0)(pv.Emoji),[D,B]=(0,n.J0)([]),[R,L]=(0,n.J0)([]),{isMobile:x}=(0,Y.Ay)(),[E,V]=(0,Wp.A)(i,p,void 0,x),{shouldRender:_,transitionClassNames:U}=(0,Ke.A)(i,p,!1,!1),O=(0,T.A)();!fv&&i&&(fv=!0),(0,n.vJ)(()=>{m()},[m]),(0,n.vJ)(()=>{d||F(pv.Stickers)},[d]),(0,n.Nf)(()=>{if(x&&i&&!c)return document.body.classList.add("enable-symbol-menu-transforms"),document.body.classList.add("is-symbol-menu-open"),()=>{document.body.classList.remove("is-symbol-menu-open"),setTimeout(()=>{(0,r.RK)(()=>{document.body.classList.remove("enable-symbol-menu-transforms")})},350)}},[c,x,i]);const K=(0,n.li)(D);K.current=D,(0,n.vJ)(()=>{K.current.length&&!i&&(K.current.forEach(e=>{y({emoji:e})}),B([]))},[i,y]);const J=(0,M.A)((e,t)=>{B(e=>[...e,t]),v(e)}),G=(0,n.li)(R);G.current=R,(0,n.vJ)(()=>{G.current.length&&!i&&(G.current.forEach(e=>{S({documentId:e})}),L([]))},[i,S]);const j=(0,M.A)(e=>{L(t=>[...t,e.id]),g(e)}),z=(0,M.A)(e=>{p(),C(e)}),H=(0,M.A)((e,t,i,n)=>{A?.(e,t,i,!0,n)}),$=(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{className:"SymbolMenu-main",onClick:function(e){e.stopPropagation()},children:fv&&(0,te.Y)(se.Ay,{name:(0,Vc.P)("slide",N),activeKey:P,renderCount:Object.values(vv).length,children:function(n,r){switch(P){case pv.Emoji:return(0,te.Y)(hv,{className:"picker-tab",onEmojiSelect:J});case pv.CustomEmoji:return(0,te.Y)(ol,{className:"picker-tab",isHidden:!i||!n,idPrefix:l,loadAndPlay:i&&(n||r),chatId:e,isTranslucent:!x&&w,onCustomEmojiSelect:j});case pv.Stickers:return(0,te.Y)(mp,{className:"picker-tab",isHidden:!i||!n,loadAndPlay:!!s&&i&&(n||r),idPrefix:l,canSendStickers:s,noContextMenus:!o,chatId:e,threadId:t,isTranslucent:!x&&w,onStickerSelect:H});case pv.GIFs:return(0,te.Y)(mv,{className:"picker-tab",loadAndPlay:!!a&&i&&(n||r),canSendGifs:a,onGifSelect:f})}}})}),x&&(0,te.Y)(Q.A,{round:!0,faded:!0,color:"translucent",ariaLabel:O("Close"),className:"symbol-close-button",size:"tiny",onClick:p,children:(0,te.Y)(W.A,{name:"close"})}),(0,te.Y)(Av,{activeTab:P,onSwitchTab:F,onRemoveSymbol:b,canSearch:o,onSearchOpen:z,isAttachmentModal:c,canSendPlainText:d})]});if(x){if(!_)return;const e=(0,me.A)("SymbolMenu mobile-menu",U,k&&"left-column-open",c&&"in-attachment-modal",o&&"in-middle-column");return c?(0,te.Y)("div",{className:e,children:$}):(0,te.Y)(rl.A,{children:(0,te.Y)("div",{className:e,children:$})})}return(0,te.Y)(qe.A,{isOpen:i,onClose:p,withPortal:c,className:(0,me.A)("SymbolMenu",h),onCloseAnimationEnd:p,onMouseEnter:u.TF?void 0:E,onMouseLeave:u.TF?void 0:V,noCloseOnBackdrop:!u.TF,noCompact:!0,...c?I:{positionX:"left",positionY:"bottom"},children:$})}));var Cv=i(91034);const yv=(0,n.ph)(({withAvatar:e,focus:t,command:i,description:n,peer:s,clickArg:a,onClick:o})=>{const r=(0,M.A)(()=>{o(a)});return(0,te.FD)(di.A,{className:(0,me.A)("BotCommand chat-item-clickable scroll-item",e&&"with-avatar"),multiline:!0,onClick:r,focus:t,children:[e&&(0,te.Y)(Mt.A,{size:"small",peer:s}),(0,te.FD)("div",{className:"content-inner",children:[(0,te.FD)("span",{className:"title",children:["/",i]}),(0,te.Y)("span",{className:"subtitle",children:(0,Dt.A)(n)})]})]},i)}),Sv=(0,n.ph)((0,Cv.A)(({isOpen:e,chatId:t,withUsername:i,botCommands:a,quickReplies:o,quickReplyMessages:r,self:c,getHtml:d,onClick:h,onClose:u})=>{const{sendBotCommand:m,sendQuickReply:p}=(0,s.ko)(),v=(0,n.li)(),{shouldRender:g,transitionClassNames:A}=(0,Ke.A)(e,void 0,void 0,!1),f=(0,M.A)(({botId:e,command:t})=>{const n=(0,s.mS)().users.byId[e];m({command:`/${t}${i&&n?`@${(0,l.Kl)(n)}`:""}`}),h()}),b=(0,M.A)(e=>{p({chatId:t,quickReplyId:e}),h()}),C=(0,n.Kr)(()=>{if(o?.length&&r)return o.map(e=>{const t=r[e.topMessageId];return{id:e.id,command:e.shortcut,description:t?.content.text?.text||""}})},[o,r]),y=(0,M.A)(e=>!!e.command.startsWith(d().slice(1))&&("id"in e?b(e.id):f(e),!0)),S=_p({isActive:e,items:(0,n.Kr)(()=>{if(a||C)return[].concat(C||[],a||[])},[a,C]),onSelect:y,onClose:u}),k=a&&!a.length||o&&!o.length;if((0,n.vJ)(()=>{k&&u()},[k,u]),(0,n.vJ)(()=>{Vp(".chat-item-clickable",S,v)},[S]),!g||k)return;const w=(0,me.A)("iaTB59vy","composer-tooltip custom-scroll",A);return(0,te.FD)("div",{className:w,ref:v,children:[C?.map((e,t)=>(0,te.Y)(yv,{command:e.command,description:e.description,peer:c,withAvatar:!0,clickArg:e.id,onClick:b,focus:S===t},`quickReply_${e.id}`)),a?.map((e,t)=>(0,te.Y)(yv,{command:e.command,description:e.description,peer:(0,s.mS)().users.byId[e.botId],withAvatar:!0,clickArg:e,onClick:f,focus:S+(C?.length||0)===t},`${e.botId}_${e.command}`))]})})),kv=(0,n.ph)(({isOpen:e,botCommands:t,onClose:i})=>{const{sendBotCommand:n}=(0,s.ko)(),{isMobile:a}=(0,Y.Ay)(),[o,r]=(0,Wp.A)(e,i,void 0,a),l=(0,M.A)(e=>{n({command:`/${e}`}),i()});return(0,te.Y)(qe.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:i,className:"BotCommandMenu",onCloseAnimationEnd:i,onMouseEnter:u.TF?void 0:o,onMouseLeave:u.TF?void 0:r,noCloseOnBackdrop:!u.TF,noCompact:!0,children:t.map(e=>(0,te.Y)(yv,{command:e.command,description:e.description,clickArg:e.command,onClick:l},e.command))})}),wv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{stickers:i}=e.stickers.forEmoji;return{stickers:i,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}})(({chatId:e,threadId:t,isOpen:i,onStickerSelect:s,onClose:a,stickers:r,isSavedMessages:l,isCurrentUserPremium:c})=>{const d=(0,n.li)(),{shouldRender:h,transitionClassNames:u}=(0,Ke.A)(i,void 0,void 0,!1),p=(0,_.A)(r,!0),v=r||p,g=(0,hp.A)(e,t),{observe:A}=(0,Dr.BL)({rootRef:d,throttleMs:200});(0,n.vJ)(()=>i?(0,m.A)(a):void 0,[i,a]);const f=(0,me.A)("StickerTooltip composer-tooltip custom-scroll",u,!v?.length&&"hidden");return(0,te.Y)("div",{ref:d,className:f,onMouseMove:()=>{g({type:"chooseSticker"})},children:h&&v?v.map(e=>(0,te.Y)(Kr,{sticker:e,size:o.bkT,observeIntersection:A,onClick:i?s:void 0,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c},e.id)):h?(0,te.Y)($n.A,{}):void 0})})),Nv={root:"_8sFuAomM",emojiButton:"crWzZ2jr"},Iv=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{stickers:i}=e.customEmojis.forEmoji;return{customEmoji:i,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}})(({isOpen:e,addRecentCustomEmoji:t,onCustomEmojiSelect:i,onClose:a,customEmoji:r,isSavedMessages:l,isCurrentUserPremium:c,noPlay:d})=>{const{clearCustomEmojiForEmoji:h}=(0,s.ko)(),u=(0,n.li)(),{shouldRender:p,transitionClassNames:v}=(0,Ke.A)(e,void 0,void 0,!1),g=(0,_.A)(r,!0),A=r||g;(0,xs.A)(u);const{observe:f}=(0,Dr.BL)({rootRef:u,throttleMs:200,isDisabled:!e});(0,n.vJ)(()=>e?(0,m.A)(a):void 0,[e,a]);const b=(0,M.A)(n=>{e&&(i(n),t({documentId:n.id}),h())}),C=(0,me.A)(Nv.root,"composer-tooltip custom-scroll-x",v,!A?.length&&Nv.hidden);return(0,te.Y)("div",{ref:u,className:C,children:p&&A?A.map(e=>(0,te.Y)(Kr,{sticker:e,className:Nv.emojiButton,size:o.x6_,observeIntersection:f,onClick:b,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c,noPlay:d},e.id)):p?(0,te.Y)($n.A,{}):void 0})}));var Pv=i(76283);const Yv=(0,n.ph)(({isOpen:e,isOpenToBottom:t=!1,isSavedMessages:i,canSchedule:a,canScheduleUntilOnline:o,onSendSilent:r,onSendSchedule:l,onSendWhenOnline:c,onRemoveEffect:d,onClose:h,onCloseAnimationEnd:m,chatId:p,withEffects:v,hasCurrentEffect:g,effectReactions:A,allAvailableReactions:f,onToggleReaction:b,canBuyPremium:C,isCurrentUserPremium:y,isInSavedMessages:S,isInStoryViewer:k,canPlayAnimatedEmojis:w})=>{const{openEffectPicker:N}=(0,s.ko)(),[I,P]=(0,Wp.A)(e,h),[Y,D]=(0,n.J0)(!1),B=(0,T.A)(),R=(0,Ui.A)(),[L,x,E]=(0,F.A)();(0,wi.A)(([t])=>{e&&!t&&(E(),D(Boolean(o)))},[e,o]);const[V,_,U]=(0,F.A)(),O=(0,M.A)(e=>{x(),p&&N({chatId:p,position:e})});return(0,n.vJ)(()=>{e?setTimeout(()=>{_()},200):U()},[e,_,U]),(0,te.FD)(qe.A,{isOpen:e,autoClose:!0,positionX:"right",positionY:t?"top":"bottom",className:(0,me.A)("CustomSendMenu","fluid","with-menu-transitions",v&&"with-effects"),onClose:h,onCloseAnimationEnd:m,onMouseEnter:u.TF?void 0:I,onMouseLeave:u.TF?void 0:P,noCloseOnBackdrop:!u.TF,children:[v&&!k&&(0,te.Y)(Pv.A,{allAvailableReactions:f,effectReactions:A,currentReactions:void 0,onToggleReaction:b,isPrivate:!0,isReady:V,canBuyPremium:C,isCurrentUserPremium:y,isInSavedMessages:S,isForEffects:!0,canPlayAnimatedEmojis:w,onShowMore:O,onClose:h,className:(0,me.A)(L&&"ReactionSelector-hidden")}),(0,te.FD)("div",{className:(0,me.A)("CustomSendMenu_items",L&&"CustomSendMenu_items-hidden"),dir:B.isRtl?"rtl":void 0,children:[r&&(0,te.Y)(de.A,{icon:"mute",onClick:r,children:B("SendWithoutSound")}),a&&l&&(0,te.Y)(de.A,{icon:"schedule",onClick:l,children:B(i?"SetReminder":"ScheduleMessage")}),a&&l&&Y&&(0,te.Y)(de.A,{icon:"user-online",onClick:c,children:B("SendWhenOnline")}),v&&g&&(0,te.Y)(de.A,{icon:"delete",onClick:d,children:R("RemoveEffect")})]})]})});var Fv=i(41510),Dv=i(22802);const Mv={B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"underline",DEL:"strikethrough",CODE:"monospace",SPAN:"spoiler"},Tv=document.createElement("div"),Bv=(0,n.ph)(({isOpen:e,anchorPosition:t,selectedRange:i,setSelectedRange:s,onClose:a})=>{const r=(0,n.li)(),l=(0,n.li)(),{shouldRender:c,transitionClassNames:d}=(0,Ke.A)(e),[u,p,v]=(0,F.A)(),[g,A]=(0,n.J0)(""),[f,b]=(0,n.J0)(!1),[C,S]=(0,n.J0)(),[k,w]=(0,n.J0)({}),N=(0,Ui.A)();(0,n.vJ)(()=>e?(0,m.A)(a):void 0,[e,a]),(0,Dv.A)(e,r,a,!0),(0,n.vJ)(()=>{u?l.current.focus():(A(""),b(!1))},[u]),(0,n.vJ)(()=>{c||(v(),w({}),S(void 0))},[v,c]),(0,n.vJ)(()=>{if(!e||!i)return;const t={};let{parentElement:n}=i.commonAncestorContainer;for(;n&&n.id!==o.CfG;){const e=Mv[n.tagName];e&&(t[e]=!0),n=n.parentElement}w(t)},[e,i,p]);const I=(0,M.A)(()=>{if(!i)return;const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(i))}),P=(0,M.A)(()=>{const e=window.getSelection();e&&s(e.getRangeAt(0))}),Y=(0,M.A)(e=>{if(i)return Tv.replaceChildren(i.cloneContents()),e&&Tv.querySelectorAll(dp._p).forEach(e=>{e.replaceWith(e.getAttribute("alt"))}),Tv.innerHTML}),D=(0,M.A)(()=>{if(i)return i.commonAncestorContainer.parentElement});function T(){const e=l.current;if(!e)return;const{offsetWidth:t,scrollWidth:i,scrollLeft:n}=e;if(i<=t)return void S(void 0);let s="";n<i-t&&(s="mask-right"),n>0&&(s+=" mask-left"),S(s)}function B(e){if(k[e])return"active";if("monospace"===e||"strikethrough"===e){if(Object.keys(k).some(t=>t!==e&&Boolean(k[t])))return"disabled"}else if(k.monospace||k.strikethrough)return"disabled"}const R=(0,M.A)(()=>{if(k.spoiler){const e=D();if(!i||!e||e.dataset.entityType!==O.C7.Spoiler||!e.textContent)return;return e.replaceWith(e.textContent),void w(e=>({...e,spoiler:!1}))}const e=Y();document.execCommand("insertHTML",!1,`<span class="spoiler" data-entity-type="${O.C7.Spoiler}">${e}</span>`),a()}),L=(0,M.A)(()=>{w(e=>(document.execCommand(e.bold?"removeFormat":"bold"),Object.keys(e).forEach(t=>{"italic"!==t&&"underline"!==t||!Boolean(e[t])||document.execCommand(t)}),P(),{...e,bold:!e.bold}))}),x=(0,M.A)(()=>{document.execCommand("italic"),P(),w(e=>({...e,italic:!e.italic}))}),E=(0,M.A)(()=>{document.execCommand("underline"),P(),w(e=>({...e,underline:!e.underline}))}),V=(0,M.A)(()=>{if(k.strikethrough){const e=D();if(!i||!e||"DEL"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void w(e=>({...e,strikethrough:!1}))}const e=Y();document.execCommand("insertHTML",!1,`<del>${e}</del>`),a()}),_=(0,M.A)(()=>{if(k.monospace){const e=D();if(!i||!e||"CODE"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void w(e=>({...e,monospace:!1}))}const e=Y(!0);document.execCommand("insertHTML",!1,`<code class="text-entity-code" dir="auto">${e}</code>`),a()}),U=(0,M.A)(()=>{const e=((0,ds.Tc)(g)||"").split("%").map(encodeURI).join("%");if(f){const t=D();if(!t||"A"!==t.tagName)return;return t.href=e,void a()}const t=Y(!0);I(),document.execCommand("insertHTML",!1,`<a href="${e}" class="text-entity-link" dir="auto">${t}</a>`),a()}),K=(0,M.A)(e=>{const t={k:p,b:L,u:E,i:x,m:_,s:V,p:R}[function(e){const t=e.key||e.code;return t.startsWith("Key")?t.slice(3).toLowerCase():t}(e)];!e.altKey&&(e.ctrlKey||e.metaKey)&&t&&(e.preventDefault(),e.stopPropagation(),t())});if((0,n.vJ)(()=>(e&&document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)),[e,K]),!c)return;const J=(0,me.A)("TextFormatter",d,u&&"link-control-shown"),G=(0,me.A)("TextFormatter-link-url-confirm",Boolean(g.length)&&"shown"),j=t?`left: ${t.x}px; top: ${t.y}px;--text-formatter-left: ${t.x}px;`:"";return(0,te.FD)("div",{ref:r,className:J,style:j,onKeyDown:function(e){if("Enter"===e.key&&u){if(!g.trim())return;U(),e.preventDefault()}},onMouseDown:y.A,children:[(0,te.FD)("div",{className:"TextFormatter-buttons",children:[(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingSpoilerAria"),className:B("spoiler"),onClick:R,children:(0,te.Y)(W.A,{name:"eye-crossed"})}),(0,te.Y)("div",{className:"TextFormatter-divider"}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingBoldAria"),className:B("bold"),onClick:L,children:(0,te.Y)(W.A,{name:"bold"})}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingItalicAria"),className:B("italic"),onClick:x,children:(0,te.Y)(W.A,{name:"italic"})}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingUnderlineAria"),className:B("underline"),onClick:E,children:(0,te.Y)(W.A,{name:"underlined"})}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingStrikethroughAria"),className:B("strikethrough"),onClick:V,children:(0,te.Y)(W.A,{name:"strikethrough"})}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingMonospaceAria"),className:B("monospace"),onClick:_,children:(0,te.Y)(W.A,{name:"monospace"})}),(0,te.Y)("div",{className:"TextFormatter-divider"}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("FormattingAddLinkAria"),onClick:p,children:(0,te.Y)(W.A,{name:"link"})})]}),(0,te.Y)("div",{className:"TextFormatter-link-control",children:(0,te.FD)("div",{className:"TextFormatter-buttons",children:[(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("Cancel"),onClick:v,children:(0,te.Y)(W.A,{name:"arrow-left"})}),(0,te.Y)("div",{className:"TextFormatter-divider"}),(0,te.Y)("div",{className:(0,me.A)("TextFormatter-link-url-input-wrapper",C),children:(0,te.Y)("input",{ref:l,className:"TextFormatter-link-url-input",type:"text",value:g,placeholder:N("FormattingEnterUrl"),autoComplete:"off",spellCheck:!h.Vq&&void 0,inputMode:"url",dir:"auto",onChange:function(e){A(e.target.value),T()},onScroll:T})}),(0,te.FD)("div",{className:G,children:[(0,te.Y)("div",{className:"TextFormatter-divider"}),(0,te.Y)(Q.A,{color:"translucent",ariaLabel:N("Save"),className:"color-primary",onClick:U,children:(0,te.Y)(W.A,{name:"check"})})]})]})})]})}),Rv=(0,n.ph)(({emoji:e,focus:t,onClick:i,observeIntersection:n})=>{const s=(0,M.A)(t=>{t.preventDefault(),i?.(e)}),a=(0,me.A)("EmojiButton",t&&"focus");return(0,te.Y)("div",{className:a,onMouseDown:s,title:e.emoji,children:(0,te.Y)(Na.A,{documentId:e.id,size:32,withSharedAnimation:!0,shouldPreloadPreview:!0,observeIntersectionForPlaying:n})})}),Lv=(0,n.ph)(({isOpen:e,emojis:t,customEmojis:i,onClose:s,onEmojiSelect:a,onCustomEmojiSelect:o,addRecentEmoji:r,addRecentCustomEmoji:l})=>{const c=(0,n.li)(),{shouldRender:d,transitionClassNames:h}=(0,Ke.A)(e,void 0,void 0,!1),u=(0,dn.A)(t.length?[...i,...t]:void 0,350)||[];(0,xs.A)(c);const{observe:m}=(0,Dr.BL)({rootRef:c,throttleMs:200,isDisabled:!e}),p=(0,M.A)(e=>{a(e.native),r({emoji:e.id})}),v=(0,M.A)(e=>{o(e),l({documentId:e.id})}),g=(0,M.A)(e=>{"native"in e?p(e):v(e)}),A=(0,M.A)((e,t)=>{a(e),r({emoji:t})}),f=(0,M.A)(e=>{o(e),l({documentId:e.id})}),b=_p({isActive:e,isHorizontal:!0,items:u,shouldRemoveSelectionOnReset:!0,onSelect:g,onClose:s});(0,wi.A)(([e])=>{void 0!==e&&-1!==e&&function(e,t){const i=t.current;if(!i)return;const{visibleIndexes:n,allElements:s}=Ep(i,".EmojiButton",8,!0,!0,!0);if(!s.length||!s[e])return;const a=n[0];if(!n.includes(e)||e===a&&!xp(i,s[a],!0)){const t="start"==(e>n[n.length-1]?"start":"end")?44*e:0;(0,Da.A)(i,t)}}(b,c)},[b]);const C=(0,me.A)("EmojiTooltip composer-tooltip custom-scroll-x",h);return(0,te.Y)("div",{ref:c,className:C,children:d&&u?u.map((e,t)=>"native"in e?(0,te.Y)(Zp,{emoji:e,focus:b===t,onClick:A},e.id):(0,te.Y)(Rv,{emoji:e,focus:b===t,onClick:f,observeIntersection:m},e.id)):d?(0,te.Y)($n.A,{}):void 0})}),xv=(0,n.ph)(({title:e,description:t,thumbnail:i,thumbUrl:n,focus:s,transitionClassNames:a="",onClick:o})=>{let r;const c=(0,z.A)(i?(0,l.cy)(i):void 0);return(n=n||c)?r=(0,te.Y)("img",{src:n,className:a,alt:"",decoding:"async",draggable:!1}):e&&(r=(0,$e.Qh)(e,1)),(0,te.FD)(di.A,{focus:s,className:(0,me.A)("BaseResult chat-item-clickable","string"==typeof r&&"with-text"),onMouseDown:_r.u,onClick:o,children:[(0,te.Y)("span",{className:"thumb",children:"string"==typeof r?(0,Dt.A)(r):r}),(0,te.FD)("div",{className:"content-inner",children:[e&&(0,te.Y)("div",{className:"title",children:e}),t&&(0,te.Y)("div",{className:"description",children:t})]})]})}),Ev=(0,n.ph)(({focus:e,inlineResult:t,onClick:i})=>{const{title:n,description:s}=t,a="url"in t?t.url:void 0,o="webThumbnail"in t?t.webThumbnail:void 0,r=(0,M.A)(()=>{i(t)});return(0,te.Y)(xv,{focus:e,thumbnail:o,title:n||a,description:s,onClick:r})}),Vv=(0,n.ph)(({inlineResult:e,isSavedMessages:t,canSendGifs:i,observeIntersection:n,onClick:s})=>{const{gif:a}=e,o=(0,M.A)((t,i,n)=>{s(e,i,n)});if(a)return(0,te.Y)(uv,{gif:a,observeIntersection:n,className:"chat-item-clickable",onClick:i?o:void 0,isSavedMessages:t})}),_v=(0,n.ph)(({focus:e,isForGallery:t,inlineResult:i,onClick:n})=>{let s,a,o;"photo"in i&&(s=i.photo),"thumbnail"in i&&(a=i.thumbnail),"webThumbnail"in i&&(o=i.webThumbnail);const r=(0,z.A)((0,l.cy)(o)),c=(0,z.A)(s&&(0,l.rI)(s,"pictogram")),d=(0,Ki.A)(c||r),h=(0,M.A)(()=>{n(i)});if(t)return(0,te.FD)("div",{className:"MediaResult chat-item-clickable",onClick:h,children:[(0,te.Y)("img",{src:s?.thumbnail?.dataUri||r,alt:"",draggable:!1}),(0,te.Y)("img",{src:c,className:(0,me.A)("full-media",d),alt:"",draggable:!1})]});const{title:u,description:m}=i;return(0,te.Y)(xv,{focus:e,thumbnail:o,thumbUrl:c||a?.dataUri,transitionClassNames:d,title:u,description:m,onClick:h})}),Uv=(0,n.ph)(({inlineResult:e,isSavedMessages:t,observeIntersection:i,onClick:n,isCurrentUserPremium:s})=>{const{sticker:a}=e;if(a)return(0,te.Y)(Kr,{sticker:a,size:o.mD0,observeIntersection:i,title:a.emoji,className:"chat-item-clickable",onClick:n,clickArg:e,isSavedMessages:t,canViewSet:!0,noShowPremium:!0,isCurrentUserPremium:s})}),Ov=(0,ge.nF)(e=>e(),500,!0),Kv=(0,n.ph)(({isOpen:e,botId:t,isGallery:i,inlineBotResults:o,switchPm:r,switchWebview:l,isSavedMessages:c,canSendGifs:d,loadMore:h,onClose:m,onSelectResult:p,isCurrentUserPremium:v})=>{const{openChat:g,startBot:A,requestSimpleWebView:f}=(0,s.ko)(),b=(0,n.li)(),{shouldRender:C,transitionClassNames:y}=(0,Ke.A)(e,void 0,void 0,!1),S=(0,Ri.A)(i,C),{observe:k}=(0,Dr.BL)({rootRef:b,debounceMs:200,isDisabled:!e}),w=(0,M.A)(({direction:e})=>{e===a.TN.Backwards&&Ov(h)}),N=_p({isActive:e,shouldRemoveSelectionOnReset:S,noArrowNavigation:S,items:o,onSelect:p,onClose:m});(0,n.vJ)(()=>{Vp(".chat-item-clickable",N,b)},[N]);const I=(0,M.A)(()=>{g({id:t}),A({botId:t,param:r.startParam})}),P=(0,M.A)(()=>{const e=(0,Vs.A)();f({botId:t,url:l.url,buttonText:l.text,theme:e,isFromSwitchWebView:!0})}),Y=(0,_.A)(o?.length?o:void 0,C),F=o?.length?o:Y;if(!C||!(F?.length||r||l))return;const D=(0,me.A)("InlineBotTooltip composer-tooltip",u.TF?"no-scrollbar":"custom-scroll",S&&"gallery",y);return(0,te.FD)(Tn.A,{ref:b,className:D,items:F,itemSelector:".chat-item-clickable",noFastList:!0,onLoadMore:w,sensitiveArea:160,children:[r&&(0,te.Y)(di.A,{ripple:!0,className:"switch-pm scroll-item",onClick:I,children:(0,te.Y)("span",{className:"title",children:r.text})}),l&&(0,te.Y)(di.A,{ripple:!0,className:"switch-pm scroll-item",onClick:P,children:(0,te.Y)("span",{className:"title",children:l.text})}),Boolean(F?.length)&&F.map((e,t)=>{switch(e.type){case"gif":return(0,te.Y)(Vv,{inlineResult:e,observeIntersection:k,onClick:p,isSavedMessages:c,canSendGifs:d},e.id);case"photo":return(0,te.Y)(_v,{isForGallery:S,inlineResult:e,onClick:p},e.id);case"sticker":return(0,te.Y)(Uv,{inlineResult:e,observeIntersection:k,onClick:p,isSavedMessages:c,isCurrentUserPremium:v},e.id);case"video":case"file":case"game":return(0,te.Y)(_v,{focus:N===t,inlineResult:e,onClick:p},e.id);case"article":case"audio":case"voice":return(0,te.Y)(Ev,{focus:N===t,inlineResult:e,onClick:p},e.id);default:return}})]})}),Jv=(0,n.ph)(({isOpen:e,chatId:t,selectedSendAsId:i,sendAsPeerIds:a,isCurrentUserPremium:o,onClose:r})=>{const{saveDefaultSendAs:l,showNotification:c}=(0,s.ko)(),d=(0,s.mS)().users.byId,h=(0,s.mS)().chats.byId,m=(0,T.A)(),p=(0,n.li)(),[v,g,A]=(0,Wp.A)(e,r,void 0);(0,n.vJ)(()=>{e&&A()},[e,A]);const f=(0,M.A)(e=>{r(),l({chatId:t,sendAsId:e})}),b=_p({isActive:e,items:a,onSelect:f,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:r});return(0,n.vJ)(()=>{Vp(".chat-item-clickable",b,p)},[b]),(0,n.vJ)(()=>{a&&!a.length&&r()},[a,r]),(0,te.FD)(qe.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:r,className:"SendAsMenu",onCloseAnimationEnd:r,onMouseEnter:u.TF?void 0:v,onMouseLeave:u.TF?void 0:g,noCloseOnBackdrop:!u.TF,noCompact:!0,children:[(0,te.Y)("div",{className:"send-as-title",dir:"auto",children:m("SendMessageAsTitle")}),d&&h&&a?.map(({id:e,isPremium:t},n)=>{const s=d[e],a=h[e],r=s||a,l=(0,me.A)(i===e&&"selected");return(0,te.FD)(di.A,{className:"SendAsItem chat-item-clickable scroll-item with-avatar",onClick:()=>{!t||o?f(e):c({message:m("SelectSendAsPeerPremiumHint"),actionText:m("Open"),action:{action:"openPremiumModal",payload:{}}})},focus:b===n,rightElement:!o&&t&&(0,te.Y)(W.A,{name:"lock-badge",className:"send-as-icon-locked"}),children:[(0,te.Y)(Mt.A,{size:"small",peer:r,className:l}),(0,te.FD)("div",{className:"info",children:[r&&(0,te.Y)(qn.A,{peer:r,noFake:!0}),(0,te.Y)("span",{className:"subtitle",children:s?m("VoipGroupPersonalAccount"):m("Subscribers",a?.membersCount,"i")})]})]},e)})]})}),Gv=(0,n.ph)((0,s.EK)((e,{stickerSetId:t})=>({set:(0,c.ycM)(e,t),shouldPlay:(0,c.ML4)(e),isCurrentUserPremium:(0,c.g29)(e)}))(({stickerSetId:e,observeIntersection:t,set:i,shouldPlay:a,isModalOpen:r,isCurrentUserPremium:l})=>{const{loadStickers:c,toggleStickerSet:d,openStickerSet:h}=(0,s.ko)(),u=(0,n.li)(),m=(0,T.A)(),p=i&&!i.isArchived&&Boolean(i.installedDate),v=Boolean(i?.stickers),g=(0,n.Kr)(()=>{if(!i)return[];const e=(i.stickers?.filter(({hasEffect:e})=>e)??[]).slice(0,3),t=(i.covers||[]).map(({id:e})=>e),n=i.stickers?i.stickers.filter(({id:e})=>!t.includes(e)):[];return[...e,...i.covers||[],...n].slice(0,5)},[i]);(0,n.vJ)(()=>{!v&&g.length<5&&i&&c({stickerSetInfo:{shortName:i.shortName}})},[v,g.length,c,i,e]);const A=(0,n.hb)(()=>{d({stickerSetId:e})},[d,e]),f=(0,n.hb)(e=>{h({stickerSetInfo:e.stickerSetInfo})},[h]);if(!i)return;const b=g.length>0;return(0,te.FD)("div",{className:"sticker-set",dir:m.isRtl?"rtl":void 0,children:[(0,te.FD)("div",{className:"sticker-set-header",children:[(0,te.FD)("div",{className:"title-wrapper",children:[(0,te.Y)("h3",{className:"title",dir:"auto",children:i.title}),(0,te.Y)("p",{className:"count",dir:"auto",children:m("Stickers",i.count,"i")})]}),(0,te.Y)(Q.A,{className:p?"is-added":void 0,color:"primary",size:"tiny",pill:!0,fluid:!0,onClick:A,children:m(p?"Stickers.Installed":"Stickers.Install")})]}),(0,te.FD)("div",{className:"sticker-set-main shared-canvas-container",children:[(0,te.Y)("canvas",{ref:u,className:"shared-canvas"}),!b&&(0,te.Y)(Ee.A,{}),b&&g.map(e=>(0,te.Y)(Kr,{sticker:e,size:o.Rqe,observeIntersection:t,noPlay:!a||r,clickArg:e,onClick:f,noContextMenu:!0,isCurrentUserPremium:l,sharedCanvasRef:u}))]})]},i.id)})),jv=(0,ge.nF)(e=>e(),6e4,!0),zv=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.BmE)(e),{query:i,resultIds:n}=t||{},{featured:s}=e.stickers;return{query:i,featuredIds:s.setIds,resultIds:n,isModalOpen:Boolean((0,c.nTw)(e).openedStickerSetShortName)}})(({isActive:e,query:t,featuredIds:i,resultIds:a,isModalOpen:o,onClose:r})=>{const{loadFeaturedStickers:l}=(0,s.ko)(),c=(0,n.li)(),d=(0,T.A)(),{observe:h}=(0,Dr.BL)({rootRef:c,throttleMs:200});return(0,n.vJ)(()=>{jv(()=>{l()})}),(0,Ce.A)({isActive:e,onBack:r}),(0,te.Y)("div",{ref:c,className:"StickerSearch custom-scroll",dir:d.isRtl?"rtl":void 0,children:function(){if(void 0!==t)return!t&&i?i.map(e=>(0,te.Y)(Gv,{stickerSetId:e,observeIntersection:h,isModalOpen:o},e)):a?a.length?a.map(e=>(0,te.Y)(Gv,{stickerSetId:e,observeIntersection:h,isModalOpen:o},e)):(0,te.Y)("p",{className:"helper-text",dir:"auto",children:"Nothing found."}):(0,te.Y)($n.A,{})}()})})),Hv=(0,n.ph)((0,s.EK)(e=>{const t=(0,c.Wy7)(e),{query:i,results:n}=t||{},{chatId:s,threadId:a}=(0,c.Xf0)(e)||{},o=s?(0,c.hds)(e,s):void 0,r=s?(0,c.AWZ)(e,s):void 0,d=o?(0,c.ALW)(e,o):void 0,h=Boolean(s)&&(0,c.nZ4)(e,s),u=s&&a?(0,c.Vw0)(e,s,a):void 0,m=Boolean(!u?.isCommentsInfo&&u?.fromChannelId),p=s&&a?(0,c.S0q)(e,s,a):void 0;return{query:i,results:n,chat:o,chatFullInfo:r,isChatWithBot:d,isSavedMessages:h,canPostInChat:Boolean(o)&&Boolean(a)&&(0,l.__)(o,p,m,r),canScheduleUntilOnline:Boolean(s)&&(0,c.RBq)(e,s),currentMessageList:(0,c.Xf0)(e)}})(({isActive:e,query:t,results:i,chat:a,chatFullInfo:o,isChatWithBot:r,canScheduleUntilOnline:c,isSavedMessages:d,canPostInChat:h,currentMessageList:m,onClose:p})=>{const{searchMoreGifs:v,sendMessage:g,setGifSearchQuery:A}=(0,s.ko)(),f=(0,n.li)(),[b,C]=(0,Jm.A)(c),{observe:y}=(0,Dr.BL)({rootRef:f,debounceMs:300}),S=h&&(0,l.Q_)(a,o,r,d).canSendGifs,k=(0,n.hb)((e,t,i)=>{if(S){if(!m)return;i?b(i=>{g({messageList:m,gif:e,scheduledAt:i,isSilent:t})}):g({messageList:m,gif:e,isSilent:t})}u.TF&&A({query:void 0})},[S,m,b]),w=(0,n.hb)(()=>{v()},[v]),N=(0,T.A)();(0,Ce.A)({isActive:e,onBack:p});const I=Boolean(void 0!==t&&i&&i.length);return(0,te.FD)("div",{className:"GifSearch",dir:N.isRtl?"rtl":void 0,children:[(0,te.Y)(Tn.A,{ref:f,className:(0,me.A)("gif-container custom-scroll",I&&"grid"),items:i,itemSelector:".GifButton",preloadBackwards:96,noFastList:!0,onLoadMore:w,children:function(){if(void 0!==t)return i?i.length?i.map(e=>(0,te.Y)(uv,{gif:e,observeIntersection:y,onClick:S?k:void 0,isSavedMessages:d},e.id)):(0,te.Y)("p",{className:"helper-text",dir:"auto",children:N("NoGIFsFound")}):(0,te.Y)($n.A,{})}()}),C]})}));var $v=i(75319),qv=i(71950);const Wv="OAKzmAva",Qv="BQ6HUOqN",Zv="U96CW2I7",Xv="vXi2JQlj",eg="bi3fL59p",tg="GUK4ajPK",ig="YH6jeZIh",ng="q1LnuIUn",sg="PJZzyVLK",ag="C7NpG5Y9",og=(0,n.ph)(function({postStatistic:e}){const t=(0,T.A)(),i=(0,Ui.A)();return(0,te.FD)("div",{className:ig,children:[e.reactionsCount>0&&(0,te.FD)("span",{className:ng,children:[(0,te.Y)(W.A,{name:"heart-outline",className:sg}),(0,$e.Vw)(i,e.reactionsCount)]}),e.forwardsCount>0&&(0,te.FD)("span",{className:ng,children:[(0,te.Y)(W.A,{name:"forward",className:sg}),(0,$e.Vw)(i,e.forwardsCount)]}),!e.forwardsCount&&!e.reactionsCount&&t("ChannelStats.SharesCount_ZeroValueHolder")]})});function rg(e,t,i,n){return i?(0,te.FD)("span",{children:[(0,te.Y)("img",{src:i,alt:"",draggable:!1,className:(0,me.A)(Zv,n&&"yxjDeIct")}),(0,l.zX)(t)&&(0,te.Y)(W.A,{name:"play"}),(0,A.C)(e,t,!0)]}):(0,A.C)(e,t)}const lg=(0,n.ph)(({postStatistic:e,message:t})=>{const i=(0,Ui.A)(),{toggleMessageStatistics:a}=(0,s.ko)(),o=(0,id.A)(t),r=(0,td.A)(t,"micro"),c=(0,z.A)(r),d=Boolean((0,l.lk)(t)),h=(0,n.hb)(()=>{a({messageId:t.id})},[a,t.id]);return(0,te.FD)("div",{className:(0,me.A)(Wv,Boolean(c||o)&&Qv),onClick:h,children:[(0,te.FD)("div",{className:eg,children:[(0,te.Y)("div",{className:Xv,children:rg(i,t,c||o,d)}),(0,te.Y)("div",{className:ig,children:i("ChannelStatsViewsCount",{count:e.viewsCount},{pluralValue:e.viewsCount})})]}),(0,te.FD)("div",{className:tg,children:[(0,te.Y)("div",{className:ag,children:(0,He.L2)(1e3*t.date,i.code)}),(0,te.Y)(og,{postStatistic:e})]})]})});function cg(e,t,i){return(0,te.FD)("span",{children:[i?(0,te.Y)("span",{className:"TmJvv2A6",children:(0,te.Y)("img",{src:i,alt:"",draggable:!1,className:(0,me.A)(Zv,"cdfiLmXo","BOfHPv20")})}):(0,te.Y)(Mt.A,{peer:t,size:"small",className:Zv}),e("Story")]})}const dg=(0,n.ph)(function({chat:e,story:t,postStatistic:i}){const n=(0,T.A)(),{toggleStoryStatistics:a}=(0,s.ko)(),o=t&&"content"in t,r=o?t.content.video:void 0,c=o?(0,l.EN)(t):void 0,d=(0,z.A)(c),h=d||r?.thumbnail?.dataUri,u=(0,M.A)(()=>{a({storyId:i.storyId})});return(0,te.FD)("div",{className:(0,me.A)(Wv,Qv),onClick:u,children:[(0,te.FD)("div",{className:eg,children:[(0,te.Y)("div",{className:Xv,children:cg(n,e,d||h)}),(0,te.Y)("div",{className:ig,children:n("ChannelStats.ViewsCount",i.viewsCount,"i")})]}),(0,te.FD)("div",{className:tg,children:[(0,te.Y)("div",{className:ag,children:o&&Boolean(t.date)&&(0,He.L2)(1e3*t.date,n.code)}),(0,te.Y)(og,{postStatistic:i})]})]})}),hg="T1l_4J8z",ug="S1x1ovkC",mg="WxL3i5PM",pg="aUrozL5_",vg="QQHwjG88",gg="QGctP1Nk";let Ag,fg;const bg={growthGraph:"ChannelStats.Graph.Growth",followersGraph:"ChannelStats.Graph.Followers",muteGraph:"ChannelStats.Graph.Notifications",topHoursGraph:"ChannelStats.Graph.ViewsByHours",viewsBySourceGraph:"ChannelStats.Graph.ViewsBySource",newFollowersBySourceGraph:"ChannelStats.Graph.NewFollowersBySource",languagesGraph:"ChannelStats.Graph.Language",interactionsGraph:"ChannelStats.Graph.Interactions",reactionsByEmotionGraph:"ChannelStats.Graph.Reactions",storyInteractionsGraph:"ChannelStats.Graph.Stories",storyReactionsByEmotionGraph:"ChannelStats.Graph.StoriesReactions"},Cg=Object.keys(bg),yg={growthGraph:"Stats.GroupGrowthTitle",membersGraph:"Stats.GroupMembersTitle",languagesGraph:"Stats.GroupLanguagesTitle",messagesGraph:"Stats.GroupMessagesTitle",actionsGraph:"Stats.GroupActionsTitle",topHoursGraph:"Stats.GroupTopHoursTitle"},Sg=Object.keys(yg),kg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.gqw)(e,t),n=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t)?.statisticsDcId,a="chatTypeSuperGroup"===n?.type,o=(0,c.zeq)(e,t),r=(0,c._bp)(e,t)?.byId;return{statistics:i,dcId:s,isGroup:a,chat:n,messagesById:o,storiesById:r}})(({chatId:e,chat:t,statistics:a,dcId:o,isGroup:r,messagesById:l,storiesById:c})=>{const d=(0,T.A)(),h=(0,n.li)(),[u,m]=(0,n.J0)(!1),p=(0,n.li)(new Set),v=(0,n.li)(new Set),{loadStatistics:g,loadStatisticsAsyncGraph:A}=(0,s.ko)(),f=(0,D.A)();(0,n.vJ)(()=>{g({chatId:e,isGroup:r})},[e,g,r]);const b=(0,n.Kr)(()=>r?Sg:Cg,[r]),C=(0,n.Kr)(()=>r?yg:bg,[r]);return(0,n.vJ)(()=>{a&&b.forEach(t=>{const i=a[t];(0,$v.R)(i)&&"async"===i.graphType&&A({name:t,chatId:e,token:i.token,isPercentage:"languagesGraph"===t})})},[b,e,a,A]),(0,n.vJ)(()=>{(async()=>{await async function(){return Ag||(Ag=i.e(4810).then(i.bind(i,24810)),fg=await Ag),Ag}(),u?a&&h.current&&(b.forEach((e,t)=>{const i=a[e];if(!(0,$v.R)(i))return;const n="async"===i.graphType,s="error"===i.graphType;if(n||p.current.has(e))return;if(s)return p.current.add(e),void v.current.add(e);const{zoomToken:r}=i;fg.create(h.current.children[t],{title:d(C[e]),...r?{onZoom:e=>(0,Ze.px)("fetchStatisticsAsyncGraph",{token:r,x:e,dcId:o}),zoomOutLabel:d("Graph.ZoomOut")}:{},...i}),p.current.add(e),h.current.children[t].classList.remove(gg)}),f()):m(!0)})()},[b,C,u,a,d,e,A,o,f]),(0,te.FD)("div",{className:(0,me.A)(hg,"panel-content custom-scroll",u&&pg),children:[a&&(0,te.Y)(qv.A,{statistics:a,type:r?"group":"channel",title:d("StatisticOverview")}),!p.current.size&&(0,te.Y)($n.A,{}),(0,te.Y)("div",{ref:h,children:b.map(e=>{const t=p.current.has(e)&&!v.current.has(e);return(0,te.Y)("div",{className:(0,me.A)(vg,!t&&gg)})})}),Boolean(a?.recentPosts?.length)&&(0,te.FD)("div",{className:"suY9dEIz",children:[(0,te.Y)("h2",{className:"evQIkAqx",children:d("ChannelStats.Recent.Header")}),a.recentPosts.map(e=>{if("msgId"in e){const t=l[e.msgId];if(!t||!("content"in t))return;return(0,te.Y)(lg,{message:t,postStatistic:e},`statistic_message_${e.msgId}`)}if("storyId"in e&&t){const i=c?.[e.storyId];return(0,te.Y)(dg,{chat:t,story:i,postStatistic:e},`statistic_story_${e.storyId}`)}})]})]})})),wg="oXLpD4Y4",Ng="paQ2VBe_",Ig="WvFuOAIf",Pg=(0,n.ph)(({data:e})=>{const t=(0,T.A)(),{openChatByUsername:i}=(0,s.ko)(),a=(0,n.Kr)(()=>e.chat?(0,l.Kl)(e.chat):void 0,[e.chat]),o=(0,n.hb)(()=>{i({username:a,messageId:e.messageId})},[e.messageId,i,a]);return(0,te.FD)("div",{className:(0,me.A)(wg,"statistic-public-forward"),onClick:o,children:[(0,te.Y)(Mt.A,{size:"medium",peer:e.chat}),(0,te.FD)("div",{children:[(0,te.Y)("div",{className:Ng,children:e.title}),(0,te.Y)("div",{className:Ig,children:t("ChannelStats.ViewsCount",e.views,"i")})]})]})});let Yg,Fg;const Dg={viewsGraph:"Stats.MessageInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Mg=Object.keys(Dg),Tg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.AWZ)(e,t)?.statisticsDcId,n=(0,c.nTw)(e);return{statistics:n.statistics.currentMessage,dcId:i,messageId:n.statistics.currentMessageId}})(function({chatId:e,isActive:t,statistics:o,dcId:r,messageId:l}){const c=(0,T.A)(),d=(0,n.li)(),[h,u]=(0,n.J0)(!1),m=(0,n.li)(new Set),p=(0,n.li)(new Set),{loadMessageStatistics:v,loadMessagePublicForwards:g,loadStatisticsAsyncGraph:A}=(0,s.ko)(),f=(0,D.A)();(0,n.vJ)(()=>{l&&v({chatId:e,messageId:l})},[e,v,l]),(0,n.vJ)(()=>{t&&!l||(m.current.clear(),p.current.clear(),u(!1))},[t,l]),(0,n.vJ)(()=>{o&&Mg.forEach(t=>{const i=o[t];(0,$v.R)(i)&&"async"===i.graphType&&A({name:t,chatId:e,token:i.token})})},[e,o,A]),(0,n.vJ)(()=>{(async()=>{await async function(){return Yg||(Yg=i.e(4810).then(i.bind(i,24810)),Fg=await Yg),Yg}(),h?o&&d.current&&(Mg.forEach((e,t)=>{const i=o[e];if(!(0,$v.R)(i))return;const n="async"===i.graphType,s="error"===i.graphType;if(n||m.current.has(e))return;if(s)return m.current.add(e),void p.current.add(e);const{zoomToken:a}=i;Fg.create(d.current.children[t],{title:c(Dg[e]),...a?{onZoom:e=>(0,Ze.px)("fetchStatisticsAsyncGraph",{token:a,x:e,dcId:r}),zoomOutLabel:c("Graph.ZoomOut")}:{},...i}),m.current.add(e)}),f()):u(!0)})()},[h,o,c,e,l,A,r,f]);const b=(0,M.A)(({direction:t})=>{t===a.TN.Backwards&&l&&g({chatId:e,messageId:l})});return h&&o&&l?(0,te.FD)("div",{className:(0,me.A)(hg,"custom-scroll",h&&pg),children:[(0,te.Y)(qv.A,{statistics:o,type:"message",title:c("StatisticOverview")}),(!m.current.size||!o.publicForwardsData)&&(0,te.Y)($n.A,{}),(0,te.Y)("div",{ref:d,children:Mg.map(e=>{const t=m.current.has(e)&&!p.current.has(e);return(0,te.Y)("div",{className:(0,me.A)(vg,!t&&gg)})})}),Boolean(o.publicForwards)&&(0,te.FD)("div",{className:ug,children:[(0,te.Y)("h2",{className:mg,children:c("Stats.Message.PublicShares")}),(0,te.Y)(Tn.A,{items:o.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:b,noFastList:!0,children:o.publicForwardsData.map(e=>(0,te.Y)(Pg,{data:e},e.messageId))})]})]},`${e}-${l}`):(0,te.Y)($n.A,{})})),Bg=(0,n.ph)(function({data:e,chatsById:t,usersById:i}){const n=(0,T.A)(),{openChat:a}=(0,s.ko)(),o=i[e.peerId],r=t[e.peerId],c=(0,M.A)(()=>{a({id:o.id})});return(0,te.FD)("div",{className:(0,me.A)(wg,"statistic-public-forward"),onClick:c,children:[(0,te.Y)(Mt.A,{size:"medium",peer:o||r}),(0,te.FD)("div",{children:[(0,te.Y)("div",{className:Ng,children:o?(0,l.Yg)(o):(0,l.Js)(n,r)}),(0,te.Y)("div",{className:Ig,children:e.viewsCount?n("ChannelStats.ViewsCount",e.viewsCount,"i"):n("NoViews")})]})]})});let Rg,Lg;const xg={viewsGraph:"Stats.StoryInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Eg=Object.keys(xg),Vg=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.AWZ)(e,t)?.statisticsDcId,n=(0,c.nTw)(e),s=n.statistics.currentStory,a=n.statistics.currentStoryId,{byId:o}=e.users,{byId:r}=e.chats;return{statistics:s,dcId:i,storyId:a,usersById:o,chatsById:r}})(function({chatId:e,isActive:t,statistics:a,dcId:o,storyId:r,chatsById:l,usersById:c}){const d=(0,T.A)(),h=(0,n.li)(),[u,m]=(0,n.J0)(!1),p=(0,n.li)(new Set),v=(0,n.li)(new Set),{loadStoryStatistics:g,loadStoryPublicForwards:A,loadStatisticsAsyncGraph:f}=(0,s.ko)(),b=(0,D.A)();(0,n.vJ)(()=>{r&&g({chatId:e,storyId:r})},[e,r]),(0,n.vJ)(()=>{t&&!r||(p.current.clear(),v.current.clear(),m(!1))},[t,r]),(0,n.vJ)(()=>{a&&Eg.forEach(t=>{const i=a[t];(0,$v.R)(i)&&"async"===i.graphType&&f({name:t,chatId:e,token:i.token})})},[e,a,f]),(0,n.vJ)(()=>{(async()=>{await async function(){return Rg||(Rg=i.e(4810).then(i.bind(i,24810)),Lg=await Rg),Rg}(),u?a&&h.current&&(Eg.forEach((e,t)=>{const i=a[e];if(!(0,$v.R)(i))return;const n="async"===i.graphType,s="error"===i.graphType;if(n||p.current.has(e))return;if(s)return p.current.add(e),void v.current.add(e);const{zoomToken:r}=i;Lg.create(h.current.children[t],{title:d(xg[e]),...r?{onZoom:e=>(0,Ze.px)("fetchStatisticsAsyncGraph",{token:r,x:e,dcId:o}),zoomOutLabel:d("Graph.ZoomOut")}:{},...i}),p.current.add(e)}),b()):m(!0)})()},[u,a,d,e,r,f,o,b]);const C=(0,M.A)(()=>{r&&A({chatId:e,storyId:r})});return u&&a&&r?(0,te.FD)("div",{className:(0,me.A)(hg,"custom-scroll",u&&pg),children:[(0,te.Y)(qv.A,{statistics:a,type:"story",title:d("StatisticOverview")}),!p.current.size&&(0,te.Y)($n.A,{}),(0,te.Y)("div",{ref:h,children:Eg.map(e=>{const t=p.current.has(e)&&!v.current.has(e);return(0,te.Y)("div",{className:(0,me.A)(vg,!t&&gg)})})}),Boolean(a.publicForwards)&&(0,te.FD)("div",{className:ug,children:[(0,te.Y)("h2",{className:mg,children:d("Stats.Message.PublicShares")}),(0,te.Y)(Tn.A,{items:a.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:C,noFastList:!0,children:a.publicForwardsData.map(e=>"messageId"in e?(0,te.Y)(Pg,{data:e},`message_${e.messageId}`):(0,te.Y)(Bg,{data:e,chatsById:l,usersById:c},`story_${e.storyId}`))})]})]},`${e}-${r}`):(0,te.Y)($n.A,{})}));var _g=i(55573);const Ug=(0,n.ph)((0,s.EK)((e,{answer:t})=>{const{voters:i,offsets:n}=(0,c.nTw)(e).pollResults;return{voters:i?.[t.option],offset:n?.[t.option]||""}})(({chat:e,message:t,answer:i,answerVote:a,totalVoters:o,voters:r,offset:l})=>{const{loadPollOptionResults:c,openChat:d,closePollResults:h}=(0,s.ko)(),u=(0,_.A)(a.votersCount),[m,p]=(0,n.J0)(!0),g=Boolean(r),{option:A,text:f}=i,b=(0,T.A)();(0,n.vJ)(()=>{g&&u===a.votersCount||c({chat:e,messageId:t.id,option:A,offset:l,limit:4,shouldResetVoters:!0})},[a.votersCount,g]);const C=(0,n.hb)(()=>{p(!0),c({chat:e,messageId:t.id,option:A,offset:l,limit:50})},[e,c,t.id,l,A]);(0,n.vJ)(()=>{p(!1)},[r]);const y=(0,n.hb)(e=>{d({id:e}),h()},[h,d]);return(0,te.FD)("div",{className:"PollAnswerResults",children:[(0,te.FD)("div",{className:"poll-voters",children:[r?r.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable",onClick:()=>y(e),children:(0,v.L8)(e)?(0,te.Y)(xn.A,{avatarSize:"tiny",userId:e,forceShowSelf:!0,noStatusOrTyping:!0}):(0,te.Y)(Ln.A,{avatarSize:"tiny",chatId:e,noStatusOrTyping:!0})},e)):(0,te.Y)($n.A,{}),r&&function(){const e=a.votersCount-r.length;return a.votersCount>4&&e>0&&(0,te.Y)(_g.A,{count:e,itemName:"voter",isLoading:m,onClick:C})}()]}),(0,te.FD)("div",{className:"answer-head",dir:b.isRtl?"rtl":void 0,children:[(0,te.Y)("span",{className:"answer-title",dir:"auto",children:(0,un.fd)({text:f.text,entities:f.entities})}),(0,te.FD)("span",{className:"answer-percent",dir:b.isRtl?"auto":void 0,children:[(S=a.votersCount,k=o,k>0?(S/k*100).toFixed():0),"%"]})]})]});var S,k})),Og=(0,n.ph)((0,s.EK)(e=>{const{pollResults:{chatId:t,messageId:i}}=(0,c.nTw)(e),n=t?(0,c.hds)(e,t):void 0,s=t&&i?(0,c.O5q)(e,t,i):void 0;return{chat:n,message:s,poll:s&&(0,c.zcZ)(e,s)}})(({isActive:e,chat:t,message:i,poll:n,onClose:s})=>{const a=(0,T.A)();if((0,Ce.A)({isActive:e,onBack:s}),!i||!n||!t)return(0,te.Y)($n.A,{});const{summary:o,results:r}=n;if(!r.results)return;const l=(0,Ci.dU)(r.results,"option");return(0,te.FD)("div",{className:"PollResults",dir:a.isRtl?"rtl":void 0,children:[(0,te.Y)("h3",{className:"poll-question",dir:"auto",children:(0,un.fd)({text:o.question.text,entities:o.question.entities})}),(0,te.Y)("div",{className:"poll-results-list custom-scroll",children:o.answers.map(e=>(0,te.Y)(Ug,{chat:t,message:i,answer:e,answerVote:l[e.option],totalVoters:r.totalVoters},`${n.id}-${e.option}`))})]})}));var Kg=i(90603);const Jg="xrnUE4e6",Gg="z7kF7tij",jg="T6wFpdQO",zg="CWsWIKQ1",Hg="KBl0ycLl",$g="iJ1U9kDD",qg="Rk6PT_yc",Wg="qlo3vSEw",Qg="r06zwL42",Zg=5*g.$,Xg=(0,n.ph)((0,s.EK)(e=>{const{createTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,createTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}})(({isActive:e,chat:t,createTopicPanel:i,isCurrentUserPremium:a,onClose:r})=>{const{createTopic:l,openPremiumModal:c}=(0,s.ko)(),[d,h]=(0,n.J0)(""),[u,m]=(0,n.J0)(0),[p,v]=(0,n.J0)(void 0),g=(0,T.A)(),A=Boolean(d),f=Boolean(i?.isLoading);(0,Ce.A)({isActive:e,onBack:r}),(0,n.vJ)(()=>{e||(h(""),v(void 0))},[e]);const b=(0,n.hb)(e=>{h(e.target.value)},[]),C=(0,n.hb)(()=>{m(e=>(0,_a.A)((0,Kg.e$)().length,e+1))},[]),y=(0,n.hb)(()=>{l({chatId:t.id,title:d,iconColor:(0,Kg.e$)()[u],iconEmojiId:p})},[t,l,u,p,d]),S=(0,n.hb)(e=>{e.isFree||a||e.id===o.MyF?e.id!==o.MyF?v(e.id):v(void 0):c({initialSection:"animated_emoji"})},[a,c]),k=(0,n.Kr)(()=>({id:0,title:d,iconColor:(0,Kg.e$)()[u],iconEmojiId:p}),[u,p,d]);if(t?.isForum)return(0,te.FD)("div",{className:Jg,children:[(0,te.FD)("div",{className:(0,me.A)(Gg,"custom-scroll"),children:[(0,te.FD)("div",{className:(0,me.A)(jg,zg),children:[(0,te.Y)("span",{className:Wg,children:g("CreateTopicTitle")}),(0,te.Y)(se.Ay,{name:"zoomFade",activeKey:Number(k.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:$g,children:(0,te.Y)(Wn.A,{topic:k,className:(0,me.A)(qg,"K1CTKtBS"),onClick:C,size:Zg,noLoopLimit:!0})}),(0,te.Y)(Z.A,{value:d,onChange:b,label:g("lng_forum_topic_title"),disabled:f,teactExperimentControlled:!0})]}),(0,te.Y)("div",{className:(0,me.A)(jg,Hg),children:(0,te.Y)(ol,{idPrefix:"create-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:S,className:Qg,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})})]}),(0,te.Y)(Ni.A,{isShown:A,disabled:f,onClick:y,ariaLabel:g("Save"),children:f?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})})),eA=5*g.$,tA=(0,n.ph)((0,s.EK)(e=>{const{editTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,topic:t?.chatId&&t?.topicId?(0,c.S0q)(e,t.chatId,t.topicId):void 0,editTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}})(({isActive:e,chat:t,topic:i,editTopicPanel:a,isCurrentUserPremium:r,onClose:l})=>{const{editTopic:c,openPremiumModal:d}=(0,s.ko)(),[h,u]=(0,n.J0)(""),[m,p]=(0,n.J0)(void 0),v=(0,T.A)(),g=Boolean(a?.isLoading),A=i?.id===o.HxB;(0,Ce.A)({isActive:e,onBack:l}),(0,n.vJ)(()=>{e||(u(""),p(void 0))},[e]),(0,n.vJ)(()=>{(i?.title||i?.iconEmojiId)&&(u(i.title),p(i.iconEmojiId))},[i]);const f=(0,n.Kr)(()=>h!==i?.title||m!==i?.iconEmojiId,[m,h,i?.iconEmojiId,i?.title]),b=(0,n.hb)(e=>{const t=e.target.value;u(t)},[]),C=(0,n.hb)(()=>{c({chatId:t.id,title:h,topicId:i.id,iconEmojiId:m})},[t,c,m,h,i]),y=(0,n.hb)(e=>{e.isFree||r||e.id===o.MyF?e.id!==o.MyF?p(e.id):p("0"):d({initialSection:"animated_emoji"})},[r,d]),S=(0,n.Kr)(()=>({...i,title:h,iconEmojiId:m}),[m,h,i]);if(t?.isForum)return(0,te.FD)("div",{className:Jg,children:[(0,te.FD)("div",{className:(0,me.A)(Gg,"custom-scroll"),children:[!i&&(0,te.Y)($n.A,{}),i&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:(0,me.A)(jg,zg,A&&"YftUWqqw"),children:[(0,te.Y)("span",{className:Wg,children:v(A?"CreateGeneralTopicTitle":"CreateTopicTitle")}),(0,te.Y)(se.Ay,{name:"zoomFade",activeKey:Number(S.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:$g,children:(0,te.Y)(Wn.A,{topic:S,className:qg,size:eA,noLoopLimit:!0})}),(0,te.Y)(Z.A,{value:h,onChange:b,label:v("lng_forum_topic_title"),disabled:g,teactExperimentControlled:!0})]}),!A&&(0,te.Y)("div",{className:(0,me.A)(jg,Hg),children:(0,te.Y)(ol,{idPrefix:"edit-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:y,className:Qg,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})})]})]}),(0,te.Y)(Ni.A,{isShown:f,disabled:g,onClick:C,ariaLabel:v("Save"),children:g?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})})),iA="Please provide name",nA=(0,n.ph)((0,s.EK)((e,{userId:t})=>{const i=(0,c.yps)(e,t),n=(0,c.vGo)(e,t),{progress:s}=(0,c.nTw)(e).management,a=(0,Sa.d)(e,"aboutLength");return{userId:t,user:i,progress:s,currentBio:n?.bio,maxBioLength:a}})(({userId:e,user:t,progress:i,currentBio:o,isActive:r,maxBioLength:c,onClose:d})=>{const{setBotInfo:h,uploadProfilePhoto:u,uploadContactProfilePhoto:m,startBotFatherConversation:p}=(0,s.ko)(),[v,g,A]=(0,F.A)(!1),[f,b,C]=(0,F.A)(!1),[y,S]=(0,n.J0)(),k=(0,T.A)(),w=(0,n.Kr)(()=>t?(0,l.Kl)(t):void 0,[t]);(0,Ce.A)({isActive:r,onBack:d});const N=t?(0,l.u0)(t):"",[I,P]=(0,n.J0)(),[Y,D]=(0,n.J0)(N||""),[B,R]=(0,n.J0)(o||""),L=t&&(0,l.cP)(t),x=(0,z.A)(L,!1,O.qZ.BlobUrl);(0,n.vJ)(()=>{A(),C()},[e]),(0,n.vJ)(()=>{D(N||""),R(o||"")},[N,o,t]),(0,n.vJ)(()=>{P(void 0)},[x]),(0,n.vJ)(()=>{i===a.TD.Complete&&(A(),C(),S(void 0))},[i]);const E=(0,M.A)(e=>{D(e.target.value),g(),y===iA&&S(void 0)}),V=(0,M.A)(e=>{R(e.target.value),g()}),_=(0,M.A)(e=>{P(e),b()}),U=(0,M.A)(()=>{const e=Y.trim(),i=B.trim();e.length?(h({...v&&{bot:t,name:e,description:i}}),I&&u({file:I,...f&&{bot:t}})):S(iA)}),K=(0,M.A)(()=>{p({param:`${w}-intro`})}),J=(0,M.A)(()=>{p({param:`${w}-commands`})}),G=(0,M.A)(()=>{p({param:w})}),j=(0,n.li)(),H=(0,n.li)(!1),$=(0,M.A)(t=>{b(),m({userId:e,file:t,isSuggest:H.current})});if(!t)return;const q=i===a.TD.InProgress;return(0,te.FD)("div",{className:"Management",children:[(0,te.FD)("div",{className:"custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(Uh.A,{currentAvatarBlobUrl:x,onChange:_,title:k("ChatSetPhotoOrVideo"),disabled:q}),(0,te.Y)(Z.A,{id:"user-name",label:k("PaymentCheckoutName"),onChange:E,value:Y,error:y===iA?y:void 0,teactExperimentControlled:!0}),(0,te.Y)(Ql.A,{value:B,onChange:V,label:k("DescriptionPlaceholder"),disabled:q,maxLength:c,maxLengthIndicator:c?(c-B.length).toString():void 0})]}),(0,te.Y)("div",{className:"section",children:(0,te.FD)("div",{className:"dialog-buttons",children:[(0,te.Y)(di.A,{icon:"bot-commands-filled",ripple:!0,onClick:K,children:(0,te.Y)("span",{children:k("BotEditIntro")})}),(0,te.Y)(di.A,{icon:"bot-command",ripple:!0,onClick:J,children:(0,te.Y)("span",{children:k("BotEditCommands")})}),(0,te.Y)(di.A,{icon:"bots",ripple:!0,onClick:G,children:(0,te.Y)("span",{children:k("BotChangeSettings")})}),(0,te.Y)("div",{className:"section-info section-info_push",children:(0,Dt.A)(k("BotManageInfo"),["links"])})]})})]}),(0,te.Y)(Ni.A,{isShown:v||f,onClick:U,disabled:q,ariaLabel:k("Save"),children:q?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),(0,te.Y)(Fu.A,{onChange:$,inputRef:j})]})})),sA="Channel title can't be empty",aA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{management:n}=(0,c.nTw)(e),{progress:s}=n,{invites:a}=n.byChatId[t]||{},o=e.appConfig.channelAutoTranslationLevelMin,r=i?.hasAutoTranslation,d=i?.level,h=!(!d||!o)&&d>=o;return{chat:i,chatFullInfo:(0,c.AWZ)(e,t),progress:s,canChangeInfo:(0,l.ub)(i,"changeInfo"),canInvite:(0,l.ub)(i,"inviteUsers"),exportedInvites:a,availableReactions:e.reactions.availableReactions,hasAutoTranslation:r,canToggleAutoTranslation:h}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chatId:e,chat:t,chatFullInfo:i,progress:o,canChangeInfo:r,canInvite:d,exportedInvites:h,isActive:u,availableReactions:m,onScreenSelect:p,onClose:v,hasAutoTranslation:g,canToggleAutoTranslation:A})=>{const{updateChat:f,closeManagement:b,leaveChannel:C,deleteChannel:y,openChat:S,loadExportedChatInvites:k,loadChatJoinRequests:w,toggleAutoTranslation:N}=(0,s.ko)(),I=t?.title||"",P=i?.about||"",Y=Boolean(i?.linkedChatId),[D,B,R]=(0,F.A)(),[L,x]=(0,n.J0)(!1),[E,V]=(0,n.J0)(I),[_,U]=(0,n.J0)(P),[K,J]=(0,n.J0)(),[G,j]=(0,n.J0)(),H=t&&(0,l.cP)(t),$=(0,z.A)(H,!1,O.qZ.BlobUrl),q=(0,T.A)(),Q=t&&(0,l.WX)(t),X=(0,M.A)(()=>{N({chatId:e,isEnabled:!g})});(0,Ce.A)({isActive:u,onBack:v}),(0,n.vJ)(()=>{d&&(k({chatId:e}),k({chatId:e,isRevoked:!0}),w({chatId:e}))},[e,d]),(0,n.vJ)(()=>{o===a.TD.Complete&&(x(!1),j(void 0))},[o]);const ee=(0,n.Kr)(()=>Object.keys(i?.adminMembersById||{}).length,[i?.adminMembersById]),ie=i?.kickedMembers?.length||0,ne=(0,M.A)(()=>{p(a.je.ChatPrivacyType)}),se=(0,M.A)(()=>{p(a.je.Discussion)}),ae=(0,M.A)(()=>{p(a.je.Reactions)}),oe=(0,M.A)(()=>{p(a.je.ChatAdministrators)}),re=(0,M.A)(()=>{p(a.je.Invites)}),le=(0,M.A)(()=>{p(a.je.JoinRequests)}),ce=(0,M.A)(e=>{J(e),x(!0)}),de=(0,M.A)(e=>{V(e.target.value),x(!0)}),he=(0,M.A)(e=>{U(e.target.value),x(!0)}),ue=(0,M.A)(()=>{const t=E.trim(),i=_.trim();t.length?f({chatId:e,title:t,about:i,photo:K}):j(sA)}),me=(0,M.A)(()=>{p(a.je.ChannelSubscribers)}),pe=(0,M.A)(()=>{p(a.je.ChannelRemovedUsers)}),ve=(0,M.A)(()=>{t.isCreator?y({chatId:t.id}):C({chatId:t.id}),R(),b(),S({id:void 0})}),ge=(0,n.Kr)(()=>{if(!i?.enabledReactions)return q("ReactionsOff");if("all"===i.enabledReactions.type)return q("ReactionsAll");const e=i.enabledReactions.allowed.length,t=m?.filter(e=>!e.isInactive).length||0;return t?`${e} / ${t}`:e.toString()},[m,i?.enabledReactions,q]),Ae=(0,n.Kr)(()=>(0,l.gA)(t),[t]);if((0,c._ls)((0,s.mS)(),e)||t.isForbidden)return;const fe=o===a.TD.InProgress;return(0,te.FD)("div",{className:"Management",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(Uh.A,{currentAvatarBlobUrl:$,onChange:ce,disabled:!r}),(0,te.FD)("div",{className:"settings-edit",children:[(0,te.Y)(Z.A,{id:"channel-title",label:q("EnterChannelName"),onChange:de,value:E,error:G===sA?G:void 0,disabled:!r}),(0,te.Y)(Ql.A,{id:"channel-about",label:q("DescriptionPlaceholder"),onChange:he,value:_,maxLength:255,maxLengthIndicator:(255-_.length).toString(),disabled:!r,noReplaceNewlines:!0})]}),t.isCreator&&(0,te.FD)(di.A,{icon:"lock",multiline:!0,onClick:ne,children:[(0,te.Y)("span",{className:"title",children:q("ChannelType")}),(0,te.Y)("span",{className:"subtitle",children:q(Ae?"TypePublic":"TypePrivate")})]}),(0,te.FD)(di.A,{icon:"message",multiline:!0,onClick:se,disabled:!r,children:[(0,te.Y)("span",{className:"title",children:q("Discussion")}),(0,te.Y)("span",{className:"subtitle",children:q(Y?"DiscussionUnlink":"Add")})]}),d&&(0,te.FD)(di.A,{icon:"link",onClick:re,multiline:!0,disabled:!h,children:[(0,te.Y)("span",{className:"title",children:q("GroupInfo.InviteLinks")}),(0,te.Y)("span",{className:"subtitle",children:h?(0,$e.Sm)(h.length):q("Loading")})]}),Boolean(t.joinRequests?.length)&&(0,te.FD)(di.A,{icon:"add-user-filled",onClick:le,multiline:!0,children:[(0,te.Y)("span",{className:"title",children:q("SubscribeRequests")}),(0,te.Y)("span",{className:"subtitle",children:(0,$e.Sm)(t.joinRequests.length)})]}),(0,te.FD)(di.A,{icon:"heart-outline",multiline:!0,onClick:ae,disabled:!r,children:[(0,te.Y)("span",{className:"title",children:q("Reactions")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:ge})]}),Q&&(0,te.FD)(di.A,{icon:"language",narrow:!0,ripple:!0,disabled:!A,onClick:X,children:[(0,te.Y)("span",{children:q("AutomaticTranslation")}),(0,te.Y)(bi.A,{id:"auto-translation",label:q("AutomaticTranslation"),checked:g})]})]}),(0,te.FD)("div",{className:"section",children:[(0,te.FD)(di.A,{icon:"admin",multiline:!0,onClick:oe,children:[(0,te.Y)("span",{className:"title",children:q("ChannelAdministrators")}),(0,te.Y)("span",{className:"subtitle",children:ee})]}),(0,te.FD)(di.A,{icon:"group",multiline:!0,onClick:me,children:[(0,te.Y)("span",{className:"title",dir:"auto",children:q("ChannelSubscribers")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:(0,$e.Sm)(t.membersCount)})]}),(0,te.FD)(di.A,{icon:"delete-user",multiline:!0,onClick:pe,children:[(0,te.Y)("span",{className:"title",children:q("ChannelBlockedUsers")}),(0,te.Y)("span",{className:"subtitle",children:ie})]})]}),(0,te.Y)("div",{className:"section",children:(0,te.Y)(di.A,{icon:"delete",ripple:!0,destructive:!0,onClick:B,children:t.isCreator?q("ChannelDelete"):q("LeaveChannel")})})]}),(0,te.Y)(Ni.A,{isShown:L,onClick:ue,disabled:fe,ariaLabel:q("Save"),children:fe?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),(0,te.Y)(gi.A,{isOpen:D,onClose:R,text:t.isCreator?q("ChannelDeleteAlert"):q("ChannelLeaveAlert"),confirmLabel:t.isCreator?q("ChannelDelete"):q("LeaveChannel"),confirmHandler:ve,confirmIsDestructive:!0})]})})),oA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,currentUserId:e.currentUserId,isChannel:i&&(0,l.WX)(i),adminMembersById:(0,c.AWZ)(e,t)?.adminMembersById}})(({isActive:e,chat:t,isChannel:i,currentUserId:o,adminMembersById:r,onScreenSelect:c,onChatMemberSelect:d,onClose:h})=>{const{toggleSignatures:u}=(0,s.ko)(),m=(0,T.A)();(0,Ce.A)({isActive:e,onBack:h});const p=Boolean(t?.areSignaturesShown),v=Boolean(t?.areProfilesShown),g=Boolean(t?.isCreator||t&&(0,l.ub)(t,"addAdmins")),A=i&&(0,l.ub)(t,"postMessages"),f=(0,n.Kr)(()=>{if(!r)return[];const[e,t]=(0,Ci.jB)(Object.values(r),e=>e.isOwner);return[...e,...t]},[r]),b=(0,M.A)(e=>{d(e.userId,e.promotedByUserId===o),c(a.je.ChatAdminRights)}),C=(0,M.A)(()=>{u({chatId:t.id,areProfilesEnabled:v,areSignaturesEnabled:!p})}),y=(0,M.A)(()=>{u({chatId:t.id,areProfilesEnabled:!v,areSignaturesEnabled:p})}),S=(0,M.A)(()=>{c(a.je.GroupAddAdmins)}),k=(0,M.A)(e=>{if(e.isOwner)return m("ChannelCreator");const t=(0,s.mS)().users.byId,i=e.promotedByUserId?t[e.promotedByUserId]:void 0;return i?m("EditAdminPromotedBy",(0,l.Yg)(i)):m("ChannelAdmin")});return(0,te.Y)("div",{className:"Management",children:(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.Y)("div",{className:"section",children:(0,te.FD)(di.A,{icon:"recent",multiline:!0,disabled:!0,children:[(0,te.Y)("span",{className:"title",children:m("EventLog")}),(0,te.Y)("span",{className:"subtitle",children:m(i?"EventLogInfoDetailChannel":"EventLogInfoDetail")})]})}),(0,te.FD)("div",{className:"section",dir:m.isRtl?"rtl":void 0,children:[(0,te.Y)("p",{className:"section-help",dir:"auto",children:m(i?"Channel.Management.AddModeratorHelp":"Group.Management.AddModeratorHelp")}),f.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable",onClick:()=>b(e),children:(0,te.Y)(xn.A,{userId:e.userId,status:k(e),forceShowSelf:!0})},e.userId)),(0,te.Y)(Ni.A,{isShown:g,onClick:S,ariaLabel:m("Channel.Management.AddModerator"),children:(0,te.Y)(W.A,{name:"add-user-filled"})})]}),A&&(0,te.FD)("div",{className:"section",children:[(0,te.Y)("div",{className:"ListItem narrow",children:(0,te.Y)(ps.A,{checked:p,label:m("ChannelSignMessages"),onChange:C})}),p&&(0,te.FD)(te.FK,{children:[(0,te.Y)("div",{className:"ListItem narrow",children:(0,te.Y)(ps.A,{checked:v,label:m("ChannelSignMessagesWithProfile"),onChange:y})}),(0,te.Y)("p",{className:"section-info section-info_push",children:m("ChannelSignProfilesInfo")})]})]})]})})})),rA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{isUsernameAvailable:n,checkedUsername:s,error:a}=(0,c.YK)(e,t);return{chat:i,isChannel:(0,l.WX)(i),progress:(0,c.nTw)(e).management.progress,error:a,isUsernameAvailable:n,checkedUsername:s,isProtected:i?.isProtected,maxPublicLinks:(0,Sa.d)(e,"channelsPublic"),privateInviteLink:(0,c.AWZ)(e,t)?.inviteLink}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)&&(0,c.YK)(e,t)))(({chat:e,isActive:t,isChannel:i,progress:r,isUsernameAvailable:c,checkedUsername:d,error:h,isProtected:u,maxPublicLinks:m,privateInviteLink:p,onClose:v})=>{const{updatePublicLink:g,updatePrivateLink:A,toggleIsProtected:f,openLimitReachedModal:b,resetManagementError:C}=(0,s.ko)(),y=(0,n.Kr)(()=>e.usernames?.find(({isEditable:e})=>e),[e.usernames]),S=y?.username||"",k=(0,n.Kr)(()=>(0,l.gA)(e),[e]),[w,N]=(0,n.J0)(!1),[I,P]=(0,n.J0)(k?"public":"private"),[Y,D]=(0,n.J0)(),[M,B,R]=(0,F.A)(),[L,x,E]=(0,F.A)(),V=(0,_.A)(c),U=w&&Boolean("public"===I&&(Y||S&&""===Y)&&(c??V)||"private"===I&&k);(0,Ce.A)({isActive:t,onBack:v}),(0,n.vJ)(()=>{N(!1)},[S]),(0,n.vJ)(()=>{I&&!p&&A()},[I,p,A]);const O=(0,n.hb)(t=>{D(t),N(!0),h&&C({chatId:e.id})},[e.id,h]),K=(0,n.hb)((e,t)=>{if(Object.values((0,s.mS)().chats.byId).filter(({isCreator:e,usernames:t})=>e&&t?.some(e=>e.isActive)).length>=m&&"public"===e){b({limit:"channelsPublic"});const e=t.currentTarget.closest(".radio-group");return e.querySelector("[value=public]").checked=!1,void(e.querySelector("[value=private]").checked=!0)}P(e),N(!0)},[m,b]),J=(0,n.hb)(t=>{f({chatId:e.id,isProtected:"protected"===t})},[e.id,f]),G=(0,n.hb)(()=>{k&&"private"===I?x():g({username:"public"===I&&Y||""})},[k,x,I,g,Y]),j=(0,n.hb)(()=>{g({username:"",shouldDisableUsernames:!0}),E()},[E,g]),z=(0,n.hb)(()=>{R(),A()},[R,A]),H=(0,T.A)(),$=i?"Channel":"Mega",q=i?"Channel":"Group",Q=[{value:"private",label:H(`${$}Private`),subLabel:H(`${$}PrivateInfo`)},{value:"public",label:H(`${$}Public`),subLabel:H(`${$}PublicInfo`)}],Z=[{value:"allowed",label:H("ChannelVisibility.Forwarding.Enabled")},{value:"protected",label:H("ChannelVisibility.Forwarding.Disabled")}],X=r===a.TD.InProgress,ie="public"===I&&e.usernames&&e.usernames.length>0;return(0,te.FD)("div",{className:"Management",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.FD)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:[(0,te.Y)("h3",{className:"section-heading",children:H(`${q}Type`)}),(0,te.Y)(ee.A,{selected:I,name:"channel-type",options:Q,onChange:K})]}),"private"===I?(0,te.Y)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:p?(0,te.FD)(te.FK,{children:[(0,te.Y)(Al.A,{link:p,className:"invite-link"}),(0,te.Y)("p",{className:"section-info",dir:H.isRtl?"rtl":void 0,children:H(`${$}PrivateLinkHelp`)}),(0,te.Y)(di.A,{icon:"delete",ripple:!0,destructive:!0,onClick:B,children:H("RevokeLink")}),(0,te.Y)(gi.A,{isOpen:M,onClose:R,text:H("RevokeAlert"),confirmLabel:H("RevokeButton"),confirmHandler:z,confirmIsDestructive:!0})]}):(0,te.Y)($n.A,{})}):(0,te.FD)("div",{className:"section no-border",children:[(0,te.Y)("div",{className:"settings-input",children:(0,te.Y)(_h,{asLink:!0,currentUsername:S,isLoading:X,isUsernameAvailable:c,checkedUsername:d,onChange:O})}),h===o.Y3M&&function(){const e=`${o.jsp}${o.NjX}`;return(0,te.Y)("p",{className:"section-info",dir:"auto",children:H("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map(t=>"PURCHASE_LINK"===t?(0,te.Y)(Ll.A,{url:e,text:`@${o.NjX}`}):t)})}(),(0,te.Y)("p",{className:"section-info",dir:"auto",children:H(`${q}.Username.CreatePublicLinkHelp`)})]}),ie&&(0,te.Y)(Lh,{chatId:e.id,usernames:e.usernames,onEditUsername:O}),(0,te.FD)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:[(0,te.Y)("h3",{className:"section-heading",children:H(i?"ChannelVisibility.Forwarding.ChannelTitle":"ChannelVisibility.Forwarding.GroupTitle")}),(0,te.Y)(ee.A,{selected:u?"protected":"allowed",name:"forwarding-type",options:Z,onChange:J}),(0,te.Y)("p",{className:"section-info section-info_push",children:H(i?"ChannelVisibility.Forwarding.ChannelInfo":"ChannelVisibility.Forwarding.GroupInfo")})]})]}),(0,te.Y)(Ni.A,{isShown:U,disabled:X,ariaLabel:H("Save"),onClick:G,children:X?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),(0,te.Y)(gi.A,{isOpen:L,onClose:E,text:H("ChannelVisibility.Confirm.MakePrivate.Channel",S),confirmHandler:j,confirmIsDestructive:!0})]})})),lA=(0,n.ph)((0,s.EK)((e,{chat:t})=>{const{currentUserId:i}=e;return{currentUserId:i,chatMembers:(0,c.AWZ)(e,t.id)?.members}})(({chat:e,currentUserId:t,chatMembers:i,isOpen:a,onClose:o})=>{const{loadMoreMembers:r,deleteChatMember:l}=(0,s.ko)(),c=(0,T.A)(),[d,h]=(0,n.J0)(""),u=(0,n.Kr)(()=>{const e=(i||[]).reduce((e,i)=>(i.isAdmin||i.isOwner||i.userId===t||e.push(i.userId),e),[]);return(0,Ft.PU)({ids:e,query:d,type:"user"})},[i,t,d]),m=(0,M.A)(()=>{r({chatId:e.id})}),p=(0,M.A)(t=>{l({chatId:e.id,userId:t}),o()});return(0,te.Y)(es,{isOpen:a,chatOrUserIds:u,searchPlaceholder:c("ChannelBlockUser"),search:d,onSearchChange:h,loadMore:m,onSelectChatOrUser:p,onClose:o})})),cA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{byId:n}=e.users;return{chat:i,usersById:n,canDeleteMembers:i&&((0,l.ub)(i,"banUsers")||i.isCreator),removedMembers:(0,c.AWZ)(e,t)?.kickedMembers||yi.p,isChannel:i&&(0,l.WX)(i)}})(({chat:e,usersById:t,canDeleteMembers:i,removedMembers:a,isChannel:o,onClose:r,isActive:c})=>{const{updateChatMemberBannedRights:d}=(0,s.ko)(),h=(0,T.A)(),[u,m,p]=(0,F.A)();(0,Ce.A)({isActive:c,onBack:r});const v=(0,n.hb)(e=>{if(!e.kickedByUserId)return;const i=t[e.kickedByUserId];return i?h("UserRemovedBy",(0,l.Yg)(i)):void 0},[h,t]),g=(0,n.hb)(t=>{if(e)return[{title:h("Unblock"),icon:"delete",destructive:!0,handler:()=>d({chatId:e.id,userId:t.userId,bannedRights:{}})}]},[h,e,d]);return(0,te.Y)("div",{className:"Management",children:(0,te.Y)("div",{className:"panel-content custom-scroll",children:(0,te.FD)("div",{className:"section",dir:h.isRtl?"rtl":void 0,children:[(0,te.Y)("p",{className:"section-help",children:h(o?"NoBlockedChannel2":"NoBlockedGroup2")}),a.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable",ripple:!0,contextActions:g(e),children:(0,te.Y)(xn.A,{userId:e.userId,status:v(e),forceShowSelf:!0})},e.userId)),i&&(0,te.Y)(Ni.A,{isShown:!0,onClick:m,ariaLabel:h("Channel.EditAdmin.Permission.BanUsers"),children:(0,te.Y)(W.A,{name:"add-user-filled"})}),e&&i&&(0,te.Y)(lA,{chat:e,isOpen:u,onClose:p})]})})})})),dA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{linkedChatId:n}=(0,c.AWZ)(e,t)||{},{forDiscussionIds:s,byId:a}=e.chats;return{chat:i,chatsByIds:a,forDiscussionIds:s,linkedChat:n?(0,c.hds)(e,n):void 0,isChannel:i&&(0,l.WX)(i)}})(({chat:e,onClose:t,isActive:i,chatId:r,chatsByIds:c,linkedChat:d,forDiscussionIds:h,isChannel:u,onScreenSelect:m})=>{const{loadGroupsForDiscussion:p,linkDiscussionGroup:v,unlinkDiscussionGroup:g,toggleJoinRequest:A,toggleJoinToSend:f}=(0,s.ko)(),[b,C]=(0,n.J0)(),[y,S,k]=(0,F.A)(),[w,N,I]=(0,F.A)(),[P,Y]=(0,n.J0)(Boolean(d?.isJoinToSend)),[D,B]=(0,n.J0)(Boolean(d?.isJoinRequest)),R=(0,T.A)(),L=d?.id;(0,Ce.A)({isActive:i,onBack:t}),(0,n.vJ)(()=>{p()},[p]),(0,n.vJ)(()=>{i&&(Y(d?.isJoinToSend||!1),B(d?.isJoinRequest||!1))},[d,i]);const x=(0,n.hb)(()=>{k(),g({channelId:u?r:L}),u||m(a.je.Initial)},[k,g,u,r,L,m]),E=(0,n.hb)(()=>{I(),v({channelId:r,chatId:b})},[I,v,r,b]),V=(0,n.hb)(e=>{Y(e),f({chatId:L,isEnabled:e}),e||B(!1)},[L,f]),_=(0,n.hb)(e=>{B(e),A({chatId:L,isEnabled:e})},[L,A]);const U=(0,M.A)(()=>{m(a.je.NewDiscussionGroup)});return(0,te.Y)("div",{className:"Management",children:(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.DiscussionGroups,size:o.Uyp,className:"section-icon"}),d&&(0,te.FD)("div",{children:[d&&(0,te.Y)(di.A,{className:"chat-item-clickable",inactive:!0,children:(0,te.Y)(Ln.A,{chatId:d.id})}),(0,te.Y)(di.A,{icon:"delete",ripple:!0,destructive:!0,onClick:S,children:R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")}),(0,te.Y)(gi.A,{isOpen:y,onClose:k,header:(0,te.FD)("div",{className:"modal-header",children:[(0,te.Y)(Mt.A,{size:"tiny",peer:d}),(0,te.Y)("div",{className:"modal-title",children:R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")})]}),textParts:(0,Dt.A)(R(u?"DiscussionUnlinkChannelAlert":"DiscussionUnlinkGroupAlert",d?.title),["br","simple_markdown"]),confirmLabel:R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"),confirmHandler:x,confirmIsDestructive:!0})]}),!d&&(0,te.FD)("div",{children:[(0,te.Y)("p",{className:"section-help",dir:"auto",children:R("DiscussionChannelHelp")}),(0,te.FD)("div",{teactFastList:!0,children:[(0,te.Y)(di.A,{icon:"group",ripple:!0,className:"create-item",withPrimaryColor:!0,teactOrderKey:0,onClick:U,children:R("DiscussionCreateGroup")},"create-group"),h?h.map((e,t)=>(0,te.Y)(di.A,{teactOrderKey:t+1,className:"chat-item-clickable scroll-item",onClick:()=>{C(e),N()},children:(0,te.Y)(Ln.A,{chatId:e})},e)):(0,te.Y)(Gc.A,{teactOrderKey:0,text:"No discussion groups found"},"nothing-found")]}),(0,te.Y)("p",{className:"mt-4 mb-0 section-help",dir:"auto",children:R("DiscussionChannelHelp2")}),(0,te.Y)(gi.A,{isOpen:w,onClose:I,header:function(){if(!b)return;const e=c[b];return e?(0,te.FD)("div",{className:"modal-header",children:[(0,te.Y)(Mt.A,{size:"tiny",peer:e}),(0,te.Y)("div",{className:"modal-title",children:R("Channel.DiscussionGroup.LinkGroup")})]}):void 0}(),textParts:function(){if(!b)return;const t=c[b];return t?(0,l.gA)(t)?(0,Dt.A)(`Do you want to make **${t.title}** the discussion board for **${e?.title}**?`,["br","simple_markdown"]):(0,Dt.A)(`Do you want to make **${t.title}** the discussion board for **${e?.title}**?\n\nAnyone from the channel will be able to see messages in this group.`,["br","simple_markdown"]):void 0}(),confirmLabel:R("DiscussionLinkGroup"),confirmHandler:E})]})]}),d&&(0,te.FD)("div",{className:"section",children:[(0,te.Y)("h3",{className:"section-heading",children:R("ChannelSettingsJoinTitle")}),(0,te.Y)("div",{className:"ListItem narrow",children:(0,te.Y)(ps.A,{checked:P,onCheck:V,label:R("ChannelSettingsJoinToSend")})}),P&&(0,te.Y)("div",{className:"ListItem narrow",children:(0,te.Y)(ps.A,{checked:D,onCheck:_,label:R("ChannelSettingsJoinRequest")})}),(0,te.Y)("p",{className:"section-info section-info_push",children:R(P?"ChannelSettingsJoinRequestInfo":"ChannelSettingsJoinToSendInfo")})]})]})})})),hA="Group title can't be empty",uA=["sendMessages","embedLinks","sendPolls","changeInfo","inviteUsers","pinMessages","manageTopics","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs"],mA=uA.length+1,pA=(0,ge.sg)(e=>e(),500,!1),vA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t),{management:s,limitReachedModal:a}=(0,c.nTw)(e),{progress:o}=s,r=Boolean(n?.linkedChatId),d=(0,l.yn)(i),{invites:h}=s.byChatId[t]||{},u=!r&&((0,l.ub)(i,"changeInfo")||i.isCreator);return{chat:i,chatFullInfo:n,progress:o,isBasicGroup:d,hasLinkedChannel:r,canChangeInfo:i.isCreator||(0,l.ub)(i,"changeInfo"),canBanUsers:i.isCreator||(0,l.ub)(i,"banUsers"),canInvite:i.isCreator||(0,l.ub)(i,"inviteUsers"),exportedInvites:h,isChannelsPremiumLimitReached:"channels"===a?.limit,availableReactions:e.reactions.availableReactions,canEditForum:u}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chatId:e,chat:t,chatFullInfo:i,progress:o,isBasicGroup:r,hasLinkedChannel:d,canChangeInfo:h,canBanUsers:u,canInvite:m,canEditForum:p,isActive:v,exportedInvites:g,isChannelsPremiumLimitReached:A,availableReactions:f,onScreenSelect:b,onClose:C})=>{const{togglePreHistoryHidden:y,updateChat:S,deleteChat:k,leaveChannel:w,deleteChannel:N,closeManagement:I,openChat:P,loadExportedChatInvites:Y,loadChatJoinRequests:D,toggleForum:B}=(0,s.ko)(),[R,L,x]=(0,F.A)(),E=t.title,V=i?.about||"",[_,U]=(0,n.J0)(!1),[K,J]=(0,n.J0)(E),[G,j]=(0,n.J0)(V),[H,$]=(0,n.J0)(),[q,Q]=(0,n.J0)(),[X,ee]=(0,n.J0)(t.isForum),ie=(0,l.cP)(t),ne=(0,z.A)(ie,!1,O.qZ.BlobUrl),se=(0,n.Kr)(()=>(0,l.gA)(t),[t]),ae=(0,T.A)(),oe=(0,n.li)();(0,Ce.A)({isActive:v,onBack:C}),(0,n.vJ)(()=>{m&&(Y({chatId:e}),Y({chatId:e,isRevoked:!0}),D({chatId:e}))},[e,m]),(0,n.vJ)(()=>{ee(Boolean(t.isForum))},[t.isForum]),(0,n.vJ)(()=>{o===a.TD.Complete&&(U(!1),Q(void 0))},[o]);const re=(0,M.A)(()=>{b(a.je.ChatPrivacyType)}),le=(0,M.A)(()=>{b(a.je.Discussion)}),ce=(0,M.A)(()=>{b(a.je.Reactions)}),de=(0,M.A)(()=>{b(a.je.GroupPermissions)}),he=(0,M.A)(()=>{b(a.je.ChatAdministrators)}),ue=(0,M.A)(()=>{b(a.je.Invites)}),me=(0,M.A)(()=>{b(a.je.JoinRequests)}),pe=(0,M.A)(e=>{$(e),U(!0)}),ve=(0,M.A)(e=>{J(e.target.value),U(!0)}),ge=(0,M.A)(e=>{j(e.target.value),U(!0)}),Ae=(0,M.A)(()=>{const t=K.trim(),i=G.trim();t.length?S({chatId:e,title:t,about:i,photo:H}):Q(hA)}),fe=(0,M.A)(()=>{b(a.je.GroupMembers)}),be=(0,M.A)(()=>{if(!i)return;const{isPreHistoryHidden:e}=i;y({chatId:t.id,isEnabled:!e})}),ye=(0,M.A)(()=>{ee(t=>{const i=!t;return pA(()=>{B({chatId:e,isEnabled:i})}),i})});(0,n.vJ)(()=>{if(!A)return;const e=oe.current?.querySelector("input");e.checked=!i?.isPreHistoryHidden},[A,i?.isPreHistoryHidden]);const Se=(0,n.Kr)(()=>{if(!i?.enabledReactions)return ae("ReactionsOff");if("all"===i.enabledReactions.type)return ae("ReactionsAll");const e=i.enabledReactions.allowed.length,t=f?.filter(e=>!e.isInactive).length||0;return t?`${e} / ${t}`:e.toString()},[f,i?.enabledReactions,ae]),ke=(0,n.Kr)(()=>{if(!t.defaultBannedRights)return 0;let e=uA.filter(e=>!("manageTopics"===e&&!X||t.defaultBannedRights[e])).length;const{sendStickers:i,sendGifs:n}=t.defaultBannedRights;return i||n||(e+=1),e},[t.defaultBannedRights,X]),we=(0,n.Kr)(()=>Object.keys(i?.adminMembersById||{}).length,[i?.adminMembersById]),Ne=(0,M.A)(()=>{r?k({chatId:t.id}):t.isCreator?N({chatId:t.id}):w({chatId:t.id}),x(),I(),P({id:void 0})});if((0,c._ls)((0,s.mS)(),e)||t.isForbidden)return;const Ie=o===a.TD.InProgress;return(0,te.FD)("div",{className:"Management",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(Uh.A,{isForForum:X,currentAvatarBlobUrl:ne,onChange:pe,disabled:!h}),(0,te.FD)("div",{className:"settings-edit",children:[(0,te.Y)(Z.A,{id:"group-title",label:ae("GroupName"),onChange:ve,value:K,error:q===hA?q:void 0,disabled:!h}),(0,te.Y)(Ql.A,{id:"group-about",label:ae("DescriptionPlaceholder"),maxLength:255,maxLengthIndicator:(255-G.length).toString(),onChange:ge,value:G,disabled:!h,noReplaceNewlines:!0})]}),t.isCreator&&(0,te.FD)(di.A,{icon:"lock",multiline:!0,onClick:re,children:[(0,te.Y)("span",{className:"title",children:ae("GroupType")}),(0,te.Y)("span",{className:"subtitle",children:ae(se?"TypePublic":"TypePrivate")})]}),d&&(0,te.FD)(di.A,{icon:"message",multiline:!0,onClick:le,children:[(0,te.Y)("span",{className:"title",children:ae("LinkedChannel")}),(0,te.Y)("span",{className:"subtitle",children:ae("DiscussionUnlink")})]}),(0,te.FD)(di.A,{icon:"permissions",multiline:!0,onClick:de,disabled:!u,children:[(0,te.Y)("span",{className:"title",children:ae("ChannelPermissions")}),(0,te.FD)("span",{className:"subtitle",dir:"auto",children:[ke,"/",mA-(X?0:1)]})]}),(0,te.FD)(di.A,{icon:"heart-outline",multiline:!0,onClick:ce,disabled:!h,children:[(0,te.Y)("span",{className:"title",children:ae("Reactions")}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:Se})]}),(0,te.FD)(di.A,{icon:"admin",multiline:!0,onClick:he,children:[(0,te.Y)("span",{className:"title",children:ae("ChannelAdministrators")}),(0,te.Y)("span",{className:"subtitle",children:(0,$e.Sm)(we)})]}),m&&(0,te.FD)(di.A,{icon:"link",onClick:ue,multiline:!0,disabled:!g,children:[(0,te.Y)("span",{className:"title",children:ae("GroupInfo.InviteLinks")}),(0,te.Y)("span",{className:"subtitle",children:g?(0,$e.Sm)(g.length):ae("Loading")})]}),Boolean(t.joinRequests?.length)&&(0,te.FD)(di.A,{icon:"add-user-filled",onClick:me,multiline:!0,children:[(0,te.Y)("span",{className:"title",children:ae("MemberRequests")}),(0,te.Y)("span",{className:"subtitle",children:(0,$e.Sm)(t.joinRequests.length)})]}),p&&(0,te.FD)(te.FK,{children:[(0,te.FD)(di.A,{icon:"forums",ripple:!0,onClick:ye,children:[(0,te.Y)("span",{children:ae("ChannelTopics")}),(0,te.Y)(bi.A,{id:"group-notifications",label:ae("ChannelTopics"),checked:X,inactive:!0})]}),(0,te.Y)("div",{className:"section-info section-info_push",children:ae("ForumToggleDescription")})]})]}),(0,te.FD)("div",{className:"section",children:[(0,te.FD)(di.A,{icon:"group",multiline:!0,onClick:fe,children:[(0,te.Y)("span",{className:"title",children:ae("GroupMembers")}),(0,te.Y)("span",{className:"subtitle",children:(0,$e.Sm)(t.membersCount??0)})]}),!se&&!d&&Boolean(i)&&(0,te.Y)("div",{className:"ListItem narrow",ref:oe,children:(0,te.Y)(ps.A,{className:"align-checkbox-with-list-buttons",checked:!i.isPreHistoryHidden,label:ae("ChatHistory"),onChange:be,subLabel:i.isPreHistoryHidden?ae("ChatHistoryHiddenInfo2"):ae("ChatHistoryVisibleInfo"),disabled:!u})})]}),(0,te.Y)("div",{className:"section",children:(0,te.Y)(di.A,{icon:"delete",ripple:!0,destructive:!0,onClick:L,children:ae("DeleteMega")})})]}),(0,te.Y)(Ni.A,{isShown:_,onClick:Ae,disabled:Ie,ariaLabel:ae("Save"),children:Ie?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),(0,te.Y)(gi.A,{isOpen:R,onClose:x,textParts:(0,Dt.A)(r||!t.isCreator?ae("AreYouSureDeleteAndExit"):ae("AreYouSureDeleteThisChatWithGroup",t.title),["br","simple_markdown"]),confirmLabel:r||!t.isCreator?ae("DeleteMega"):ae("DeleteGroupForAll"),confirmHandler:Ne,confirmIsDestructive:!0})]})})),gA=(0,n.ph)((0,s.EK)((e,{chatId:t,isPromotedByCurrentUser:i})=>{const n=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t),{byId:a}=e.users,{currentUserId:o}=e,r=(0,l.WX)(n),d=!(n.isCreator||i);return{chat:n,usersById:a,currentUserId:o,isChannel:r,isForum:n.isForum,isFormFullyDisabled:d,defaultRights:n.adminRights,hasFullInfo:Boolean(s),adminMembersById:s?.adminMembersById}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({isActive:e,isNewAdmin:t,selectedUserId:i,defaultRights:o,chat:r,usersById:c,currentUserId:d,adminMembersById:h,hasFullInfo:u,isChannel:m,isForum:p,isFormFullyDisabled:v,onClose:g,onScreenSelect:A})=>{const{updateChatAdmin:f}=(0,s.ko)(),[b,C]=(0,n.J0)({}),[y,S]=(0,n.J0)(Boolean(t)),[k,w]=(0,n.J0)(!1),[N,I,P]=(0,F.A)(),[Y,D]=(0,n.J0)(""),M=(0,T.A)();(0,Ce.A)({isActive:e,onBack:g});const B=(0,n.Kr)(()=>{const e=i?h?.[i]:void 0;if(!t||!e&&i){if(t){const e=(0,s.mS)().users.byId[i];return e?{userId:e.id,adminRights:o,customTitle:M("ChannelAdmin"),isOwner:!1,promotedByUserId:void 0}:void 0}return e}},[h,o,t,M,i]);(0,n.vJ)(()=>{u&&i&&!B&&A(a.je.ChatAdministrators)},[r,u,A,B,i]),(0,n.vJ)(()=>{C(B?.adminRights||{}),D((B?.customTitle||"").substr(0,16)),S(Boolean(t)),w(!1)},[o,t,B]);const R=(0,n.hb)(e=>{const{name:t}=e.target;C(e=>{return{...e,[t]:(i=e[t],!i||void 0)};var i}),S(!0)},[]),L=(0,n.hb)(()=>{i&&(w(!0),f({chatId:r.id,userId:i,adminRights:b,customTitle:Y}))},[i,f,r.id,b,Y]),x=(0,n.hb)(()=>{i&&(f({chatId:r.id,userId:i,adminRights:{}}),P())},[r.id,P,i,f]),E=(0,n.hb)(e=>!((0,l.yn)(r)||!v&&r.adminRights&&(r.isCreator||r.adminRights[e])),[r,v]),V=(0,n.Kr)(()=>{if(t||!B)return;if(B.isOwner)return M("ChannelCreator");const e=B.promotedByUserId?c[B.promotedByUserId]:void 0;return e?M("EditAdminPromotedBy",(0,l.Yg)(e)):M("ChannelAdmin")},[t,B,c,M]),_=(0,n.hb)(e=>{const{value:t}=e.target;D(t),S(!0)},[]);if(B)return(0,te.FD)("div",{className:"Management",children:[(0,te.Y)("div",{className:"panel-content custom-scroll",children:(0,te.FD)("div",{className:"section",children:[(0,te.Y)(di.A,{inactive:!0,className:"chat-item-clickable",children:(0,te.Y)(xn.A,{userId:B.userId,status:V,forceShowSelf:!0})}),(0,te.Y)("h3",{className:"section-heading mt-4",dir:"auto",children:M("EditAdminWhatCanDo")}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"changeInfo",checked:Boolean(b.changeInfo),label:M(m?"EditAdminChangeChannelInfo":"EditAdminChangeGroupInfo"),blocking:!0,disabled:E("changeInfo"),onChange:R})}),m&&(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"postMessages",checked:Boolean(b.postMessages),label:M("EditAdminPostMessages"),blocking:!0,disabled:E("postMessages"),onChange:R})}),m&&(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"editMessages",checked:Boolean(b.editMessages),label:M("EditAdminEditMessages"),blocking:!0,disabled:E("editMessages"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"deleteMessages",checked:Boolean(b.deleteMessages),label:M(m?"EditAdminDeleteMessages":"EditAdminGroupDeleteMessages"),blocking:!0,disabled:E("deleteMessages"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"postStories",checked:Boolean(b.postStories),label:M("EditAdminPostStories"),blocking:!0,disabled:E("postStories"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"editStories",checked:Boolean(b.editStories),label:M("EditAdminEditStories"),blocking:!0,disabled:E("editStories"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"deleteStories",checked:Boolean(b.deleteStories),label:M("EditAdminDeleteStories"),blocking:!0,disabled:E("deleteStories"),onChange:R})}),!m&&(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"banUsers",checked:Boolean(b.banUsers),label:M("EditAdminBanUsers"),blocking:!0,disabled:E("banUsers"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"inviteUsers",checked:Boolean(b.inviteUsers),label:M("EditAdminAddUsers"),blocking:!0,disabled:E("inviteUsers"),onChange:R})}),!m&&(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"pinMessages",checked:Boolean(b.pinMessages),label:M("EditAdminPinMessages"),blocking:!0,disabled:E("pinMessages"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"addAdmins",checked:Boolean(b.addAdmins),label:M("EditAdminAddAdmins"),blocking:!0,disabled:E("addAdmins"),onChange:R})}),(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"manageCall",checked:Boolean(b.manageCall),label:M("StartVoipChatPermission"),blocking:!0,disabled:E("manageCall"),onChange:R})}),p&&(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"manageTopics",checked:Boolean(b.manageTopics),label:M("ManageTopicsPermission"),blocking:!0,disabled:E("manageTopics"),onChange:R})}),!m&&(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:"anonymous",checked:Boolean(b.anonymous),label:M("EditAdminSendAnonymously"),blocking:!0,disabled:E("anonymous"),onChange:R})}),v&&(0,te.Y)("p",{className:"section-info mb-4",dir:"auto",children:M("Channel.EditAdmin.CannotEdit")}),!m&&(0,te.Y)(Z.A,{id:"admin-title",label:M("EditAdminRank"),onChange:_,value:Y,disabled:v,maxLength:16}),d!==i&&!v&&!t&&(0,te.Y)(di.A,{icon:"delete",ripple:!0,destructive:!0,onClick:I,children:M("EditAdminRemoveAdmin")})]})}),(0,te.Y)(Ni.A,{isShown:y,onClick:L,ariaLabel:M("Save"),disabled:k,children:k?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),!t&&(0,te.Y)(gi.A,{isOpen:N,onClose:P,text:"Are you sure you want to dismiss this admin?",confirmLabel:M("Channel.Admin.Dismiss"),confirmHandler:x,confirmIsDestructive:!0})]})}));var AA=i(23459),fA=i(285);const bA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{statusesById:n}=e.users,{members:s,adminMembersById:a,areParticipantsHidden:o}=(0,c.AWZ)(e,t)||{},r=i&&(0,l.WX)(i),{userIds:d}=e.contactList||{},h=e.appConfig.hiddenMembersMinCount,u=i&&(i.isCreator||(0,l.ub)(i,"banUsers")),m=u&&!(0,l.yn)(i)&&void 0!==i.membersCount&&void 0!==h&&i.membersCount>=h,p=i&&((0,l.ub)(i,"inviteUsers")||!r&&!(0,l.Sq)(i,"inviteUsers")||i.isCreator),{query:v,fetchingStatus:g,globalUserIds:A,localUserIds:f}=(0,c.nTw)(e).userSearch;return{areParticipantsHidden:Boolean(i&&o),members:s,canAddMembers:p,adminMembersById:a,userStatusesById:n,isChannel:r,localContactIds:d,searchQuery:v,isSearching:g,globalUserIds:A,localUserIds:f,canDeleteMembers:u,currentUserId:e.currentUserId,canHideParticipants:m}})(({chatId:e,noAdmins:t,members:i,canAddMembers:o,adminMembersById:r,userStatusesById:c,isChannel:d,isActive:h,globalUserIds:u,localContactIds:m,localUserIds:p,isSearching:v,searchQuery:g,currentUserId:A,canDeleteMembers:f,areParticipantsHidden:b,canHideParticipants:C,onClose:y,onScreenSelect:S,onChatMemberSelect:k})=>{const{openChat:w,setUserSearchQuery:N,closeManagement:I,toggleParticipantsHidden:P,setNewChatMembersDialogState:Y,toggleManagement:F}=(0,s.ko)(),D=(0,T.A)(),B=(0,n.li)(),R=(0,n.li)(),[L,x]=(0,n.J0)(),E=(0,n.Kr)(()=>t&&r?Object.keys(r):[],[r,t]),V=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId;if(!i||!e)return[];const n=(0,l.UB)(i.map(({userId:e})=>e),e,c);return t?n.filter(e=>!E.includes(e)):n},[i,c,t,E]);(0,AA.A)(V);const _=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId,i=Boolean(g),n=i?m?(0,Ft.PU)({ids:m,query:g,type:"user"}):[]:V;return(0,Jn.A)((0,Ci.Am)([...n,...i&&p||[],...i&&u||[]]).filter(i=>{const n=e[i];return!n||(d||n.canBeInvitedToGroup||!(0,l.tv)(n))&&(!t||!E.includes(i))}),!0)},[V,m,g,p,u,d,t,E]),[U,O]=(0,jn.A)(void 0,_,Boolean(g)),K=(0,M.A)(e=>{t?(k(e,!0),S(a.je.ChatNewAdminRights)):(I(),w({id:e}))}),J=(0,M.A)(e=>{N({query:e.target.value})}),G=(0,Hn.A)(R,h,e=>{U&&U.length>0&&K(U[-1===e?0:e])},".ListItem-button",!0),j=(0,M.A)(()=>{x(void 0)}),z=(0,M.A)(()=>{P({chatId:e,isEnabled:!b})}),H=(0,M.A)(()=>{F(),Y({newChatMembersProgress:a.D7.InProgress})});return(0,Ce.A)({isActive:h,onBack:y}),(0,te.FD)("div",{className:"Management",children:[t&&(0,te.Y)("div",{className:"Management__filter",dir:D.isRtl?"rtl":void 0,children:(0,te.Y)(Z.A,{ref:B,value:g,onChange:J,placeholder:D("Search")})}),(0,te.FD)("div",{className:"panel-content custom-scroll",children:[C&&!d&&(0,te.FD)("div",{className:"section",children:[(0,te.FD)(di.A,{icon:"group",ripple:!0,onClick:z,children:[(0,te.Y)("span",{children:D("ChannelHideMembers")}),(0,te.Y)(bi.A,{label:D("ChannelHideMembers"),checked:b})]}),(0,te.Y)("p",{className:"section-info",children:D(b?"GroupMembers.MembersHiddenOn":"GroupMembers.MembersHiddenOff")})]}),(0,te.Y)("div",{className:"section",children:U?.length?(0,te.Y)(Tn.A,{className:"picker-list custom-scroll",items:_,onLoadMore:O,noScrollRestore:Boolean(g),ref:R,onKeyDown:G,children:U.map(e=>{return(0,te.Y)(di.A,{className:"chat-item-clickable scroll-item",onClick:()=>K(e),contextActions:(t=e,t!==A&&f?[{title:D("lng_context_remove_from_group"),icon:"stop",handler:()=>{x(t)}}]:void 0),withPortalForMenu:!0,children:(0,te.Y)(xn.A,{userId:e,forceShowSelf:!0})},e);var t})}):v||!U||U.length?(0,te.Y)($n.A,{}):(0,te.Y)(Gc.A,{teactOrderKey:0,text:d?"No subscribers found":"No members found"},"nothing-found")})]}),o&&(0,te.Y)(Ni.A,{isShown:!0,onClick:H,ariaLabel:D("lng_channel_add_users"),children:(0,te.Y)(W.A,{name:"add-user-filled"})}),f&&(0,te.Y)(fA.A,{isOpen:Boolean(L),userId:L,onClose:j})]})})),CA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t),{progress:s}=(0,c.nTw)(e).management,a=i?.paidMessagesStars,r=e.appConfig.starsPaidMessageCommissionPermille;return{chat:i,progress:s,currentUserId:e.currentUserId,removedUsersCount:n?.kickedMembers?.length||0,members:n?.members,arePaidMessagesAvailable:Boolean(n?.arePaidMessagesAvailable&&r),canChargeForMessages:Boolean(a&&r),groupPeersPaidStars:a||o.wZe}})(({onScreenSelect:e,onChatMemberSelect:t,chat:i,progress:o,currentUserId:r,removedUsersCount:l,members:c,onClose:d,isActive:h,arePaidMessagesAvailable:u,canChargeForMessages:m,groupPeersPaidStars:p})=>{const{updateChatDefaultBannedRights:v,updatePaidMessagesPrice:g}=(0,s.ko)(),{permissions:A,havePermissionChanged:f,isLoading:b,handlePermissionChange:C,setIsLoading:y}=mc(i?.defaultBannedRights),S=(0,T.A)(),k=(0,Ui.A)();(0,Ce.A)({isActive:h,onBack:d});const w=(0,n.hb)(()=>{e(a.je.GroupRemovedUsers)},[e]),N=(0,n.hb)(()=>{e(a.je.GroupUserPermissionsCreate)},[e]),I=(0,n.hb)(i=>{t(i.userId,i.promotedByUserId===r),e(a.je.GroupUserPermissions)},[r,t,e]),[P,Y]=(0,n.J0)(!1),[D,B,R]=(0,F.A)(),[L,x]=(0,n.J0)(m),[E,V]=(0,n.J0)(p);(0,n.vJ)(()=>{o===a.TD.Complete&&R()},[o]);const _=(0,M.A)(()=>{i&&(y(!0),v({chatId:i.id,bannedRights:A}))}),U=(0,M.A)(()=>{i&&g({chatId:i?.id,paidMessagesStars:L?E:0})}),O=(0,M.A)(()=>{D&&U(),f&&_()}),K=(0,n.Kr)(()=>c?c.filter(({bannedRights:e})=>Boolean(e)):[],[c]),J=(0,n.hb)(e=>{const{bannedRights:t}=e;if(!t||!i)return;const{defaultBannedRights:n}=i;return Object.keys(t).reduce((e,i)=>{const s=i;if(!t[s]||n?.[s]||"sendInline"===s||"viewMessages"===s||"sendGames"===s)return e;const a=function(e){switch(e){case"sendMessages":return"UserRestrictionsNoSend";case"sendMedia":return"UserRestrictionsNoSendMedia";case"sendStickers":return"UserRestrictionsNoSendStickers";case"embedLinks":return"UserRestrictionsNoEmbedLinks";case"sendPolls":return"UserRestrictionsNoSendPolls";case"changeInfo":return"UserRestrictionsNoChangeInfo";case"inviteUsers":return"UserRestrictionsInviteUsers";case"pinMessages":return"UserRestrictionsPinMessages";case"manageTopics":return"GroupPermission.NoManageTopics";case"sendPlain":return"UserRestrictionsNoSendText";case"sendDocs":return"UserRestrictionsNoSendDocs";case"sendRoundvideos":return"UserRestrictionsNoSendRound";case"sendVoices":return"UserRestrictionsNoSendVoice";case"sendAudios":return"UserRestrictionsNoSendMusic";case"sendVideos":return"UserRestrictionsNoSendVideos";case"sendPhotos":return"UserRestrictionsNoSendPhotos";default:return}}(s);if(!a)return e;const o=S(a);return`${e}${e.length?`, ${o}`:o}`},"")},[i,S]),G=(0,M.A)(()=>{x(!L),B()}),j=(0,M.A)(e=>{V(e),B()}),z=D||f,H=o===a.TD.InProgress||b;return(0,te.FD)("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 432px;--before-shift-height: 96px;",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.FD)("div",{className:"section without-bottom-shadow",children:[(0,te.Y)("h3",{className:"section-heading",dir:"auto",children:k("ChannelPermissionsHeader")}),(0,te.Y)(vc,{chatId:i?.id,isMediaDropdownOpen:P,setIsMediaDropdownOpen:Y,handlePermissionChange:C,permissions:A,dropdownClassName:"DropdownListTrap",className:(0,me.A)("DropdownList",P&&"DropdownList--open"),shiftedClassName:(0,me.A)("part",P&&"shifted")})]}),u&&(0,te.FD)("div",{className:(0,me.A)("section",P&&"shifted"),children:[(0,te.FD)(di.A,{onClick:G,children:[(0,te.Y)("span",{children:k("GroupMessagesChargePrice")}),(0,te.Y)(bi.A,{id:"charge_for_messages",label:k("GroupMessagesChargePrice"),checked:L})]}),(0,te.Y)("p",{className:"settings-item-description-larger",dir:k.isRtl?"rtl":void 0,children:k("RightsChargeStarsAbout")})]}),L&&(0,te.Y)("div",{className:(0,me.A)("section",P&&"shifted"),children:(0,te.Y)(mh,{canChangeChargeForMessages:!0,isGroupChat:!0,chargeForMessages:E,onChange:j})}),(0,te.Y)("div",{className:(0,me.A)("section",P&&"shifted"),children:(0,te.FD)(di.A,{icon:"delete-user",multiline:!0,narrow:!0,onClick:w,children:[(0,te.Y)("span",{className:"title",children:k("ChannelBlockedUsers")}),(0,te.Y)("span",{className:"subtitle",children:l})]})}),(0,te.FD)("div",{className:(0,me.A)("section",P&&"shifted"),children:[(0,te.Y)("h3",{className:"section-heading",dir:"auto",children:k("PrivacyExceptions")}),(0,te.Y)(di.A,{icon:"add-user",onClick:N,children:k("ChannelAddException")}),K.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable exceptions-member",onClick:()=>I(e),children:(0,te.Y)(xn.A,{userId:e.userId,status:J(e),forceShowSelf:!0})},e.userId))]})]}),(0,te.Y)(Ni.A,{isShown:z,onClick:O,ariaLabel:k("Save"),disabled:H,children:H?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})})),yA=(0,n.ph)((0,s.EK)((e,{chatId:t,isPromotedByCurrentUser:i})=>{const n=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t);return{chat:n,isFormFullyDisabled:!(n.isCreator||i),hasFullInfo:Boolean(s),members:s?.members}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({chat:e,selectedChatMemberId:t,hasFullInfo:i,members:o,onScreenSelect:r,isFormFullyDisabled:l,onClose:c,isActive:d})=>{const{updateChatMemberBannedRights:h}=(0,s.ko)(),u=(0,n.Kr)(()=>{if(o)return o.find(({userId:e})=>e===t)},[o,t]),{permissions:m,havePermissionChanged:p,isLoading:v,handlePermissionChange:g,setIsLoading:A}=mc(u?.bannedRights||e?.defaultBannedRights),[f,b,C]=(0,F.A)(),y=(0,Ui.A)(),S=(0,T.A)();(0,Ce.A)({isActive:d,onBack:c}),(0,n.vJ)(()=>{i&&t&&!u&&r(a.je.GroupPermissions)},[e,i,r,u,t]);const k=(0,n.hb)(()=>{e&&t&&(A(!0),h({chatId:e.id,userId:t,bannedRights:m}))},[e,t,A,h,m]),w=(0,n.hb)(()=>{e&&t&&h({chatId:e.id,userId:t,bannedRights:{viewMessages:!0}})},[e,t,h]),N=(0,n.hb)(t=>!!l||!(!e||!e.defaultBannedRights)&&e.defaultBannedRights[t],[e,l]),[I,P]=(0,n.J0)(!1);if(u)return(0,te.FD)("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 431px;--before-shift-height: 192px;",children:[(0,te.FD)("div",{className:"custom-scroll",children:[(0,te.FD)("div",{className:"section without-bottom-shadow",children:[(0,te.Y)(di.A,{inactive:!0,className:"chat-item-clickable",children:(0,te.Y)(xn.A,{userId:u.userId,forceShowSelf:!0})}),(0,te.Y)("h3",{className:"section-heading mt-4",dir:"auto",children:S("UserRestrictionsCanDo")}),(0,te.Y)(vc,{chatId:e?.id,isMediaDropdownOpen:I,setIsMediaDropdownOpen:P,handlePermissionChange:g,permissions:m,className:(0,me.A)("DropdownList",I&&"DropdownList--open"),dropdownClassName:"DropdownListTrap",shiftedClassName:(0,me.A)("part",I&&"shifted"),getControlIsDisabled:N})]}),!l&&(0,te.Y)("div",{className:(0,me.A)("section",I&&"shifted"),children:(0,te.Y)(di.A,{icon:"delete-user",ripple:!0,destructive:!0,onClick:b,children:S("UserRestrictionsBlock")})})]}),(0,te.Y)(Ni.A,{isShown:p,onClick:k,ariaLabel:S("Save"),disabled:v,children:v?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),(0,te.Y)(gi.A,{isOpen:f,onClose:C,text:y("GroupManagementBanUserConfirm"),confirmLabel:"Remove",confirmHandler:w,confirmIsDestructive:!0})]})})),SA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{byId:n,statusesById:s}=e.users,a=(0,c.AWZ)(e,t)?.members;return{members:a,usersById:n,userStatusesById:s,isChannel:i&&(0,l.WX)(i)}})(({usersById:e,userStatusesById:t,members:i,isChannel:s,onScreenSelect:o,onChatMemberSelect:r,onClose:c,isActive:d})=>{(0,Ce.A)({isActive:d,onBack:c});const h=(0,n.Kr)(()=>{if(i&&e)return(0,l.UB)(i.filter(e=>!e.isOwner).map(({userId:e})=>e),e,t)},[i,e,t]),u=(0,n.hb)(e=>{r(e),o(a.je.GroupUserPermissions)},[r,o]);return(0,te.Y)("div",{className:"Management",children:(0,te.Y)("div",{className:"custom-scroll",children:(0,te.Y)("div",{className:"section",teactFastList:!0,children:h?h.map((e,t)=>(0,te.Y)(di.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item",onClick:()=>u(e),children:(0,te.Y)(xn.A,{userId:e,forceShowSelf:!0})},e)):(0,te.Y)(Gc.A,{teactOrderKey:0,text:s?"No subscribers found":"No members found"},"nothing-found")})})})})),kA=[1,10,100],wA={hour:36e5,day:864e5,week:6048e5},NA=wA.hour,IA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{editingInvite:i}=(0,c.nTw)(e).management.byChatId[t]||{};return{editingInvite:i}})(({chatId:e,editingInvite:t,isActive:i,onClose:o,onScreenSelect:r})=>{const{editExportedChatInvite:l,exportChatInvite:c}=(0,s.ko)(),d=(0,T.A)(),[h,u,m]=(0,F.A)(),[p,v]=(0,n.J0)(!1),[g,A]=(0,n.J0)(""),[f,b]=(0,n.J0)(Date.now()+NA),[C,y]=(0,n.J0)("unlimited"),[S,k]=(0,n.J0)(10),[w,N]=(0,n.J0)("0"),[I,P]=(0,n.J0)(!1);(0,Ce.A)({isActive:i,onBack:o}),(0,j.A)(([e])=>{if(e!==t)if(t){const{title:e,usageLimit:i,expireDate:n,isRequestNeeded:s}=t;if(e&&A(e),i&&(N(kA.includes(i)?i.toString():"custom"),k(i)),n){const e=(0,ci.Fm)()+NA;y("custom"),b(1e3*Math.max(n,e))}s&&v(!0)}else A(""),y("unlimited"),N("0"),b(1e3*(0,ci.Fm)()+NA),k(10),v(!1)},[t]);const Y=(0,n.hb)(e=>{v(e.target.checked)},[]),D=(0,n.hb)(e=>{A(e.target.value)},[]),M=(0,n.hb)(e=>{k(Number.parseInt(e.target.value,10))},[]),B=(0,n.hb)(e=>{b(e.getTime()),m()},[m]),R=(0,n.hb)(()=>{P(!0);const i="custom"===w?S:Number(w);let n;switch(C){case"custom":n=(0,ci.Fm)()+(f-Date.now())/1e3;break;case"hour":case"day":case"week":n=(0,ci.Fm)()+wA[C]/1e3;break;case"unlimited":n=0;break;default:n=void 0}t?l({link:t.link,chatId:e,title:g,isRequestNeeded:p,expireDate:n,usageLimit:i}):c({chatId:e,title:g,isRequestNeeded:p,expireDate:n,usageLimit:i}),r(a.je.Invites)},[e,f,S,l,t,c,p,C,w,g,r]);return(0,te.FD)("div",{className:"Management ManageInvite",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.Y)("div",{className:"section",children:(0,te.Y)(ps.A,{label:d("ApproveNewMembers"),subLabel:d("ApproveNewMembersDescription"),checked:p,onChange:Y})}),(0,te.FD)("div",{className:"section",children:[(0,te.Y)(Z.A,{className:"link-name",placeholder:d("LinkNameHint"),value:g,onChange:D}),(0,te.Y)("p",{className:"section-help hint",children:d("LinkNameHelp")})]}),(0,te.FD)("div",{className:"section",children:[(0,te.Y)("div",{className:"section-heading",children:d("LimitByPeriod")}),(0,te.Y)(ee.A,{name:"expireOptions",options:[{value:"hour",label:d("Hours",1)},{value:"day",label:d("Days",1)},{value:"week",label:d("Weeks",1)},{value:"unlimited",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_expire_custom")}],onChange:y,selected:C}),"custom"===C&&(0,te.FD)(Q.A,{className:"expire-limit",isText:!0,onClick:u,children:[(0,He.Lu)(d,f)," ",(0,He.fU)(d,f)]}),(0,te.Y)("p",{className:"section-help hint",children:d("TimeLimitHelp")})]}),!p&&(0,te.FD)("div",{className:"section",children:[(0,te.Y)("div",{className:"section-heading",children:d("LimitNumberOfUses")}),(0,te.Y)(ee.A,{name:"usageOptions",options:[...kA.map(e=>({value:e.toString(),label:e})),{value:"0",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_usage_custom")}],onChange:N,selected:w}),"custom"===w&&(0,te.Y)("input",{className:"form-control usage-limit",type:"number",min:"1",max:"99999",value:S,onChange:M}),(0,te.Y)("p",{className:"section-help hint",children:d("UsesLimitHelp")})]}),(0,te.Y)(Ni.A,{isShown:!0,onClick:R,disabled:I,ariaLabel:d(t?"SaveLink":"CreateLink"),children:(0,te.Y)(W.A,{name:"check"})})]}),(0,te.Y)(ys,{isOpen:h,isFutureMode:!0,withTimePicker:!0,onClose:m,onSubmit:B,selectedAt:f,submitButtonLabel:d("Save")})]})})),PA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{inviteInfo:i}=(0,c.nTw)(e).management.byChatId[t]||{},{invite:n,importers:s,requesters:a}=i||{},o=(0,c.hds)(e,t);return{invite:n,importers:s,requesters:a,isChannel:o&&(0,l.WX)(o)}})(({chatId:e,invite:t,importers:i,requesters:a,isChannel:o,isActive:r,onClose:l})=>{const{loadChatInviteImporters:c,loadChatInviteRequesters:d,openChat:h}=(0,s.ko)(),u=(0,T.A)(),{usage:m=0,usageLimit:p,link:v,adminId:g}=t||{},A=t?.expireDate&&1e3*(t.expireDate-(0,ci.Fm)())+Date.now(),f=(t?.expireDate||0)-(0,ci.Fm)()<0;return(0,n.vJ)(()=>{v&&(c({chatId:e,link:v}),d({chatId:e,link:v}))},[e,v,c,d]),(0,Ce.A)({isActive:r,onBack:l}),(0,te.Y)("div",{className:"Management ManageInviteInfo",children:(0,te.FD)("div",{className:"panel-content custom-scroll",children:[!t&&(0,te.Y)("p",{className:"section-help",children:u("Loading")}),t&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(Al.A,{title:t.title,link:t.link,className:"invite-link"}),Boolean(A)&&(0,te.Y)("p",{className:"section-help",children:f?u("ExpiredLink"):u("LinkExpiresIn",`${(0,He.Lu)(u,A)} ${(0,He.fU)(u,A)}`)})]}),g&&(0,te.FD)("div",{className:"section",children:[(0,te.Y)("p",{className:"section-heading",children:u("LinkCreatedeBy")}),(0,te.Y)(di.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:g}),children:(0,te.Y)(xn.A,{userId:g,status:(0,He.fS)(u,1e3*t.date,!0),forceShowSelf:!0})})]}),(()=>{if(i?.length||!a?.length)return i?(0,te.FD)("div",{className:"section",children:[(0,te.Y)("p",{className:"section-heading",children:i.length?u("PeopleJoined",m):u("NoOneJoined")}),(0,te.FD)("p",{className:"section-help",children:[!i.length&&(p?u("PeopleCanJoinViaLinkCount",p-m):u("NoOneJoinedYet")),i.map(e=>{const t=(0,He.fS)(u,1e3*e.date,!0),i=e.isFromChatList?`${t} • ${u("JoinedViaFolder")}`:t;return(0,te.Y)(di.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:e.userId}),children:(0,te.Y)(xn.A,{userId:e.userId,status:i,forceShowSelf:!0})})})]})]}):(0,te.Y)(Ee.A,{})})(),(()=>{if(!t?.isRevoked){if(!a&&i)return(0,te.Y)(Ee.A,{});if(a?.length)return(0,te.FD)("div",{className:"section",children:[(0,te.Y)("p",{className:"section-heading",children:u(o?"SubscribeRequests":"MemberRequests")}),(0,te.Y)("p",{className:"section-help",children:a.map(e=>(0,te.Y)(di.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:e.userId}),children:(0,te.Y)(xn.A,{userId:e.userId,status:(0,He.fS)(u,1e3*e.date,!0),forceShowSelf:!0})}))})]})}})()]})]})})})),YA="•";function FA(e,t){const{isPermanent:i,usage:n=0,date:s}=e,{isPermanent:a,usage:o=0,date:r}=t;return i||a?Number(i)-Number(a):n||o?o-n:r-s}const DA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{invites:i,revokedInvites:n}=(0,c.nTw)(e).management.byChatId[t]||{},s=(0,c.hds)(e,t);return{exportedInvites:i,revokedExportedInvites:n,chat:s,isChannel:s&&(0,l.WX)(s)}})(({chatId:e,chat:t,exportedInvites:i,revokedExportedInvites:r,isActive:c,isChannel:d,onClose:h,onScreenSelect:u})=>{const{setEditingExportedInvite:m,showNotification:p,editExportedChatInvite:v,deleteExportedChatInvite:g,deleteRevokedExportedChatInvites:A,setOpenedInviteInfo:f}=(0,s.ko)(),b=(0,Ui.A)(),C=(0,T.A)(),[y,S,k]=(0,F.A)(),[w,N,I]=(0,F.A)(),[P,Y]=(0,n.J0)(),[M,B,R]=(0,F.A)(),[L,x]=(0,n.J0)();(0,Ce.A)({isActive:c,onBack:h});const E=(0,n.Kr)(()=>{if(i)return i.some(({expireDate:e})=>e&&e-(0,ci.Fm)()<He.il/1e3)},[i]),V=(0,D.A)();(0,Fs.A)(V,E?1e3:void 0);const _=(0,n.Kr)(()=>t&&(0,l.Kl)(t),[t]),U=i?.find(({isPermanent:e})=>e),O=_?`${o.jsp}${_}`:U?.link,K=(0,n.Kr)(()=>{const e=t?.hasUsername?i:i?.filter(({isPermanent:e})=>!e);return e?.sort(FA)},[t?.hasUsername,i]),J=(0,n.hb)(t=>{const{link:i,title:n,isRequestNeeded:s,expireDate:a,usageLimit:o}=t;v({chatId:e,link:i,title:n,isRequestNeeded:s,expireDate:a,usageLimit:o,isRevoked:!0})},[e,v]),G=(0,n.hb)(e=>{Y(e),N()},[N]),j=(0,n.hb)(()=>{P&&(J(P),Y(void 0),I())},[I,J,P]),z=(0,n.hb)(()=>{u(a.je.EditInvite)},[u]),H=(0,n.hb)(()=>{U&&G(U)},[G,U]),$=(0,n.hb)(()=>{A({chatId:e}),k()},[e,k,A]),q=(0,n.hb)(t=>{f({chatId:e,invite:t}),u(a.je.InviteInfo)},[e,u,f]),Q=(0,n.hb)(t=>{g({chatId:e,link:t.link})},[e,g]),Z=(0,n.hb)(e=>{x(e),B()},[B]),X=(0,n.hb)(()=>{L&&(Q(L),x(void 0),R())},[R,Q,L]),ee=(0,n.hb)(e=>{(0,Rc.eM)(e),p({message:C("LinkCopied")})},[C,p]),ie=e=>{const{usage:t=0,usageLimit:i,expireDate:n,isPermanent:s,requested:a,isRevoked:o}=e;let r="";if(r=!o&&i&&t<i?C("CanJoin",i-t):t?C("PeopleJoined",t):C("NoOneJoined"),o)return r+=` ${YA} ${C("Revoked")}`,r;if(a&&(r+=` ${YA} ${C("JoinRequests",a)}`),void 0!==i&&t===i)r+=` ${YA} ${C("LinkLimitReached")}`;else if(n){const e=n-(0,ci.Fm)();r+=` ${YA} `,r+=e>0?C("InviteLink.ExpiresIn",(0,He.zt)(b,e)):C("InviteLink.Expired")}else s&&(r+=` ${YA} ${C("Permanent")}`);return r},ne=e=>{const{usage:t=0,usageLimit:i,isRevoked:n,expireDate:s}=e;return n?"link-status-icon-gray":i&&t<i?"link-status-icon-green":s&&1e3*(s-(0,ci.Fm)())<=0?"link-status-icon-red":"link-status-icon-blue"},se=t=>{const i=[];return i.push({title:C("Copy"),icon:"copy",handler:()=>ee(t.link)}),t.isPermanent||t.isRevoked||i.push({title:C("Edit"),icon:"edit",handler:()=>(t=>{m({chatId:e,invite:t}),u(a.je.EditInvite)})(t)}),t.isRevoked?i.push({title:C("DeleteLink"),icon:"delete",handler:()=>Z(t),destructive:!0}):i.push({title:C("RevokeButton"),icon:"delete",handler:()=>G(t),destructive:!0}),i};return(0,te.FD)("div",{className:"Management ManageInvites",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.Invite,size:o.xMZ,className:"section-icon"}),(0,te.Y)("p",{className:"section-help",children:C(d?"PrimaryLinkHelpChannel":"PrimaryLinkHelp")})]}),O&&(0,te.Y)("div",{className:"section",children:(0,te.Y)(Al.A,{className:"settings-input",link:O,withShare:!0,onRevoke:t?.usernames?void 0:H,title:C(t?.usernames?"PublicLink":"lng_create_permanent_link_title")})}),(0,te.FD)("div",{className:"section",teactFastList:!0,children:[(0,te.Y)(di.A,{icon:"add",withPrimaryColor:!0,className:"create-item",onClick:z,children:C("CreateNewLink")},"create"),(!K||!K.length)&&(0,te.Y)(Gc.A,{text:"No links found"},"nothing"),K?.map(e=>(0,te.FD)(di.A,{leftElement:(0,te.Y)(W.A,{name:"link",className:`link-status-icon ${ne(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>q(e),contextActions:se(e),children:[(0,te.Y)("span",{className:"title invite-title",children:e.title||e.link}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:ie(e)})]},e.link)),(0,te.Y)("p",{className:"section-help hint",children:C("ManageLinksInfoHelp")},"links-hint")]}),r&&Boolean(r.length)&&(0,te.FD)("div",{className:"section",teactFastList:!0,children:[(0,te.Y)("p",{className:"section-help",children:C("RevokedLinks")},"title"),(0,te.Y)(di.A,{icon:"delete",destructive:!0,onClick:S,children:(0,te.Y)("span",{className:"title",children:C("DeleteAllRevokedLinks")})},"delete"),r?.map(e=>(0,te.FD)(di.A,{leftElement:(0,te.Y)(W.A,{name:"link",className:`link-status-icon ${ne(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>q(e),contextActions:se(e),children:[(0,te.Y)("span",{className:"title",children:e.title||e.link}),(0,te.Y)("span",{className:"subtitle",dir:"auto",children:ie(e)})]},e.link))]})]}),(0,te.Y)(gi.A,{isOpen:y,onClose:k,title:C("DeleteAllRevokedLinks"),text:C("DeleteAllRevokedLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("DeleteAll"),confirmHandler:$}),(0,te.Y)(gi.A,{isOpen:w,onClose:I,title:C("RevokeLink"),text:C("RevokeAlert"),confirmIsDestructive:!0,confirmLabel:C("RevokeButton"),confirmHandler:j}),(0,te.Y)(gi.A,{isOpen:M,onClose:R,title:C("DeleteLink"),text:C("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("Delete"),confirmHandler:X})]})})),MA=(0,n.ph)((0,s.EK)((e,{userId:t})=>({user:(0,c.mBe)(e,t)}))(({userId:e,chatId:t,about:i,date:a,isChannel:o,user:r})=>{const{openChat:c,hideChatJoinRequest:d}=(0,s.ko)(),h=(0,me.x)("JoinRequest"),u=(0,T.A)(),m=(0,l.Yg)(r),p=1e3*(a-(0,ci.Fm)())+Date.now(),v=(0,He.cK)(new Date(p))?(0,He.fU)(u,p):(0,He.F5)(u,p,!0,!1,!0),g=(0,n.hb)(()=>{d({chatId:t,userId:e,isApproved:!0})},[t,d,e]),A=(0,n.hb)(()=>{d({chatId:t,userId:e,isApproved:!1})},[t,d,e]);return(0,te.FD)("div",{className:h("&"),children:[(0,te.FD)("div",{className:h("top"),children:[(0,te.FD)("div",{className:h("user"),onClick:()=>{c({id:e})},children:[(0,te.Y)(Mt.A,{size:"medium",peer:r},e),(0,te.FD)("div",{className:h("user-info"),children:[(0,te.Y)("div",{className:h("user-name"),children:m}),(0,te.Y)("div",{className:h("user-subtitle"),children:i})]})]}),(0,te.Y)("div",{className:h("date"),children:v})]}),(0,te.FD)("div",{className:h("buttons"),children:[(0,te.Y)(Q.A,{className:h("button"),onClick:g,children:u(o?"ChannelAddToChannel":"ChannelAddToGroup")}),(0,te.Y)(Q.A,{className:h("button"),isText:!0,onClick:A,children:u("DismissRequest")})]})]})})),TA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,isChannel:i&&(0,l.WX)(i)}})(({chat:e,chatId:t,isActive:i,isChannel:a,onClose:r})=>{const{hideAllChatJoinRequests:l,loadChatJoinRequests:c}=(0,s.ko)(),[d,h,u]=(0,F.A)(),[m,p,g]=(0,F.A)(),A=(0,T.A)();(0,Ce.A)({isActive:i,onBack:r}),(0,n.vJ)(()=>{e?.joinRequests||(0,v.L8)(t)||c({chatId:t})},[e,t,c]);const f=(0,n.hb)(()=>{l({chatId:t,isApproved:!0}),u()},[l,t,u]),b=(0,n.hb)(()=>{l({chatId:t,isApproved:!1}),g()},[l,t,g]);return(0,te.FD)("div",{className:"Management ManageJoinRequests",children:[(0,te.FD)("div",{className:"custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(zr.A,{tgsUrl:jr.w.JoinRequest,size:o.OMf,className:"section-icon"}),Boolean(e?.joinRequests?.length)&&(0,te.FD)("div",{className:"bulk-actions",children:[(0,te.Y)(Q.A,{className:"bulk-action-button",onClick:h,children:"Accept all"}),(0,te.Y)(Q.A,{className:"bulk-action-button",onClick:p,isText:!0,children:"Dismiss all"})]})]}),(0,te.FD)("div",{className:"section",teactFastList:!0,children:[(0,te.Y)("p",{children:e?.joinRequests?e.joinRequests.length?A("JoinRequests",e.joinRequests.length):A("NoMemberRequests"):A("Loading")},"title"),!e?.joinRequests&&(0,te.Y)(Ee.A,{},"loading"),0===e?.joinRequests?.length&&(0,te.Y)("p",{className:"section-help",children:A(a?"NoSubscribeRequestsDescription":"NoMemberRequestsDescription")},"empty"),e?.joinRequests?.map(({userId:e,about:i,date:n})=>(0,te.Y)(MA,{userId:e,about:i,date:n,isChannel:a,chatId:t},e))]})]}),(0,te.Y)(gi.A,{isOpen:d,onClose:u,title:"Accept all requests?",text:"Are you sure you want to accept all requests?",confirmHandler:f}),(0,te.Y)(gi.A,{isOpen:m,onClose:g,title:"Reject all requests?",text:"Are you sure you want to reject all requests?",confirmHandler:b})]})})),BA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{maxUniqueReactions:n}=e.appConfig,s=(0,c.AWZ)(e,t),a=s?.reactionsLimit||n,o=(0,l.WX)(i);return{enabledReactions:s?.enabledReactions,availableReactions:e.reactions.availableReactions,chat:i,maxUniqueReactions:n,reactionsLimit:a,isChannel:o}},(e,{chatId:t})=>Boolean((0,c.hds)(e,t)))(({availableReactions:e,enabledReactions:t,chat:i,isActive:a,onClose:o,maxUniqueReactions:r,reactionsLimit:c,isChannel:d})=>{const{setChatEnabledReactions:h}=(0,s.ko)(),u=(0,T.A)(),[m,p]=(0,n.J0)(!1),[v,g]=(0,n.J0)(!1),[A,f]=(0,n.J0)(t),[b,C]=(0,n.J0)(c);(0,Ce.A)({isActive:a,onBack:o});const y=(0,n.Kr)(()=>[{value:"all",label:u("AllReactions")},{value:"some",label:u("SomeReactions")},{value:"none",label:u("NoReactions")}],[u]),S=(0,n.hb)(()=>{i&&(g(!0),h({chatId:i.id,enabledReactions:A,reactionsLimit:b}))},[i,A,h,b]);(0,n.vJ)(()=>{g(!1),p(!1),f(t),C(c)},[t,c]);const k=(0,n.Kr)(()=>e?.filter(({isInactive:e})=>!e),[e]);(0,n.vJ)(()=>{if(void 0===b||b===c){if("some"===A?.type&&"all"!==t?.type&&"some"!==t?.type&&0===A.allowed.length)return void p(!1);if(A?.type===t?.type){if("some"===A?.type&&"some"===t?.type){const e=A.allowed,i=t?.allowed;if(e.length!==i.length||e.reverse().some(e=>!i.find(t=>(0,l.a0)(e,t))))return void p(!0)}p(!1)}else p(!0)}else p(!0)},[b,c,A,t]);const w=(0,n.hb)(e=>{"all"===e?(f({type:"all"}),C(c)):"some"===e?(f({type:"some",allowed:"some"===t?.type?t.allowed:[]}),C(c)):(f(void 0),C(void 0))},[t,c]),N=(0,n.hb)(e=>{if(!i||!k)return;const{name:t,checked:n}=e.currentTarget;if("some"===A?.type){const e={emoticon:t};f(n?{type:"some",allowed:[...A.allowed,e]}:{type:"some",allowed:A.allowed.filter(t=>!(0,l.a0)(t,e))})}},[k,i,A]),I=(0,n.hb)(e=>{C(e)},[]),P=(0,n.hb)(e=>u("PeerInfo.AllowedReactions.MaxCountValue",e),[u]),Y=d&&("all"===A?.type||"some"===A?.type);return(0,te.FD)("div",{className:"Management",children:[(0,te.FD)("div",{className:"panel-content custom-scroll",children:[Boolean(b&&Y)&&(0,te.FD)("div",{className:"section",children:[(0,te.Y)("h3",{className:"section-heading",children:u("MaximumReactionsHeader")}),(0,te.Y)(We.A,{min:1,max:r,value:b,onChange:I,renderValue:P,isCenteredLayout:!0}),(0,te.Y)("p",{className:"section-info section-info_push",children:u("ChannelReactions.MaxCount.Info")})]}),(0,te.FD)("div",{className:"section",children:[(0,te.Y)("h3",{className:"section-heading",children:u("AvailableReactions")}),(0,te.Y)(ee.A,{selected:A?.type||"none",name:"reactions",options:y,onChange:w}),(0,te.FD)("p",{className:"section-info section-info_push",children:["all"===A?.type&&u("EnableAllReactionsInfo"),"some"===A?.type&&u("EnableSomeReactionsInfo"),!A&&u("DisableReactionsInfo")]})]}),"some"===A?.type&&(0,te.FD)("div",{className:"section section-with-fab",children:[(0,te.Y)("h3",{className:"section-heading",children:u("OnlyAllowThisReactions")}),k?.map(({reaction:t,title:i})=>(0,te.Y)("div",{className:"ListItem",children:(0,te.Y)(ps.A,{name:t.emoticon,checked:A?.allowed.some(e=>(0,l.a0)(t,e)),label:(0,te.FD)("div",{className:"Reaction",children:[(0,te.Y)(En.A,{reaction:t,availableReactions:e}),i]}),withIcon:!0,onChange:N})}))]})]}),(0,te.Y)(Ni.A,{isShown:m,onClick:S,ariaLabel:u("Save"),disabled:v,children:v?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})})]})})),RA="Please provide first name",LA=(0,n.ph)((0,s.EK)((e,{userId:t})=>{const i=(0,c.mBe)(e,t),n=(0,c.hds)(e,t),s=(0,c.vGo)(e,t),{progress:a}=(0,c.nTw)(e).management,o=n&&(0,Hc.If)(n,(0,c.K52)(e),(0,c.P5N)(e,n.id)),r=s?.personalPhoto;return{user:i,progress:a,isMuted:o,personalPhoto:r,notPersonalPhoto:s?.profilePhoto||s?.fallbackPhoto}})(({userId:e,user:t,progress:i,isMuted:r,onClose:c,isActive:d,personalPhoto:h,notPersonalPhoto:u})=>{const{updateContact:m,deleteContact:p,closeManagement:v,uploadContactProfilePhoto:g,updateChatMutedState:A}=(0,s.ko)(),[f,b,C]=(0,F.A)(),[y,S,k]=(0,F.A)(),[w,N,I]=(0,F.A)(),[P,Y]=(0,n.J0)(),[D,M,B]=(0,F.A)(),R=(0,T.A)();(0,Ce.A)({isActive:d,onBack:c});const L=t&&t.firstName||"",x=t&&t.lastName||"",[E,V]=(0,n.J0)(L),[_,U]=(0,n.J0)(x),[O,K]=(0,n.J0)(!r);(0,n.vJ)(()=>{K(!r)},[r]),(0,n.vJ)(()=>{I(),B(),C()},[C,e]),(0,n.vJ)(()=>{V(L),U(x)},[L,x,t]),(0,n.vJ)(()=>{i===a.TD.Complete&&(I(),Y(void 0),C())},[C,i]);const J=(0,n.hb)(e=>{V(e.target.value),N(),P===RA&&Y(void 0)},[P]),G=(0,n.hb)(e=>{U(e.target.value),N()},[]),j=(0,n.hb)(e=>{K(e.target.checked),M(),N()},[]),z=(0,n.hb)(()=>{const t=E.trim(),i=_.trim();t.length?(m({userId:e,firstName:t,lastName:i}),D&&A({chatId:e,mutedUntil:O?o.Os5:o.xEh})):Y(RA)},[E,O,D,_,e]),H=(0,n.hb)(()=>{p({userId:e}),C(),v()},[C,v,p,e]),$=(0,n.li)(),q=(0,n.li)(!1),Q=(0,n.hb)(()=>{$.current?.click(),q.current=!0},[]),X=(0,n.hb)(()=>{$.current?.click(),q.current=!1},[]),ee=(0,n.hb)(()=>{k(),N(),g({userId:e})},[k,g,e]),ie=(0,n.hb)(t=>{N(),g({userId:e,file:t,isSuggest:q.current})},[g,e]);if(!t)return;const ne=!(0,l.tv)(t)&&t.id!==o.zv8,se=i===a.TD.InProgress;return(0,te.FD)("div",{className:"Management",children:[(0,te.FD)("div",{className:"custom-scroll",children:[(0,te.FD)("div",{className:"section",children:[(0,te.Y)(xn.A,{userId:t.id,avatarSize:"jumbo",noStatusOrTyping:!0,noEmojiStatus:!0,withFullInfo:!0}),(0,te.FD)("div",{className:"settings-edit",children:[(0,te.Y)(Z.A,{id:"user-first-name",label:R("UserInfo.FirstNamePlaceholder"),onChange:J,value:E,error:P===RA?P:void 0}),(0,te.Y)(Z.A,{id:"user-last-name",label:R("UserInfo.LastNamePlaceholder"),onChange:G,value:_})]}),(0,te.Y)("div",{className:"ListItem narrow",children:(0,te.Y)(ps.A,{checked:O,label:R("Notifications"),subLabel:R(O?"UserInfo.NotificationsEnabled":"UserInfo.NotificationsDisabled"),onChange:j})})]}),ne&&(0,te.FD)("div",{className:"section",children:[(0,te.Y)(di.A,{icon:"camera-add",ripple:!0,onClick:Q,children:(0,te.Y)("span",{className:"list-item-ellipsis",children:R("UserInfo.SuggestPhoto",t.firstName)})}),(0,te.Y)(di.A,{icon:"camera-add",ripple:!0,onClick:X,children:(0,te.Y)("span",{className:"list-item-ellipsis",children:R("UserInfo.SetCustomPhoto",t.firstName)})}),h&&(0,te.Y)(di.A,{leftElement:(0,te.Y)(Mt.A,{photo:u,noPersonalPhoto:!0,peer:t,size:"mini",className:"personal-photo"}),ripple:!0,onClick:S,children:R("UserInfo.ResetCustomPhoto")}),(0,te.Y)("p",{className:"section-help",dir:"auto",children:R("UserInfo.CustomPhotoInfo",t.firstName)})]}),(0,te.Y)("div",{className:"section",children:(0,te.Y)(di.A,{icon:"delete",ripple:!0,destructive:!0,onClick:b,children:R("DeleteContact")})})]}),(0,te.Y)(Ni.A,{isShown:w,onClick:z,disabled:se,ariaLabel:R("Save"),children:se?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"check"})}),(0,te.Y)(gi.A,{isOpen:f,onClose:C,text:R("AreYouSureDeleteContact"),confirmLabel:R("DeleteContact"),confirmHandler:H,confirmIsDestructive:!0}),(0,te.Y)(gi.A,{isOpen:y,onClose:k,text:R("UserInfo.ResetToOriginalAlertText",t.firstName),confirmLabel:R("Reset"),confirmHandler:ee,confirmIsDestructive:!0}),(0,te.Y)(Fu.A,{onChange:ie,inputRef:$})]})})),xA=(0,n.ph)((0,s.EK)((e,{chatId:t})=>{const{progress:i,error:n}=(0,c.nTw)(e).chatCreation||{};return{chat:(0,c.hds)(e,t),creationProgress:i,creationError:n}})(({chat:e,onClose:t,isActive:i,creationProgress:o,creationError:r})=>{const{createChannel:l}=(0,s.ko)(),c=(0,Ui.A)();(0,Ce.A)({isActive:i,onBack:t});const[d,h]=(0,n.J0)(c("NewDiscussionChatTitle",{name:e?.title})),[u,m]=(0,n.J0)(),[p,v]=(0,n.J0)(),g=o===a.n7.InProgress,A=(0,M.A)(e=>{const{value:t}=e.currentTarget,i=t.trimStart();h(i),i!==t&&(e.currentTarget.value=i)}),f=r&&c("NewChatTitleEmptyError")||(p!==c("NewChatTitleEmptyError")&&p!==c("NewChannelTitleEmptyError")?p:void 0),b=(0,M.A)(()=>{d.length?e&&l({discussionChannelId:e.id,title:d,photo:u,isSuperGroup:!0}):v(c("NewChatTitleEmptyError"))});return(0,te.Y)("div",{className:"Management",children:(0,te.Y)("div",{className:"panel-content custom-scroll",children:(0,te.FD)("div",{className:"NewChat",children:[(0,te.FD)("div",{className:"NewChat-inner step-2",children:[(0,te.Y)(Uh.A,{onChange:m,title:c("AddPhoto")}),(0,te.Y)(Z.A,{value:d,onChange:A,label:c("GroupName"),error:p===c("NewChatTitleEmptyError")||p===c("NewChannelTitleEmptyError")?p:void 0}),f&&(0,te.Y)("p",{className:"error",children:f})]}),(0,te.Y)(Ni.A,{isShown:0!==d.length,onClick:b,disabled:g,ariaLabel:c("DiscussionCreateGroup"),children:g?(0,te.Y)(Ee.A,{color:"white"}):(0,te.Y)(W.A,{name:"arrow-right"})})]})})})})),EA=(0,n.ph)((0,s.EK)(e=>({managementType:(0,c.vn8)(e)}))(({chatId:e,currentScreen:t,selectedChatMemberId:i,isPromotedByCurrentUser:n,onScreenSelect:s,onChatMemberSelect:o,onClose:r,isActive:l,managementType:c})=>{switch(t){case a.je.Initial:switch(c){case"bot":return(0,te.Y)(nA,{userId:e,onClose:r,isActive:l},e);case"user":return(0,te.Y)(LA,{userId:e,onClose:r,isActive:l},e);case"group":return(0,te.Y)(vA,{chatId:e,onScreenSelect:s,onClose:r,isActive:l||[a.je.ChatPrivacyType,a.je.Discussion,a.je.GroupPermissions,a.je.ChatAdministrators,a.je.GroupRemovedUsers,a.je.GroupUserPermissionsCreate,a.je.GroupUserPermissions,a.je.ChatAdminRights,a.je.ChatNewAdminRights,a.je.GroupRecentActions].includes(t)},e);case"channel":return(0,te.Y)(aA,{chatId:e,onScreenSelect:s,onClose:r,isActive:l||[a.je.ChannelSubscribers,a.je.ChatAdministrators,a.je.ChannelRemovedUsers,a.je.Discussion,a.je.ChatPrivacyType,a.je.ChatAdminRights,a.je.ChatNewAdminRights,a.je.GroupRecentActions].includes(t)},e)}break;case a.je.ChatPrivacyType:return(0,te.Y)(rA,{chatId:e,isActive:l,onClose:r});case a.je.Discussion:return(0,te.Y)(dA,{chatId:e,onScreenSelect:s,isActive:l,onClose:r});case a.je.GroupPermissions:return(0,te.Y)(CA,{chatId:e,onScreenSelect:s,onChatMemberSelect:o,isActive:l||[a.je.GroupRemovedUsers,a.je.GroupUserPermissionsCreate,a.je.GroupUserPermissions].includes(t),onClose:r});case a.je.ChannelRemovedUsers:case a.je.GroupRemovedUsers:return(0,te.Y)(cA,{chatId:e,isActive:l,onClose:r});case a.je.GroupUserPermissionsCreate:return(0,te.Y)(SA,{chatId:e,onChatMemberSelect:o,onScreenSelect:s,isActive:l||[a.je.GroupUserPermissions].includes(t),onClose:r});case a.je.GroupUserPermissions:return(0,te.Y)(yA,{chatId:e,selectedChatMemberId:i,isPromotedByCurrentUser:n,onScreenSelect:s,isActive:l,onClose:r});case a.je.ChatAdministrators:return(0,te.Y)(oA,{chatId:e,onScreenSelect:s,onChatMemberSelect:o,isActive:l||[a.je.ChatAdminRights,a.je.ChatNewAdminRights,a.je.GroupRecentActions].includes(t),onClose:r});case a.je.NewDiscussionGroup:return(0,te.Y)(xA,{chatId:e,onScreenSelect:s,isActive:l,onClose:r});case a.je.ChatNewAdminRights:case a.je.ChatAdminRights:return(0,te.Y)(gA,{chatId:e,isNewAdmin:t===a.je.ChatNewAdminRights,selectedUserId:i,isPromotedByCurrentUser:n,onScreenSelect:s,isActive:l,onClose:r});case a.je.ChannelSubscribers:case a.je.GroupMembers:return(0,te.Y)(bA,{chatId:e,isActive:l,onClose:r});case a.je.Invites:return(0,te.Y)(DA,{chatId:e,isActive:l,onClose:r,onScreenSelect:s});case a.je.EditInvite:return(0,te.Y)(IA,{chatId:e,isActive:l,onClose:r,onScreenSelect:s});case a.je.GroupAddAdmins:return(0,te.Y)(bA,{chatId:e,noAdmins:!0,isActive:l,onClose:r,onScreenSelect:s,onChatMemberSelect:o});case a.je.Reactions:return(0,te.Y)(BA,{chatId:e,isActive:l,onClose:r});case a.je.InviteInfo:return(0,te.Y)(PA,{chatId:e,isActive:l,onClose:r});case a.je.JoinRequests:return(0,te.Y)(TA,{chatId:e,isActive:l,onClose:r})}})),VA=/^4\d/,_A=/^5[1-5]/,UA=/^2[2-7]\d{2}/,OA=/^220[0-4]/;let KA=function(e){return e[e.Default=0]="Default",e[e.Visa=1]="Visa",e[e.Mastercard=2]="Mastercard",e[e.Mir=3]="Mir",e}({});const JA={[KA.Default]:"",[KA.Visa]:"visa",[KA.Mastercard]:"mastercard",[KA.Mir]:"mir"};function GA(e){return e=e.replace(/\s/g,""),VA.test(e)?KA.Visa:OA.test(e)?KA.Mir:_A.test(e)||UA.test(e)?KA.Mastercard:KA.Default}const jA={streetLine1:"",streetLine2:"",city:"",state:"",countryIso2:"",postCode:"",fullName:"",email:"",phone:"",shipping:"",cardNumber:"",cardholder:"",expiry:"",cvv:"",billingCountry:"",billingZip:"",saveInfo:!0,saveCredentials:!1,formErrors:{},tipAmount:0,savedCredentialId:""},zA=(e,t)=>{switch(t.type){case"changeAddress1":return{...e,streetLine1:t.payload,formErrors:{...e.formErrors,streetLine1:void 0}};case"changeAddress2":return{...e,streetLine2:t.payload,formErrors:{...e.formErrors,streetLine2:void 0}};case"changeCity":return{...e,city:t.payload,formErrors:{...e.formErrors,city:void 0}};case"changeState":return{...e,state:t.payload,formErrors:{...e.formErrors,state:void 0}};case"changeCountry":return{...e,countryIso2:t.payload.iso2,billingCountry:t.payload.defaultName,formErrors:{...e.formErrors,countryIso2:void 0}};case"changePostCode":return{...e,postCode:t.payload,formErrors:{...e.formErrors,postCode:void 0}};case"changeFullName":return{...e,fullName:t.payload,formErrors:{...e.formErrors,fullName:void 0}};case"changeEmail":return{...e,email:t.payload,formErrors:{...e.formErrors,email:void 0}};case"changePhone":return{...e,phone:t.payload,formErrors:{...e.formErrors,phone:void 0}};case"changeShipping":return{...e,shipping:t.payload};case"changeCardNumber":return{...e,cardNumber:t.payload,formErrors:{...e.formErrors,cardNumber:void 0}};case"changeCardholder":return{...e,cardholder:t.payload,formErrors:{...e.formErrors,cardholder:void 0}};case"changeExpiryDate":return{...e,expiry:t.payload,formErrors:{...e.formErrors,expiry:void 0}};case"changeCvvCode":return{...e,cvv:t.payload,formErrors:{...e.formErrors,cvv:void 0}};case"changeBillingCountry":return{...e,billingCountry:t.payload,formErrors:{...e.formErrors,billingCountry:void 0}};case"changeBillingZip":return{...e,billingZip:t.payload,formErrors:{...e.formErrors,billingZip:void 0}};case"changeSaveInfo":return{...e,saveInfo:t.payload};case"changeSaveCredentials":return{...e,saveCredentials:t.payload};case"updateUserInfo":return t.payload.country?{...e,...t.payload,billingCountry:t.payload.country}:{...e,...t.payload};case"setFormErrors":return{...e,formErrors:{...e.formErrors,...t.payload}};case"setTipAmount":return{...e,tipAmount:t.payload};case"changeSavedCredentialId":return{...e,savedCredentialId:t.payload};case"resetState":return{...jA};default:return e}};var HA=i(37960);const $A={root:"maC_9u6e",description:"zQ6lEVJ2","checkout-picture":"JgWvLdK2",checkoutPicture:"JgWvLdK2",text:"T2pYH395","checkout-title":"HadolzeF",checkoutTitle:"HadolzeF","checkout-description":"oZW7mUNP",checkoutDescription:"oZW7mUNP","price-info":"P618Q3yr",priceInfo:"P618Q3yr","price-info-item":"XNNG_ajy",priceInfoItem:"XNNG_ajy","price-info-item-main":"D9gYNLVk",priceInfoItemMain:"D9gYNLVk","price-info-item-title":"NtY5Aah7",priceInfoItemTitle:"NtY5Aah7",tipsList:"WHO341eB",tipsItem:"ksLlzBxw",tipsItem_active:"J4yem62L",tipsItemActive:"J4yem62L","invoice-info":"U2IBOLP1",invoiceInfo:"U2IBOLP1",provider:"kqWcdro1",stripe:"xKztZrna",smartglocal:"X_Ge1o4u","checkout-info-item-info-title":"ysWuPklS",checkoutInfoItemInfoTitle:"ysWuPklS","checkout-info-item-info-data":"MpC_P8_c",checkoutInfoItemInfoData:"MpC_P8_c","tos-checkbox":"OrRb0xG7",tosCheckbox:"OrRb0xG7",list:"l_wfiFG0"},qA=(0,n.ph)(({title:e,description:t,photo:i,invoice:o,shippingPrices:r,checkoutInfo:c,totalPrice:d,isTosAccepted:h,dispatch:u,onAcceptTos:m,tipAmount:p,needAddress:v,hasShippingOptions:g,savedCredentials:A,isPaymentFormUrl:f,botName:b})=>{const{setPaymentStep:C}=(0,s.ko)(),y=(0,T.A)(),S=(0,Ui.A)(),k=Boolean(u),{termsUrl:w,suggestedTipAmounts:N,maxTipAmount:I}=o||{},{paymentMethod:P,paymentProvider:Y,shippingAddress:F,name:D,phone:M,shippingMethod:B}=c||{},R=(0,z.A)((0,l.cy)(i)),{ref:L}=(0,HA.A)({hasMediaData:Boolean(R)}),x=(0,n.hb)(e=>{u({type:"setTipAmount",payload:I?Math.min(e,I):e})},[u,I]),E=(0,n.hb)(()=>{C({step:A?.length?a.tn.SavedPayments:a.tn.PaymentInfo})},[A?.length,C]),V=(0,n.hb)(()=>{C({step:a.tn.ShippingInfo})},[C]),_=(0,n.hb)(()=>{C({step:a.tn.Shipping})},[C]);return(0,te.FD)("div",{className:$A.root,children:[(0,te.FD)("div",{className:$A.description,children:[R&&(0,te.Y)("img",{ref:L,className:$A.checkoutPicture,src:R,draggable:!1,width:i.dimensions?.width,height:i.dimensions?.height,alt:""}),!R&&i&&(0,te.Y)(on.A,{width:i.dimensions?.width,height:i.dimensions?.height,className:$A.checkoutPicture,forceAspectRatio:!0}),(0,te.FD)("div",{className:$A.text,children:[(0,te.Y)("h5",{className:$A.checkoutTitle,children:e}),t&&(0,te.Y)("div",{className:$A.checkoutDescription,children:(0,Dt.A)(t,["br","links","emoji"])})]})]}),(0,te.FD)("div",{className:$A.priceInfo,children:[o.prices.map(e=>WA(S,e.label,e.amount,o.currency)),r&&r.map(e=>WA(S,e.label,e.amount,o.currency)),N&&N.length>0&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:$A.priceInfoItem,children:[(0,te.Y)("div",{className:$A.priceInfoItemTitle,children:e}),(0,te.Y)("div",{children:(0,ka.vv)(S,p,o.currency)})]}),(0,te.Y)("div",{className:$A.tipsList,children:N.map(e=>(0,te.Y)("div",{className:(0,me.A)($A.tipsItem,e===p&&$A.tipsItem_active),onClick:u?()=>x(e===p?0:e):void 0,children:(0,ka.vv)(S,e,o.currency,{shouldOmitFractions:!0})},e))})]}),void 0!==d&&WA(S,y("Checkout.TotalAmount"),d,o.currency,!0)]}),(0,te.FD)("div",{className:$A.invoiceInfo,children:[!f&&QA({title:P||A?.[0].title,label:y("PaymentCheckoutMethod"),icon:"card",onClick:k?E:void 0}),Y&&QA({title:Y,label:y("PaymentCheckoutProvider"),customIcon:(0,me.A)($A.provider,$A[Y.toLowerCase()])}),(v||!k&&F)&&QA({title:F,label:y("PaymentShippingAddress"),icon:"location",onClick:k?V:void 0}),D&&QA({title:D,label:y("PaymentCheckoutName"),icon:"user"}),M&&QA({title:M,label:y("PaymentCheckoutPhoneNumber"),icon:"phone"}),(g||!k&&B)&&QA({title:B,label:y("PaymentCheckoutShippingMethod"),icon:"truck",onClick:k?_:void 0}),w&&(U=w,(0,te.Y)(ps.A,{label:function(e,t){const i=y("PaymentCheckoutAcceptRecurrent",b).split("*");return(0,te.FD)(te.FK,{children:[i[0],(0,te.Y)(Ll.A,{url:e,text:i[1],isRtl:t}),i.slice(2)]})}(U,y.isRtl),name:"checkout_tos",checked:Boolean(h),className:$A.tosCheckbox,tabIndex:0,onCheck:m}))]})]});var U});function WA(e,t,i,n,s=!1){return(0,te.FD)("div",{className:(0,me.A)($A.priceInfoItem,s&&$A.priceInfoItemMain),children:[(0,te.Y)("div",{className:$A.priceInfoItemTitle,children:t}),(0,te.Y)("div",{children:(0,ka.vv)(e,i,n)})]})}function QA({title:e,label:t,icon:i,customIcon:n,onClick:s}){const a=Boolean(e&&t!==e);return(0,te.FD)(di.A,{className:$A.list,narrow:!0,multiline:a,icon:i,inactive:!s,onClick:s,leftElement:n&&(0,te.Y)("i",{className:(0,me.A)("icon",n)}),children:[(0,te.Y)("div",{className:$A.checkoutInfoItemInfoTitle,children:e||t}),e&&t!==e&&(0,te.Y)("p",{className:$A.checkoutInfoItemInfoData,children:t})]})}const ZA=(0,n.ph)(({url:e,noRedirect:t,onClose:i,onPaymentFormSubmit:a})=>{const{openTelegramLink:r}=(0,s.ko)(),l=(0,T.A)(),c=(0,n.hb)(e=>{try{const n=JSON.parse(e.data),{eventType:s,eventData:l}=n;switch(s){case"web_app_open_tg_link":if(!t){const e=o.jsp+l.path_full;r({url:e})}i();break;case"payment_form_submit":a&&a(l);break;default:i()}}catch(e){}},[i,t,r,a]);return(0,n.vJ)(()=>(window.addEventListener("message",c),()=>window.removeEventListener("message",c)),[c]),(0,te.Y)("div",{className:"ConfirmPayment",children:(0,te.Y)("iframe",{src:e,title:l("Checkout.WebConfirmation.Title"),allow:"payment",sandbox:"allow-modals allow-forms allow-scripts allow-same-origin allow-top-navigation",className:"ConfirmPayment__content"})})}),XA=(0,n.ph)((0,s.EK)(e=>{const{payment:t}=(0,c.nTw)(e);return{errorKey:t.error?.messageKey,passwordHint:e.twoFaSettings.hint,savedCredentials:"regular"===t.form?.type?t.form.savedCredentials:void 0}})(({isActive:e,errorKey:t,state:i,savedCredentials:a,passwordHint:o,onPasswordChange:r})=>{const{clearPaymentError:l}=(0,s.ko)(),c=(0,T.A)(),d=(0,Ui.A)(),[h,u]=(0,n.J0)(!1),m=(0,n.Kr)(()=>a?.length&&i.savedCredentialId?a.find(({id:e})=>e===i.savedCredentialId)?.title:void 0,[a,i.savedCredentialId]);return(0,te.FD)("div",{className:"PaymentInfo",children:[(0,te.Y)(ih.A,{isBig:!0,isPasswordVisible:h}),(0,te.Y)(Jl.A,{error:t&&d.withRegular(t),hint:o,description:c("PaymentConfirmationMessage",m),placeholder:c("Password"),onClearError:l,shouldShowSubmit:!1,shouldResetValue:e,isPasswordVisible:h,onChangePasswordVisibility:u,onInputChange:r})]})}));var ef=i(63173);function tf(e,t=300){(0,n.vJ)(()=>{u.TF||setTimeout(()=>{(0,r.YS)(()=>{e.current?.focus()})},t)},[e,t])}const nf=i.p+"mastercard.790db81f7978635f77d8.svg",sf=i.p+"mir.e3a390b90e2e3e292621.svg",af=i.p+"visa.fb39984c9532c0336be9.svg",of=(0,n.ph)(({value:e,error:t,onChange:i})=>{const s=(0,T.A)(),a=(0,n.li)();tf(a);const[o,r]=(0,n.J0)(KA.Default);(0,n.vJ)(()=>{const t=GA(e);r(t)},[]);const l=(0,n.hb)(e=>{const t=function(e){const t=(e=e.replace(/[^\d]/g,"")).match(/.{1,4}/g);return t?t.join(" "):""}(e.target.value),n=GA(e.target.value);r(n),i(t)},[i]),c=function(e){switch(e){case KA.Mastercard:return(0,te.Y)("img",{src:nf,draggable:!1,alt:""});case KA.Visa:return(0,te.Y)("img",{src:af,draggable:!1,alt:""});case KA.Mir:return(0,te.Y)("img",{src:sf,draggable:!1,alt:""});default:return}}(o);return(0,te.FD)("div",{className:"CardInput",children:[(0,te.Y)(Z.A,{ref:a,label:s("PaymentCardNumber"),onChange:l,value:e,inputMode:"numeric",className:o?"has-right-addon":"",error:t,tabIndex:0,maxLength:19,teactExperimentControlled:!0}),(0,te.Y)("span",{className:"right-addon",children:c})]})}),rf=(0,n.ph)(({value:e,error:t,onChange:i})=>{const s=(0,T.A)(),a=(0,n.hb)(t=>{const n=t.target.value;e.endsWith("/")&&e.length>n.length?i(n):i(function(e){const t=(e=e.replace(/[^\d]/g,"").slice(0,4)).match(/.{1,2}/g);return t?.[0]&&Number(t[0])>12&&(t[0]="12"),t?.[0]&&2===t[0].length&&!t[1]&&(t[1]=""),t?t.join("/"):""}(t.target.value))},[i,e]);return(0,te.Y)(Z.A,{label:s("PaymentCardExpireDate"),onChange:a,value:e,error:t,inputMode:"numeric",tabIndex:0,maxLength:5,teactExperimentControlled:!0})}),lf=(0,n.ph)(({state:e,canSaveCredentials:t,needCardholderName:i,needCountry:s,needZip:a,countryList:o,dispatch:r})=>{const l=(0,n.li)();(0,n.vJ)(()=>{l.current&&l.current.value!==e.billingCountry&&(l.current.value=e.billingCountry)},[e.billingCountry]);const c=(0,n.hb)(e=>{r({type:"changeCardNumber",payload:e})},[r]),d=(0,n.hb)(e=>{r({type:"changeCardholder",payload:e.target.value.toUpperCase()})},[r]),h=(0,n.hb)(e=>{r({type:"changeExpiryDate",payload:e})},[r]),u=(0,n.hb)(e=>{const t=e.target.value.replace(/[^0-9]/g,"");r({type:"changeCvvCode",payload:t})},[r]),m=(0,n.hb)(e=>{r({type:"changeBillingCountry",payload:e.target.value})},[r]),p=(0,n.hb)(e=>{r({type:"changeBillingZip",payload:e.target.value})},[r]),v=(0,n.hb)(e=>{r({type:"changeSaveCredentials",payload:e.target.value})},[r]),g=(0,T.A)(),A=(0,Ui.A)(),{formErrors:f={}}=e;return(0,te.Y)("div",{className:"PaymentInfo",children:(0,te.FD)("form",{children:[(0,te.Y)("h5",{children:g("PaymentCardTitle")}),(0,te.Y)(of,{onChange:c,value:e.cardNumber,error:f.cardNumber&&A.withRegular(f.cardNumber)}),i&&(0,te.Y)(Z.A,{label:g("Checkout.NewCard.CardholderNamePlaceholder"),onChange:d,value:e.cardholder,inputMode:"text",tabIndex:0,error:f.cardholder&&A.withRegular(f.cardholder)}),(0,te.FD)("section",{className:"inline-inputs",children:[(0,te.Y)(rf,{value:e.expiry,onChange:h,error:f.expiry&&A.withRegular(f.expiry)}),(0,te.Y)(Z.A,{label:g("lng_payments_card_cvc"),onChange:u,value:e.cvv,inputMode:"numeric",maxLength:3,tabIndex:0,error:f.cvv&&A.withRegular(f.cvv),teactExperimentControlled:!0})]}),s||a?(0,te.Y)("h5",{children:g("PaymentBillingAddress")}):void 0,(0,te.FD)("section",{className:"inline-inputs",children:[s&&(0,te.Y)(ef.A,{label:g("PaymentShippingCountry"),onChange:m,value:e.billingCountry,hasArrow:Boolean(!0),id:"billing-country",error:f.billingCountry&&A.withRegular(f.billingCountry),tabIndex:0,ref:l,children:o.map(({defaultName:t,name:i})=>(0,te.Y)("option",{value:t,className:"county-item",selected:t===e.billingCountry,children:t||i}))}),a&&(0,te.Y)(Z.A,{label:g("PaymentShippingZipPlaceholder"),onChange:p,value:e.billingZip,inputMode:"text",tabIndex:0,maxLength:12,error:f.billingZip&&A.withRegular(f.billingZip)})]}),(0,te.Y)("div",{className:"checkbox",children:(0,te.Y)(ps.A,{label:g("PaymentCardSavePaymentInformation"),checked:!!t&&e.saveCredentials,tabIndex:0,subLabel:g(t?"Checkout.NewCard.SaveInfoHelp":"Checkout.2FA.Text"),onChange:v,disabled:!t})})]})})}),cf=(0,n.ph)(({state:e,savedCredentials:t,dispatch:i,onNewCardClick:s})=>{const a=(0,T.A)(),o=(0,n.Kr)(()=>t?.length?t.map(({id:e,title:t})=>({label:t,value:e})):yi.p,[t]),r=(0,n.hb)(e=>{i({type:"changeSavedCredentialId",payload:e})},[i]);return(0,te.Y)("div",{className:"PaymentInfo",children:(0,te.FD)("form",{children:[(0,te.Y)("h5",{children:a("PaymentCardTitle")}),(0,te.Y)(ee.A,{name:"saved-credentials",options:o,selected:e.savedCredentialId,onChange:r}),(0,te.Y)(Q.A,{isText:!0,onClick:s,children:a("PaymentCheckoutMethodNewCard")})]})})}),df=(0,n.ph)(({state:e,shippingOptions:t,currency:i,dispatch:s})=>{const a=(0,T.A)(),o=(0,Ui.A)();(0,n.vJ)(()=>{t&&t.length&&!e.shipping&&s({type:"changeShipping",payload:t[0].id})},[t,e.shipping,s]);const r=(0,n.hb)(e=>{s({type:"changeShipping",payload:e})},[s]),l=(0,n.Kr)(()=>t.map(({id:e,title:t,amount:n})=>({label:t,subLabel:(0,ka.vv)(o,n,i),value:e})),[t,i,o]);return(0,te.Y)("div",{className:"Shipping",children:(0,te.FD)("form",{children:[(0,te.Y)("p",{children:a("PaymentShippingMethod")}),(0,te.Y)(ee.A,{name:"shipping-options",options:l,onChange:r,selected:e.shipping})]})})}),hf=(0,n.ph)(({state:e,needEmail:t,needPhone:i,needName:s,needAddress:a,countryList:o,dispatch:r})=>{const l=(0,n.li)(),c=(0,n.li)(),d=(0,n.li)();(0,n.vJ)(()=>{d.current&&d.current.value!==e.countryIso2&&(d.current.value=e.countryIso2)},[e.countryIso2]);const h=(0,T.A)(),u=(0,Ui.A)();tf(l);const m=(0,n.hb)(e=>{r({type:"changeAddress1",payload:e.target.value})},[r]),p=(0,n.hb)(e=>{r({type:"changeAddress2",payload:e.target.value})},[r]),v=(0,n.hb)(e=>{r({type:"changeCity",payload:e.target.value})},[r]),g=(0,n.hb)(e=>{r({type:"changeState",payload:e.target.value})},[r]),A=(0,n.hb)(e=>{r({type:"changeCountry",payload:o.find(t=>t.iso2===e.target.value)})},[o,r]),f=(0,n.hb)(e=>{r({type:"changePostCode",payload:e.target.value})},[r]),b=(0,n.hb)(e=>{r({type:"changeFullName",payload:e.target.value})},[r]),C=(0,n.hb)(e=>{r({type:"changeEmail",payload:e.target.value})},[r]),y=(0,n.hb)(e=>{let{value:t}=e.target;t=`+${t.replace(/\D/g,"")}`,c.current&&(c.current.value=t),r({type:"changePhone",payload:t})},[r]),S=(0,n.hb)(e=>{r({type:"changeSaveInfo",payload:e.target.value})},[r]),{formErrors:k}=e;return(0,te.Y)("div",{className:"ShippingInfo",children:(0,te.FD)("form",{children:[a?(0,te.FD)("div",{children:[(0,te.Y)("h5",{children:h("PaymentShippingAddress")}),(0,te.Y)(Z.A,{ref:l,label:h("PaymentShippingAddress1Placeholder"),onChange:m,value:e.streetLine1,inputMode:"text",tabIndex:0,error:k.streetLine1&&u.withRegular(k.streetLine1)}),(0,te.Y)(Z.A,{label:h("PaymentShippingAddress2Placeholder"),onChange:p,value:e.streetLine2,inputMode:"text",tabIndex:0,error:k.streetLine2&&u.withRegular(k.streetLine2)}),(0,te.Y)(Z.A,{label:h("PaymentShippingCityPlaceholder"),onChange:v,value:e.city,inputMode:"text",tabIndex:0,error:k.city&&u.withRegular(k.city)}),(0,te.Y)(Z.A,{label:h("PaymentShippingStatePlaceholder"),onChange:g,value:e.state,inputMode:"text",error:k.state&&u.withRegular(k.state)}),(0,te.Y)(ef.A,{label:h("PaymentShippingCountry"),onChange:A,value:e.countryIso2,hasArrow:Boolean(!0),id:"shipping-country",error:k.countryIso2&&u.withRegular(k.countryIso2),ref:d,tabIndex:0,children:o.map(({defaultName:t,name:i,iso2:n})=>(0,te.Y)("option",{value:n,className:"county-item",selected:n===e.countryIso2,children:t||i}))}),(0,te.Y)(Z.A,{label:h("PaymentShippingZipPlaceholder"),onChange:f,value:e.postCode,inputMode:"text",tabIndex:0,error:k.postCode&&u.withRegular(k.postCode)})]}):void 0,s||t||i?(0,te.Y)("h5",{children:h("PaymentShippingReceiver")}):void 0,s&&(0,te.Y)(Z.A,{label:h("PaymentShippingName"),onChange:b,value:e.fullName,inputMode:"text",tabIndex:0,error:k.fullName&&u.withRegular(k.fullName)}),t&&(0,te.Y)(Z.A,{label:h("PaymentShippingEmailPlaceholder"),onChange:C,value:e.email,inputMode:"email",tabIndex:0,error:k.email&&u.withRegular(k.email)}),i&&(0,te.Y)(Z.A,{label:h("PaymentShippingPhoneNumber"),onChange:y,value:e.phone,inputMode:"tel",tabIndex:0,error:k.phone&&u.withRegular(k.phone),ref:c}),(0,te.Y)(ps.A,{label:h("PaymentShippingSave"),subLabel:h("PaymentShippingSaveInfo"),checked:Boolean(e.saveInfo),tabIndex:0,onChange:S})]})})}),uf="stripe",mf="smartglocal",pf=new Set([uf,mf]),vf=(0,n.ph)((0,s.EK)(e=>{const{form:t,step:i,shippingOptions:n,error:s,confirmPaymentUrl:a,inputInvoice:o,requestId:r,stripeCredentials:d,smartGlocalCredentials:h,temporaryPassword:u,isExtendedMedia:m,url:p}=(0,c.nTw)(e).payment,{invoice:v,nativeParams:g,nativeProvider:A}=t||{},f=e.countryList.general;let b=t?.nativeProvider;!b&&p&&(b=p.startsWith("https://payment.smart-glocal.com")?mf:void 0);const C=o&&"chatId"in o?(0,c.hds)(e,o.chatId):void 0,y=Boolean(v&&(!b||!pf.has(b))),{needCardholderName:S,needCountry:k,needZip:w}=g||{},N=t?.botId?(0,c.mBe)(e,t.botId):void 0,I=(0,l.Yg)(N);return{step:i,chat:C,shippingOptions:n,nativeProvider:b,isProviderError:y,form:t,invoice:v,needCardholderName:S,needCountry:k,needZip:w,error:s,confirmPaymentUrl:a??p,isPaymentFormUrl:Boolean(!A&&p),countryList:f,requestId:r,hasShippingOptions:Boolean(n?.length),smartGlocalToken:h?.token,stripeId:d?.id,passwordValidUntil:u?.validUntil,isExtendedMedia:m,botName:I}})(({isOpen:e,onClose:t,step:i,shippingOptions:o,form:r,isProviderError:l,invoice:c,nativeProvider:d,needCardholderName:h,needCountry:u,needZip:m,confirmPaymentUrl:p,error:v,countryList:g,hasShippingOptions:A,requestId:f,smartGlocalToken:b,stripeId:C,passwordValidUntil:y,isExtendedMedia:S,isPaymentFormUrl:k,botName:w})=>{const{loadPasswordInfo:N,validateRequestedInfo:I,sendPaymentForm:P,setPaymentStep:Y,sendCredentialsInfo:D,clearPaymentError:B,validatePaymentPassword:R,setSmartGlocalCardInfo:L}=(0,s.ko)(),x=(0,T.A)(),E=(0,Ui.A)(),[V,U,O]=(0,F.A)(),[K,J]=(0,Ed.A)(zA,jA),[G,j]=(0,n.J0)(!1),[z,H]=(0,n.J0)(!1),[$,q]=(0,n.J0)(""),Z=(0,_.A)(i,!0),ee=(0,_.A)(f),ie=i!==a.tn.ConfirmPayment,ne=(0,n.hb)(e=>{Y({step:e})},[Y]);(0,n.vJ)(()=>{e&&(q(""),N(),U())},[e,N,U]),(0,n.vJ)(()=>{!e&&V&&O()},[O,V,e]),(0,n.vJ)(()=>{(void 0!==i||v)&&j(!1)},[i,v,f]),(0,n.vJ)(()=>{i!==a.tn.Checkout||i!==Z||f===ee||K.savedCredentialId||K.cardNumber||ne(a.tn.PaymentInfo)},[K.cardNumber,K.savedCredentialId,ee,Z,f,ne,i]),(0,n.vJ)(()=>{v?.field&&J({type:"setFormErrors",payload:{[v.field]:v.messageKey}})},[v,J]),(0,n.vJ)(()=>{if(r?.savedInfo){const{name:e,phone:t,email:i,shippingAddress:n}=r.savedInfo,{countryIso2:s,...a}=n||{},o=s&&g.find(({iso2:e})=>e===s).defaultName;J({type:"updateUserInfo",payload:{fullName:e,phone:t&&"+"!==t.charAt(0)?`+${t}`:t,email:i,...o&&{country:o,countryIso2:s,...a}}})}},[r,J,g]),(0,n.vJ)(()=>{r?.savedCredentials?.length&&J({type:"changeSavedCredentialId",payload:r.savedCredentials[0].id})},[J,r?.savedCredentials]);const ae=(0,n.hb)(()=>{B()},[B]),oe=(0,n.Kr)(()=>i!==a.tn.Checkout?0:function(e=[],t,i,n){const s=t?Af(t,i):[];let a=n;return a=e.concat(s||[]).reduce((e,t)=>e+t.amount,a),a}(c?.prices,o,K.shipping,K.tipAmount),[i,c?.prices,o,K.shipping,K.tipAmount]),re=(0,n.Kr)(()=>{if(i===a.tn.Checkout)return function(e,t,i){const n=function(e){const t=GA(e);return JA[t]||""}(e.cardNumber),s=n&&e.cardNumber?`${n} *${e.cardNumber.slice(-4)}`:void 0,a=e.streetLine1?`${e.streetLine1}, ${e.city}, ${e.countryIso2}`:void 0,{phone:o,fullName:r}=e,l=t?gf(t,e.shipping):void 0,c=l?.title;return{paymentMethod:s,paymentProvider:i,shippingAddress:a,name:r,phone:o,shippingMethod:c}}(K,o,d||"")},[i,K,o,d]),le=(0,n.hb)(()=>{ne(a.tn.PaymentInfo)},[ne]),ce=(0,n.hb)(()=>{B()},[B]),de=(0,n.hb)(()=>{P({shippingOptionId:K.shipping,saveCredentials:K.saveCredentials,savedCredentialId:K.savedCredentialId,tipAmount:K.tipAmount})},[P,K]),he=(0,n.hb)(e=>{const{credentials:t}=e;L(t),de()},[de]),ue=(0,n.hb)(()=>{const{saveInfo:e}=K,t=function(e){const{streetLine1:t,streetLine2:i,city:n,state:s,countryIso2:a,postCode:o,fullName:r,phone:l,email:c}=e;return{name:r,phone:l,email:c,shippingAddress:{streetLine1:t,streetLine2:i,city:n,state:s,countryIso2:a,postCode:o}}}(K);I({requestInfo:t,saveInfo:e})},[I,K]),pe=(0,n.hb)(()=>{const e=function(e){const{cardNumber:t,cardholder:i,expiry:n,cvv:s,billingCountry:a,billingZip:o}=e,[r,l]=n.split("/");return{data:{cardNumber:t,cardholder:i,expiryMonth:r,expiryYear:l,cvv:s,country:a,zip:o}}}(K);D({credentials:e})},[D,K]),ve=(0,M.A)(()=>{switch(i){case a.tn.ShippingInfo:j(!0),ue();break;case a.tn.Shipping:ne(a.tn.Checkout);break;case a.tn.SavedPayments:ne(a.tn.ConfirmPassword);break;case a.tn.ConfirmPassword:if(""===$)return;j(!0),R({password:$});break;case a.tn.PaymentInfo:j(!0),pe(),J({type:"changeSavedCredentialId",payload:""});break;case a.tn.Checkout:{if(k)return j(!0),void ne(a.tn.ConfirmPayment);if(r?.savedInfo&&!f&&!K.shipping)return j(!0),void ue();if(K.savedCredentialId&&(!y||y<=Date.now()/1e3-3))return void ne(a.tn.ConfirmPassword);if(!K.savedCredentialId&&(d===uf&&!C||d===mf&&!b))return void ne(a.tn.PaymentInfo);const{phone:e,email:t,fullName:i}=K,n=c?.isEmailRequested&&!t||c?.isPhoneRequested&&!e||c?.isNameRequested&&!i;if(c?.isShippingAddressRequested&&!f||n)return void ne(a.tn.ShippingInfo);if(c?.isShippingAddressRequested&&!K.shipping&&o?.length)return void ne(a.tn.Shipping);j(!0),de();break}}});(0,n.vJ)(()=>i===a.tn.ConfirmPassword?(0,Li.A)({onEnter:ve}):void 0,[ve,i]);const ge=(0,n.hb)(()=>{J({type:"resetState"}),H(!1),t()},[t,J]),Ae=(0,n.hb)(()=>{ne(i===a.tn.ConfirmPassword?a.tn.SavedPayments:a.tn.Checkout)},[ne,i]),fe=(0,n.Kr)(()=>{switch(i){case a.tn.Checkout:return x("PaymentCheckout");case a.tn.ShippingInfo:return x("PaymentShippingInfo");case a.tn.Shipping:return x("PaymentShippingMethod");case a.tn.SavedPayments:return x("PaymentCheckoutMethod");case a.tn.ConfirmPassword:return x("Checkout.PasswordEntry.Title");case a.tn.PaymentInfo:return x("PaymentCardInfo");case a.tn.ConfirmPayment:return x("Checkout.WebConfirmation.Title");default:return""}},[i,x]),be=i===a.tn.Checkout?x("Checkout.PayPrice",(0,ka.Ad)(oe,c.currency,x.code)):E("PaymentInfoDone");if(l)return(0,te.FD)(X.A,{className:"error",isOpen:V,onClose:O,onCloseAnimationEnd:ge,children:[(0,te.Y)("p",{children:E("PaymentsProvidesNotSupported",void 0,{withNodes:!0,renderTextFilters:["br"]})}),(0,te.Y)("div",{className:"dialog-buttons mt-2",children:(0,te.Y)(Q.A,{isText:!0,onClick:O,children:x("OK")})})]});const Ce=function(){if(G)return!0;switch(i){case a.tn.Checkout:return Boolean(c?.termsUrl)&&!z;case a.tn.PaymentInfo:return Boolean(""===K.cardNumber||h&&""===K.cardholder||""===K.cvv||""===K.expiry);default:return!1}}();return(0,te.FD)(X.A,{className:(0,me.A)("PaymentModal",c?.isRecurring&&"recurring"),isOpen:V,onClose:O,onCloseAnimationEnd:ge,children:[(0,te.FD)("div",{className:"header",dir:x.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:i===a.tn.Checkout?O:Ae,ariaLabel:E("Close"),children:(0,te.Y)(W.A,{name:i===a.tn.Checkout?"close":"arrow-left"})}),(0,te.Y)("h3",{children:fe})]}),void 0!==i?(0,te.Y)(se.Ay,{name:"slide",activeKey:i,shouldCleanup:!0,cleanupOnlyKey:a.tn.ConfirmPayment,children:(0,te.Y)("div",{className:"content custom-scroll",children:function(e){switch(e){case a.tn.Checkout:return(0,te.Y)(qA,{title:r.title,description:r.description,photo:r.photo,dispatch:J,shippingPrices:K.shipping&&o?Af(o,K.shipping):void 0,totalPrice:oe,invoice:c,checkoutInfo:re,isPaymentFormUrl:k,hasShippingOptions:A,tipAmount:K.tipAmount,needAddress:Boolean(c?.isShippingAddressRequested),savedCredentials:r.savedCredentials,isTosAccepted:z,onAcceptTos:H,botName:w});case a.tn.SavedPayments:return(0,te.Y)(cf,{state:K,savedCredentials:r.savedCredentials,dispatch:J,onNewCardClick:le});case a.tn.ConfirmPassword:return(0,te.Y)(XA,{state:K,savedCredentials:r.savedCredentials,onPasswordChange:q,isActive:e===i});case a.tn.PaymentInfo:return(0,te.Y)(lf,{state:K,dispatch:J,canSaveCredentials:Boolean(!r.isPasswordMissing&&r.canSaveCredentials),needCardholderName:h,needCountry:u,needZip:m,countryList:g});case a.tn.ShippingInfo:return(0,te.Y)(hf,{state:K,dispatch:J,needAddress:Boolean(c?.isShippingAddressRequested),needEmail:Boolean(c?.isEmailRequested||c?.isEmailSentToProvider),needPhone:Boolean(c?.isPhoneRequested||c?.isPhoneSentToProvider),needName:Boolean(c?.isNameRequested),countryList:g});case a.tn.Shipping:return(0,te.Y)(df,{state:K,dispatch:J,shippingOptions:o||[],currency:c.currency});case a.tn.ConfirmPayment:return(0,te.Y)(ZA,{url:p,noRedirect:S,onPaymentFormSubmit:he,onClose:O});default:return}}(i)})}):(0,te.Y)("div",{className:"empty-content",children:(0,te.Y)(Ee.A,{color:"gray"})}),ie&&(0,te.Y)("div",{className:"footer",children:(0,te.Y)(Q.A,{className:"button-text",type:"submit",onClick:ve,disabled:Ce,isLoading:G,children:be})}),v&&!v.field&&function(){if(v)return(0,te.FD)(X.A,{className:"error",isOpen:Boolean(v),onClose:ae,children:[(0,te.Y)("h4",{children:v.descriptionKey?E.withRegular(v.descriptionKey):E("ErrorUnspecified")}),(0,te.Y)("div",{className:"dialog-buttons mt-2",children:(0,te.Y)(Q.A,{isText:!0,onClick:ce,children:E("OK")})})]})}()]})}));function gf(e,t){return e.find(({id:e})=>e===t)}function Af(e,t){const i=gf(e,t);return i?.prices}const ff=(0,n.ph)((0,s.EK)(e=>{const{receipt:t}=(0,c.nTw)(e).payment;return{receipt:t}})(({isOpen:e,onClose:t,receipt:i})=>{const s=(0,Ui.A)(),[a,o,r]=(0,F.A)();(0,n.vJ)(()=>{e&&o()},[e,o]);const l=(0,Tl.A)(i),c=i||l,d=(0,n.Kr)(()=>{if(c)return function(e,t,i){if(!t)return{paymentMethod:e};const{shippingAddress:n}=t,s=n?.streetLine1?`${n.streetLine1}, ${n.city}, ${n.countryIso2}`:void 0,{phone:a,name:o}=t;return{paymentMethod:e,shippingAddress:s,name:o,phone:a,shippingMethod:i}}(c.credentialsTitle,c.info,c.shippingMethod)},[c]);return(0,te.Y)(X.A,{className:"PaymentModal PaymentModal-receipt",isOpen:a,onClose:r,onCloseAnimationEnd:t,children:c&&(0,te.FD)(te.FK,{children:[(0,te.FD)("div",{className:"header",dir:s.isRtl?"rtl":void 0,children:[(0,te.Y)(Q.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:r,ariaLabel:"Close",children:(0,te.Y)(W.A,{name:"close"})}),(0,te.FD)("h3",{children:[" ",s("PaymentReceipt")," "]})]}),(0,te.Y)("div",{className:"receipt-content custom-scroll",children:(0,te.Y)(qA,{shippingPrices:c.shippingPrices,totalPrice:c.totalAmount,tipAmount:c.tipAmount,invoice:c.invoice,checkoutInfo:d,title:c.title,description:c.description,photo:c.photo})})]})})})),bf="Qo4PtFZI",Cf="wtfpombl",yf=(0,n.ph)((0,s.EK)((e,{modal:t})=>({chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0}))(({modal:e,chat:t})=>{const{sendInviteMessages:i,closeInviteViaLinkModal:a,openPremiumModal:o}=(0,s.ko)(),{missingUsers:r}=e||{},c=(0,T.A)(),[d,h]=(0,n.J0)([]),u=(0,n.Kr)(()=>r?.map(e=>e.id)||yi.p,[r]),[m,p]=(0,n.Kr)(()=>{if(!r?.length)return[[],[]];const[e,t]=(0,Ci.jB)(r,e=>e.isRequiringPremiumToMessage);return[e.map(e=>e.id),t.map(e=>e.id)]},[r]),v=(0,n.Kr)(()=>r?.filter(e=>e.isRequiringPremiumToInvite||e.isRequiringPremiumToMessage).map(e=>e.id),[r]),g=(0,n.Kr)(()=>{if(r)return!r.some(e=>e.isRequiringPremiumToInvite&&!e.isRequiringPremiumToMessage)},[r]),A=(0,n.Kr)(()=>{const e=(0,s.mS)().users.byId;return v?.map(t=>e[t])},[v]);(0,n.vJ)(()=>{h(p)},[p]);const f=(0,M.A)(()=>a()),b=(0,n.hb)(()=>{i({chatId:t.id,userIds:d}),a()},[d,t]),C=(0,n.hb)(()=>{o()},[]),y=(0,n.Kr)(()=>{if(t)return Boolean(t?.isCreator||t?.adminRights?.inviteUsers)},[t]),S=(0,n.Kr)(()=>y?c(1===r?.length?"InviteBlockedOneMessage":"InviteBlockedManyMessage"):c("InviteRestrictedUsers2",r?.length),[y,c,r?.length]),k=(0,n.Kr)(()=>{if(!v?.length||!A?.length)return;const e=g?"InviteMessagePremiumBlocked":"InvitePremiumBlocked";let t=`${e}One`,i=[(0,l.Yg)(A[0])];return 2===v.length?(t=`${e}Two`,i=[(0,l.Yg)(A[0]),(0,l.Yg)(A[1])]):3===v.length?(t=`${e}Three`,i=[(0,l.Yg)(A[0]),(0,l.Yg)(A[1]),(0,l.Yg)(A[2])]):v.length>3&&(t=`${e}Many`,i=[(0,l.Yg)(A[0]),(0,l.Yg)(A[1]),(v.length-2).toString()]),c(t,i,void 0,A.length)},[v,g,c,A]),w=Boolean(A?.length),N=Boolean(p?.length);return(0,te.FD)(X.A,{isOpen:Boolean(u&&t),contentClassName:"n8eENbaR",onClose:f,isSlim:!0,children:[(0,te.Y)(Q.A,{round:!0,color:"translucent",size:"smaller",className:"smosGkw9",ariaLabel:c("Close"),onClick:f,children:(0,te.Y)(W.A,{name:"close"})}),k&&(0,te.FD)(te.FK,{children:[(0,te.Y)(bn.A,{className:"Nc3SOtKd",peers:A,size:"large"}),(0,te.Y)("h3",{className:Cf,children:c(y?"InvitePremiumBlockedTitle":"ChannelInviteViaLinkRestricted")}),(0,te.Y)("p",{className:bf,children:(0,Dt.A)(k,["simple_markdown"])}),(0,te.Y)(Q.A,{withPremiumGradient:!0,isShiny:!0,onClick:C,children:c("InvitePremiumBlockedSubscribe")})]}),w&&N&&(0,te.Y)(Nc.A,{className:"UoMeVIyC",children:c("InvitePremiumBlockedOr")}),N&&(0,te.FD)(te.FK,{children:[(0,te.Y)("h3",{className:Cf,children:c("InviteBlockedTitle")}),(0,te.Y)("p",{className:bf,children:S}),(0,te.Y)(Si.A,{className:"nEYyTS_m",itemIds:u,selectedIds:d,lockedUnselectedIds:m,lockedUnselectedSubtitle:c("InvitePremiumBlockedUser"),onSelectedIdsChange:h,isViewOnly:!y,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),y&&(0,te.Y)(Q.A,{className:"Ttkq3nqt",onClick:b,disabled:!d.length,children:c("SendInviteLink.ActionInvite")})]})]})}));var Sf=i(84555);const kf=(0,n.ph)(({modal:e})=>{const{closeOneTimeMediaModal:t}=(0,s.ko)(),i=(0,T.A)(),n=(0,Ri.A)(e?.message,!0),{shouldRender:o,transitionClassNames:r}=(0,Ke.A)(Boolean(e)),d=(0,M.A)(()=>{}),h=(0,M.A)(()=>{t()});if(!o||!n)return;const u=(0,l.Ie)(n),m=(0,c.SJA)((0,s.mS)()),p=i(u?"Chat.Voice.Single.Close":"Chat.Voice.Single.DeleteAndClose");return(0,te.FD)("div",{className:(0,me.A)("c3xMWwzW",r),children:[function(){if(!n?.content)return;const{voice:e,video:t}=n.content;return e?(0,te.Y)(Jc.Ay,{className:"VLiJWMs0",theme:m,message:n,origin:a.d9.OneTimeModal,autoPlay:!0,onPlay:d,onPause:h}):t?.isRound?(0,te.Y)(Sf.A,{className:"ML2YEpGq",message:n,origin:"oneTimeModal",onStop:h}):void 0}(),(0,te.Y)("div",{className:"VWy1qXJL",children:(0,te.Y)(Q.A,{faded:!0,onClick:h,pill:!0,size:"smaller",color:"dark"===m?"dark":"secondary",className:"FfMrCmD9",children:p})})]})}),wf=(0,n.ph)(({isOpen:e})=>{const t=(0,T.A)(),i=(0,Ui.A)(),{closeWebAppsCloseConfirmationModal:a,closeWebAppModal:o}=(0,s.ko)(),[r,l]=(0,n.J0)(!1),c=(0,n.li)(),d=(0,n.hb)(()=>{a({shouldSkipInFuture:r})},[r]),h=(0,n.hb)(()=>{o({shouldSkipConfirmation:!0}),a({shouldSkipInFuture:r})},[r]),u=(0,n.hb)(e=>{-1===e&&h()},[h]),m=(0,Hn.A)(c,e,u,".Button");return(0,te.FD)(X.A,{className:(0,me.A)("confirm"),title:i("CloseMiniApps"),isOpen:e,onClose:d,children:[(0,te.Y)("p",{children:i("AreYouSureCloseMiniApps")}),(0,te.Y)(ps.A,{className:"dialog-checkbox",label:i("DoNotAskAgain"),checked:r,onCheck:l}),(0,te.FD)("div",{className:"dialog-buttons mt-2",ref:c,onKeyDown:m,children:[(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:h,color:"danger",children:t("Confirm")}),(0,te.Y)(Q.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:t("Cancel")})]})]})}),Nf=(0,n.ph)((0,s.EK)(e=>{const t=e.appConfig.freezeUntilDate,i=e.appConfig.freezeAppealUrl,n=e.botFreezeAppealId?(0,c.mBe)(e,e.botFreezeAppealId):void 0;return{freezeUntilDate:t,freezeAppealUrl:i,botFreezeAppealUsername:n&&(0,l.Kl)(n)}})(({modal:e,freezeUntilDate:t,freezeAppealUrl:i,botFreezeAppealUsername:a})=>{const{closeFrozenAccountModal:o,openUrl:r}=(0,s.ko)(),l=(0,Ui.A)(),c=Boolean(e),d=(0,M.A)(()=>{o()}),h=(0,M.A)(()=>{o(),i&&r({url:i})}),u=(0,n.Kr)(()=>(0,te.FD)("div",{className:"cW2rtp6M",children:[(0,te.Y)(zr.A,{size:160,tgsUrl:jr.w.BannedDuck,noLoop:!0}),(0,te.Y)("div",{className:"qLSm0uyC",children:l("FrozenAccountModalTitle")})]}),[l]),m=(0,n.Kr)(()=>{if(c)return(0,te.FD)("div",{className:"Vj3QQ_JQ",children:[(0,te.Y)(Q.A,{className:"anvg3JaY",onClick:h,noForcedUpperCase:!0,children:l("ButtonAppeal")}),(0,te.Y)(Q.A,{isText:!0,onClick:d,noForcedUpperCase:!0,children:l("ButtonUnderstood")})]})},[l,c]);if(!t||!a)return;const p=new Date(1e3*t),v=(0,te.Y)(Wo.A,{onClick:h,isPrimary:!0,children:(0,Lc.A)(a)}),g=[["hand-stop",l("FrozenAccountViolationTitle"),l("FrozenAccountViolationSubtitle")],["lock",l("FrozenAccountReadOnlyTitle"),l("FrozenAccountReadOnlySubtitle")],["frozen-time",l("FrozenAccountAppealTitle"),l("FrozenAccountAppealSubtitle",{botLink:v,date:(0,He.A)(p,l.code)},{withNodes:!0})]];return(0,te.Y)(El.A,{isOpen:c,header:u,listItemData:g,footer:m,hasBackdrop:!0,onClose:d})})),If="OvdHupR0",Pf=(0,n.ph)((0,s.EK)((e,{modal:t})=>{const i=e.currentUserId,n=t?.userId?(0,c.mBe)(e,t.userId):void 0,s=t?.userId?(0,c.vGo)(e,t.userId):void 0,a=s?.starsRating,o=s?.starsMyPendingRating,r=s?.starsMyPendingRatingDate;return{user:n,currentUserId:i,starsRating:a,pendingRating:o,pendingRatingDate:r}})(({modal:e,user:t,currentUserId:i,starsRating:a,pendingRating:o,pendingRatingDate:r})=>{const{closeProfileRatingModal:l}=(0,s.ko)(),c=(0,Ui.A)(),d=Boolean(e),[h,u]=(0,n.J0)(!1),m=(0,M.A)(()=>{l()});(0,n.vJ)(()=>{d||u(!1)},[d]);const p=(0,M.A)(()=>{u(!0)}),v=(0,M.A)(()=>{u(!1)}),g=e=>{const t="added"===e,i=c(t?"RatingBadgeAdded":"RatingBadgeDeducted"),n=t?"Lr6JUU14":"OxZxdqcn";return(0,te.Y)("span",{className:(0,me.A)("JdeFDQBI",n),children:i})},A=(0,n.Kr)(()=>{if(!(e&&t&&a&&d))return;const n=h&&o?o:a,s=n.stars,l=n.currentLevelStars,u=n.nextLevelStars,m=n.level,g=m+1,A=m<0,f=!h&&o?o.level:a.level;let b=0;b=u&&u>l?Math.max(.03,(s-l)/(u-l)):1;const C=A?.5:Math.max(0,Math.min(1,b)),y=r?r-Math.floor(Date.now()/1e3):0,S=o?o.stars-a.stars:0,k=o&&r;let w="none";m>=0&&f>=0&&m!==f&&(w=m>f?"forward":"backward"),m<0&&f<0&&m!==f&&(w=m<f?"backward":"forward");const N=c("ActionFallbackUser");return(0,te.FD)("div",{className:"ChJT6ggP",children:[(0,te.Y)(ml.A,{leftText:A?void 0:c("RatingLevel",{level:m}),rightText:A?c("RatingNegativeLevel"):c("RatingLevel",{level:g}),floatingBadgeIcon:A?"warning":"crown-wear",floatingBadgeText:A?m.toString():`${c.number(s)} / ${c.number(u||s)}`,progress:C,isPrimary:m>=0,isNegative:m<0,animationDirection:w,className:(0,me.A)("XYpzs7CQ",k&&"UgviXkNW")}),(()=>{if(k)return(0,te.Y)(se.Ay,{name:"fade",className:(0,me.A)("_K5HhOM0",A&&"X6iX4F56"),activeKey:h?1:0,shouldCleanup:!0,shouldRestoreHeight:!0,children:h?(0,te.Y)("p",{children:c("DescriptionFutureRating",{time:(0,He.A$)(c,y),points:Math.abs(S),link:(0,te.Y)("span",{className:"dcNVNCXo",onClick:v,children:c("LinkDescriptionRatingBack")})},{pluralValue:Math.abs(S),withNodes:!0})}):(0,te.Y)("p",{children:c("DescriptionPendingRating",{time:(0,He.A$)(c,y),points:Math.abs(S),link:(0,te.Y)("span",{className:"yY4hj8r_",onClick:p,children:c("LinkDescriptionRatingPreview")})},{pluralValue:Math.abs(S),withNodes:!0})})})})(),(0,te.Y)("div",{className:"IvsV0tkW",children:c("TitleRating")}),(0,te.Y)("p",{className:"ravQhVQQ",children:t?.id===i?c("RatingYourReflectsActivity"):c("RatingReflectsActivity",{name:(0,Ft.F9)(c,t)||N},{withMarkdown:!0,withNodes:!0})})]})},[e,t,i,a,o,r,h,c,p,v,d]),f=[["closed-gift",c("RatingGiftsFromTelegram"),(0,te.FD)("span",{className:If,children:[g("added"),c("RatingGiftsFromTelegramDesc")]})],["user-stars",c("RatingGiftsAndPostsFromUsers"),(0,te.FD)("span",{className:If,children:[g("added"),c("RatingGiftsAndPostsFromUsersDesc")]})],["stars-refund",c("RatingRefundsAndConversions"),(0,te.FD)("span",{className:If,children:[g("deducted"),c("RatingRefundsAndConversionsDesc")]})]],b=(0,n.Kr)(()=>{if(d)return(0,te.Y)("div",{className:"XtZPIDLP",children:(0,te.FD)(Q.A,{onClick:m,children:[(0,te.Y)(W.A,{name:"understood",className:"Lwz8rpdL"}),c("ButtonUnderstood")]})})},[c,d,m]);return(0,te.Y)(El.A,{contentClassName:"ndqkeHwR",isOpen:d,header:A,listItemData:f,footer:b,onClose:m})}))}}]);
//# sourceMappingURL=9451.1bb0524ecd15e6482c40.js.map